<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/fit/langaus.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_6012cc17ed1f4568bbcf0a0e185e84c7.html">fit</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">langaus.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__fit.html">Fit Tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/langaus.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/langaus.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  Convoluted Landau and Gaussian Fitting Function (using <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a>'s Landau and Gauss functions) </p>
<p>Based on a Fortran code by R.Fruehwirth (<a href="#" onclick="location.href='mai'+'lto:'+'fru'+'hw'+'irt'+'h@'+'hep'+'hy'+'.oe'+'aw'+'.ac'+'.a'+'t'; return false;">fruhw<span style="display: none;">.nosp@m.</span>irth<span style="display: none;">.nosp@m.</span>@heph<span style="display: none;">.nosp@m.</span>y.oe<span style="display: none;">.nosp@m.</span>aw.ac<span style="display: none;">.nosp@m.</span>.at</a>)</p>
<p>to execute this example, do:</p>
<div class="fragment"><div class="line">root &gt; .x langaus.C</div></div><!-- fragment --><p>or</p>
<div class="fragment"><div class="line">root &gt; .x langaus.C++</div></div><!-- fragment --><div class="image">
<img src="pict1_langaus.C.png" alt="pict1_langaus.C.png" width="700"/>
</div>
 <div class="fragment"><div class="line"></div><div class="line">Fitting...</div><div class="line"> FCN=5.25252 FROM MIGRAD    STATUS=CONVERGED     193 CALLS         194 TOTAL</div><div class="line">                     EDM=3.227e-09    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                   STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  Width        1.25740e+00   3.04846e-01   1.37307e-04   1.57021e-04</div><div class="line">   2  MP           2.08890e+01   1.28244e+00   3.40886e-05   8.22843e-04</div><div class="line">   3  Area         1.15515e+04   2.42312e+03   1.66644e-05  -1.66635e-03</div><div class="line">   4  GSigma       4.06350e+00   7.58845e-01   2.30703e-04  -2.48397e-04</div><div class="line">Fitting done</div><div class="line">Plotting results...</div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TH1_8h.html">TH1.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TF1_8h.html">TF1.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TROOT_8h.html">TROOT.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TStyle_8h.html">TStyle.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TMath_8h.html">TMath.h</a>&quot;</span></div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> langaufun(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *par) {</div><div class="line"></div><div class="line">   <span class="comment">//Fit parameters:</span></div><div class="line">   <span class="comment">//par[0]=Width (scale) parameter of Landau density</span></div><div class="line">   <span class="comment">//par[1]=Most Probable (MP, location) parameter of Landau density</span></div><div class="line">   <span class="comment">//par[2]=Total area (integral -inf to inf, normalization constant)</span></div><div class="line">   <span class="comment">//par[3]=Width (sigma) of convoluted Gaussian function</span></div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">//In the Landau distribution (represented by the CERNLIB approximation),</span></div><div class="line">   <span class="comment">//the maximum is located at x=-0.22278298 with the location parameter=0.</span></div><div class="line">   <span class="comment">//This shift is corrected within this function, so that the actual</span></div><div class="line">   <span class="comment">//maximum is identical to the MP parameter.</span></div><div class="line"></div><div class="line">      <span class="comment">// Numeric constants</span></div><div class="line">      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> invsq2pi = 0.3989422804014;   <span class="comment">// (2 pi)^(-1/2)</span></div><div class="line">      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> mpshift  = -0.22278298;       <span class="comment">// Landau maximum location</span></div><div class="line"></div><div class="line">      <span class="comment">// Control constants</span></div><div class="line">      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> np = 100.0;      <span class="comment">// number of convolution steps</span></div><div class="line">      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> sc =   5.0;      <span class="comment">// convolution extends to +-sc Gaussian sigmas</span></div><div class="line"></div><div class="line">      <span class="comment">// Variables</span></div><div class="line">      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> xx;</div><div class="line">      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> mpc;</div><div class="line">      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> fland;</div><div class="line">      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="tmva_2tmva_2src_2Factory_8cxx.html#a73e5b6a37db0af518793b45eba2bbe8e">sum</a> = 0.0;</div><div class="line">      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> xlow,xupp;</div><div class="line">      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> step;</div><div class="line">      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> i;</div><div class="line"></div><div class="line"></div><div class="line">      <span class="comment">// MP shift correction</span></div><div class="line">      mpc = par[1] - mpshift * par[0];</div><div class="line"></div><div class="line">      <span class="comment">// Range of convolution integral</span></div><div class="line">      xlow = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0] - sc * par[3];</div><div class="line">      xupp = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0] + sc * par[3];</div><div class="line"></div><div class="line">      step = (xupp-xlow) / np;</div><div class="line"></div><div class="line">      <span class="comment">// Convolution integral of Landau and Gaussian by sum</span></div><div class="line">      <span class="keywordflow">for</span>(i=1.0; i&lt;=np/2; i++) {</div><div class="line">         xx = xlow + (i-.5) * step;</div><div class="line">         fland = <a class="code" href="namespaceTMath.html#a656690875991a17d35e8a514f37f35d9">TMath::Landau</a>(xx,mpc,par[0]) / par[0];</div><div class="line">         <a class="code" href="tmva_2tmva_2src_2Factory_8cxx.html#a73e5b6a37db0af518793b45eba2bbe8e">sum</a> += fland * <a class="code" href="namespaceTMath.html#a1b1e666e3ef4e55ef616d81ac778b149">TMath::Gaus</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0],xx,par[3]);</div><div class="line"></div><div class="line">         xx = xupp - (i-.5) * step;</div><div class="line">         fland = <a class="code" href="namespaceTMath.html#a656690875991a17d35e8a514f37f35d9">TMath::Landau</a>(xx,mpc,par[0]) / par[0];</div><div class="line">         <a class="code" href="tmva_2tmva_2src_2Factory_8cxx.html#a73e5b6a37db0af518793b45eba2bbe8e">sum</a> += fland * <a class="code" href="namespaceTMath.html#a1b1e666e3ef4e55ef616d81ac778b149">TMath::Gaus</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0],xx,par[3]);</div><div class="line">      }</div><div class="line"></div><div class="line">      <span class="keywordflow">return</span> (par[2] * step * <a class="code" href="tmva_2tmva_2src_2Factory_8cxx.html#a73e5b6a37db0af518793b45eba2bbe8e">sum</a> * invsq2pi / par[3]);</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><a class="code" href="classTF1.html">TF1</a> *langaufit(<a class="code" href="classTH1F.html">TH1F</a> *his, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *fitrange, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *startvalues, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *parlimitslo, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *parlimitshi, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *fitparams, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *fiterrors, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *ChiSqr, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> *NDF)</div><div class="line">{</div><div class="line">   <span class="comment">// Once again, here are the Landau * Gaussian parameters:</span></div><div class="line">   <span class="comment">//   par[0]=Width (scale) parameter of Landau density</span></div><div class="line">   <span class="comment">//   par[1]=Most Probable (MP, location) parameter of Landau density</span></div><div class="line">   <span class="comment">//   par[2]=Total area (integral -inf to inf, normalization constant)</span></div><div class="line">   <span class="comment">//   par[3]=Width (sigma) of convoluted Gaussian function</span></div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// Variables for langaufit call:</span></div><div class="line">   <span class="comment">//   his             histogram to fit</span></div><div class="line">   <span class="comment">//   fitrange[2]     lo and hi boundaries of fit range</span></div><div class="line">   <span class="comment">//   startvalues[4]  reasonable start values for the fit</span></div><div class="line">   <span class="comment">//   parlimitslo[4]  lower parameter limits</span></div><div class="line">   <span class="comment">//   parlimitshi[4]  upper parameter limits</span></div><div class="line">   <span class="comment">//   fitparams[4]    returns the final fit parameters</span></div><div class="line">   <span class="comment">//   fiterrors[4]    returns the final fit errors</span></div><div class="line">   <span class="comment">//   ChiSqr          returns the chi square</span></div><div class="line">   <span class="comment">//   NDF             returns ndf</span></div><div class="line"></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a72a4388b7fc57f981af8c65fefcceb1f">Char_t</a> FunName[100];</div><div class="line"></div><div class="line">   sprintf(FunName,<span class="stringliteral">&quot;Fitfcn_%s&quot;</span>,his-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>());</div><div class="line"></div><div class="line">   <a class="code" href="classTF1.html">TF1</a> *ffitold = (<a class="code" href="classTF1.html">TF1</a>*)<a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;GetListOfFunctions()-&gt;FindObject(FunName);</div><div class="line">   <span class="keywordflow">if</span> (ffitold) <span class="keyword">delete</span> ffitold;</div><div class="line"></div><div class="line">   <a class="code" href="classTF1.html">TF1</a> *ffit = <span class="keyword">new</span> <a class="code" href="classTF1.html">TF1</a>(FunName,langaufun,fitrange[0],fitrange[1],4);</div><div class="line">   ffit-&gt;<a class="code" href="classTF1.html#ad3b4503c22e70e5c219031d83e137905">SetParameters</a>(startvalues);</div><div class="line">   ffit-&gt;<a class="code" href="classTF1.html#ad8728f1bc73804ed4f5e3883eec930cc">SetParNames</a>(<span class="stringliteral">&quot;Width&quot;</span>,<span class="stringliteral">&quot;MP&quot;</span>,<span class="stringliteral">&quot;Area&quot;</span>,<span class="stringliteral">&quot;GSigma&quot;</span>);</div><div class="line"></div><div class="line">   <span class="keywordflow">for</span> (i=0; i&lt;4; i++) {</div><div class="line">      ffit-&gt;<a class="code" href="classTF1.html#aa88c62b4561379329cfe10707b7d50e1">SetParLimits</a>(i, parlimitslo[i], parlimitshi[i]);</div><div class="line">   }</div><div class="line"></div><div class="line">   his-&gt;<a class="code" href="classTH1.html#a63eb028df86bc86c8e20c989eb23fb2a">Fit</a>(FunName,<span class="stringliteral">&quot;RB0&quot;</span>);   <span class="comment">// fit within specified range, use ParLimits, do not plot</span></div><div class="line"></div><div class="line">   ffit-&gt;<a class="code" href="classTF1.html#ad0a801d9302263cc47c61d690b4d9bfd">GetParameters</a>(fitparams);    <span class="comment">// obtain fit parameters</span></div><div class="line">   <span class="keywordflow">for</span> (i=0; i&lt;4; i++) {</div><div class="line">      fiterrors[i] = ffit-&gt;<a class="code" href="classTF1.html#a1fb2037102d0f725f2b2a98f8685b987">GetParError</a>(i);     <span class="comment">// obtain fit parameter errors</span></div><div class="line">   }</div><div class="line">   ChiSqr[0] = ffit-&gt;<a class="code" href="classTF1.html#a2f38b1f9f01326158459b1bfd8fe4285">GetChisquare</a>();  <span class="comment">// obtain chi^2</span></div><div class="line">   NDF[0] = ffit-&gt;<a class="code" href="classTF1.html#a0ec4878f851604ca6130832b561e2d81">GetNDF</a>();           <span class="comment">// obtain ndf</span></div><div class="line"></div><div class="line">   <span class="keywordflow">return</span> (ffit);              <span class="comment">// return fit function</span></div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> langaupro(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *params, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> &amp;maxx, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> &amp;FWHM) {</div><div class="line"></div><div class="line">   <span class="comment">// Seaches for the location (x value) at the maximum of the</span></div><div class="line">   <span class="comment">// Landau-Gaussian convolute and its full width at half-maximum.</span></div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// The search is probably not very efficient, but it&#39;s a first try.</span></div><div class="line"></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> p,<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,fy,fxr,fxl;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> step;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>,lold;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> MAXCALLS = 10000;</div><div class="line"></div><div class="line"></div><div class="line">   <span class="comment">// Search for maximum</span></div><div class="line"></div><div class="line">   p = params[1] - 0.1 * params[0];</div><div class="line">   step = 0.05 * params[0];</div><div class="line">   lold = -2.0;</div><div class="line">   <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>    = -1.0;</div><div class="line"></div><div class="line"></div><div class="line">   <span class="keywordflow">while</span> ( (<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> != lold) &amp;&amp; (i &lt; MAXCALLS) ) {</div><div class="line">      i++;</div><div class="line"></div><div class="line">      lold = <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>;</div><div class="line">      <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = p + step;</div><div class="line">      <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = langaufun(&amp;<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,params);</div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &lt; lold)</div><div class="line">         step = -step/10;</div><div class="line"></div><div class="line">      p += step;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (i == MAXCALLS)</div><div class="line">      <span class="keywordflow">return</span> (-1);</div><div class="line"></div><div class="line">   maxx = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>;</div><div class="line"></div><div class="line">   fy = <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>/2;</div><div class="line"></div><div class="line"></div><div class="line">   <span class="comment">// Search for right x location of fy</span></div><div class="line"></div><div class="line">   p = maxx + params[0];</div><div class="line">   step = params[0];</div><div class="line">   lold = -2.0;</div><div class="line">   <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>    = -1e300;</div><div class="line">   i    = 0;</div><div class="line"></div><div class="line"></div><div class="line">   <span class="keywordflow">while</span> ( (<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> != lold) &amp;&amp; (i &lt; MAXCALLS) ) {</div><div class="line">      i++;</div><div class="line"></div><div class="line">      lold = <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>;</div><div class="line">      <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = p + step;</div><div class="line">      <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = <a class="code" href="namespaceTMath.html#af682354cea223351f1306bf98a858dfd">TMath::Abs</a>(langaufun(&amp;<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,params) - fy);</div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &gt; lold)</div><div class="line">         step = -step/10;</div><div class="line"></div><div class="line">      p += step;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (i == MAXCALLS)</div><div class="line">      <span class="keywordflow">return</span> (-2);</div><div class="line"></div><div class="line">   fxr = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>;</div><div class="line"></div><div class="line"></div><div class="line">   <span class="comment">// Search for left x location of fy</span></div><div class="line"></div><div class="line">   p = maxx - 0.5 * params[0];</div><div class="line">   step = -params[0];</div><div class="line">   lold = -2.0;</div><div class="line">   <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>    = -1e300;</div><div class="line">   i    = 0;</div><div class="line"></div><div class="line">   <span class="keywordflow">while</span> ( (<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> != lold) &amp;&amp; (i &lt; MAXCALLS) ) {</div><div class="line">      i++;</div><div class="line"></div><div class="line">      lold = <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>;</div><div class="line">      <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = p + step;</div><div class="line">      <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = <a class="code" href="namespaceTMath.html#af682354cea223351f1306bf98a858dfd">TMath::Abs</a>(langaufun(&amp;<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,params) - fy);</div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &gt; lold)</div><div class="line">         step = -step/10;</div><div class="line"></div><div class="line">      p += step;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (i == MAXCALLS)</div><div class="line">      <span class="keywordflow">return</span> (-3);</div><div class="line"></div><div class="line"></div><div class="line">   fxl = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>;</div><div class="line"></div><div class="line">   FWHM = fxr - fxl;</div><div class="line">   <span class="keywordflow">return</span> (0);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> langaus() {</div><div class="line">   <span class="comment">// Fill Histogram</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> data[100] = {0,0,0,0,0,0,2,6,11,18,18,55,90,141,255,323,454,563,681,</div><div class="line">                    737,821,796,832,720,637,558,519,460,357,291,279,241,212,</div><div class="line">                    153,164,139,106,95,91,76,80,80,59,58,51,30,49,23,35,28,23,</div><div class="line">                    22,27,27,24,20,16,17,14,20,12,12,13,10,17,7,6,12,6,12,4,</div><div class="line">                    9,9,10,3,4,5,2,4,1,5,5,1,7,1,6,3,3,3,4,5,4,4,2,2,7,2,4};</div><div class="line">   <a class="code" href="classTH1F.html">TH1F</a> *hSNR = <span class="keyword">new</span> <a class="code" href="classTH1F.html">TH1F</a>(<span class="stringliteral">&quot;snr&quot;</span>,<span class="stringliteral">&quot;Signal-to-noise&quot;</span>,400,0,400);</div><div class="line"></div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i=0; i&lt;100; i++) hSNR-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(i,data[i]);</div><div class="line"></div><div class="line">   <span class="comment">// Fitting SNR histo</span></div><div class="line">   printf(<span class="stringliteral">&quot;Fitting...\n&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Setting fit range and start values</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> fr[2];</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> sv[4], pllo[4], plhi[4], fp[4], fpe[4];</div><div class="line">   fr[0]=0.3*hSNR-&gt;<a class="code" href="classTH1.html#a3e2fa7eca22330a7f6458e481e6ca0ae">GetMean</a>();</div><div class="line">   fr[1]=3.0*hSNR-&gt;<a class="code" href="classTH1.html#a3e2fa7eca22330a7f6458e481e6ca0ae">GetMean</a>();</div><div class="line"></div><div class="line">   pllo[0]=0.5; pllo[1]=5.0; pllo[2]=1.0; pllo[3]=0.4;</div><div class="line">   plhi[0]=5.0; plhi[1]=50.0; plhi[2]=1000000.0; plhi[3]=5.0;</div><div class="line">   sv[0]=1.8; sv[1]=20.0; sv[2]=50000.0; sv[3]=3.0;</div><div class="line"></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> chisqr;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>    ndf;</div><div class="line">   <a class="code" href="classTF1.html">TF1</a> *fitsnr = langaufit(hSNR,fr,sv,pllo,plhi,fp,fpe,&amp;chisqr,&amp;ndf);</div><div class="line"></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> SNRPeak, SNRFWHM;</div><div class="line">   langaupro(fp,SNRPeak,SNRFWHM);</div><div class="line"></div><div class="line">   printf(<span class="stringliteral">&quot;Fitting done\nPlotting results...\n&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Global style settings</span></div><div class="line">   <a class="code" href="TStyle_8h.html#ace94cabdcf18c1e8a7856d8c3f388cfe">gStyle</a>-&gt;<a class="code" href="classTStyle.html#a0ae6f6044b6d7a32756d7e98bb210d6c">SetOptStat</a>(1111);</div><div class="line">   <a class="code" href="TStyle_8h.html#ace94cabdcf18c1e8a7856d8c3f388cfe">gStyle</a>-&gt;<a class="code" href="classTStyle.html#aedeb1d117d9f16af9f8ad430bf956d64">SetOptFit</a>(111);</div><div class="line">   <a class="code" href="TStyle_8h.html#ace94cabdcf18c1e8a7856d8c3f388cfe">gStyle</a>-&gt;<a class="code" href="classTStyle.html#aed869925b696156a0357f5b3d19fa40d">SetLabelSize</a>(0.03,<span class="stringliteral">&quot;x&quot;</span>);</div><div class="line">   <a class="code" href="TStyle_8h.html#ace94cabdcf18c1e8a7856d8c3f388cfe">gStyle</a>-&gt;<a class="code" href="classTStyle.html#aed869925b696156a0357f5b3d19fa40d">SetLabelSize</a>(0.03,<span class="stringliteral">&quot;y&quot;</span>);</div><div class="line"></div><div class="line">   hSNR-&gt;<a class="code" href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">GetXaxis</a>()-&gt;<a class="code" href="classTAxis.html#aed523b084d6b3f24f6b1128d7810e199">SetRange</a>(0,70);</div><div class="line">   hSNR-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line">   fitsnr-&gt;<a class="code" href="classTF1.html#ab2c6b27e1558988dc7399408666588fa">Draw</a>(<span class="stringliteral">&quot;lsame&quot;</span>);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><dl class="section author"><dt>Authors</dt><dd>H.Pernegger, Markus Friedl </dd></dl>

<p class="definition">Definition in file <a class="el" href="langaus_8C_source.html">langaus.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:07 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/roostats/rs401c_FeldmanCousins.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_87facaa6959ceb8d3dacccaf663f7b84.html">roostats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">rs401c_FeldmanCousins.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__roostats.html">RooStats Tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/rs401c_FeldmanCousins.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/rs401c_FeldmanCousins.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  Produces an interval on the mean signal in a number counting experiment with known background using the Feldman-Cousins technique. </p>
<p>Using the <a class="el" href="namespaceRooStats.html" title="Namespace for the RooStats classes. ">RooStats</a> FeldmanCousins tool with 200 bins it takes 1 min and the interval is [0.2625, 10.6125] with a step size of 0.075. The interval in Feldman &amp; Cousins's original paper is [.29, 10.81] Phys.Rev.D57:3873-3889,1998.</p>
<div class="image">
<img src="pict1_rs401c_FeldmanCousins.C.png" alt="pict1_rs401c_FeldmanCousins.C.png" width="700"/>
</div>
 <div class="image">
<img src="pict2_rs401c_FeldmanCousins.C.png" alt="pict2_rs401c_FeldmanCousins.C.png" width="700"/>
</div>
 <div class="fragment"><div class="line"></div><div class="line"></div><div class="line">[1mRooFit v3.60 -- Developed by Wouter Verkerke and David Kirkby[0m </div><div class="line">                Copyright (C) 2000-2013 NIKHEF, University of California &amp; Stanford University</div><div class="line">                All rights reserved, please read http://roofit.sourceforge.net/license.txt</div><div class="line"></div><div class="line">DataStore poisData (Generated From )</div><div class="line">  Contains 1 entries</div><div class="line">  Observables: </div><div class="line">    1)  x = 7  L(0 - 50)  &quot;&quot;</div><div class="line"></div><div class="line">RooWorkspace()  contents</div><div class="line"></div><div class="line">variables</div><div class="line">---------</div><div class="line">(mu,x)</div><div class="line"></div><div class="line">p.d.f.s</div><div class="line">-------</div><div class="line">RooPoisson::pois[ x=x mean=mean ] = 0.0224772</div><div class="line"></div><div class="line">functions</div><div class="line">--------</div><div class="line">RooAddition::mean[ mu + b ] = 5.5</div><div class="line"></div><div class="line">named sets</div><div class="line">----------</div><div class="line">poissonProblem_Observables:(x)</div><div class="line">poissonProblem_POI:(mu)</div><div class="line"></div><div class="line"></div><div class="line">=== Using the following for poissonProblem ===</div><div class="line">Observables:             RooArgSet:: = (x)</div><div class="line">Parameters of Interest:  RooArgSet:: = (mu)</div><div class="line">PDF:                     RooPoisson::pois[ x=x mean=mean ] = 0.0224772</div><div class="line"></div><div class="line">FeldmanCousins: ntoys per point: adaptive</div><div class="line">FeldmanCousins: nEvents per toy will not fluctuate, will always be 1</div><div class="line">FeldmanCousins: Model has no nuisance parameters</div><div class="line">FeldmanCousins: # points to test = 100</div><div class="line">NeymanConstruction: Prog: 1/100 total MC = 240 this test stat = 1.83324</div><div class="line"> mu=0.075 [-1e+30, 1.08573]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 2/100 total MC = 80 this test stat = 1.64984</div><div class="line"> mu=0.225 [-1e+30, 0.949959]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 3/100 total MC = 80 this test stat = 1.4816</div><div class="line"> mu=0.375 [-1e+30, 0.827185]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 4/100 total MC = 240 this test stat = 1.32721</div><div class="line"> mu=0.525 [-1e+30, 1.32721]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 5/100 total MC = 80 this test stat = 1.1855</div><div class="line"> mu=0.675 [-1e+30, 2.73604]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 6/100 total MC = 240 this test stat = 1.05546</div><div class="line"> mu=0.825 [-1e+30, 1.72806]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 7/100 total MC = 80 this test stat = 0.936198</div><div class="line"> mu=0.975 [-1e+30, 2.32979]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 8/100 total MC = 80 this test stat = 0.826909</div><div class="line"> mu=1.125 [-1e+30, 1.424]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 9/100 total MC = 80 this test stat = 0.726882</div><div class="line"> mu=1.275 [-1e+30, 1.28826]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 10/100 total MC = 80 this test stat = 0.635479</div><div class="line"> mu=1.425 [-1e+30, 1.81459]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 11/100 total MC = 80 this test stat = 0.552124</div><div class="line"> mu=1.575 [-1e+30, 1.66456]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 12/100 total MC = 80 this test stat = 0.476298</div><div class="line"> mu=1.725 [-1e+30, 1.725]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 13/100 total MC = 80 this test stat = 0.40753</div><div class="line"> mu=1.875 [-1e+30, 2.05965]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 14/100 total MC = 80 this test stat = 0.345393</div><div class="line"> mu=2.025 [-1e+30, 1.9066]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 15/100 total MC = 80 this test stat = 0.289496</div><div class="line"> mu=2.175 [-1e+30, 1.76244]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 16/100 total MC = 80 this test stat = 0.239482</div><div class="line"> mu=2.325 [-1e+30, 1.7512]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 17/100 total MC = 80 this test stat = 0.195006</div><div class="line"> mu=2.475 [-1e+30, 1.27184]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 18/100 total MC = 80 this test stat = 0.155824</div><div class="line"> mu=2.625 [-1e+30, 1.99639]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 19/100 total MC = 80 this test stat = 0.121603</div><div class="line"> mu=2.775 [-1e+30, 1.86293]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 20/100 total MC = 80 this test stat = 0.0921062</div><div class="line"> mu=2.925 [-1e+30, 1.73086]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 21/100 total MC = 80 this test stat = 0.0670922</div><div class="line"> mu=3.075 [-1e+30, 1.60585]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 22/100 total MC = 80 this test stat = 0.0463567</div><div class="line"> mu=3.225 [-1e+30, 2.10098]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 23/100 total MC = 80 this test stat = 0.0296823</div><div class="line"> mu=3.375 [-1e+30, 1.96524]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 24/100 total MC = 80 this test stat = 0.0168841</div><div class="line"> mu=3.525 [-1e+30, 1.97094]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 25/100 total MC = 80 this test stat = 0.00778646</div><div class="line"> mu=3.675 [-1e+30, 2.07549]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 26/100 total MC = 80 this test stat = 0.00222463</div><div class="line"> mu=3.825 [-1e+30, 1.59677]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 27/100 total MC = 80 this test stat = 4.47494e-05</div><div class="line"> mu=3.975 [-1e+30, 2.06902]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 28/100 total MC = 80 this test stat = 0.00110295</div><div class="line"> mu=4.125 [-1e+30, 2.39501]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 29/100 total MC = 80 this test stat = 0.00526396</div><div class="line"> mu=4.275 [-1e+30, 1.6175]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 30/100 total MC = 80 this test stat = 0.0123995</div><div class="line"> mu=4.425 [-1e+30, 1.70627]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 31/100 total MC = 80 this test stat = 0.0223862</div><div class="line"> mu=4.575 [-1e+30, 1.79627]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 32/100 total MC = 80 this test stat = 0.0351383</div><div class="line"> mu=4.725 [-1e+30, 2.04934]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 33/100 total MC = 80 this test stat = 0.0505187</div><div class="line"> mu=4.875 [-1e+30, 2.94484]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 34/100 total MC = 80 this test stat = 0.0684391</div><div class="line"> mu=5.025 [-1e+30, 3.0571]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 35/100 total MC = 80 this test stat = 0.0888053</div><div class="line"> mu=5.175 [-1e+30, 2.27954]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 36/100 total MC = 80 this test stat = 0.11153</div><div class="line"> mu=5.325 [-1e+30, 2.26305]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 37/100 total MC = 80 this test stat = 0.136526</div><div class="line"> mu=5.475 [-1e+30, 2.03894]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 38/100 total MC = 80 this test stat = 0.163716</div><div class="line"> mu=5.625 [-1e+30, 1.55152]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 39/100 total MC = 80 this test stat = 0.193024</div><div class="line"> mu=5.775 [-1e+30, 1.81715]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 40/100 total MC = 80 this test stat = 0.224377</div><div class="line"> mu=5.925 [-1e+30, 1.71475]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 41/100 total MC = 80 this test stat = 0.257707</div><div class="line"> mu=6.075 [-1e+30, 2.75427]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 42/100 total MC = 80 this test stat = 0.292951</div><div class="line"> mu=6.225 [-1e+30, 2.03573]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 43/100 total MC = 80 this test stat = 0.330045</div><div class="line"> mu=6.375 [-1e+30, 1.92767]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 44/100 total MC = 80 this test stat = 0.368932</div><div class="line"> mu=6.525 [-1e+30, 2.0545]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 45/100 total MC = 80 this test stat = 0.409554</div><div class="line"> mu=6.675 [-1e+30, 2.142]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 46/100 total MC = 80 this test stat = 0.45186</div><div class="line"> mu=6.825 [-1e+30, 2.72294]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 47/100 total MC = 80 this test stat = 0.495797</div><div class="line"> mu=6.975 [-1e+30, 2.03823]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 48/100 total MC = 80 this test stat = 0.541318</div><div class="line"> mu=7.125 [-1e+30, 2.41015]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 49/100 total MC = 80 this test stat = 0.588375</div><div class="line"> mu=7.275 [-1e+30, 1.83449]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 50/100 total MC = 80 this test stat = 0.636924</div><div class="line"> mu=7.425 [-1e+30, 2.80213]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 51/100 total MC = 80 this test stat = 0.686922</div><div class="line"> mu=7.575 [-1e+30, 1.82973]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 52/100 total MC = 80 this test stat = 0.738329</div><div class="line"> mu=7.725 [-1e+30, 1.9093]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 53/100 total MC = 80 this test stat = 0.791105</div><div class="line"> mu=7.875 [-1e+30, 1.98986]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 54/100 total MC = 80 this test stat = 0.845213</div><div class="line"> mu=8.025 [-1e+30, 2.81879]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 55/100 total MC = 80 this test stat = 0.900613</div><div class="line"> mu=8.175 [-1e+30, 2.23216]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 56/100 total MC = 80 this test stat = 0.957282</div><div class="line"> mu=8.325 [-1e+30, 1.51348]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 57/100 total MC = 80 this test stat = 1.01518</div><div class="line"> mu=8.475 [-1e+30, 2.32134]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 58/100 total MC = 80 this test stat = 1.07427</div><div class="line"> mu=8.625 [-1e+30, 4.56136]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 59/100 total MC = 80 this test stat = 1.13452</div><div class="line"> mu=8.775 [-1e+30, 1.83847]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 60/100 total MC = 80 this test stat = 1.19591</div><div class="line"> mu=8.925 [-1e+30, 1.80373]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 61/100 total MC = 80 this test stat = 1.25841</div><div class="line"> mu=9.075 [-1e+30, 2.45893]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 62/100 total MC = 80 this test stat = 1.32199</div><div class="line"> mu=9.225 [-1e+30, 1.95466]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 63/100 total MC = 80 this test stat = 1.38662</div><div class="line"> mu=9.375 [-1e+30, 2.24356]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 64/100 total MC = 80 this test stat = 1.45228</div><div class="line"> mu=9.525 [-1e+30, 2.50319]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 65/100 total MC = 80 this test stat = 1.51895</div><div class="line"> mu=9.675 [-1e+30, 3.02403]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 66/100 total MC = 240 this test stat = 1.5866</div><div class="line"> mu=9.825 [-1e+30, 1.60451]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 67/100 total MC = 80 this test stat = 1.6552</div><div class="line"> mu=9.975 [-1e+30, 3.20706]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 68/100 total MC = 80 this test stat = 1.72474</div><div class="line"> mu=10.125 [-1e+30, 2.42844]  in interval = 1</div><div class="line"></div><div class="line">[#0] PROGRESS:Generation -- generated toys: 500 / 1440</div><div class="line">[#0] PROGRESS:Generation -- generated toys: 1000 / 1440</div><div class="line">NeymanConstruction: Prog: 69/100 total MC = 2160 this test stat = 1.79519</div><div class="line"> mu=10.275 [-1e+30, 1.79519]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 70/100 total MC = 240 this test stat = 1.86654</div><div class="line"> mu=10.425 [-1e+30, 1.86654]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 71/100 total MC = 80 this test stat = 1.93876</div><div class="line"> mu=10.575 [-1e+30, 2.67618]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 72/100 total MC = 80 this test stat = 2.01184</div><div class="line"> mu=10.725 [-1e+30, 1.40678]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 73/100 total MC = 80 this test stat = 2.08575</div><div class="line"> mu=10.875 [-1e+30, 1.86151]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 74/100 total MC = 240 this test stat = 2.16048</div><div class="line"> mu=11.025 [-1e+30, 1.7642]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 75/100 total MC = 80 this test stat = 2.23601</div><div class="line"> mu=11.175 [-1e+30, 1.59869]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 76/100 total MC = 240 this test stat = 2.31232</div><div class="line"> mu=11.325 [-1e+30, 1.66448]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 77/100 total MC = 80 this test stat = 2.38941</div><div class="line"> mu=11.475 [-1e+30, 1.26987]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 78/100 total MC = 240 this test stat = 2.46724</div><div class="line"> mu=11.625 [-1e+30, 1.40071]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 79/100 total MC = 80 this test stat = 2.54582</div><div class="line"> mu=11.775 [-1e+30, 1.86704]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 80/100 total MC = 80 this test stat = 2.62511</div><div class="line"> mu=11.925 [-1e+30, 1.93623]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 81/100 total MC = 80 this test stat = 2.70511</div><div class="line"> mu=12.075 [-1e+30, 1.43268]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 82/100 total MC = 240 this test stat = 2.7858</div><div class="line"> mu=12.225 [-1e+30, 1.49357]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 83/100 total MC = 80 this test stat = 2.86717</div><div class="line"> mu=12.375 [-1e+30, 1.55534]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 84/100 total MC = 80 this test stat = 2.94921</div><div class="line"> mu=12.525 [-1e+30, 1.12633]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 85/100 total MC = 80 this test stat = 3.0319</div><div class="line"> mu=12.675 [-1e+30, 2.29398]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 86/100 total MC = 80 this test stat = 3.11523</div><div class="line"> mu=12.825 [-1e+30, 1.7457]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 87/100 total MC = 80 this test stat = 3.1992</div><div class="line"> mu=12.975 [-1e+30, 1.8108]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 88/100 total MC = 80 this test stat = 3.28378</div><div class="line"> mu=13.125 [-1e+30, 2.51757]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 89/100 total MC = 240 this test stat = 3.36896</div><div class="line"> mu=13.275 [-1e+30, 1.40455]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 90/100 total MC = 80 this test stat = 3.45474</div><div class="line"> mu=13.425 [-1e+30, 2.01076]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 91/100 total MC = 240 this test stat = 3.5411</div><div class="line"> mu=13.575 [-1e+30, 2.07896]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 92/100 total MC = 80 this test stat = 3.62804</div><div class="line"> mu=13.725 [-1e+30, 2.14788]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 93/100 total MC = 80 this test stat = 3.71554</div><div class="line"> mu=13.875 [-1e+30, 1.16768]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 94/100 total MC = 80 this test stat = 3.80359</div><div class="line"> mu=14.025 [-1e+30, 1.70402]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 95/100 total MC = 240 this test stat = 3.89219</div><div class="line"> mu=14.175 [-1e+30, 1.7663]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 96/100 total MC = 240 this test stat = 3.98132</div><div class="line"> mu=14.325 [-1e+30, 1.32819]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 97/100 total MC = 80 this test stat = 4.07097</div><div class="line"> mu=14.475 [-1e+30, 1.38336]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 98/100 total MC = 80 this test stat = 4.16114</div><div class="line"> mu=14.625 [-1e+30, 1.43935]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 99/100 total MC = 240 this test stat = 4.25182</div><div class="line"> mu=14.775 [-1e+30, 1.49612]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 100/100 total MC = 240 this test stat = 4.343</div><div class="line"> mu=14.925 [-1e+30, 2.08888]  in interval = 0</div><div class="line"></div><div class="line">[#1] INFO:Eval -- 68 points in interval</div><div class="line">is this point in the interval? 0</div><div class="line">interval is [0.525, 10.575]</div><div class="line">Real time 0:00:02, CP time 2.590</div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooGlobalFunc_8h.html">RooGlobalFunc.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ConfInterval_8h.html">RooStats/ConfInterval.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="PointSetInterval_8h.html">RooStats/PointSetInterval.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ConfidenceBelt_8h.html">RooStats/ConfidenceBelt.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="FeldmanCousins_8h.html">RooStats/FeldmanCousins.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ModelConfig_8h.html">RooStats/ModelConfig.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooWorkspace_8h.html">RooWorkspace.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooDataSet_8h.html">RooDataSet.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooRealVar_8h.html">RooRealVar.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooConstVar_8h.html">RooConstVar.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooAddition_8h.html">RooAddition.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooDataHist_8h.html">RooDataHist.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooPoisson_8h.html">RooPoisson.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooPlot_8h.html">RooPlot.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TTree_8h.html">TTree.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TH1F_8h.html">TH1F.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TMarker_8h.html">TMarker.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TStopwatch_8h.html">TStopwatch.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// use this order for safety on library loading</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooFit.html">RooFit</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooStats.html">RooStats</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> rs401c_FeldmanCousins()</div><div class="line">{</div><div class="line">   <span class="comment">// to time the macro... about 30 s</span></div><div class="line">   <a class="code" href="classTStopwatch.html">TStopwatch</a> t;</div><div class="line">   t.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line"></div><div class="line">   <span class="comment">// make a simple model</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>(<span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 1, 0, 50);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> mu(<span class="stringliteral">&quot;mu&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 2.5, 0, 15); <span class="comment">// with a limit on mu&gt;=0</span></div><div class="line">   <a class="code" href="classRooConstVar.html">RooConstVar</a> <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>(<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 3.);</div><div class="line">   <a class="code" href="classRooAddition.html">RooAddition</a> mean(<span class="stringliteral">&quot;mean&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="classRooArgList.html">RooArgList</a>(mu, <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>));</div><div class="line">   <a class="code" href="classRooPoisson.html">RooPoisson</a> pois(<span class="stringliteral">&quot;pois&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, mean);</div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> parameters(mu);</div><div class="line"></div><div class="line">   <span class="comment">// create a toy dataset</span></div><div class="line">   <a class="code" href="classRooDataSet.html">RooDataSet</a> *data = pois.generate(<a class="code" href="classRooArgSet.html">RooArgSet</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>), 1);</div><div class="line">   data-&gt;<a class="code" href="classRooAbsData.html#a98d1640c9b96aca94a44a83f2443321d">Print</a>(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"></div><div class="line">   <a class="code" href="classTCanvas.html">TCanvas</a> *dataCanvas = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>(<span class="stringliteral">&quot;dataCanvas&quot;</span>);</div><div class="line">   <a class="code" href="classRooPlot.html">RooPlot</a> *frame = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>.frame();</div><div class="line">   data-&gt;<a class="code" href="classRooAbsData.html#ac27709a0077810f29787f046e8d03898">plotOn</a>(frame);</div><div class="line">   frame-&gt;<a class="code" href="classRooPlot.html#ad7cdede86cb3721e079ec55fcb3b4edc">Draw</a>();</div><div class="line">   dataCanvas-&gt;<a class="code" href="classTCanvas.html#a83bb3270c4e4cd4250730d5586ceebd6">Update</a>();</div><div class="line"></div><div class="line">   <a class="code" href="classRooWorkspace.html">RooWorkspace</a> *w = <span class="keyword">new</span> <a class="code" href="classRooWorkspace.html">RooWorkspace</a>();</div><div class="line">   <a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> modelConfig(<span class="stringliteral">&quot;poissonProblem&quot;</span>, w);</div><div class="line">   modelConfig.<a class="code" href="classRooStats_1_1ModelConfig.html#afdd514ddbe92c70b56d0a3cc87f0a745">SetPdf</a>(pois);</div><div class="line">   modelConfig.<a class="code" href="classRooStats_1_1ModelConfig.html#a6c7174b07a0cf56574f04d7e319cd15c">SetParametersOfInterest</a>(parameters);</div><div class="line">   modelConfig.<a class="code" href="classRooStats_1_1ModelConfig.html#a0e4f2861bf29e08e6c518b2d09f9376f">SetObservables</a>(<a class="code" href="classRooArgSet.html">RooArgSet</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>));</div><div class="line">   w-&gt;<a class="code" href="classRooWorkspace.html#a9131cf30e7ea371b14a619ebf0d7e18f">Print</a>();</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   //////// show use of Feldman-Cousins</span></div><div class="line"><span class="comment"></span>   <a class="code" href="classRooStats_1_1FeldmanCousins.html">RooStats::FeldmanCousins</a> <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>(*data, modelConfig);</div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.SetTestSize(.05); <span class="comment">// set size of test</span></div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.UseAdaptiveSampling(<span class="keyword">true</span>);</div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.FluctuateNumDataEntries(<span class="keyword">false</span>); <span class="comment">// number counting analysis: dataset always has 1 entry with N events observed</span></div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.SetNBins(100);                  <span class="comment">// number of points to test per parameter</span></div><div class="line"></div><div class="line">   <span class="comment">// use the Feldman-Cousins tool</span></div><div class="line">   <a class="code" href="classRooStats_1_1PointSetInterval.html">PointSetInterval</a> *interval = (<a class="code" href="classRooStats_1_1PointSetInterval.html">PointSetInterval</a> *)<a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetInterval();</div><div class="line"></div><div class="line">   <span class="comment">// make a canvas for plots</span></div><div class="line">   <a class="code" href="classTCanvas.html">TCanvas</a> *intervalCanvas = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>(<span class="stringliteral">&quot;intervalCanvas&quot;</span>);</div><div class="line"></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;is this point in the interval? &quot;</span> &lt;&lt; interval-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#aaf24f6918bb1b53d769431a4c5369be1">IsInInterval</a>(parameters) &lt;&lt; std::endl;</div><div class="line"></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;interval is [&quot;</span> &lt;&lt; interval-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#aa221cea064f8013ff5f7fde218a226e3">LowerLimit</a>(mu) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; interval-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#a8c43f888bbc5ba55ec8553a0506dcfc6">UpperLimit</a>(mu) &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">// using 200 bins it takes 1 min and the answer is</span></div><div class="line">   <span class="comment">// interval is [0.2625, 10.6125] with a step size of .075</span></div><div class="line">   <span class="comment">// The interval in Feldman &amp; Cousins&#39;s original paper is [.29, 10.81]</span></div><div class="line">   <span class="comment">//  Phys.Rev.D57:3873-3889,1998.</span></div><div class="line"></div><div class="line">   <span class="comment">// No dedicated plotting class yet, so do it by hand:</span></div><div class="line"></div><div class="line">   <a class="code" href="classRooDataHist.html">RooDataHist</a> *parameterScan = (<a class="code" href="classRooDataHist.html">RooDataHist</a> *)<a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetPointsToScan();</div><div class="line">   <a class="code" href="classTH1F.html">TH1F</a> *hist = (<a class="code" href="classTH1F.html">TH1F</a> *)parameterScan-&gt;<a class="code" href="classRooAbsData.html#a6bedebf5f36a904d7083469e19bf7184">createHistogram</a>(<span class="stringliteral">&quot;mu&quot;</span>, 30);</div><div class="line">   hist-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line"></div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *tmpPoint;</div><div class="line">   <span class="comment">// loop over points to test</span></div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0; i &lt; parameterScan-&gt;<a class="code" href="classRooDataHist.html#a5b038f19e19dfefebeb798b07d787def">numEntries</a>(); ++i) {</div><div class="line">      <span class="comment">//    cout &lt;&lt; &quot;on parameter point &quot; &lt;&lt; i &lt;&lt; &quot; out of &quot; &lt;&lt; parameterScan-&gt;numEntries() &lt;&lt; endl;</span></div><div class="line">      <span class="comment">// get a parameter point from the list of points to test.</span></div><div class="line">      tmpPoint = (<a class="code" href="classRooArgSet.html">RooArgSet</a> *)parameterScan-&gt;<a class="code" href="classRooDataHist.html#a404062c26adf9084ded720a375eb7d1b">get</a>(i)-&gt;<a class="code" href="classRooArgSet.html#a693748866f98afb0b4e9efd40de6b405">clone</a>(<span class="stringliteral">&quot;temp&quot;</span>);</div><div class="line"></div><div class="line">      <a class="code" href="classTMarker.html">TMarker</a> *<a class="code" href="triangle_8c.html#a487cec016bbf0452d2d944074585baa8">mark</a> = <span class="keyword">new</span> <a class="code" href="classTMarker.html">TMarker</a>(tmpPoint-&gt;<a class="code" href="classRooArgSet.html#a72568bf2b2726891810ba3b3e8251f0b">getRealValue</a>(<span class="stringliteral">&quot;mu&quot;</span>), 1, 25);</div><div class="line">      <span class="keywordflow">if</span> (interval-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#aaf24f6918bb1b53d769431a4c5369be1">IsInInterval</a>(*tmpPoint))</div><div class="line">         <a class="code" href="triangle_8c.html#a487cec016bbf0452d2d944074585baa8">mark</a>-&gt;SetMarkerColor(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8aab48c32302f7159d81e081c41dc2d3d2">kBlue</a>);</div><div class="line">      <span class="keywordflow">else</span></div><div class="line">         <a class="code" href="triangle_8c.html#a487cec016bbf0452d2d944074585baa8">mark</a>-&gt;SetMarkerColor(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a5a655b1a02e5b0311571ca57ce4f3900">kRed</a>);</div><div class="line"></div><div class="line">      <a class="code" href="triangle_8c.html#a487cec016bbf0452d2d944074585baa8">mark</a>-&gt;Draw(<span class="stringliteral">&quot;s&quot;</span>);</div><div class="line">      <span class="comment">// delete tmpPoint;</span></div><div class="line">      <span class="comment">//    delete mark;</span></div><div class="line">   }</div><div class="line">   t.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   t.<a class="code" href="classTStopwatch.html#aa393762ec66c9732940dccf05e8be7ec">Print</a>();</div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>Kyle Cranmer </dd></dl>

<p class="definition">Definition in file <a class="el" href="rs401c__FeldmanCousins_8C_source.html">rs401c_FeldmanCousins.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:26 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

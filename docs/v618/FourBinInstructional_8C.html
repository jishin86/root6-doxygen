<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/roostats/FourBinInstructional.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_87facaa6959ceb8d3dacccaf663f7b84.html">roostats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">FourBinInstructional.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__roostats.html">RooStats Tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/FourBinInstructional.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/FourBinInstructional.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  This example is a generalization of the on/off problem. </p>
<p>This example is a generalization of the on/off problem. It's a common setup for SUSY searches. Imagine that one has two variables "x" and "y" (eg. missing ET and SumET), see figure. The signal region has high values of both of these variables (top right). One can see low values of "x" or "y" acting as side-bands. If we just used "y" as a sideband, we would have the on/off problem.</p><ul>
<li>In the signal region we observe non events and expect s+b events.</li>
<li>In the region with low values of "y" (bottom right) we observe noff events and expect tau*b events. Note the significance of tau. In the background only case:</li>
</ul>
<div class="fragment"><div class="line"><a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a> ~ &lt;expectation off&gt; / &lt;expectation on&gt;</div></div><!-- fragment --><p>If tau is known, this model is sufficient, but often tau is not known exactly. So one can use low values of "x" as an additional constraint for tau. Note that this technique critically depends on the notion that the joint distribution for "x" and "y" can be factorized. Generally, these regions have many events, so it the ratio can be measured very precisely there. So we extend the model to describe the left two boxes... denoted with "bar".</p><ul>
<li>In the upper left we observe nonbar events and expect bbar events</li>
<li>In the bottom left we observe noffbar events and expect tau bbar events Note again we have:</li>
</ul>
<div class="fragment"><div class="line"><a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a> ~ &lt;expectation off <a class="code" href="namespaceTGeant4Unit.html#a1ab8b5cfc85e9ba5e9ec983cd924f67a">bar</a>&gt; / &lt;expectation on <a class="code" href="namespaceTGeant4Unit.html#a1ab8b5cfc85e9ba5e9ec983cd924f67a">bar</a>&gt;</div></div><!-- fragment --><p>One can further expand the model to account for the systematic associated to assuming the distribution of "x" and "y" factorizes (eg. that tau is the same for off/on and offbar/onbar). This can be done in several ways, but here we introduce an additional parameter rho, which so that one set of models will use tau and the other tau*rho. The choice is arbitrary, but it has consequences on the numerical stability of the algorithms. The "bar" measurements typically have more events (&amp; smaller relative errors). If we choose</p>
<div class="fragment"><div class="line">&lt;expectation noffbar&gt; = <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a> * rho * &lt;expectation noonbar&gt;</div></div><!-- fragment --><p>the product tau*rho will be known very precisely (~1/sqrt(bbar)) and the contour in those parameters will be narrow and have a non-trivial tau~1/rho shape. However, if we choose to put rho on the non/noff measurements (where the product will have an error <code>~1/sqrt(b))</code>, the contours will be more amenable to numerical techniques. Thus, here we choose to define:</p>
<div class="fragment"><div class="line">   <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a> := &lt;expectation off <a class="code" href="namespaceTGeant4Unit.html#a1ab8b5cfc85e9ba5e9ec983cd924f67a">bar</a>&gt; / (&lt;expectation on <a class="code" href="namespaceTGeant4Unit.html#a1ab8b5cfc85e9ba5e9ec983cd924f67a">bar</a>&gt;)</div><div class="line">   rho := &lt;expectation off&gt; / (&lt;expectation on&gt; * <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a>)</div><div class="line"></div><div class="line">^ <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a></div><div class="line">|</div><div class="line">|---------------------------+</div><div class="line">|               |           |</div><div class="line">|     nonbar    |    non    |</div><div class="line">|      bbar     |    <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>+<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>    |</div><div class="line">|               |           |</div><div class="line">|---------------+-----------|</div><div class="line">|               |           |</div><div class="line">|    noffbar    |    noff   |</div><div class="line">|    <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a> bbar   | <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a> <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> rho |</div><div class="line">|               |           |</div><div class="line">+-----------------------------&gt; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a></div></div><!-- fragment --><p>Left in this way, the problem is under-constrained. However, one may have some auxiliary measurement (usually based on Monte Carlo) to constrain rho. Let us call this auxiliary measurement that gives the nominal value of rho "rhonom". Thus, there is a 'constraint' term in the full model: P(rhonom | rho). In this case, we consider a Gaussian constraint with standard deviation sigma.</p>
<p>In the example, the initial values of the parameters are:</p>
<div class="fragment"><div class="line">- <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>    = 40</div><div class="line">- <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>    = 100</div><div class="line">- <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a>  = 5</div><div class="line">- bbar = 1000</div><div class="line">- rho  = 1</div><div class="line">(<a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a> <span class="keywordflow">for</span> rho = 20%)</div></div><!-- fragment --><p>and in the toy dataset:</p>
<div class="fragment"><div class="line">- non = 139</div><div class="line">- noff = 528</div><div class="line">- nonbar = 993</div><div class="line">- noffbar = 4906</div><div class="line">- rhonom = 1.27824</div></div><!-- fragment --><p>Note, the covariance matrix of the parameters has large off-diagonal terms. Clearly s,b are anti-correlated. Similarly, since noffbar &gt;&gt; nonbar, one would expect bbar,tau to be anti-correlated.</p>
<p>This can be seen below.</p>
<div class="fragment"><div class="line">       GLOBAL      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>    bbar   rho      <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>     <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a></div><div class="line">   <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>  0.96820   1.000  0.191 -0.942 -0.762 -0.209</div><div class="line">bbar  0.91191   0.191  1.000  0.000 -0.146 -0.912</div><div class="line"> rho  0.96348  -0.942  0.000  1.000  0.718 -0.000</div><div class="line">   <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>  0.76250  -0.762 -0.146  0.718  1.000  0.160</div><div class="line"> <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a>  0.92084  -0.209 -0.912 -0.000  0.160  1.000</div></div><!-- fragment --><p>Similarly, since tau*rho appears as a product, we expect rho,tau to be anti-correlated. When the error on rho is significantly larger than 1/sqrt(bbar), tau is essentially known and the correlation is minimal (tau mainly cares about bbar, and rho about b,s). In the alternate parametrization (bbar* tau * rho) the correlation coefficient for rho,tau is large (and negative).</p>
<p>The code below uses best-practices for <a class="el" href="namespaceRooFit.html" title="Template specialisation used in RooAbsArg: ">RooFit</a> &amp; <a class="el" href="namespaceRooStats.html" title="Namespace for the RooStats classes. ">RooStats</a> as of June 2010.</p>
<p>It proceeds as follows:</p><ul>
<li>create a workspace to hold the model</li>
<li>use workspace factory to quickly create the terms of the model</li>
<li>use workspace factory to define total model (a prod pdf)</li>
<li>create a <a class="el" href="namespaceRooStats.html" title="Namespace for the RooStats classes. ">RooStats</a> ModelConfig to specify observables, parameters of interest</li>
<li>add to the ModelConfig a prior on the parameters for Bayesian techniques note, the pdf it is factorized for parameters of interest &amp; nuisance params</li>
<li>visualize the model</li>
<li>write the workspace to a file</li>
<li>use several of <a class="el" href="namespaceRooStats.html" title="Namespace for the RooStats classes. ">RooStats</a> IntervalCalculators &amp; compare results</li>
</ul>
<div class="image">
<img src="pict1_FourBinInstructional.C.png" alt="pict1_FourBinInstructional.C.png" width="700"/>
</div>
 <div class="fragment"><div class="line"></div><div class="line"></div><div class="line">[1mRooFit v3.60 -- Developed by Wouter Verkerke and David Kirkby[0m </div><div class="line">                Copyright (C) 2000-2013 NIKHEF, University of California &amp; Stanford University</div><div class="line">                All rights reserved, please read http://roofit.sourceforge.net/license.txt</div><div class="line"></div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(wspace) importing dataset modelData</div><div class="line">[#1] INFO:Minization -- createNLL: caching constraint set under name CONSTR_OF_PDF_model_FOR_OBS_noff:noffbar:non:nonbar:rhonom with 0 entries</div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::DoGLobalFit - find MLE </div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::DoMinimizeNLL - using Minuit / Migrad with strategy 1</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization --  The following expressions will be evaluated in cache-and-track mode: (on,off,onbar,offbar,mcCons)</div><div class="line">[#1] INFO:Minization -- </div><div class="line">  RooFitResult: minimized FCN value: 16.2872, estimated distance to minimum: 1.21263e-07</div><div class="line">                covariance matrix quality: Full, accurate covariance matrix</div><div class="line">                Status : MINIMIZE=0 </div><div class="line"></div><div class="line">    Floating Parameter    FinalValue +/-  Error   </div><div class="line">  --------------------  --------------------------</div><div class="line">                     b    8.3602e+01 +/-  1.39e+01</div><div class="line">                  bbar    9.9301e+02 +/-  3.15e+01</div><div class="line">                   rho    1.2783e+00 +/-  1.99e-01</div><div class="line">                     s    5.5397e+01 +/-  1.78e+01</div><div class="line">                   tau    4.9405e+00 +/-  1.72e-01</div><div class="line"></div><div class="line">Bayesian Calc. only supports on parameter of interest</div><div class="line">[#1] INFO:Minization -- createNLL picked up cached consraints from workspace with 0 entries</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization --  The following expressions will be evaluated in cache-and-track mode: (on,off,onbar,offbar,mcCons)</div><div class="line"> **********</div><div class="line"> **    1 **SET PRINT           1</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    2 **SET NOGRAD</div><div class="line"> **********</div><div class="line"> PARAMETER DEFINITIONS:</div><div class="line">    NO.   NAME         VALUE      STEP SIZE      LIMITS</div><div class="line">     1 b            1.17958e+02  1.38657e+01    0.00000e+00  3.00000e+02</div><div class="line">     2 bbar         1.00111e+03  3.15028e+01    5.00000e+02  2.00000e+03</div><div class="line">     3 rho          9.28979e-01  1.98664e-01    0.00000e+00  2.00000e+00</div><div class="line">     4 s            1.20959e+01  1.78108e+01    0.00000e+00  1.00000e+02</div><div class="line"> MINUIT WARNING IN PARAMETR</div><div class="line"> ============== VARIABLE4 BROUGHT BACK INSIDE LIMITS.</div><div class="line">     5 tau          4.89226e+00  1.71714e-01    3.00000e+00  7.00000e+00</div><div class="line"> **********</div><div class="line"> **    3 **SET ERR         0.5</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    4 **SET PRINT           1</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    5 **SET STR           1</div><div class="line"> **********</div><div class="line"> NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY</div><div class="line"> **********</div><div class="line"> **    6 **MIGRAD        2500           1</div><div class="line"> **********</div><div class="line"> FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.</div><div class="line"> START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03</div><div class="line"> FCN=18.2144 FROM MIGRAD    STATUS=INITIATE       20 CALLS          21 TOTAL</div><div class="line">                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       </div><div class="line">  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  b            1.17958e+02   1.38657e+01   9.47846e-02  -1.99668e-02</div><div class="line">   2  bbar         1.00111e+03   3.15028e+01   4.45472e-02  -1.41126e-01</div><div class="line">   3  rho          9.28979e-01   1.98664e-01   2.00529e-01  -1.44934e-02</div><div class="line">   4  s            1.20959e+01   1.78108e+01   5.77645e-01  -2.24297e+00</div><div class="line">   5  tau          4.89226e+00   1.71714e-01   8.60889e-02  -8.62116e-02</div><div class="line">                               ERR DEF= 0.5</div><div class="line"> MIGRAD MINIMIZATION HAS CONVERGED.</div><div class="line"> MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.</div><div class="line"> COVARIANCE MATRIX CALCULATED SUCCESSFULLY</div><div class="line"> FCN=16.2872 FROM MIGRAD    STATUS=CONVERGED     190 CALLS         191 TOTAL</div><div class="line">                     EDM=3.60952e-06    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                   STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  b            8.35905e+01   1.38674e+01   7.30675e-05   2.40054e-02</div><div class="line">   2  bbar         9.93029e+02   3.15029e+01   5.19045e-05  -3.02691e-02</div><div class="line">   3  rho          1.27859e+00   1.98756e-01   1.58308e-04   1.62267e-02</div><div class="line">   4  s            5.54105e+01   1.78121e+01   6.70504e-04   3.43694e-04</div><div class="line">   5  tau          4.94037e+00   1.71705e-01   9.49080e-05  -2.33170e-02</div><div class="line">                               ERR DEF= 0.5</div><div class="line"> EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  5    ERR DEF=0.5</div><div class="line">  1.930e+02  8.359e+01 -2.620e+00 -1.929e+02 -5.000e-01 </div><div class="line">  8.359e+01  9.931e+02  1.215e-04 -8.356e+01 -4.941e+00 </div><div class="line"> -2.620e+00  1.215e-04  4.008e-02  2.619e+00 -7.270e-07 </div><div class="line"> -1.929e+02 -8.356e+01  2.619e+00  3.319e+02  4.999e-01 </div><div class="line"> -5.000e-01 -4.941e+00 -7.270e-07  4.999e-01  2.956e-02 </div><div class="line"> PARAMETER  CORRELATION COEFFICIENTS  </div><div class="line">       NO.  GLOBAL      1      2      3      4      5</div><div class="line">        1  0.96819   1.000  0.191 -0.942 -0.762 -0.209</div><div class="line">        2  0.91196   0.191  1.000  0.000 -0.146 -0.912</div><div class="line">        3  0.96348  -0.942  0.000  1.000  0.718 -0.000</div><div class="line">        4  0.76233  -0.762 -0.146  0.718  1.000  0.160</div><div class="line">        5  0.92088  -0.209 -0.912 -0.000  0.160  1.000</div><div class="line"> **********</div><div class="line"> **    7 **SET ERR         0.5</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    8 **SET PRINT           1</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    9 **HESSE        2500</div><div class="line"> **********</div><div class="line"> COVARIANCE MATRIX CALCULATED SUCCESSFULLY</div><div class="line"> FCN=16.2872 FROM HESSE     STATUS=OK             31 CALLS         222 TOTAL</div><div class="line">                     EDM=3.61105e-06    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                INTERNAL      INTERNAL  </div><div class="line">  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   </div><div class="line">   1  b            8.35905e+01   1.38730e+01   1.46135e-05  -4.58641e-01</div><div class="line">   2  bbar         9.93029e+02   3.15087e+01   1.03809e-05  -3.49712e-01</div><div class="line">   3  rho          1.27859e+00   1.98830e-01   3.16616e-05   2.82321e-01</div><div class="line">   4  s            5.54105e+01   1.78187e+01   1.34101e-04   1.08422e-01</div><div class="line">   5  tau          4.94037e+00   1.71739e-01   1.89816e-05  -2.98215e-02</div><div class="line">                               ERR DEF= 0.5</div><div class="line"> EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  5    ERR DEF=0.5</div><div class="line">  1.931e+02  8.364e+01 -2.622e+00 -1.931e+02 -5.003e-01 </div><div class="line">  8.364e+01  9.935e+02 -1.760e-04 -8.364e+01 -4.943e+00 </div><div class="line"> -2.622e+00 -1.760e-04  4.011e-02  2.622e+00  1.053e-06 </div><div class="line"> -1.931e+02 -8.364e+01  2.622e+00  3.321e+02  5.003e-01 </div><div class="line"> -5.003e-01 -4.943e+00  1.053e-06  5.003e-01  2.957e-02 </div><div class="line"> PARAMETER  CORRELATION COEFFICIENTS  </div><div class="line">       NO.  GLOBAL      1      2      3      4      5</div><div class="line">        1  0.96821   1.000  0.191 -0.942 -0.763 -0.209</div><div class="line">        2  0.91199   0.191  1.000 -0.000 -0.146 -0.912</div><div class="line">        3  0.96351  -0.942 -0.000  1.000  0.718  0.000</div><div class="line">        4  0.76255  -0.763 -0.146  0.718  1.000  0.160</div><div class="line">        5  0.92091  -0.209 -0.912  0.000  0.160  1.000</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_model_modelData_Profile[s]) Creating instance of MINUIT</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_model_modelData_Profile[s]) determining minimum likelihood for current configurations w.r.t all observable</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_model_modelData_Profile[s]) minimum found at (s=55.4077)</div><div class="line">.</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_model_modelData_Profile[s]) Creating instance of MINUIT</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_model_modelData_Profile[s]) determining minimum likelihood for current configurations w.r.t all observable</div><div class="line">[#0] ERROR:InputArguments -- RooArgSet::checkForDup: ERROR argument with name s is already in this set</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_model_modelData_Profile[s]) minimum found at (s=55.4105)</div><div class="line">..........................................................................................................................................................................................................Profile Likelihood interval on s = [12.1902, 88.6871]</div><div class="line">Real time 0:00:00, CP time 0.220</div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TStopwatch_8h.html">TStopwatch.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TROOT_8h.html">TROOT.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooPlot_8h.html">RooPlot.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooAbsPdf_8h.html">RooAbsPdf.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooWorkspace_8h.html">RooWorkspace.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooDataSet_8h.html">RooDataSet.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooGlobalFunc_8h.html">RooGlobalFunc.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooFitResult_8h.html">RooFitResult.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooRandom_8h.html">RooRandom.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ProfileLikelihoodCalculator_8h.html">RooStats/ProfileLikelihoodCalculator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="LikelihoodInterval_8h.html">RooStats/LikelihoodInterval.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="LikelihoodIntervalPlot_8h.html">RooStats/LikelihoodIntervalPlot.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="BayesianCalculator_8h.html">RooStats/BayesianCalculator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="MCMCCalculator_8h.html">RooStats/MCMCCalculator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="MCMCInterval_8h.html">RooStats/MCMCInterval.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="MCMCIntervalPlot_8h.html">RooStats/MCMCIntervalPlot.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ProposalHelper_8h.html">RooStats/ProposalHelper.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SimpleInterval_8h.html">RooStats/SimpleInterval.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="FeldmanCousins_8h.html">RooStats/FeldmanCousins.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="PointSetInterval_8h.html">RooStats/PointSetInterval.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooFit.html">RooFit</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooStats.html">RooStats</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> FourBinInstructional(<span class="keywordtype">bool</span> doBayesian = <span class="keyword">false</span>, <span class="keywordtype">bool</span> doFeldmanCousins = <span class="keyword">false</span>, <span class="keywordtype">bool</span> doMCMC = <span class="keyword">false</span>)</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// let&#39;s time this challenging example</span></div><div class="line">   <a class="code" href="classTStopwatch.html">TStopwatch</a> t;</div><div class="line">   t.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line"></div><div class="line">   <span class="comment">// set RooFit random seed for reproducible results</span></div><div class="line">   <a class="code" href="classRooRandom.html#af8d5482a5fd444ed2a20beb1d248a25e">RooRandom::randomGenerator</a>()-&gt;<a class="code" href="classTRandom.html#a2007ae15ce828266aecb783ed3410e8b">SetSeed</a>(4357);</div><div class="line"></div><div class="line">   <span class="comment">// make model</span></div><div class="line">   <a class="code" href="classRooWorkspace.html">RooWorkspace</a> *wspace = <span class="keyword">new</span> <a class="code" href="classRooWorkspace.html">RooWorkspace</a>(<span class="stringliteral">&quot;wspace&quot;</span>);</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Poisson::on(non[0,1000], sum::splusb(s[40,0,100],b[100,0,300]))&quot;</span>);</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Poisson::off(noff[0,5000], prod::taub(b,tau[5,3,7],rho[1,0,2]))&quot;</span>);</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Poisson::onbar(nonbar[0,10000], bbar[1000,500,2000])&quot;</span>);</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Poisson::offbar(noffbar[0,1000000], prod::lambdaoffbar(bbar, tau))&quot;</span>);</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Gaussian::mcCons(rhonom[1.,0,2], rho, sigma[.2])&quot;</span>);</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;PROD::model(on,off,onbar,offbar,mcCons)&quot;</span>);</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#abe7f509a5b08d97201cfa90c1cf91479">defineSet</a>(<span class="stringliteral">&quot;obs&quot;</span>, <span class="stringliteral">&quot;non,noff,nonbar,noffbar,rhonom&quot;</span>);</div><div class="line"></div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Uniform::prior_poi({s})&quot;</span>);</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Uniform::prior_nuis({b,bbar,tau, rho})&quot;</span>);</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;PROD::prior(prior_poi,prior_nuis)&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// ----------------------------------</span></div><div class="line">   <span class="comment">// Control some interesting variations</span></div><div class="line">   <span class="comment">// define parameers of interest</span></div><div class="line">   <span class="comment">// for 1-d plots</span></div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#abe7f509a5b08d97201cfa90c1cf91479">defineSet</a>(<span class="stringliteral">&quot;poi&quot;</span>, <span class="stringliteral">&quot;s&quot;</span>);</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#abe7f509a5b08d97201cfa90c1cf91479">defineSet</a>(<span class="stringliteral">&quot;nuis&quot;</span>, <span class="stringliteral">&quot;b,tau,rho,bbar&quot;</span>);</div><div class="line">   <span class="comment">// for 2-d plots to inspect correlations:</span></div><div class="line">   <span class="comment">//  wspace-&gt;defineSet(&quot;poi&quot;,&quot;s,rho&quot;);</span></div><div class="line"></div><div class="line">   <span class="comment">// test simpler cases where parameters are known.</span></div><div class="line">   <span class="comment">//  wspace-&gt;var(&quot;tau&quot;)-&gt;setConstant();</span></div><div class="line">   <span class="comment">//  wspace-&gt;var(&quot;rho&quot;)-&gt;setConstant();</span></div><div class="line">   <span class="comment">//  wspace-&gt;var(&quot;b&quot;)-&gt;setConstant();</span></div><div class="line">   <span class="comment">//  wspace-&gt;var(&quot;bbar&quot;)-&gt;setConstant();</span></div><div class="line"></div><div class="line">   <span class="comment">// inspect workspace</span></div><div class="line">   <span class="comment">//  wspace-&gt;Print();</span></div><div class="line"></div><div class="line">   <span class="comment">// ----------------------------------------------------------</span></div><div class="line">   <span class="comment">// Generate toy data</span></div><div class="line">   <span class="comment">// generate toy data assuming current value of the parameters</span></div><div class="line">   <span class="comment">// import into workspace.</span></div><div class="line">   <span class="comment">// add Verbose() to see how it&#39;s being generated</span></div><div class="line">   <a class="code" href="classRooDataSet.html">RooDataSet</a> *data = wspace-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;model&quot;</span>)-&gt;<a class="code" href="classRooAbsPdf.html#aff9a0b0fd2e1cab5124bd0d209ecbb18">generate</a>(*wspace-&gt;<a class="code" href="classRooWorkspace.html#af505b7efdb0c2aae4a2e4234734ba51d">set</a>(<span class="stringliteral">&quot;obs&quot;</span>), 1);</div><div class="line">   <span class="comment">//  data-&gt;Print(&quot;v&quot;);</span></div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#acff0ca83ad63c5b7a4cb8ea39d0e1669">import</a>(*data);</div><div class="line"></div><div class="line">   <span class="comment">// ----------------------------------</span></div><div class="line">   <span class="comment">// Now the statistical tests</span></div><div class="line">   <span class="comment">// model config</span></div><div class="line">   <a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> *modelConfig = <span class="keyword">new</span> <a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a>(<span class="stringliteral">&quot;FourBins&quot;</span>);</div><div class="line">   modelConfig-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a4fb60011fc248f5919f06718a15961da">SetWorkspace</a>(*wspace);</div><div class="line">   modelConfig-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#afdd514ddbe92c70b56d0a3cc87f0a745">SetPdf</a>(*wspace-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;model&quot;</span>));</div><div class="line">   modelConfig-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2e20b49de09efa96c8306ccf0840e65d">SetPriorPdf</a>(*wspace-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;prior&quot;</span>));</div><div class="line">   modelConfig-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a6c7174b07a0cf56574f04d7e319cd15c">SetParametersOfInterest</a>(*wspace-&gt;<a class="code" href="classRooWorkspace.html#af505b7efdb0c2aae4a2e4234734ba51d">set</a>(<span class="stringliteral">&quot;poi&quot;</span>));</div><div class="line">   modelConfig-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ae1f9b32270671d2bf7b9f0fcac4f957e">SetNuisanceParameters</a>(*wspace-&gt;<a class="code" href="classRooWorkspace.html#af505b7efdb0c2aae4a2e4234734ba51d">set</a>(<span class="stringliteral">&quot;nuis&quot;</span>));</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#acff0ca83ad63c5b7a4cb8ea39d0e1669">import</a>(*modelConfig);</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#a99bc69a858f1dd54a3f69fcb11b0081f">writeToFile</a>(<span class="stringliteral">&quot;FourBin.root&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------</span></div><div class="line">   <span class="comment">// If you want to see the covariance matrix uncomment</span></div><div class="line">   <span class="comment">//  wspace-&gt;pdf(&quot;model&quot;)-&gt;fitTo(*data);</span></div><div class="line"></div><div class="line">   <span class="comment">// use ProfileLikelihood</span></div><div class="line">   <a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html">ProfileLikelihoodCalculator</a> plc(*data, *modelConfig);</div><div class="line">   plc.SetConfidenceLevel(0.95);</div><div class="line">   <a class="code" href="classRooStats_1_1LikelihoodInterval.html">LikelihoodInterval</a> *plInt = plc.GetInterval();</div><div class="line">   <a class="code" href="namespaceRooFit.html#a36e12ae9ea9c0d3ab48f71c4ffcdace3">RooFit::MsgLevel</a> msglevel = <a class="code" href="classRooMsgService.html#a1aa4beeeda7e2aab5de645f2b8774c9c">RooMsgService::instance</a>().<a class="code" href="classRooMsgService.html#af93881c7dc6172b3e71419943a0244df">globalKillBelow</a>();</div><div class="line">   <a class="code" href="classRooMsgService.html#a1aa4beeeda7e2aab5de645f2b8774c9c">RooMsgService::instance</a>().<a class="code" href="classRooMsgService.html#a2dd001ce79ae42f7b8ff145053f255ed">setGlobalKillBelow</a>(<a class="code" href="namespaceRooFit.html#a36e12ae9ea9c0d3ab48f71c4ffcdace3a42b1fe0b904c330d15b7566bffe55b3a">RooFit::FATAL</a>);</div><div class="line">   plInt-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#a0fdc8984bf021be6c212c9dec27d2da1">LowerLimit</a>(*wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;s&quot;</span>)); <span class="comment">// get ugly print out of the way. Fix.</span></div><div class="line">   <a class="code" href="classRooMsgService.html#a1aa4beeeda7e2aab5de645f2b8774c9c">RooMsgService::instance</a>().<a class="code" href="classRooMsgService.html#a2dd001ce79ae42f7b8ff145053f255ed">setGlobalKillBelow</a>(msglevel);</div><div class="line"></div><div class="line">   <span class="comment">// use FeldmaCousins (takes ~20 min)</span></div><div class="line">   <a class="code" href="classRooStats_1_1FeldmanCousins.html">FeldmanCousins</a> <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>(*data, *modelConfig);</div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.SetConfidenceLevel(0.95);</div><div class="line">   <span class="comment">// number counting: dataset always has 1 entry with N events observed</span></div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.FluctuateNumDataEntries(<span class="keyword">false</span>);</div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.UseAdaptiveSampling(<span class="keyword">true</span>);</div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.SetNBins(40);</div><div class="line">   <a class="code" href="classRooStats_1_1PointSetInterval.html">PointSetInterval</a> *fcInt = NULL;</div><div class="line">   <span class="keywordflow">if</span> (doFeldmanCousins) {                          <span class="comment">// takes 7 minutes</span></div><div class="line">      fcInt = (<a class="code" href="classRooStats_1_1PointSetInterval.html">PointSetInterval</a> *)<a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetInterval(); <span class="comment">// fix cast</span></div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// use BayesianCalculator (only 1-d parameter of interest, slow for this problem)</span></div><div class="line">   <a class="code" href="classRooStats_1_1BayesianCalculator.html">BayesianCalculator</a> bc(*data, *modelConfig);</div><div class="line">   bc.SetConfidenceLevel(0.95);</div><div class="line">   <a class="code" href="classRooStats_1_1SimpleInterval.html">SimpleInterval</a> *bInt = NULL;</div><div class="line">   <span class="keywordflow">if</span> (doBayesian &amp;&amp; wspace-&gt;<a class="code" href="classRooWorkspace.html#af505b7efdb0c2aae4a2e4234734ba51d">set</a>(<span class="stringliteral">&quot;poi&quot;</span>)-&gt;<a class="code" href="classRooAbsCollection.html#a4cd5c184f7be3a6a1ec80d7f8ff5842e">getSize</a>() == 1) {</div><div class="line">      bInt = bc.GetInterval();</div><div class="line">   } <span class="keywordflow">else</span> {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;Bayesian Calc. only supports on parameter of interest&quot;</span> &lt;&lt; endl;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// use MCMCCalculator  (takes about 1 min)</span></div><div class="line">   <span class="comment">// Want an efficient proposal function, so derive it from covariance</span></div><div class="line">   <span class="comment">// matrix of fit</span></div><div class="line">   <a class="code" href="classRooFitResult.html">RooFitResult</a> *fit = wspace-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;model&quot;</span>)-&gt;<a class="code" href="classRooAbsPdf.html#a8f802a3a93467d5b7b089e3ccaec0fa8">fitTo</a>(*data, <a class="code" href="namespaceRooFit.html#aaccf9043976e51d28313a373a022f003">Save</a>());</div><div class="line">   <a class="code" href="classRooStats_1_1ProposalHelper.html">ProposalHelper</a> ph;</div><div class="line">   ph.<a class="code" href="classRooStats_1_1ProposalHelper.html#a69f305778842862cf5f793facdaa4c61">SetVariables</a>((<a class="code" href="classRooArgSet.html">RooArgSet</a> &amp;)fit-&gt;<a class="code" href="classRooFitResult.html#a90de237846f00972f77ecd6fb346b471">floatParsFinal</a>());</div><div class="line">   ph.<a class="code" href="classRooStats_1_1ProposalHelper.html#a1ad42c99d84a9b94023e07757d71dd40">SetCovMatrix</a>(fit-&gt;<a class="code" href="classRooFitResult.html#a16fffe1a2eafa3733bc2501a7bf23b62">covarianceMatrix</a>());</div><div class="line">   ph.<a class="code" href="classRooStats_1_1ProposalHelper.html#a32046486740cee28adeaaeade6e33783">SetUpdateProposalParameters</a>(<a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>); <span class="comment">// auto-create mean vars and add mappings</span></div><div class="line">   ph.<a class="code" href="classRooStats_1_1ProposalHelper.html#a9acb9ac26ffa8b6b7b994a594cf10e37">SetCacheSize</a>(100);</div><div class="line">   <a class="code" href="classRooStats_1_1ProposalFunction.html">ProposalFunction</a> *pf = ph.<a class="code" href="classRooStats_1_1ProposalHelper.html#a5fc754f0a8f348cbfa17a83de916889b">GetProposalFunction</a>();</div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1MCMCCalculator.html">MCMCCalculator</a> mc(*data, *modelConfig);</div><div class="line">   mc.SetConfidenceLevel(0.95);</div><div class="line">   mc.SetProposalFunction(*pf);</div><div class="line">   mc.SetNumBurnInSteps(500); <span class="comment">// first N steps to be ignored as burn-in</span></div><div class="line">   mc.SetNumIters(50000);</div><div class="line">   mc.SetLeftSideTailFraction(0.5); <span class="comment">// make a central interval</span></div><div class="line">   <a class="code" href="classRooStats_1_1MCMCInterval.html">MCMCInterval</a> *mcInt = NULL;</div><div class="line">   <span class="keywordflow">if</span> (doMCMC)</div><div class="line">      mcInt = mc.GetInterval();</div><div class="line"></div><div class="line">   <span class="comment">// ----------------------------------</span></div><div class="line">   <span class="comment">// Make some  plots</span></div><div class="line">   <a class="code" href="classTCanvas.html">TCanvas</a> *<a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a> = (<a class="code" href="classTCanvas.html">TCanvas</a> *)<a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;Get(<span class="stringliteral">&quot;c1&quot;</span>);</div><div class="line">   <span class="keywordflow">if</span> (!<a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>)</div><div class="line">      <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a> = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>(<span class="stringliteral">&quot;c1&quot;</span>);</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (doBayesian &amp;&amp; doMCMC) {</div><div class="line">      <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;Divide(3);</div><div class="line">      <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(1);</div><div class="line">   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (doBayesian || doMCMC) {</div><div class="line">      <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;Divide(2);</div><div class="line">      <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(1);</div><div class="line">   }</div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1LikelihoodIntervalPlot.html">LikelihoodIntervalPlot</a> *lrplot = <span class="keyword">new</span> <a class="code" href="classRooStats_1_1LikelihoodIntervalPlot.html">LikelihoodIntervalPlot</a>(plInt);</div><div class="line">   lrplot-&gt;<a class="code" href="classRooStats_1_1LikelihoodIntervalPlot.html#a7cc57cbb1fd4aa50f3e76cb3815321d8">Draw</a>();</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (doBayesian &amp;&amp; wspace-&gt;<a class="code" href="classRooWorkspace.html#af505b7efdb0c2aae4a2e4234734ba51d">set</a>(<span class="stringliteral">&quot;poi&quot;</span>)-&gt;<a class="code" href="classRooAbsCollection.html#a4cd5c184f7be3a6a1ec80d7f8ff5842e">getSize</a>() == 1) {</div><div class="line">      <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(2);</div><div class="line">      <span class="comment">// the plot takes a long time and print lots of error</span></div><div class="line">      <span class="comment">// using a scan it is better</span></div><div class="line">      bc.SetScanOfPosterior(20);</div><div class="line">      <a class="code" href="classRooPlot.html">RooPlot</a> *bplot = bc.GetPosteriorPlot();</div><div class="line">      bplot-&gt;<a class="code" href="classRooPlot.html#ad7cdede86cb3721e079ec55fcb3b4edc">Draw</a>();</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (doMCMC) {</div><div class="line">      <span class="keywordflow">if</span> (doBayesian &amp;&amp; wspace-&gt;<a class="code" href="classRooWorkspace.html#af505b7efdb0c2aae4a2e4234734ba51d">set</a>(<span class="stringliteral">&quot;poi&quot;</span>)-&gt;<a class="code" href="classRooAbsCollection.html#a4cd5c184f7be3a6a1ec80d7f8ff5842e">getSize</a>() == 1)</div><div class="line">         <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(3);</div><div class="line">      <span class="keywordflow">else</span></div><div class="line">         <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(2);</div><div class="line">      <a class="code" href="classRooStats_1_1MCMCIntervalPlot.html">MCMCIntervalPlot</a> mcPlot(*mcInt);</div><div class="line">      mcPlot.Draw();</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// ----------------------------------</span></div><div class="line">   <span class="comment">// querry intervals</span></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Profile Likelihood interval on s = [&quot;</span> &lt;&lt; plInt-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#a0fdc8984bf021be6c212c9dec27d2da1">LowerLimit</a>(*wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;s&quot;</span>)) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line">        &lt;&lt; plInt-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#a8083e0c3adbd18cd86f0048846981d36">UpperLimit</a>(*wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;s&quot;</span>)) &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; endl;</div><div class="line">   <span class="comment">// Profile Likelihood interval on s = [12.1902, 88.6871]</span></div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (doBayesian &amp;&amp; wspace-&gt;<a class="code" href="classRooWorkspace.html#af505b7efdb0c2aae4a2e4234734ba51d">set</a>(<span class="stringliteral">&quot;poi&quot;</span>)-&gt;<a class="code" href="classRooAbsCollection.html#a4cd5c184f7be3a6a1ec80d7f8ff5842e">getSize</a>() == 1) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;Bayesian interval on s = [&quot;</span> &lt;&lt; bInt-&gt;<a class="code" href="classRooStats_1_1SimpleInterval.html#a92358336f7ea5e22682904fc4f421777">LowerLimit</a>() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; bInt-&gt;<a class="code" href="classRooStats_1_1SimpleInterval.html#a68d9e474835ac16a4955e2790196b0ce">UpperLimit</a>() &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; endl;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (doFeldmanCousins) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;Feldman Cousins interval on s = [&quot;</span> &lt;&lt; fcInt-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#aa221cea064f8013ff5f7fde218a226e3">LowerLimit</a>(*wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;s&quot;</span>)) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line">           &lt;&lt; fcInt-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#a8c43f888bbc5ba55ec8553a0506dcfc6">UpperLimit</a>(*wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;s&quot;</span>)) &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="comment">// Feldman Cousins interval on s = [18.75 +/- 2.45, 83.75 +/- 2.45]</span></div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (doMCMC) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;MCMC interval on s = [&quot;</span> &lt;&lt; mcInt-&gt;<a class="code" href="classRooStats_1_1MCMCInterval.html#a8431ef4e859c68a2d08f0a2562e2e8e6">LowerLimit</a>(*wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;s&quot;</span>)) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line">           &lt;&lt; mcInt-&gt;<a class="code" href="classRooStats_1_1MCMCInterval.html#a14314c91266d7ff84d7fcdf14b8f655e">UpperLimit</a>(*wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;s&quot;</span>)) &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="comment">// MCMC interval on s = [15.7628, 84.7266]</span></div><div class="line">   }</div><div class="line"></div><div class="line">   t.<a class="code" href="classTStopwatch.html#aa393762ec66c9732940dccf05e8be7ec">Print</a>();</div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Authors</dt><dd>authors: Kyle Cranmer, Tanja Rommerskirchen </dd></dl>

<p class="definition">Definition in file <a class="el" href="FourBinInstructional_8C_source.html">FourBinInstructional.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:25 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/fit/multidimfit.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_6012cc17ed1f4568bbcf0a0e185e84c7.html">fit</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">multidimfit.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__fit.html">Fit Tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/multidimfit.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/multidimfit.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  Multi-Dimensional Parametrisation and Fitting </p>
<div class="fragment"><div class="line"></div><div class="line">*************************************************</div><div class="line">*             Multidimensional Fit              *</div><div class="line">*                                               *</div><div class="line">* By Christian Holm &lt;cholm@nbi.dk&gt; 14/10/00     *</div><div class="line">*************************************************</div><div class="line"></div><div class="line">User parameters:</div><div class="line">----------------</div><div class="line"> Variables:                    4</div><div class="line"> Data points:                  0</div><div class="line"> Max Terms:                    30</div><div class="line"> Power Limit Parameter:        1</div><div class="line"> Max functions:                1000</div><div class="line"> Max functions to study:       1000</div><div class="line"> Max angle (optional):         10</div><div class="line"> Min angle:                    10</div><div class="line"> Relative Error accepted:      0.01</div><div class="line"> Maximum Powers:                6 6 6 6</div><div class="line"></div><div class="line"> Parameterisation will be done using Monomials</div><div class="line"></div><div class="line">======================================</div><div class="line">Sample statistics:</div><div class="line">------------------</div><div class="line">                 D          1          2          3          4</div><div class="line"> Max:     141.6264      9.954       9.99      9.998      9.995</div><div class="line"> Min:     0.149448     0.0455    0.01523    0.04109   0.003819</div><div class="line"> Mean:    48.40441      5.033      5.044          5      5.002</div><div class="line"> Function Sum Squares:         1.678e+06</div><div class="line"></div><div class="line">Coeff   SumSqRes    Contrib   Angle      QM   Func     Value        W^2  Powers</div><div class="line">    1  5.065e+05  1.367e-26      10 6.67e-07     0  -5.23e-15        500  0 0 0 0</div><div class="line">    2   1.15e+05  3.915e+05      50   0.167     2      47.33      174.7  1 0 0 0</div><div class="line">    3  8.755e+04  2.749e+04      80   0.167     1      13.26      156.3  0 0 0 1</div><div class="line">    4  6.188e+04  2.568e+04      80   0.167     3      12.39      167.3  0 0 1 0</div><div class="line">    5  3.708e+04   2.48e+04      80   0.167     4       12.6      156.3  0 1 0 0</div><div class="line">    6  2.596e+04  1.112e+04      85   0.333     8      14.91      50.03  1 1 0 0</div><div class="line">    7  1.667e+04       9290      85   0.333     9      13.02      54.78  1 0 0 1</div><div class="line">    8       7382       9287      85   0.333    14      12.64      58.13  1 0 1 0</div><div class="line">    9       6235       1147    87.5   0.333     5      5.095      44.16  0 0 0 2</div><div class="line">   10       5218       1018    87.5   0.333    12      4.983      40.99  0 2 0 0</div><div class="line">   11       4193       1025    87.5   0.667    53      5.229       37.5  0 0 4 0</div><div class="line">   12       3299      893.8    88.8   0.333     6     -4.058      54.27  0 0 1 1</div><div class="line">   13       2458      841.2    88.8   0.333     7     -4.155      48.73  0 1 0 1</div><div class="line">   14       1933      524.7    88.8   0.333    13     -3.291      48.45  0 1 1 0</div><div class="line">   15       1675      258.1    88.8     0.5    19      4.211      14.56  1 0 0 2</div><div class="line">   16       1334      340.6    88.8     0.5    26     -4.731      15.22  1 1 0 1</div><div class="line">   17       1079      255.5    88.8     0.5    33      3.953      16.35  1 0 2 0</div><div class="line">   18      788.2      290.4    88.8     0.5    34      4.687      13.22  1 2 0 0</div><div class="line">   19      709.2      78.94    89.4     0.5    21       2.23      15.88  0 1 1 1</div><div class="line">   20      473.4      235.8    89.4     0.5    23     -3.543      18.78  1 0 1 1</div><div class="line">   21      235.4        238    89.4     0.5    28     -3.976      15.06  1 1 1 0</div><div class="line">Results of Parameterisation:</div><div class="line">----------------------------</div><div class="line"> Total reduction of square residuals    5.063e+05</div><div class="line"> Relative precision obtained:           0.01185</div><div class="line"> Error obtained:                        235.4</div><div class="line"> Multiple correlation coefficient:      0.9995</div><div class="line"> Reduced Chi square over sample:        0.4975</div><div class="line"> Maximum residual value:                3.243</div><div class="line"> Minimum residual value:                -2.59</div><div class="line"> Estimated root mean square:            0.6862</div><div class="line"> Maximum powers used:                   1 2 4 2 </div><div class="line"> Function codes of candidate functions.</div><div class="line">  1: considered,  2: too little contribution,  3: accepted.</div><div class="line"> 3333333333 1133311113 1313113131 1113311111 1111111111 1113111111</div><div class="line"> 1111111111 1111111111 1111111111 1111111111 1111111111 1111111111</div><div class="line"> 111111</div><div class="line"> Loop over candidates stopped because max allowed studies reached</div><div class="line"></div><div class="line">Coefficients:</div><div class="line">-------------</div><div class="line">   #         Value        Error   Powers</div><div class="line"> ---------------------------------------</div><div class="line">   0        -4.371       0.08798     0   0   0   0</div><div class="line">   1         43.15        0.1601     1   0   0   0</div><div class="line">   2         13.43       0.08032     0   0   0   1</div><div class="line">   3         13.46       0.07805     0   0   1   0</div><div class="line">   4          13.4       0.08054     0   1   0   0</div><div class="line">   5         13.33        0.1423     1   1   0   0</div><div class="line">   6          13.3        0.1367     1   0   0   1</div><div class="line">   7         13.35        0.1331     1   0   1   0</div><div class="line">   8         4.497        0.1511     0   0   0   2</div><div class="line">   9         4.639        0.1585     0   2   0   0</div><div class="line">  10          4.89         0.164     0   0   4   0</div><div class="line">  11          -3.7        0.1364     0   0   1   1</div><div class="line">  12        -3.986        0.1438     0   1   0   1</div><div class="line">  13        -3.862        0.1458     0   1   1   0</div><div class="line">  14         4.361        0.2614     1   0   0   2</div><div class="line">  15        -4.026        0.2555     1   1   0   1</div><div class="line">  16          4.57        0.2477     1   0   2   0</div><div class="line">  17         4.698        0.2729     1   2   0   0</div><div class="line">  18         2.838        0.2525     0   1   1   1</div><div class="line">  19        -3.489        0.2292     1   0   1   1</div><div class="line">  20        -3.976        0.2566     1   1   1   0</div><div class="line"></div><div class="line">Results of Fit:</div><div class="line">---------------</div><div class="line"> Test sample size:                      2100</div><div class="line"> Multiple correlation coefficient:      0.9994</div><div class="line"> Relative precision obtained:           0.0001753</div><div class="line"> Error obtained:                        1275</div><div class="line"> Reduced Chi square over sample:        2.47</div><div class="line"></div><div class="line"> FCN=1 FROM MIGRAD    STATUS=CONVERGED     861 CALLS         862 TOTAL</div><div class="line">                     EDM=1.67352e-06    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                  PHYSICAL LIMITS       </div><div class="line">  NO.   NAME      VALUE            ERROR       NEGATIVE      POSITIVE  </div><div class="line">   1  coeff00     -4.39851e+00   4.44260e-02</div><div class="line">   2  coeff01      4.31493e+01   8.56451e-02</div><div class="line">   3  coeff02      1.34121e+01   3.78565e-02</div><div class="line">   4  coeff03      1.34869e+01   3.80951e-02</div><div class="line">   5  coeff04      1.33954e+01   3.74054e-02</div><div class="line">   6  coeff05      1.32280e+01   6.57916e-02</div><div class="line">   7  coeff06      1.33441e+01   6.75855e-02</div><div class="line">   8  coeff07      1.32943e+01   6.66410e-02</div><div class="line">   9  coeff08      4.52254e+00   7.39945e-02</div><div class="line">  10  coeff09      4.65912e+00   7.21745e-02</div><div class="line">  11  coeff10      4.94808e+00   8.14935e-02</div><div class="line">  12  coeff11     -4.02586e+00   6.53780e-02</div><div class="line">  13  coeff12     -4.04534e+00   6.55396e-02</div><div class="line">  14  coeff13     -3.93856e+00   6.51725e-02</div><div class="line">  15  coeff14      4.42141e+00   1.30526e-01</div><div class="line">  16  coeff15     -4.00581e+00   1.17191e-01</div><div class="line">  17  coeff16      4.62595e+00   1.30233e-01</div><div class="line">  18  coeff17      4.37782e+00   1.28579e-01</div><div class="line">  19  coeff18      3.51629e+00   1.13771e-01</div><div class="line">  20  coeff19     -4.11068e+00   1.17446e-01</div><div class="line">  21  coeff20     -3.82302e+00   1.16486e-01</div><div class="line"></div><div class="line">Coefficients:</div><div class="line">-------------</div><div class="line">   #         Value        Error   Powers</div><div class="line"> ---------------------------------------</div><div class="line">   0        -4.399       0.04443     0   0   0   0</div><div class="line">   1         43.15       0.08565     1   0   0   0</div><div class="line">   2         13.41       0.03786     0   0   0   1</div><div class="line">   3         13.49        0.0381     0   0   1   0</div><div class="line">   4          13.4       0.03741     0   1   0   0</div><div class="line">   5         13.23       0.06579     1   1   0   0</div><div class="line">   6         13.34       0.06759     1   0   0   1</div><div class="line">   7         13.29       0.06664     1   0   1   0</div><div class="line">   8         4.523       0.07399     0   0   0   2</div><div class="line">   9         4.659       0.07217     0   2   0   0</div><div class="line">  10         4.948       0.08149     0   0   4   0</div><div class="line">  11        -4.026       0.06538     0   0   1   1</div><div class="line">  12        -4.045       0.06554     0   1   0   1</div><div class="line">  13        -3.939       0.06517     0   1   1   0</div><div class="line">  14         4.421        0.1305     1   0   0   2</div><div class="line">  15        -4.006        0.1172     1   1   0   1</div><div class="line">  16         4.626        0.1302     1   0   2   0</div><div class="line">  17         4.378        0.1286     1   2   0   0</div><div class="line">  18         3.516        0.1138     0   1   1   1</div><div class="line">  19        -4.111        0.1174     1   0   1   1</div><div class="line">  20        -3.823        0.1165     1   1   1   0</div><div class="line"></div><div class="line">Writing on file &quot;MDF.C&quot; ... done</div><div class="line"></div><div class="line">multidimfit ..............................................  OK</div><div class="line">(int) 0</div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Riostream_8h.html">Riostream.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TROOT_8h.html">TROOT.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TApplication_8h.html">TApplication.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TH1_8h.html">TH1.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TSystem_8h.html">TSystem.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TBrowser_8h.html">TBrowser.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TFile_8h.html">TFile.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TRandom_8h.html">TRandom.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TMultiDimFit_8h.html">TMultiDimFit.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TVectorD_8h.html">TVectorD.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TMath_8h.html">TMath.h</a>&quot;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//____________________________________________________________________</span></div><div class="line"><span class="keywordtype">void</span> makeData(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>* <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>&amp; <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>&amp; <a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>)</div><div class="line">{</div><div class="line">  <span class="comment">// Make data points</span></div><div class="line">  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> upp[5] = { 10, 10, 10, 10,  1 };</div><div class="line">  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> low[5] = {  0,  0,  0,  0, .1 };</div><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div><div class="line">    <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i] = (upp[i] - low[i]) * <a class="code" href="TRandom_8h.html#a9ee275021031e1e27291bb36baa0e3e2">gRandom</a>-&gt;<a class="code" href="classTRandom.html#af504d4f838ab09eb48b7c252615563aa">Rndm</a>() + low[i];</div><div class="line"></div><div class="line">  <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0] * <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[1] * <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[1] + <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[2] * <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[2] + <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[3] * <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[3]);</div><div class="line"></div><div class="line">  <a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a> = <a class="code" href="TRandom_8h.html#a9ee275021031e1e27291bb36baa0e3e2">gRandom</a>-&gt;<a class="code" href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">Gaus</a>(upp[4],low[4]);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//____________________________________________________________________</span></div><div class="line"><span class="keywordtype">int</span> CompareResults(<a class="code" href="classTMultiDimFit.html">TMultiDimFit</a> *fit, <span class="keywordtype">bool</span> doFit)</div><div class="line">{</div><div class="line">      <span class="comment">//Compare results with reference run</span></div><div class="line"></div><div class="line"></div><div class="line">      <span class="comment">// the right coefficients (before fit)</span></div><div class="line">   <span class="keywordtype">double</span> GoodCoeffsNoFit[] = {</div><div class="line">   -4.37056,</div><div class="line">   43.1468,</div><div class="line">   13.432,</div><div class="line">   13.4632,</div><div class="line">   13.3964,</div><div class="line">   13.328,</div><div class="line">   13.3016,</div><div class="line">   13.3519,</div><div class="line">   4.49724,</div><div class="line">   4.63876,</div><div class="line">   4.89036,</div><div class="line">   -3.69982,</div><div class="line">   -3.98618,</div><div class="line">   -3.86195,</div><div class="line">   4.36054,</div><div class="line">   -4.02597,</div><div class="line">   4.57037,</div><div class="line">   4.69845,</div><div class="line">   2.83819,</div><div class="line">   -3.48855,</div><div class="line">   -3.97612</div><div class="line">   };</div><div class="line"></div><div class="line">      <span class="comment">// the right coefficients (after fit)</span></div><div class="line">   <span class="keywordtype">double</span> GoodCoeffs[] = {</div><div class="line">      -4.399,</div><div class="line">      43.15,</div><div class="line">      13.41,</div><div class="line">      13.49,</div><div class="line">      13.4,</div><div class="line">      13.23,</div><div class="line">      13.34,</div><div class="line">      13.29,</div><div class="line">      4.523,</div><div class="line">      4.659,</div><div class="line">      4.948,</div><div class="line">      -4.026,</div><div class="line">      -4.045,</div><div class="line">      -3.939,</div><div class="line">      4.421,</div><div class="line">      -4.006,</div><div class="line">      4.626,</div><div class="line">      4.378,</div><div class="line">      3.516,</div><div class="line">      -4.111,</div><div class="line">      -3.823,</div><div class="line">   };</div><div class="line"></div><div class="line">   <span class="comment">// Good Powers</span></div><div class="line">   <span class="keywordtype">int</span> GoodPower[] = {</div><div class="line">   1,  1,  1,  1,</div><div class="line">   2,  1,  1,  1,</div><div class="line">   1,  1,  1,  2,</div><div class="line">   1,  1,  2,  1,</div><div class="line">   1,  2,  1,  1,</div><div class="line">   2,  2,  1,  1,</div><div class="line">   2,  1,  1,  2,</div><div class="line">   2,  1,  2,  1,</div><div class="line">   1,  1,  1,  3,</div><div class="line">   1,  3,  1,  1,</div><div class="line">   1,  1,  5,  1,</div><div class="line">   1,  1,  2,  2,</div><div class="line">   1,  2,  1,  2,</div><div class="line">   1,  2,  2,  1,</div><div class="line">   2,  1,  1,  3,</div><div class="line">   2,  2,  1,  2,</div><div class="line">   2,  1,  3,  1,</div><div class="line">   2,  3,  1,  1,</div><div class="line">   1,  2,  2,  2,</div><div class="line">   2,  1,  2,  2,</div><div class="line">   2,  2,  2,  1</div><div class="line">   };</div><div class="line"></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nc = fit-&gt;<a class="code" href="classTMultiDimFit.html#a05022f855a32fc5316c58bd73f3d4fb5">GetNCoefficients</a>();</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nv = fit-&gt;<a class="code" href="classTMultiDimFit.html#a5548d9131c541140f629e1dfe5cb491b">GetNVariables</a>();</div><div class="line">   <span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> *powers = fit-&gt;<a class="code" href="classTMultiDimFit.html#afc9026986e661cdc53c5e9da07ef903e">GetPowers</a>();</div><div class="line">   <span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> *pindex = fit-&gt;<a class="code" href="classTMultiDimFit.html#a8ac246d0269feff0a81b2856303c7ad1">GetPowerIndex</a>();</div><div class="line">   <span class="keywordflow">if</span> (nc != 21) <span class="keywordflow">return</span> 1;</div><div class="line">   <span class="keyword">const</span> <a class="code" href="classTVectorT.html">TVectorD</a> *coeffs = fit-&gt;<a class="code" href="classTMultiDimFit.html#a8dd1595241675b6e92136db7d075eee9">GetCoefficients</a>();</div><div class="line">   <span class="keywordtype">int</span> k = 0;</div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i=0;i&lt;nc;i++) {</div><div class="line">      <span class="keywordflow">if</span> (doFit) {</div><div class="line">         <span class="keywordflow">if</span> (!<a class="code" href="namespaceTMath.html#aba442ea8aa2b658f88ef7f4ce3cc7b89">TMath::AreEqualRel</a>((*coeffs)[i],GoodCoeffs[i],1<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-3)) <span class="keywordflow">return</span> 2;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">else</span> {</div><div class="line">         <span class="keywordflow">if</span> (<a class="code" href="namespaceTMath.html#af682354cea223351f1306bf98a858dfd">TMath::Abs</a>((*coeffs)[i] - GoodCoeffsNoFit[i]) &gt; 5<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-5) <span class="keywordflow">return</span> 2;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> j=0;j&lt;nv;j++) {</div><div class="line">         <span class="keywordflow">if</span> (powers[pindex[i]*nv+j] != GoodPower[k]) <span class="keywordflow">return</span> 3;</div><div class="line">         k++;</div><div class="line">      }</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// now test the result of the generated function</span></div><div class="line">   <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLine(<span class="stringliteral">&quot;.L MDF.C&quot;</span>);</div><div class="line"></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> refMDF = (doFit) ? 43.95 : 43.98;</div><div class="line">   <span class="comment">// this does not work in CLing since the function is not defined</span></div><div class="line">   <span class="comment">//Double_t x[]    = {5,5,5,5};</span></div><div class="line">   <span class="comment">//Double_t rMDF   = MDF(x);</span></div><div class="line">   <span class="comment">//LM:  need to return the address of the result since it is casted to a long (this should not be in a tutorial !)</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> iret = <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLine(<span class="stringliteral">&quot; Double_t xvalues[] = {5,5,5,5}; double result=MDF(xvalues); &amp;result;&quot;</span>);</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> rMDF = * ( (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>*)iret);</div><div class="line">   <span class="comment">//printf(&quot;%f\n&quot;,rMDF);</span></div><div class="line">   <span class="keywordflow">if</span> (<a class="code" href="namespaceTMath.html#af682354cea223351f1306bf98a858dfd">TMath::Abs</a>(rMDF -refMDF) &gt; 1<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-2) <span class="keywordflow">return</span> 4;</div><div class="line">   <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//____________________________________________________________________</span></div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> multidimfit(<span class="keywordtype">bool</span> doFit = <span class="keyword">true</span>)</div><div class="line">{</div><div class="line"></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;*************************************************&quot;</span> &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;*             Multidimensional Fit              *&quot;</span> &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;*                                               *&quot;</span> &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;* By Christian Holm &lt;cholm@nbi.dk&gt; 14/10/00     *&quot;</span> &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;*************************************************&quot;</span> &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">// Initialize global TRannom object.</span></div><div class="line">   <a class="code" href="TRandom_8h.html#a9ee275021031e1e27291bb36baa0e3e2">gRandom</a> = <span class="keyword">new</span> <a class="code" href="classTRandom.html">TRandom</a>();</div><div class="line"></div><div class="line">   <span class="comment">// Open output file</span></div><div class="line">   <a class="code" href="classTFile.html">TFile</a>* <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a> = <span class="keyword">new</span> <a class="code" href="classTFile.html">TFile</a>(<span class="stringliteral">&quot;mdf.root&quot;</span>, <span class="stringliteral">&quot;RECREATE&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Global data parameters</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nVars       = 4;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nData       = 500;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[4];</div><div class="line"></div><div class="line">   <span class="comment">// make fit object and set parameters on it.</span></div><div class="line">   <a class="code" href="classTMultiDimFit.html">TMultiDimFit</a>* fit = <span class="keyword">new</span> <a class="code" href="classTMultiDimFit.html">TMultiDimFit</a>(nVars, <a class="code" href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152ea01c4c4c755c598880447ca3ce72b0950">TMultiDimFit::kMonomials</a>,<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> mPowers[]   = { 6 , 6, 6, 6 };</div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#a86d869eb42826e07457c0fc10604776c">SetMaxPowers</a>(mPowers);</div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#a12d443e8b20d116b7510863e0fbf2a99">SetMaxFunctions</a>(1000);</div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#a0b7d068098688409595bf0ca53449d45">SetMaxStudy</a>(1000);</div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#a3ffa2fd7bc7b430d87abe0ef35871add">SetMaxTerms</a>(30);</div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#a6bc775ada70124b1e5aa1d61e4f07f52">SetPowerLimit</a>(1);</div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#adc46df2e9e96fbf1c7bcf4f0386e1641">SetMinAngle</a>(10);</div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#aa9b31c2a4a4c02dbcb21dc4e4147755f">SetMaxAngle</a>(10);</div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#aa0d8c58be3bf2a36465b65d015f4cb83">SetMinRelativeError</a>(.01);</div><div class="line"></div><div class="line">   <span class="comment">// variables to hold the temporary input data</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>;</div><div class="line"></div><div class="line">   <span class="comment">// Print out the start parameters</span></div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#ae18eb732b7f700f28365e074d2685096">Print</a>(<span class="stringliteral">&quot;p&quot;</span>);</div><div class="line"></div><div class="line">   printf(<span class="stringliteral">&quot;======================================\n&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Create training sample</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i;</div><div class="line">   <span class="keywordflow">for</span> (i = 0; i &lt; nData ; i++) {</div><div class="line"></div><div class="line">      <span class="comment">// Make some data</span></div><div class="line">      makeData(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>,<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>);</div><div class="line"></div><div class="line">      <span class="comment">// Add the row to the fit object</span></div><div class="line">      fit-&gt;<a class="code" href="classTMultiDimFit.html#a74720b6e5b76b417cf809cf57401ef3c">AddRow</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>,<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>);</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// Print out the statistics</span></div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#ae18eb732b7f700f28365e074d2685096">Print</a>(<span class="stringliteral">&quot;s&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Book histograms</span></div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#af062a8ff2b0850e9b25edd065b4d9b2e">MakeHistograms</a>();</div><div class="line"></div><div class="line">   <span class="comment">// Find the parameterization</span></div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#a6fcbef530e89fe295103c1f84107ef33">FindParameterization</a>();</div><div class="line"></div><div class="line">   <span class="comment">// Print coefficents</span></div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#ae18eb732b7f700f28365e074d2685096">Print</a>(<span class="stringliteral">&quot;rc&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Get the min and max of variables from the training sample, used</span></div><div class="line">   <span class="comment">// for cuts in test sample.</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *xMax = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[nVars];</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *xMin = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[nVars];</div><div class="line">   <span class="keywordflow">for</span> (i = 0; i &lt; nVars; i++) {</div><div class="line">      xMax[i] = (*fit-&gt;<a class="code" href="classTMultiDimFit.html#a62926112e2f9dbbe761aa760c0010092">GetMaxVariables</a>())(i);</div><div class="line">      xMin[i] = (*fit-&gt;<a class="code" href="classTMultiDimFit.html#a01c04e3d23e33c41f0e958c928059ec4">GetMinVariables</a>())(i);</div><div class="line">   }</div><div class="line"></div><div class="line">   nData = fit-&gt;<a class="code" href="classTMultiDimFit.html#a05022f855a32fc5316c58bd73f3d4fb5">GetNCoefficients</a>() * 100;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> j;</div><div class="line"></div><div class="line">   <span class="comment">// Create test sample</span></div><div class="line">   <span class="keywordflow">for</span> (i = 0; i &lt; nData ; i++) {</div><div class="line">      <span class="comment">// Make some data</span></div><div class="line">      makeData(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>,<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>);</div><div class="line"></div><div class="line">      <span class="keywordflow">for</span> (j = 0; j &lt; nVars; j++)</div><div class="line">         <span class="keywordflow">if</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[j] &lt; xMin[j] || <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[j] &gt; xMax[j])</div><div class="line">      <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">      <span class="comment">// If we get through the loop above, all variables are in range</span></div><div class="line">      <span class="keywordflow">if</span> (j == nVars)</div><div class="line">         <span class="comment">// Add the row to the fit object</span></div><div class="line">         fit-&gt;<a class="code" href="classTMultiDimFit.html#a963c212eef6e1910fd9fd2f3f05d4bdd">AddTestRow</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>,<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>);</div><div class="line">      <span class="keywordflow">else</span></div><div class="line">         i--;</div><div class="line">   }</div><div class="line">   <span class="comment">//delete gRandom;</span></div><div class="line"></div><div class="line">   <span class="comment">// Test the parameterizatio and coefficents using the test sample.</span></div><div class="line">   <span class="keywordflow">if</span> (doFit)</div><div class="line">      fit-&gt;<a class="code" href="classTMultiDimFit.html#a995a6ac6f1cf39c8b2ba59fcd26641b3">Fit</a>(<span class="stringliteral">&quot;M&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Print result</span></div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#ae18eb732b7f700f28365e074d2685096">Print</a>(<span class="stringliteral">&quot;fc v&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Write code to file</span></div><div class="line">   fit-&gt;<a class="code" href="classTMultiDimFit.html#a62d9ca99ba267dc7d2d80fa88f041b1f">MakeCode</a>();</div><div class="line"></div><div class="line">   <span class="comment">// Write histograms to disk, and close file</span></div><div class="line">   <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>-&gt;Write();</div><div class="line">   <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>-&gt;Close();</div><div class="line">   <span class="keyword">delete</span> <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>;</div><div class="line"></div><div class="line">   <span class="comment">// Compare results with reference run</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> compare = CompareResults(fit, doFit);</div><div class="line">   <span class="keywordflow">if</span> (!compare) {</div><div class="line">      printf(<span class="stringliteral">&quot;\nmultidimfit ..............................................  OK\n&quot;</span>);</div><div class="line">   } <span class="keywordflow">else</span> {</div><div class="line">      printf(<span class="stringliteral">&quot;\nmultidimfit ..............................................  fails case %d\n&quot;</span>,compare);</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// We&#39;re done</span></div><div class="line">   <span class="keyword">delete</span> fit;</div><div class="line">   <span class="keywordflow">return</span> compare;</div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Authors</dt><dd>Rene Brun, Christian Holm Christensen </dd></dl>

<p class="definition">Definition in file <a class="el" href="multidimfit_8C_source.html">multidimfit.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:07 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/roostats/rs_numberCountingCombination.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_87facaa6959ceb8d3dacccaf663f7b84.html">roostats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">rs_numberCountingCombination.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__roostats.html">RooStats Tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/rs_numberCountingCombination.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/rs_numberCountingCombination.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  'Number Counting Example' <a class="el" href="namespaceRooStats.html" title="Namespace for the RooStats classes. ">RooStats</a> tutorial macro #100 </p>
<p>This tutorial shows an example of a combination of two searches using number counting with background uncertainty.</p>
<p>The macro uses a <a class="el" href="namespaceRooStats.html" title="Namespace for the RooStats classes. ">RooStats</a> "factory" to construct a PDF that represents the two number counting analyses with background uncertainties. The uncertainties are taken into account by considering a sideband measurement of a size that corresponds to the background uncertainty. The problem has been studied in these references:</p><ul>
<li><a href="http://arxiv.org/abs/physics/0511028">http://arxiv.org/abs/physics/0511028</a></li>
<li><a href="http://arxiv.org/abs/physics/0702156">http://arxiv.org/abs/physics/0702156</a></li>
<li><a href="http://cdsweb.cern.ch/record/1099969?ln=en">http://cdsweb.cern.ch/record/1099969?ln=en</a></li>
</ul>
<p>After using the factory to make the model, we use a <a class="el" href="namespaceRooStats.html" title="Namespace for the RooStats classes. ">RooStats</a> ProfileLikelihoodCalculator for a Hypothesis test and a confidence interval. The calculator takes into account systematics by eliminating nuisance parameters with the profile likelihood. This is equivalent to the method of MINOS.</p>
<div class="image">
<img src="pict1_rs_numberCountingCombination.C.png" alt="pict1_rs_numberCountingCombination.C.png" width="700"/>
</div>
 <div class="fragment"><div class="line"></div><div class="line"></div><div class="line">[1mRooFit v3.60 -- Developed by Wouter Verkerke and David Kirkby[0m </div><div class="line">                Copyright (C) 2000-2013 NIKHEF, University of California &amp; Stanford University</div><div class="line">                All rights reserved, please read http://roofit.sourceforge.net/license.txt</div><div class="line"></div><div class="line">[#0] WARNING:ObjectHandling -- NumberCountingPdfFactory: changed value of tau_0 to 100.01 to be consistent with background and its uncertainty.  Also stored these values of tau into workspace with name . tau_0ExpectedNumberCountingData if you test with a different dataset, you should adjust tau appropriately.</div><div class="line"></div><div class="line">[#0] WARNING:ObjectHandling -- NumberCountingPdfFactory: changed value of tau_1 to 100.01 to be consistent with background and its uncertainty.  Also stored these values of tau into workspace with name . tau_1ExpectedNumberCountingData if you test with a different dataset, you should adjust tau appropriately.</div><div class="line"></div><div class="line">[#1] INFO:Minization -- createNLL: caching constraint set under name CONSTR_OF_PDF_TopLevelPdf_FOR_OBS_x_0:x_1:y_0:y_1 with 0 entries</div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::DoGLobalFit - find MLE </div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::DoMinimizeNLL - using Minuit / Migrad with strategy 1</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization --  The following expressions will be evaluated in cache-and-track mode: (sigRegion_0,sideband_0,sigRegion_1,sideband_1)</div><div class="line">[#1] INFO:Minization -- </div><div class="line">  RooFitResult: minimized FCN value: 17.6316, estimated distance to minimum: 1.74281e-14</div><div class="line">                covariance matrix quality: Full, accurate covariance matrix</div><div class="line">                Status : MINIMIZE=0 </div><div class="line"></div><div class="line">    Floating Parameter    FinalValue +/-  Error   </div><div class="line">  --------------------  --------------------------</div><div class="line">                   b_0    1.0000e+02 +/-  9.99e-01</div><div class="line">                   b_1    1.0000e+02 +/-  9.96e-01</div><div class="line">          masterSignal    1.0000e+00 +/-  4.78e-01</div><div class="line"></div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::GetHypoTest - do conditional fit </div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::DoMinimizeNLL - using Minuit / Migrad with strategy 1</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization -- </div><div class="line">  RooFitResult: minimized FCN value: 19.9696, estimated distance to minimum: 1.46942e-07</div><div class="line">                covariance matrix quality: Full, accurate covariance matrix</div><div class="line">                Status : MINIMIZE=0 </div><div class="line"></div><div class="line">    Floating Parameter    FinalValue +/-  Error   </div><div class="line">  --------------------  --------------------------</div><div class="line">                   b_0    1.0020e+02 +/-  9.96e-01</div><div class="line">                   b_1    1.0010e+02 +/-  9.95e-01</div><div class="line"></div><div class="line">-------------------------------------------------</div><div class="line">The p-value for the null is 0.015294</div><div class="line">Corresponding to a significance of 2.16239</div><div class="line">-------------------------------------------------</div><div class="line"></div><div class="line"></div><div class="line">[#1] INFO:Minization -- createNLL picked up cached consraints from workspace with 0 entries</div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::DoGLobalFit - find MLE </div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::DoMinimizeNLL - using Minuit / Migrad with strategy 1</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization --  The following expressions will be evaluated in cache-and-track mode: (sigRegion_0,sideband_0,sigRegion_1,sideband_1)</div><div class="line">[#1] INFO:Minization -- </div><div class="line">  RooFitResult: minimized FCN value: 17.6316, estimated distance to minimum: 4.62901e-07</div><div class="line">                covariance matrix quality: Full, accurate covariance matrix</div><div class="line">                Status : MINIMIZE=0 </div><div class="line"></div><div class="line">    Floating Parameter    FinalValue +/-  Error   </div><div class="line">  --------------------  --------------------------</div><div class="line">                   b_0    1.0000e+02 +/-  9.99e-01</div><div class="line">                   b_1    1.0000e+02 +/-  9.96e-01</div><div class="line">          masterSignal    9.9967e-01 +/-  4.78e-01</div><div class="line"></div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_TopLevelPdf_ExpectedNumberCountingData_Profile[masterSignal]) Creating instance of MINUIT</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_TopLevelPdf_ExpectedNumberCountingData_Profile[masterSignal]) determining minimum likelihood for current configurations w.r.t all observable</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_TopLevelPdf_ExpectedNumberCountingData_Profile[masterSignal]) minimum found at (masterSignal=1.00002)</div><div class="line">.</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_TopLevelPdf_ExpectedNumberCountingData_Profile[masterSignal]) Creating instance of MINUIT</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_TopLevelPdf_ExpectedNumberCountingData_Profile[masterSignal]) determining minimum likelihood for current configurations w.r.t all observable</div><div class="line">[#0] ERROR:InputArguments -- RooArgSet::checkForDup: ERROR argument with name masterSignal is already in this set</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_TopLevelPdf_ExpectedNumberCountingData_Profile[masterSignal]) minimum found at (masterSignal=1.00007)</div><div class="line">..........................................................................................................................................................................................................lower limit on master signal = 0.089069</div><div class="line">upper limit on master signal = 2.00127</div><div class="line">-------------------------------------------------</div><div class="line">Consider this parameter point:</div><div class="line">RooRealVar::masterSignal = 0 +/- 0.477956  L(0 - 3) </div><div class="line">It is NOT in the interval.</div><div class="line">-------------------------------------------------</div><div class="line"></div><div class="line"></div><div class="line">-------------------------------------------------</div><div class="line">Consider this parameter point:</div><div class="line">RooRealVar::masterSignal = 2 +/- 0.477956  L(0 - 3) </div><div class="line">It IS in the interval.</div><div class="line">-------------------------------------------------</div><div class="line"></div><div class="line"></div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ProfileLikelihoodCalculator_8h.html">RooStats/ProfileLikelihoodCalculator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="NumberCountingPdfFactory_8h.html">RooStats/NumberCountingPdfFactory.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ConfInterval_8h.html">RooStats/ConfInterval.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="HypoTestResult_8h.html">RooStats/HypoTestResult.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="LikelihoodIntervalPlot_8h.html">RooStats/LikelihoodIntervalPlot.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooRealVar_8h.html">RooRealVar.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// use this order for safety on library loading</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooFit.html">RooFit</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooStats.html">RooStats</a>;</div><div class="line"></div><div class="line"><span class="comment">// declare three variations on the same tutorial</span></div><div class="line"><span class="keywordtype">void</span> rs_numberCountingCombination_expected();</div><div class="line"><span class="keywordtype">void</span> rs_numberCountingCombination_observed();</div><div class="line"><span class="keywordtype">void</span> rs_numberCountingCombination_observedWithTau();</div><div class="line"></div><div class="line"><span class="comment">// -------------------------------</span></div><div class="line"><span class="comment">// main driver to choose one</span></div><div class="line"><span class="keywordtype">void</span> rs_numberCountingCombination(<span class="keywordtype">int</span> flag = 1)</div><div class="line">{</div><div class="line">   <span class="keywordflow">if</span> (flag == 1)</div><div class="line">      rs_numberCountingCombination_expected();</div><div class="line">   <span class="keywordflow">if</span> (flag == 2)</div><div class="line">      rs_numberCountingCombination_observed();</div><div class="line">   <span class="keywordflow">if</span> (flag == 3)</div><div class="line">      rs_numberCountingCombination_observedWithTau();</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// -------------------------------</span></div><div class="line"><span class="keywordtype">void</span> rs_numberCountingCombination_expected()</div><div class="line">{</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// An example of a number counting combination with two channels.</span></div><div class="line">   <span class="comment">// We consider both hypothesis testing and the equivalent confidence interval.</span><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// The Model building stage</span><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span></div><div class="line">   <span class="comment">// Step 1, define arrays with signal &amp; bkg expectations and background uncertainties</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>[2] = {20., 10.};      <span class="comment">// expected signal</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>[2] = {100., 100.};    <span class="comment">// expected background</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> db[2] = {.0100, .0100}; <span class="comment">// fractional background uncertainty</span></div><div class="line"></div><div class="line">   <span class="comment">// Step 2, use a RooStats factory to build a PDF for a</span></div><div class="line">   <span class="comment">// number counting combination and add it to the workspace.</span></div><div class="line">   <span class="comment">// We need to give the signal expectation to relate the masterSignal</span></div><div class="line">   <span class="comment">// to the signal contribution in the individual channels.</span></div><div class="line">   <span class="comment">// The model neglects correlations in background uncertainty,</span></div><div class="line">   <span class="comment">// but they could be added without much change to the example.</span></div><div class="line">   <a class="code" href="classRooStats_1_1NumberCountingPdfFactory.html">NumberCountingPdfFactory</a> <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>;</div><div class="line">   <a class="code" href="classRooWorkspace.html">RooWorkspace</a> *wspace = <span class="keyword">new</span> <a class="code" href="classRooWorkspace.html">RooWorkspace</a>();</div><div class="line">   <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>.AddModel(<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>, 2, wspace, <span class="stringliteral">&quot;TopLevelPdf&quot;</span>, <span class="stringliteral">&quot;masterSignal&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Step 3, use a RooStats factory to add datasets to the workspace.</span></div><div class="line">   <span class="comment">// Step 3a.</span></div><div class="line">   <span class="comment">// Add the expected data to the workspace</span></div><div class="line">   <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>.AddExpData(<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>, <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, db, 2, wspace, <span class="stringliteral">&quot;ExpectedNumberCountingData&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// see below for a printout of the workspace</span></div><div class="line">   <span class="comment">//  wspace-&gt;Print();  //uncomment to see structure of workspace</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// The Hypothesis testing stage:</span><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// Step 4, Define the null hypothesis for the calculator</span></div><div class="line">   <span class="comment">// Here you need to know the name of the variables corresponding to hypothesis.</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *mu = wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;masterSignal&quot;</span>);</div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *poi = <span class="keyword">new</span> <a class="code" href="classRooArgSet.html">RooArgSet</a>(*mu);</div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *nullParams = <span class="keyword">new</span> <a class="code" href="classRooArgSet.html">RooArgSet</a>(<span class="stringliteral">&quot;nullParams&quot;</span>);</div><div class="line">   nullParams-&gt;<a class="code" href="classRooArgSet.html#af2ef936889833658180b07e7a4f5dc95">addClone</a>(*mu);</div><div class="line">   <span class="comment">// here we explicitly set the value of the parameters for the null</span></div><div class="line">   nullParams-&gt;<a class="code" href="classRooArgSet.html#aa9a4cb32cd2340a40d45683aaf817f05">setRealValue</a>(<span class="stringliteral">&quot;masterSignal&quot;</span>, 0);</div><div class="line"></div><div class="line">   <span class="comment">// Step 5, Create a calculator for doing the hypothesis test.</span></div><div class="line">   <span class="comment">// because this is a</span></div><div class="line">   <a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html">ProfileLikelihoodCalculator</a> plc(*wspace-&gt;<a class="code" href="classRooWorkspace.html#a2e0683ca1b7375eaa434a9cc1298e736">data</a>(<span class="stringliteral">&quot;ExpectedNumberCountingData&quot;</span>), *wspace-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;TopLevelPdf&quot;</span>), *poi, 0.05,</div><div class="line">                                   nullParams);</div><div class="line"></div><div class="line">   <span class="comment">// Step 6, Use the Calculator to get a HypoTestResult</span></div><div class="line">   <a class="code" href="classRooStats_1_1HypoTestResult.html">HypoTestResult</a> *htr = plc.<a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html#a009a281b2b5bca48deb74abfb9769774">GetHypoTest</a>();</div><div class="line">   assert(htr != 0);</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------&quot;</span> &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;The p-value for the null is &quot;</span> &lt;&lt; htr-&gt;NullPValue() &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Corresponding to a significance of &quot;</span> &lt;&lt; htr-&gt;Significance() &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------\n\n&quot;</span> &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">/* expected case should return:</span></div><div class="line"><span class="comment">      -------------------------------------------------</span></div><div class="line"><span class="comment">      The p-value for the null is 0.015294</span></div><div class="line"><span class="comment">      Corresponding to a significance of 2.16239</span></div><div class="line"><span class="comment">      -------------------------------------------------</span></div><div class="line"><span class="comment">   */</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   //////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// Confidence Interval Stage</span></div><div class="line"></div><div class="line">   <span class="comment">// Step 8, Here we re-use the ProfileLikelihoodCalculator to return a confidence interval.</span></div><div class="line">   <span class="comment">// We need to specify what are our parameters of interest</span></div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *paramsOfInterest = nullParams; <span class="comment">// they are the same as before in this case</span></div><div class="line">   plc.<a class="code" href="classRooStats_1_1CombinedCalculator.html#aa37fbeb648d852327e1b992835c06f44">SetParameters</a>(*paramsOfInterest);</div><div class="line">   <a class="code" href="classRooStats_1_1LikelihoodInterval.html">LikelihoodInterval</a> *lrint = (<a class="code" href="classRooStats_1_1LikelihoodInterval.html">LikelihoodInterval</a> *)plc.<a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html#a67b7b9939206276888006e195d7d30f6">GetInterval</a>(); <span class="comment">// that was easy.</span></div><div class="line">   lrint-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#a5f37ae059af686b66ef7f4c9832de5ab">SetConfidenceLevel</a>(0.95);</div><div class="line"></div><div class="line">   <span class="comment">// Step 9, make a plot of the likelihood ratio and the interval obtained</span></div><div class="line">   <span class="comment">// paramsOfInterest-&gt;setRealValue(&quot;masterSignal&quot;,1.);</span></div><div class="line">   <span class="comment">// find limits</span></div><div class="line">   <span class="keywordtype">double</span> lower = lrint-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#a0fdc8984bf021be6c212c9dec27d2da1">LowerLimit</a>(*mu);</div><div class="line">   <span class="keywordtype">double</span> upper = lrint-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#a8083e0c3adbd18cd86f0048846981d36">UpperLimit</a>(*mu);</div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1LikelihoodIntervalPlot.html">LikelihoodIntervalPlot</a> lrPlot(lrint);</div><div class="line">   lrPlot.SetMaximum(3.);</div><div class="line">   lrPlot.Draw();</div><div class="line"></div><div class="line">   <span class="comment">// Step 10a. Get upper and lower limits</span></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;lower limit on master signal = &quot;</span> &lt;&lt; lower &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;upper limit on master signal = &quot;</span> &lt;&lt; upper &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">// Step 10b, Ask if masterSignal=0 is in the interval.</span></div><div class="line">   <span class="comment">// Note, this is equivalent to the question of a 2-sigma hypothesis test:</span></div><div class="line">   <span class="comment">// &quot;is the parameter point masterSignal=0 inside the 95% confidence interval?&quot;</span></div><div class="line">   <span class="comment">// Since the significance of the Hypothesis test was &gt; 2-sigma it should not be:</span></div><div class="line">   <span class="comment">// eg. we exclude masterSignal=0 at 95% confidence.</span></div><div class="line">   paramsOfInterest-&gt;<a class="code" href="classRooArgSet.html#aa9a4cb32cd2340a40d45683aaf817f05">setRealValue</a>(<span class="stringliteral">&quot;masterSignal&quot;</span>, 0.);</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------&quot;</span> &lt;&lt; endl;</div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;Consider this parameter point:&quot;</span> &lt;&lt; std::endl;</div><div class="line">   paramsOfInterest-&gt;<a class="code" href="classRooAbsCollection.html#a225c780c4c32077d6923e956225e437a">first</a>()-&gt;<a class="code" href="classRooAbsArg.html#a6b3b4deb1fe5d9cf935ca49a78426623">Print</a>();</div><div class="line">   <span class="keywordflow">if</span> (lrint-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#adac39e00a735e7e69079ba2ed8b53c0b">IsInInterval</a>(*paramsOfInterest))</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;It IS in the interval.&quot;</span> &lt;&lt; std::endl;</div><div class="line">   <span class="keywordflow">else</span></div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;It is NOT in the interval.&quot;</span> &lt;&lt; std::endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------\n\n&quot;</span> &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">// Step 10c, We also ask about the parameter point masterSignal=2, which is inside the interval.</span></div><div class="line">   paramsOfInterest-&gt;<a class="code" href="classRooArgSet.html#aa9a4cb32cd2340a40d45683aaf817f05">setRealValue</a>(<span class="stringliteral">&quot;masterSignal&quot;</span>, 2.);</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------&quot;</span> &lt;&lt; endl;</div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;Consider this parameter point:&quot;</span> &lt;&lt; std::endl;</div><div class="line">   paramsOfInterest-&gt;<a class="code" href="classRooAbsCollection.html#a225c780c4c32077d6923e956225e437a">first</a>()-&gt;<a class="code" href="classRooAbsArg.html#a6b3b4deb1fe5d9cf935ca49a78426623">Print</a>();</div><div class="line">   <span class="keywordflow">if</span> (lrint-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#adac39e00a735e7e69079ba2ed8b53c0b">IsInInterval</a>(*paramsOfInterest))</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;It IS in the interval.&quot;</span> &lt;&lt; std::endl;</div><div class="line">   <span class="keywordflow">else</span></div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;It is NOT in the interval.&quot;</span> &lt;&lt; std::endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------\n\n&quot;</span> &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="keyword">delete</span> lrint;</div><div class="line">   <span class="keyword">delete</span> htr;</div><div class="line">   <span class="keyword">delete</span> wspace;</div><div class="line">   <span class="keyword">delete</span> poi;</div><div class="line">   <span class="keyword">delete</span> nullParams;</div><div class="line"></div><div class="line">   <span class="comment">/*</span></div><div class="line"><span class="comment">   // Here&#39;s an example of what is in the workspace</span></div><div class="line"><span class="comment">   //  wspace-&gt;Print();</span></div><div class="line"><span class="comment">   RooWorkspace(NumberCountingWS) Number Counting WS contents</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   variables</span></div><div class="line"><span class="comment">   ---------</span></div><div class="line"><span class="comment">   (x_0,masterSignal,expected_s_0,b_0,y_0,tau_0,x_1,expected_s_1,b_1,y_1,tau_1)</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   p.d.f.s</span></div><div class="line"><span class="comment">   -------</span></div><div class="line"><span class="comment">   RooProdPdf::joint[ pdfs=(sigRegion_0,sideband_0,sigRegion_1,sideband_1) ] = 2.20148e-08</span></div><div class="line"><span class="comment">   RooPoisson::sigRegion_0[ x=x_0 mean=splusb_0 ] = 0.036393</span></div><div class="line"><span class="comment">   RooPoisson::sideband_0[ x=y_0 mean=bTau_0 ] = 0.00398939</span></div><div class="line"><span class="comment">   RooPoisson::sigRegion_1[ x=x_1 mean=splusb_1 ] = 0.0380088</span></div><div class="line"><span class="comment">   RooPoisson::sideband_1[ x=y_1 mean=bTau_1 ] = 0.00398939</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   functions</span></div><div class="line"><span class="comment">   --------</span></div><div class="line"><span class="comment">   RooAddition::splusb_0[ set1=(s_0,b_0) set2=() ] = 120</span></div><div class="line"><span class="comment">   RooProduct::s_0[ compRSet=(masterSignal,expected_s_0) compCSet=() ] = 20</span></div><div class="line"><span class="comment">   RooProduct::bTau_0[ compRSet=(b_0,tau_0) compCSet=() ] = 10000</span></div><div class="line"><span class="comment">   RooAddition::splusb_1[ set1=(s_1,b_1) set2=() ] = 110</span></div><div class="line"><span class="comment">   RooProduct::s_1[ compRSet=(masterSignal,expected_s_1) compCSet=() ] = 10</span></div><div class="line"><span class="comment">   RooProduct::bTau_1[ compRSet=(b_1,tau_1) compCSet=() ] = 10000</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   datasets</span></div><div class="line"><span class="comment">   --------</span></div><div class="line"><span class="comment">   RooDataSet::ExpectedNumberCountingData(x_0,y_0,x_1,y_1)</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   embedded pre-calculated expensive components</span></div><div class="line"><span class="comment">   -------------------------------------------</span></div><div class="line"><span class="comment">   */</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> rs_numberCountingCombination_observed()</div><div class="line">{</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// The same example with observed data in a main</span></div><div class="line">   <span class="comment">// measurement and an background-only auxiliary</span></div><div class="line">   <span class="comment">// measurement with a factor tau more background</span></div><div class="line">   <span class="comment">// than in the main measurement.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// The Model building stage</span><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span></div><div class="line">   <span class="comment">// Step 1, define arrays with signal &amp; bkg expectations and background uncertainties</span></div><div class="line">   <span class="comment">// We still need the expectation to relate signal in different channels with the master signal</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>[2] = {20., 10.}; <span class="comment">// expected signal</span></div><div class="line"></div><div class="line">   <span class="comment">// Step 2, use a RooStats factory to build a PDF for a</span></div><div class="line">   <span class="comment">// number counting combination and add it to the workspace.</span></div><div class="line">   <span class="comment">// We need to give the signal expectation to relate the masterSignal</span></div><div class="line">   <span class="comment">// to the signal contribution in the individual channels.</span></div><div class="line">   <span class="comment">// The model neglects correlations in background uncertainty,</span></div><div class="line">   <span class="comment">// but they could be added without much change to the example.</span></div><div class="line">   <a class="code" href="classRooStats_1_1NumberCountingPdfFactory.html">NumberCountingPdfFactory</a> <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>;</div><div class="line">   <a class="code" href="classRooWorkspace.html">RooWorkspace</a> *wspace = <span class="keyword">new</span> <a class="code" href="classRooWorkspace.html">RooWorkspace</a>();</div><div class="line">   <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>.AddModel(<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>, 2, wspace, <span class="stringliteral">&quot;TopLevelPdf&quot;</span>, <span class="stringliteral">&quot;masterSignal&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Step 3, use a RooStats factory to add datasets to the workspace.</span></div><div class="line">   <span class="comment">// Add the observed data to the workspace</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> mainMeas[2] = {123., 117.};   <span class="comment">// observed main measurement</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> bkgMeas[2] = {111.23, 98.76}; <span class="comment">// observed background</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> dbMeas[2] = {.011, .0095};    <span class="comment">// observed fractional background uncertainty</span></div><div class="line">   <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>.AddData(mainMeas, bkgMeas, dbMeas, 2, wspace, <span class="stringliteral">&quot;ObservedNumberCountingData&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// see below for a printout of the workspace</span></div><div class="line">   <span class="comment">//  wspace-&gt;Print();  //uncomment to see structure of workspace</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// The Hypothesis testing stage:</span><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// Step 4, Define the null hypothesis for the calculator</span></div><div class="line">   <span class="comment">// Here you need to know the name of the variables corresponding to hypothesis.</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *mu = wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;masterSignal&quot;</span>);</div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *poi = <span class="keyword">new</span> <a class="code" href="classRooArgSet.html">RooArgSet</a>(*mu);</div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *nullParams = <span class="keyword">new</span> <a class="code" href="classRooArgSet.html">RooArgSet</a>(<span class="stringliteral">&quot;nullParams&quot;</span>);</div><div class="line">   nullParams-&gt;<a class="code" href="classRooArgSet.html#af2ef936889833658180b07e7a4f5dc95">addClone</a>(*mu);</div><div class="line">   <span class="comment">// here we explicitly set the value of the parameters for the null</span></div><div class="line">   nullParams-&gt;<a class="code" href="classRooArgSet.html#aa9a4cb32cd2340a40d45683aaf817f05">setRealValue</a>(<span class="stringliteral">&quot;masterSignal&quot;</span>, 0);</div><div class="line"></div><div class="line">   <span class="comment">// Step 5, Create a calculator for doing the hypothesis test.</span></div><div class="line">   <span class="comment">// because this is a</span></div><div class="line">   <a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html">ProfileLikelihoodCalculator</a> plc(*wspace-&gt;<a class="code" href="classRooWorkspace.html#a2e0683ca1b7375eaa434a9cc1298e736">data</a>(<span class="stringliteral">&quot;ObservedNumberCountingData&quot;</span>), *wspace-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;TopLevelPdf&quot;</span>), *poi, 0.05,</div><div class="line">                                   nullParams);</div><div class="line"></div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;tau_0&quot;</span>)-&gt;<a class="code" href="classRooAbsArg.html#a6b3b4deb1fe5d9cf935ca49a78426623">Print</a>();</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;tau_1&quot;</span>)-&gt;<a class="code" href="classRooAbsArg.html#a6b3b4deb1fe5d9cf935ca49a78426623">Print</a>();</div><div class="line"></div><div class="line">   <span class="comment">// Step 7, Use the Calculator to get a HypoTestResult</span></div><div class="line">   <a class="code" href="classRooStats_1_1HypoTestResult.html">HypoTestResult</a> *htr = plc.<a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html#a009a281b2b5bca48deb74abfb9769774">GetHypoTest</a>();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------&quot;</span> &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;The p-value for the null is &quot;</span> &lt;&lt; htr-&gt;<a class="code" href="classRooStats_1_1HypoTestResult.html#a7bf8cbedc29b95b16a76d8b0fdf53e96">NullPValue</a>() &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Corresponding to a significance of &quot;</span> &lt;&lt; htr-&gt;<a class="code" href="classRooStats_1_1HypoTestResult.html#a68158d24df55c70a58c061e130132cce">Significance</a>() &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------\n\n&quot;</span> &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">/* observed case should return:</span></div><div class="line"><span class="comment">      -------------------------------------------------</span></div><div class="line"><span class="comment">      The p-value for the null is 0.0351669</span></div><div class="line"><span class="comment">      Corresponding to a significance of 1.80975</span></div><div class="line"><span class="comment">      -------------------------------------------------</span></div><div class="line"><span class="comment">   */</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   //////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// Confidence Interval Stage</span></div><div class="line"></div><div class="line">   <span class="comment">// Step 8, Here we re-use the ProfileLikelihoodCalculator to return a confidence interval.</span></div><div class="line">   <span class="comment">// We need to specify what are our parameters of interest</span></div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *paramsOfInterest = nullParams; <span class="comment">// they are the same as before in this case</span></div><div class="line">   plc.<a class="code" href="classRooStats_1_1CombinedCalculator.html#aa37fbeb648d852327e1b992835c06f44">SetParameters</a>(*paramsOfInterest);</div><div class="line">   <a class="code" href="classRooStats_1_1LikelihoodInterval.html">LikelihoodInterval</a> *lrint = (<a class="code" href="classRooStats_1_1LikelihoodInterval.html">LikelihoodInterval</a> *)plc.<a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html#a67b7b9939206276888006e195d7d30f6">GetInterval</a>(); <span class="comment">// that was easy.</span></div><div class="line">   lrint-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#a5f37ae059af686b66ef7f4c9832de5ab">SetConfidenceLevel</a>(0.95);</div><div class="line"></div><div class="line">   <span class="comment">// Step 9c. Get upper and lower limits</span></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;lower limit on master signal = &quot;</span> &lt;&lt; lrint-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#a0fdc8984bf021be6c212c9dec27d2da1">LowerLimit</a>(*mu) &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;upper limit on master signal = &quot;</span> &lt;&lt; lrint-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#a8083e0c3adbd18cd86f0048846981d36">UpperLimit</a>(*mu) &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="keyword">delete</span> lrint;</div><div class="line">   <span class="keyword">delete</span> htr;</div><div class="line">   <span class="keyword">delete</span> wspace;</div><div class="line">   <span class="keyword">delete</span> nullParams;</div><div class="line">   <span class="keyword">delete</span> poi;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> rs_numberCountingCombination_observedWithTau()</div><div class="line">{</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// The same example with observed data in a main</span></div><div class="line">   <span class="comment">// measurement and an background-only auxiliary</span></div><div class="line">   <span class="comment">// measurement with a factor tau more background</span></div><div class="line">   <span class="comment">// than in the main measurement.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// The Model building stage</span><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span></div><div class="line">   <span class="comment">// Step 1, define arrays with signal &amp; bkg expectations and background uncertainties</span></div><div class="line">   <span class="comment">// We still need the expectation to relate signal in different channels with the master signal</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>[2] = {20., 10.}; <span class="comment">// expected signal</span></div><div class="line"></div><div class="line">   <span class="comment">// Step 2, use a RooStats factory to build a PDF for a</span></div><div class="line">   <span class="comment">// number counting combination and add it to the workspace.</span></div><div class="line">   <span class="comment">// We need to give the signal expectation to relate the masterSignal</span></div><div class="line">   <span class="comment">// to the signal contribution in the individual channels.</span></div><div class="line">   <span class="comment">// The model neglects correlations in background uncertainty,</span></div><div class="line">   <span class="comment">// but they could be added without much change to the example.</span></div><div class="line">   <a class="code" href="classRooStats_1_1NumberCountingPdfFactory.html">NumberCountingPdfFactory</a> <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>;</div><div class="line">   <a class="code" href="classRooWorkspace.html">RooWorkspace</a> *wspace = <span class="keyword">new</span> <a class="code" href="classRooWorkspace.html">RooWorkspace</a>();</div><div class="line">   <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>.AddModel(<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>, 2, wspace, <span class="stringliteral">&quot;TopLevelPdf&quot;</span>, <span class="stringliteral">&quot;masterSignal&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Step 3, use a RooStats factory to add datasets to the workspace.</span></div><div class="line">   <span class="comment">// Add the observed data to the workspace in the on-off problem.</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> mainMeas[2] = {123., 117.};    <span class="comment">// observed main measurement</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> sideband[2] = {11123., 9876.}; <span class="comment">// observed sideband</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a>[2] = {100., 100.}; <span class="comment">// ratio of bkg in sideband to bkg in main measurement, from experimental design.</span></div><div class="line">   <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>.AddDataWithSideband(mainMeas, sideband, <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a>, 2, wspace, <span class="stringliteral">&quot;ObservedNumberCountingDataWithSideband&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// see below for a printout of the workspace</span></div><div class="line">   <span class="comment">//  wspace-&gt;Print();  //uncomment to see structure of workspace</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// The Hypothesis testing stage:</span><span class="comment"></span></div><div class="line"><span class="comment">   /////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// Step 4, Define the null hypothesis for the calculator</span></div><div class="line">   <span class="comment">// Here you need to know the name of the variables corresponding to hypothesis.</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *mu = wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;masterSignal&quot;</span>);</div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *poi = <span class="keyword">new</span> <a class="code" href="classRooArgSet.html">RooArgSet</a>(*mu);</div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *nullParams = <span class="keyword">new</span> <a class="code" href="classRooArgSet.html">RooArgSet</a>(<span class="stringliteral">&quot;nullParams&quot;</span>);</div><div class="line">   nullParams-&gt;<a class="code" href="classRooArgSet.html#af2ef936889833658180b07e7a4f5dc95">addClone</a>(*mu);</div><div class="line">   <span class="comment">// here we explicitly set the value of the parameters for the null</span></div><div class="line">   nullParams-&gt;<a class="code" href="classRooArgSet.html#aa9a4cb32cd2340a40d45683aaf817f05">setRealValue</a>(<span class="stringliteral">&quot;masterSignal&quot;</span>, 0);</div><div class="line"></div><div class="line">   <span class="comment">// Step 5, Create a calculator for doing the hypothesis test.</span></div><div class="line">   <span class="comment">// because this is a</span></div><div class="line">   <a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html">ProfileLikelihoodCalculator</a> plc(*wspace-&gt;<a class="code" href="classRooWorkspace.html#a2e0683ca1b7375eaa434a9cc1298e736">data</a>(<span class="stringliteral">&quot;ObservedNumberCountingDataWithSideband&quot;</span>), *wspace-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;TopLevelPdf&quot;</span>),</div><div class="line">                                   *poi, 0.05, nullParams);</div><div class="line"></div><div class="line">   <span class="comment">// Step 7, Use the Calculator to get a HypoTestResult</span></div><div class="line">   <a class="code" href="classRooStats_1_1HypoTestResult.html">HypoTestResult</a> *htr = plc.<a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html#a009a281b2b5bca48deb74abfb9769774">GetHypoTest</a>();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------&quot;</span> &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;The p-value for the null is &quot;</span> &lt;&lt; htr-&gt;<a class="code" href="classRooStats_1_1HypoTestResult.html#a7bf8cbedc29b95b16a76d8b0fdf53e96">NullPValue</a>() &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Corresponding to a significance of &quot;</span> &lt;&lt; htr-&gt;Significance() &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------\n\n&quot;</span> &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">/* observed case should return:</span></div><div class="line"><span class="comment">      -------------------------------------------------</span></div><div class="line"><span class="comment">      The p-value for the null is 0.0352035</span></div><div class="line"><span class="comment">      Corresponding to a significance of 1.80928</span></div><div class="line"><span class="comment">      -------------------------------------------------</span></div><div class="line"><span class="comment">   */</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   //////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">// Confidence Interval Stage</span></div><div class="line"></div><div class="line">   <span class="comment">// Step 8, Here we re-use the ProfileLikelihoodCalculator to return a confidence interval.</span></div><div class="line">   <span class="comment">// We need to specify what are our parameters of interest</span></div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *paramsOfInterest = nullParams; <span class="comment">// they are the same as before in this case</span></div><div class="line">   plc.<a class="code" href="classRooStats_1_1CombinedCalculator.html#aa37fbeb648d852327e1b992835c06f44">SetParameters</a>(*paramsOfInterest);</div><div class="line">   <a class="code" href="classRooStats_1_1LikelihoodInterval.html">LikelihoodInterval</a> *lrint = (<a class="code" href="classRooStats_1_1LikelihoodInterval.html">LikelihoodInterval</a> *)plc.<a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html#a67b7b9939206276888006e195d7d30f6">GetInterval</a>(); <span class="comment">// that was easy.</span></div><div class="line">   lrint-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#a5f37ae059af686b66ef7f4c9832de5ab">SetConfidenceLevel</a>(0.95);</div><div class="line"></div><div class="line">   <span class="comment">// Step 9c. Get upper and lower limits</span></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;lower limit on master signal = &quot;</span> &lt;&lt; lrint-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#a0fdc8984bf021be6c212c9dec27d2da1">LowerLimit</a>(*mu) &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;upper limit on master signal = &quot;</span> &lt;&lt; lrint-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#a8083e0c3adbd18cd86f0048846981d36">UpperLimit</a>(*mu) &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="keyword">delete</span> lrint;</div><div class="line">   <span class="keyword">delete</span> htr;</div><div class="line">   <span class="keyword">delete</span> wspace;</div><div class="line">   <span class="keyword">delete</span> nullParams;</div><div class="line">   <span class="keyword">delete</span> poi;</div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>Kyle Cranmer </dd></dl>

<p class="definition">Definition in file <a class="el" href="rs__numberCountingCombination_8C_source.html">rs_numberCountingCombination.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:27 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

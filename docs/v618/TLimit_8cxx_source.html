<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: hist/hist/src/TLimit.cxx Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8b9334156f3646fccf89e63b9869c7f9.html">hist</a></li><li class="navelem"><a class="el" href="dir_a75669761cd420cdb0e6cb084a91e897.html">hist</a></li><li class="navelem"><a class="el" href="dir_094a69ecc49b1dea368942997aba1fad.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TLimit.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="TLimit_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// @(#)root/hist:$Id$</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Author: Christophe.Delaere@cern.ch   21/08/2002</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span><span class="comment">//</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// TLimit</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// Class to compute 95% CL limits</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// adapted from the mclimit code from Tom Junk (CLs method)</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// see http://root.cern.ch/root/doc/TomJunk.pdf</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// see http://cern.ch/thomasj/searchlimits/ecl.html</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// see: Tom Junk,NIM A434, p. 435-443, 1999</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// see also the following interesting references:</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//  Alex Read, &quot;Presentation of search results: the CLs technique&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//  Journal of Physics G: Nucl. Part. Phys. 28 2693-2704 (2002).</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//  http://www.iop.org/EJ/abstract/0954-3899/28/10/313/</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// A nice article is also available in the CERN yellow report with the proceeding</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// of the 2000 CERN workshop on confidence intervals.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//  Alex Read, &quot;Modified Frequentist Analysis of Search Results (The CLs Method)&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//  CERN 2000-005 (30 May 2000)</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// see note about: &quot;Should I use TRolke, TFeldmanCousins, TLimit?&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//  in the TRolke class description.</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//</span><span class="comment"></span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">/** \class TLimit</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">    \ingroup Hist</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> Algorithm to compute 95% C.L. limits using the Likelihood ratio</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> semi-bayesian method.</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> </span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> Implemented by C. Delaere from the mclimit code written by Tom Junk [HEP-EX/9902006]. </span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> See [http://cern.ch/thomasj/searchlimits/ecl.html](http://cern.ch/thomasj/searchlimits/ecl.html) for more details.</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> It takes signal, background and data histograms wrapped in a</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> TLimitDataSource as input and runs a set of Monte Carlo experiments in</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> order to compute the limits. If needed, inputs are fluctuated according</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> to systematics. The output is a TConfidenceLevel.</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> The class TLimitDataSource takes the signal, background and data histograms as well as different</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> systematics sources to form the TLimit input.</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> The class TConfidenceLevel represents the final result of the TLimit algorithm. It is created just after the</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> time-consuming part and can be stored in a TFile for further processing.</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> It contains light methods to return CLs, CLb and other interesting</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> quantities.</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> The actual algorithm...</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> From an input (TLimitDataSource) it produces an output TConfidenceLevel.</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> For this, nmc Monte Carlo experiments are performed.</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> As usual, the larger this number, the longer the compute time,</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> but the better the result.</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> Supposing that there is a plotfile.root file containing 3 histograms</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"> (signal, background and data), you can imagine doing things like:</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">~~~{.cpp}</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> TFile* infile=new TFile(&quot;plotfile.root&quot;,&quot;READ&quot;);</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> infile-&gt;cd();</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> TH1* sh=(TH1*)infile-&gt;Get(&quot;signal&quot;);</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> TH1* bh=(TH1*)infile-&gt;Get(&quot;background&quot;);</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> TH1* dh=(TH1*)infile-&gt;Get(&quot;data&quot;);</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> TLimitDataSource* mydatasource = new TLimitDataSource(sh,bh,dh);</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"> TConfidenceLevel *myconfidence = TLimit::ComputeLimit(mydatasource,50000);</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> std::cout &lt;&lt; &quot;  CLs    : &quot; &lt;&lt; myconfidence-&gt;CLs()  &lt;&lt; std::endl;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> std::cout &lt;&lt; &quot;  CLsb   : &quot; &lt;&lt; myconfidence-&gt;CLsb() &lt;&lt; std::endl;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"> std::cout &lt;&lt; &quot;  CLb    : &quot; &lt;&lt; myconfidence-&gt;CLb()  &lt;&lt; std::endl;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"> std::cout &lt;&lt; &quot;&lt; CLs &gt;  : &quot; &lt;&lt; myconfidence-&gt;GetExpectedCLs_b()  &lt;&lt; std::endl;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"> std::cout &lt;&lt; &quot;&lt; CLsb &gt; : &quot; &lt;&lt; myconfidence-&gt;GetExpectedCLsb_b() &lt;&lt; std::endl;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"> std::cout &lt;&lt; &quot;&lt; CLb &gt;  : &quot; &lt;&lt; myconfidence-&gt;GetExpectedCLb_b()  &lt;&lt; std::endl;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"> delete myconfidence;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"> delete mydatasource;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"> infile-&gt;Close();</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">~~~</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"> More information can still be found on [this page](http://cern.ch/aleph-proj-alphapp/doc/tlimit.html)</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TLimit_8h.html">TLimit.h</a>&quot;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TArrayD_8h.html">TArrayD.h</a>&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TVectorD_8h.html">TVectorD.h</a>&quot;</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TOrdCollection_8h.html">TOrdCollection.h</a>&quot;</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TConfidenceLevel_8h.html">TConfidenceLevel.h</a>&quot;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TLimitDataSource_8h.html">TLimitDataSource.h</a>&quot;</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TRandom3_8h.html">TRandom3.h</a>&quot;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TH1_8h.html">TH1.h</a>&quot;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TObjArray_8h.html">TObjArray.h</a>&quot;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TMath_8h.html">TMath.h</a>&quot;</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TIterator_8h.html">TIterator.h</a>&quot;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TObjString_8h.html">TObjString.h</a>&quot;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TClassTable_8h.html">TClassTable.h</a>&quot;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Riostream_8h.html">Riostream.h</a>&quot;</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<a class="code" href="Rtypes_8h.html#a3f9bf160bbbb44209e95556960836b96">ClassImp</a>(<a class="code" href="classTLimit.html">TLimit</a>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<a class="code" href="classTArrayD.html">TArrayD</a> *<a class="code" href="classTLimit.html#a71dbfd44284e6f9e65f6caaf57656275">TLimit::fgTable</a> = <span class="keyword">new</span> <a class="code" href="classTArrayD.html">TArrayD</a>(0);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<a class="code" href="classTOrdCollection.html">TOrdCollection</a> *<a class="code" href="classTLimit.html#a183c83e3e78b7b86716ffd2ac6313098">TLimit::fgSystNames</a> = <span class="keyword">new</span> <a class="code" href="classTOrdCollection.html">TOrdCollection</a>();</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="classTLimit.html#a7860cad8588ad6b5a3d9a404c25a5e56">  103</a></span>&#160;<a class="code" href="classTConfidenceLevel.html">TConfidenceLevel</a> *<a class="code" href="classTLimit.html#a7860cad8588ad6b5a3d9a404c25a5e56">TLimit::ComputeLimit</a>(<a class="code" href="classTLimitDataSource.html">TLimitDataSource</a> * data,</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                       <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nmc, <span class="keywordtype">bool</span> stat,</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                       <a class="code" href="classTRandom.html">TRandom</a> * generator)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;{</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   <span class="comment">// The final object returned...</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <a class="code" href="classTConfidenceLevel.html">TConfidenceLevel</a> *result = <span class="keyword">new</span> <a class="code" href="classTConfidenceLevel.html">TConfidenceLevel</a>(nmc);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <span class="comment">// The random generator used...</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <a class="code" href="classTRandom.html">TRandom</a> *myrandom = generator ? generator : <span class="keyword">new</span> <a class="code" href="classTRandom3.html">TRandom3</a>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   <span class="comment">// Compute some total quantities on all the channels</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> maxbins = 0;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> nsig = 0;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> nbg  = 0;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> ncand   = 0;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt;= data-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#a9d86066a7071cd85bca8130b65584390">GetLast</a>(); i++) {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      maxbins = (((<a class="code" href="classTH1.html">TH1</a> *) (data-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(i)))-&gt;GetNbinsX() + 2) &gt; maxbins ?</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                 (((<a class="code" href="classTH1.html">TH1</a> *) (data-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(i)))-&gt;GetNbinsX() + 2) : maxbins;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      nsig   +=  ((<a class="code" href="classTH1.html">TH1</a> *) (data-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(i)))-&gt;Integral();</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      nbg    +=  ((<a class="code" href="classTH1.html">TH1</a> *) (data-&gt;<a class="code" href="classTLimitDataSource.html#a7dd5a9b3bc420f0542ef50e7961f1816">GetBackground</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(i)))-&gt;Integral();</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      ncand  +=  (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) ((<a class="code" href="classTH1.html">TH1</a> *) (data-&gt;<a class="code" href="classTLimitDataSource.html#a3cb541872cea35b83eecb56e97e42bfc">GetCandidates</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(i)))-&gt;Integral();</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   result-&gt;<a class="code" href="classTConfidenceLevel.html#a177e34e0ad90e57917cdbda086de1d3e">SetBtot</a>(nbg);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   result-&gt;<a class="code" href="classTConfidenceLevel.html#a10ab61c3b48a62608a3c25f6321dbdd3">SetStot</a>(nsig);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   result-&gt;<a class="code" href="classTConfidenceLevel.html#ad56e5e68231f6d0a3abdeec7168b9ae5">SetDtot</a>(ncand);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> buffer = 0;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   <a class="code" href="classTLimit.html#a71dbfd44284e6f9e65f6caaf57656275">fgTable</a>-&gt;<a class="code" href="classTArrayD.html#a58be02beec824f27a2c74e153f6fd143">Set</a>(maxbins * (data-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#a9d86066a7071cd85bca8130b65584390">GetLast</a>() + 1));</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> channel = 0; channel &lt;= data-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#a9d86066a7071cd85bca8130b65584390">GetLast</a>(); channel++)</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> bin = 0;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;           bin &lt;= ((<a class="code" href="classTH1.html">TH1</a> *) (data-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;GetNbinsX()+1;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;           bin++) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> = (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>) ((<a class="code" href="classTH1.html">TH1</a> *) (data-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;GetBinContent(bin);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>) ((<a class="code" href="classTH1.html">TH1</a> *) (data-&gt;<a class="code" href="classTLimitDataSource.html#a7dd5a9b3bc420f0542ef50e7961f1816">GetBackground</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;GetBinContent(bin);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> = (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>) ((<a class="code" href="classTH1.html">TH1</a> *) (data-&gt;<a class="code" href="classTLimitDataSource.html#a3cb541872cea35b83eecb56e97e42bfc">GetCandidates</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;GetBinContent(bin);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;         <span class="comment">// Compute the value of the &quot;-2lnQ&quot; for the actual data</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;         <span class="keywordflow">if</span> ((<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> == 0) &amp;&amp; (<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> &gt; 0)) {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;WARNING: Ignoring bin &quot;</span> &lt;&lt; bin &lt;&lt; <span class="stringliteral">&quot; of channel &quot;</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                 &lt;&lt; channel &lt;&lt; <span class="stringliteral">&quot; which has s=&quot;</span> &lt;&lt; <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> &lt;&lt; <span class="stringliteral">&quot; but b=&quot;</span> &lt;&lt; <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;         Maybe the MC statistic has to be improved...&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;         }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;         <span class="keywordflow">if</span> ((<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> &gt; 0) &amp;&amp; (<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; 0))</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            buffer += <a class="code" href="classTLimit.html#a0a42ecf1da76ec9f800d082a0cb518fd">LogLikelihood</a>(<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>, <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;         <span class="comment">// precompute the log(1+s/b)&#39;s in an array to speed up computation</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;         <span class="comment">// background-free bins are set to have a maximum t.s. value</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;         <span class="comment">// for protection (corresponding to s/b of about 5E8)</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;         <span class="keywordflow">if</span> ((<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> &gt; 0) &amp;&amp; (<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; 0))</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <a class="code" href="classTLimit.html#a71dbfd44284e6f9e65f6caaf57656275">fgTable</a>-&gt;<a class="code" href="classTArrayD.html#a81b42721a4e4922a0af912587fcd733c">AddAt</a>(<a class="code" href="classTLimit.html#a0a42ecf1da76ec9f800d082a0cb518fd">LogLikelihood</a>(<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>, <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, 1), (channel * maxbins) + bin);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> &gt; 0) &amp;&amp; (<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> == 0))</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <a class="code" href="classTLimit.html#a71dbfd44284e6f9e65f6caaf57656275">fgTable</a>-&gt;<a class="code" href="classTArrayD.html#a81b42721a4e4922a0af912587fcd733c">AddAt</a>(20, (channel * maxbins) + bin);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   result-&gt;<a class="code" href="classTConfidenceLevel.html#aac900e6679df1053a90133eda027b1a6">SetTSD</a>(buffer);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <span class="comment">// accumulate MC experiments.  Hold the test statistic function fixed, but</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   <span class="comment">// fluctuate s and b within syst. errors for computing probabilities of</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="comment">// having that outcome.  (Alex Read&#39;s prescription -- errors are on the ensemble,</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <span class="comment">// not on the observed test statistic.  This technique does not split outcomes.)</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <span class="comment">// keep the tstats as sum log(1+s/b). convert to -2lnQ when preparing the results</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <span class="comment">// (reason -- like to keep the &lt; signs right)</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *tss = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[nmc];</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *tsb = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[nmc];</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *lrs = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[nmc];</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *lrb = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[nmc];</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   <a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>* tmp_src = (<a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>*)(data-&gt;<a class="code" href="classTObject.html#a4696036d44dcbe28970a13b8f4e5d6b2">Clone</a>());</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>* tmp_src2 = (<a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>*)(data-&gt;<a class="code" href="classTObject.html#a4696036d44dcbe28970a13b8f4e5d6b2">Clone</a>());</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; nmc; i++) {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      tss[i] = 0;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      tsb[i] = 0;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      lrs[i] = 0;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      lrb[i] = 0;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="comment">// fluctuate signal and background</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>*  fluctuated = <a class="code" href="classTLimit.html#a7c6119e6a96dd7faf5bc5aaa61b9396f">Fluctuate</a>(data, tmp_src, !i, myrandom, stat) ? tmp_src : data;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="comment">// make an independent set of fluctuations for reweighting pseudoexperiments</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="comment">// it turns out using the same fluctuated ones for numerator and denominator</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="comment">// is biased.</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>*  fluctuated2 = <a class="code" href="classTLimit.html#a7c6119e6a96dd7faf5bc5aaa61b9396f">Fluctuate</a>(data, tmp_src2, <span class="keyword">false</span>, myrandom, stat) ? tmp_src2 : data;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> channel = 0;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;           channel &lt;= fluctuated-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#a9d86066a7071cd85bca8130b65584390">GetLast</a>(); channel++) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;         <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> bin = 0;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;              bin &lt;=((<a class="code" href="classTH1.html">TH1</a> *) (fluctuated-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;GetNbinsX()+1;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;              bin++) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>) ((<a class="code" href="classTH1.html">TH1</a> *) (fluctuated-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;GetBinContent(bin) != 0) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;               <span class="comment">// s+b hypothesis</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;               <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> rate = (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>) ((<a class="code" href="classTH1.html">TH1</a> *) (fluctuated-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;GetBinContent(bin) +</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                               (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>) ((<a class="code" href="classTH1.html">TH1</a> *) (fluctuated-&gt;<a class="code" href="classTLimitDataSource.html#a7dd5a9b3bc420f0542ef50e7961f1816">GetBackground</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;GetBinContent(bin);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;               <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> rand = myrandom-&gt;<a class="code" href="classTRandom.html#a1529ed28e6ce1230d135548460b12c19">Poisson</a>(rate);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;               tss[i] += rand * <a class="code" href="classTLimit.html#a71dbfd44284e6f9e65f6caaf57656275">fgTable</a>-&gt;<a class="code" href="classTArrayD.html#a36c45a210c89b13e32179d5a6ed3fe4a">At</a>((channel * maxbins) + bin);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;               <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> = (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>) ((<a class="code" href="classTH1.html">TH1</a> *) (fluctuated-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;GetBinContent(bin);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;               <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> s2= (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>) ((<a class="code" href="classTH1.html">TH1</a> *) (fluctuated2-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;GetBinContent(bin);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;               <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>) ((<a class="code" href="classTH1.html">TH1</a> *) (fluctuated-&gt;<a class="code" href="classTLimitDataSource.html#a7dd5a9b3bc420f0542ef50e7961f1816">GetBackground</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;GetBinContent(bin);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;               <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> b2= (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>) ((<a class="code" href="classTH1.html">TH1</a> *) (fluctuated2-&gt;<a class="code" href="classTLimitDataSource.html#a7dd5a9b3bc420f0542ef50e7961f1816">GetBackground</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;GetBinContent(bin);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;               <span class="keywordflow">if</span> ((<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> &gt; 0) &amp;&amp; (b2 &gt; 0))</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                  lrs[i] += <a class="code" href="classTLimit.html#a0a42ecf1da76ec9f800d082a0cb518fd">LogLikelihood</a>(<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>, <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, b2, rand) - <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> - <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> + b2;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> &gt; 0) &amp;&amp; (b2 == 0))</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                  lrs[i] += 20 * rand - <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;               <span class="comment">// b hypothesis</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;               rate = (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>) ((<a class="code" href="classTH1.html">TH1</a> *) (fluctuated-&gt;<a class="code" href="classTLimitDataSource.html#a7dd5a9b3bc420f0542ef50e7961f1816">GetBackground</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;GetBinContent(bin);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;               rand = myrandom-&gt;<a class="code" href="classTRandom.html#a1529ed28e6ce1230d135548460b12c19">Poisson</a>(rate);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;               tsb[i] += rand * <a class="code" href="classTLimit.html#a71dbfd44284e6f9e65f6caaf57656275">fgTable</a>-&gt;<a class="code" href="classTArrayD.html#a36c45a210c89b13e32179d5a6ed3fe4a">At</a>((channel * maxbins) + bin);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;               <span class="keywordflow">if</span> ((s2 &gt; 0) &amp;&amp; (<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; 0))</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                  lrb[i] += <a class="code" href="classTLimit.html#a0a42ecf1da76ec9f800d082a0cb518fd">LogLikelihood</a>(s2, b2, <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, rand) - s2 - b2 + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> &gt; 0) &amp;&amp; (<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> == 0))</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                  lrb[i] += 20 * rand - <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;         }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      lrs[i] = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(lrs[i] &lt; 710 ? lrs[i] : 710);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      lrb[i] = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(lrb[i] &lt; 710 ? lrb[i] : 710);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <span class="keyword">delete</span> tmp_src;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <span class="keyword">delete</span> tmp_src2;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   <span class="comment">// lrs and lrb are the LR&#39;s (no logs) = prob(s+b)/prob(b) for</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   <span class="comment">// that choice of s and b within syst. errors in the ensemble.  These are</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   <span class="comment">// the MC experiment weights for relating the s+b and b PDF&#39;s of the unsmeared</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <span class="comment">// test statistic (in which cas one can use another test statistic if one likes).</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <span class="comment">// Now produce the output object.</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <span class="comment">// The final quantities are computed on-demand form the arrays tss, tsb, lrs and lrb.</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   result-&gt;<a class="code" href="classTConfidenceLevel.html#a0fc15c1c4232c205f1d1bc97cc40a231">SetTSS</a>(tss);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   result-&gt;<a class="code" href="classTConfidenceLevel.html#a2fcc04451ee8bd9a46cbb747bcdf1590">SetTSB</a>(tsb);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   result-&gt;<a class="code" href="classTConfidenceLevel.html#a4144b849b381482a271b1dad6d20ccdc">SetLRS</a>(lrs);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   result-&gt;<a class="code" href="classTConfidenceLevel.html#a19b253ed2717cb7e76390a846417bd6d">SetLRB</a>(lrb);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   <span class="keywordflow">if</span> (!generator)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keyword">delete</span> myrandom;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="classTLimit.html#a7c6119e6a96dd7faf5bc5aaa61b9396f">  228</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classTLimit.html#a7c6119e6a96dd7faf5bc5aaa61b9396f">TLimit::Fluctuate</a>(<a class="code" href="classTLimitDataSource.html">TLimitDataSource</a> * input, <a class="code" href="classTLimitDataSource.html">TLimitDataSource</a> * <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>,</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                       <span class="keywordtype">bool</span> <a class="code" href="RooClassFactory_8cxx.html#a7b1f33c3ad9e56861188ab82a77e2bee">init</a>, <a class="code" href="classTRandom.html">TRandom</a> * generator, <span class="keywordtype">bool</span> stat)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;{</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   <span class="comment">// initialisation: create a sorted list of all the names of systematics</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="RooClassFactory_8cxx.html#a7b1f33c3ad9e56861188ab82a77e2bee">init</a>) {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">// create a &quot;map&quot; with the systematics names</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <a class="code" href="classTIterator.html">TIterator</a> *errornames = input-&gt;<a class="code" href="classTLimitDataSource.html#a5a4628ea220f06721c299fe9f1f81260">GetErrorNames</a>()-&gt;<a class="code" href="classTObjArray.html#a947421098b6079e18faee606dd9c48df">MakeIterator</a>();</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <a class="code" href="classTObjArray.html">TObjArray</a> *listofnames = 0;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classTLimit.html#a183c83e3e78b7b86716ffd2ac6313098">fgSystNames</a>;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <a class="code" href="classTLimit.html#a183c83e3e78b7b86716ffd2ac6313098">fgSystNames</a> = <span class="keyword">new</span> <a class="code" href="classTOrdCollection.html">TOrdCollection</a>();</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">while</span> ((listofnames = ((<a class="code" href="classTObjArray.html">TObjArray</a> *) errornames-&gt;<a class="code" href="classTIterator.html#a84fc49025ff66ab1854d366a2fbc8a90">Next</a>()))) {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;         <a class="code" href="classTObjString.html">TObjString</a> *name = 0;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;         <a class="code" href="classTIterator.html">TIterator</a> *loniter = listofnames-&gt;<a class="code" href="classTObjArray.html#a947421098b6079e18faee606dd9c48df">MakeIterator</a>();</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;         <span class="keywordflow">while</span> ((name = (<a class="code" href="classTObjString.html">TObjString</a> *) (loniter-&gt;<a class="code" href="classTIterator.html#a84fc49025ff66ab1854d366a2fbc8a90">Next</a>())))</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="classTLimit.html#a183c83e3e78b7b86716ffd2ac6313098">fgSystNames</a>-&gt;<a class="code" href="classTOrdCollection.html#a1339e6ac4350d25ae1702f72514f46ce">IndexOf</a>(name)) &lt; 0)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;               <a class="code" href="classTLimit.html#a183c83e3e78b7b86716ffd2ac6313098">fgSystNames</a>-&gt;<a class="code" href="classTOrdCollection.html#a470f9d966fcf5fb18b80244994dfce88">AddLast</a>(name);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <a class="code" href="classTLimit.html#a183c83e3e78b7b86716ffd2ac6313098">fgSystNames</a>-&gt;<a class="code" href="classTOrdCollection.html#a623e5b9fef8f4eab9478b3ef63d04058">Sort</a>();</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   <span class="comment">// if the output is not given, create it from the input</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>)</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a> = (<a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>*)(input-&gt;<a class="code" href="classTObject.html#a4696036d44dcbe28970a13b8f4e5d6b2">Clone</a>());</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   <span class="comment">// if there are no systematics, just returns the input as &quot;fluctuated&quot; output</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   <span class="keywordflow">if</span> ((<a class="code" href="classTLimit.html#a183c83e3e78b7b86716ffd2ac6313098">fgSystNames</a>-&gt;<a class="code" href="classTCollection.html#af0ca154693eeb1e9d9a0ff3a8d43e466">GetSize</a>() &lt;= 0)&amp;&amp;(!stat)) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   <span class="comment">// if there are only stat, just fluctuate stats.</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTLimit.html#a183c83e3e78b7b86716ffd2ac6313098">fgSystNames</a>-&gt;<a class="code" href="classTCollection.html#af0ca154693eeb1e9d9a0ff3a8d43e466">GetSize</a>() &lt;= 0) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>-&gt;SetOwner();</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> channel = 0; channel &lt;= input-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#a9d86066a7071cd85bca8130b65584390">GetLast</a>(); channel++) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;         <a class="code" href="classTH1.html">TH1</a> *newsignal = (<a class="code" href="classTH1.html">TH1</a>*)(<a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>-&gt;GetSignal()-&gt;At(channel));</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;         <a class="code" href="classTH1.html">TH1</a> *oldsignal = (<a class="code" href="classTH1.html">TH1</a>*)(input-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel));</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;         <span class="keywordflow">if</span>(stat)</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1; i&lt;=newsignal-&gt;<a class="code" href="classTH1.html#a68ac42aeb65a689b5b32e1865b4dfd13">GetNbinsX</a>(); i++) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;               newsignal-&gt;<a class="code" href="classTH1.html#a9599e2dae40c574fd9d8970aaf638ee6">SetBinContent</a>(i,oldsignal-&gt;<a class="code" href="classTH1.html#ac70dcb4082bd510f5aa3e6efeb043f39">GetBinContent</a>(i)+generator-&gt;<a class="code" href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">Gaus</a>(0,oldsignal-&gt;<a class="code" href="classTH1.html#a3af6cc15ab6c2490428c9b691885d919">GetBinError</a>(i)));</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;         newsignal-&gt;<a class="code" href="classTH1.html#a0367fe04ae8709fd4b82795d0a5462c3">SetDirectory</a>(0);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;         <a class="code" href="classTH1.html">TH1</a> *newbackground = (<a class="code" href="classTH1.html">TH1</a>*)(<a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>-&gt;GetBackground()-&gt;At(channel));</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;         <a class="code" href="classTH1.html">TH1</a> *oldbackground = (<a class="code" href="classTH1.html">TH1</a>*)(input-&gt;<a class="code" href="classTLimitDataSource.html#a7dd5a9b3bc420f0542ef50e7961f1816">GetBackground</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel));</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;         <span class="keywordflow">if</span>(stat)</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1; i&lt;=newbackground-&gt;<a class="code" href="classTH1.html#a68ac42aeb65a689b5b32e1865b4dfd13">GetNbinsX</a>(); i++)</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;               newbackground-&gt;<a class="code" href="classTH1.html#a9599e2dae40c574fd9d8970aaf638ee6">SetBinContent</a>(i,oldbackground-&gt;<a class="code" href="classTH1.html#ac70dcb4082bd510f5aa3e6efeb043f39">GetBinContent</a>(i)+generator-&gt;<a class="code" href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">Gaus</a>(0,oldbackground-&gt;<a class="code" href="classTH1.html#a3af6cc15ab6c2490428c9b691885d919">GetBinError</a>(i)));</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;         newbackground-&gt;<a class="code" href="classTH1.html#a0367fe04ae8709fd4b82795d0a5462c3">SetDirectory</a>(0);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   }</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   <span class="comment">// Find a choice for the random variation and</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <span class="comment">// re-toss all random numbers if any background or signal</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   <span class="comment">// goes negative.  (background = 0 is bad too, so put a little protection</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <span class="comment">// around it -- must have at least 10% of the bg estimate).</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> retoss   = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *serrf = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[(input-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#a9d86066a7071cd85bca8130b65584390">GetLast</a>()) + 1];</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *berrf = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[(input-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#a9d86066a7071cd85bca8130b65584390">GetLast</a>()) + 1];</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   <span class="keywordflow">do</span> {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *toss = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="classTLimit.html#a183c83e3e78b7b86716ffd2ac6313098">fgSystNames</a>-&gt;<a class="code" href="classTCollection.html#af0ca154693eeb1e9d9a0ff3a8d43e466">GetSize</a>()];</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0; i &lt; <a class="code" href="classTLimit.html#a183c83e3e78b7b86716ffd2ac6313098">fgSystNames</a>-&gt;<a class="code" href="classTCollection.html#af0ca154693eeb1e9d9a0ff3a8d43e466">GetSize</a>(); i++)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;         toss[i] = generator-&gt;<a class="code" href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">Gaus</a>(0, 1);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      retoss = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> channel = 0;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;           channel &lt;= input-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#a9d86066a7071cd85bca8130b65584390">GetLast</a>();</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;           channel++) {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;         serrf[channel] = 0;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;         berrf[channel] = 0;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;         <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> bin = 0;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;              bin &lt;((<a class="code" href="classTVectorT.html">TVectorD</a> *) (input-&gt;<a class="code" href="classTLimitDataSource.html#ab37ffe5cc57f17891f1f39e6f6b6f9ed">GetErrorOnSignal</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;GetNrows();</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;              bin++) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            serrf[channel] += ((<a class="code" href="classTVectorT.html">TVectorD</a> *) (input-&gt;<a class="code" href="classTLimitDataSource.html#ab37ffe5cc57f17891f1f39e6f6b6f9ed">GetErrorOnSignal</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;operator[](bin) *</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                toss[<a class="code" href="classTLimit.html#a183c83e3e78b7b86716ffd2ac6313098">fgSystNames</a>-&gt;<a class="code" href="classTOrdCollection.html#aef394c51779ea6a9153522793d293f20">BinarySearch</a>((<a class="code" href="classTObjString.html">TObjString</a>*) (((<a class="code" href="classTObjArray.html">TObjArray</a> *) (input-&gt;<a class="code" href="classTLimitDataSource.html#a5a4628ea220f06721c299fe9f1f81260">GetErrorNames</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;At(bin)))];</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            berrf[channel] += ((<a class="code" href="classTVectorT.html">TVectorD</a> *) (input-&gt;<a class="code" href="classTLimitDataSource.html#a67716e4faf2192765830346a70097edb">GetErrorOnBackground</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;operator[](bin) *</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                toss[<a class="code" href="classTLimit.html#a183c83e3e78b7b86716ffd2ac6313098">fgSystNames</a>-&gt;<a class="code" href="classTOrdCollection.html#aef394c51779ea6a9153522793d293f20">BinarySearch</a>((<a class="code" href="classTObjString.html">TObjString</a>*) (((<a class="code" href="classTObjArray.html">TObjArray</a> *) (input-&gt;<a class="code" href="classTLimitDataSource.html#a5a4628ea220f06721c299fe9f1f81260">GetErrorNames</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel)))-&gt;At(bin)))];</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;         }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;         <span class="keywordflow">if</span> ((serrf[channel] &lt; -1.0) || (berrf[channel] &lt; -0.9)) {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            retoss = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;         }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      }</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keyword">delete</span>[]toss;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   } <span class="keywordflow">while</span> (retoss);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <span class="comment">// adjust the fluctuated signal and background counts with a legal set</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <span class="comment">// of random fluctuations above.</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>-&gt;SetOwner();</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> channel = 0; channel &lt;= input-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#a9d86066a7071cd85bca8130b65584390">GetLast</a>();</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        channel++) {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <a class="code" href="classTH1.html">TH1</a> *newsignal = (<a class="code" href="classTH1.html">TH1</a>*)(<a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>-&gt;GetSignal()-&gt;At(channel));</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <a class="code" href="classTH1.html">TH1</a> *oldsignal = (<a class="code" href="classTH1.html">TH1</a>*)(input-&gt;<a class="code" href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">GetSignal</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel));</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">if</span>(stat)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1; i&lt;=newsignal-&gt;<a class="code" href="classTH1.html#a68ac42aeb65a689b5b32e1865b4dfd13">GetNbinsX</a>(); i++)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            newsignal-&gt;<a class="code" href="classTH1.html#a9599e2dae40c574fd9d8970aaf638ee6">SetBinContent</a>(i,oldsignal-&gt;<a class="code" href="classTH1.html#ac70dcb4082bd510f5aa3e6efeb043f39">GetBinContent</a>(i)+generator-&gt;<a class="code" href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">Gaus</a>(0,oldsignal-&gt;<a class="code" href="classTH1.html#a3af6cc15ab6c2490428c9b691885d919">GetBinError</a>(i)));</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1; i&lt;=newsignal-&gt;<a class="code" href="classTH1.html#a68ac42aeb65a689b5b32e1865b4dfd13">GetNbinsX</a>(); i++)</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            newsignal-&gt;<a class="code" href="classTH1.html#a9599e2dae40c574fd9d8970aaf638ee6">SetBinContent</a>(i,oldsignal-&gt;<a class="code" href="classTH1.html#ac70dcb4082bd510f5aa3e6efeb043f39">GetBinContent</a>(i));</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      newsignal-&gt;<a class="code" href="classTH1.html#add929909dcb3745f6a52e9ae0860bfbd">Scale</a>(1 + serrf[channel]);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      newsignal-&gt;<a class="code" href="classTH1.html#a0367fe04ae8709fd4b82795d0a5462c3">SetDirectory</a>(0);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <a class="code" href="classTH1.html">TH1</a> *newbackground = (<a class="code" href="classTH1.html">TH1</a>*)(<a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>-&gt;GetBackground()-&gt;At(channel));</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <a class="code" href="classTH1.html">TH1</a> *oldbackground = (<a class="code" href="classTH1.html">TH1</a>*)(input-&gt;<a class="code" href="classTLimitDataSource.html#a7dd5a9b3bc420f0542ef50e7961f1816">GetBackground</a>()-&gt;<a class="code" href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">At</a>(channel));</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">if</span>(stat)</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1; i&lt;=newbackground-&gt;<a class="code" href="classTH1.html#a68ac42aeb65a689b5b32e1865b4dfd13">GetNbinsX</a>(); i++)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            newbackground-&gt;<a class="code" href="classTH1.html#a9599e2dae40c574fd9d8970aaf638ee6">SetBinContent</a>(i,oldbackground-&gt;<a class="code" href="classTH1.html#ac70dcb4082bd510f5aa3e6efeb043f39">GetBinContent</a>(i)+generator-&gt;<a class="code" href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">Gaus</a>(0,oldbackground-&gt;<a class="code" href="classTH1.html#a3af6cc15ab6c2490428c9b691885d919">GetBinError</a>(i)));</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1; i&lt;=newbackground-&gt;<a class="code" href="classTH1.html#a68ac42aeb65a689b5b32e1865b4dfd13">GetNbinsX</a>(); i++)</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            newbackground-&gt;<a class="code" href="classTH1.html#a9599e2dae40c574fd9d8970aaf638ee6">SetBinContent</a>(i,oldbackground-&gt;<a class="code" href="classTH1.html#ac70dcb4082bd510f5aa3e6efeb043f39">GetBinContent</a>(i));</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      newbackground-&gt;<a class="code" href="classTH1.html#add929909dcb3745f6a52e9ae0860bfbd">Scale</a>(1 + berrf[channel]);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      newbackground-&gt;<a class="code" href="classTH1.html#a0367fe04ae8709fd4b82795d0a5462c3">SetDirectory</a>(0);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   <span class="keyword">delete</span>[] serrf;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   <span class="keyword">delete</span>[] berrf;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="classTLimit.html#a568b89fca9671e76c2e7f2dbea8a98a4">  337</a></span>&#160;<a class="code" href="classTConfidenceLevel.html">TConfidenceLevel</a> *<a class="code" href="classTLimit.html#a7860cad8588ad6b5a3d9a404c25a5e56">TLimit::ComputeLimit</a>(<a class="code" href="classTH1.html">TH1</a>* <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>, <a class="code" href="classTH1.html">TH1</a>* <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, <a class="code" href="classTH1.html">TH1</a>* <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>,</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                       <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nmc, <span class="keywordtype">bool</span> stat,</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                       <a class="code" href="classTRandom.html">TRandom</a> * generator)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;{</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <span class="comment">// Compute limit.</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   <a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>* lds = <span class="keyword">new</span> <a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>(<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>,<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>,<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   <a class="code" href="classTConfidenceLevel.html">TConfidenceLevel</a>* out = <a class="code" href="classTLimit.html#a7860cad8588ad6b5a3d9a404c25a5e56">ComputeLimit</a>(lds,nmc,stat,generator);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   <span class="keyword">delete</span> lds;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   <span class="keywordflow">return</span> out;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="classTLimit.html#a9e2902c901880daf7f5efe6d959ceb80">  349</a></span>&#160;<a class="code" href="classTConfidenceLevel.html">TConfidenceLevel</a> *<a class="code" href="classTLimit.html#a7860cad8588ad6b5a3d9a404c25a5e56">TLimit::ComputeLimit</a>(<a class="code" href="classTH1.html">TH1</a>* <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>, <a class="code" href="classTH1.html">TH1</a>* <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, <a class="code" href="classTH1.html">TH1</a>* <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>,</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                       <a class="code" href="classTVectorT.html">TVectorD</a>* se, <a class="code" href="classTVectorT.html">TVectorD</a>* be, <a class="code" href="classTObjArray.html">TObjArray</a>* <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>,</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                       <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nmc, <span class="keywordtype">bool</span> stat,</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                       <a class="code" href="classTRandom.html">TRandom</a> * generator)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;{</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <span class="comment">// Compute limit.</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   <a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>* lds = <span class="keyword">new</span> <a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>(<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>,<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>,<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>,se,be,<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   <a class="code" href="classTConfidenceLevel.html">TConfidenceLevel</a>* out = <a class="code" href="classTLimit.html#a7860cad8588ad6b5a3d9a404c25a5e56">ComputeLimit</a>(lds,nmc,stat,generator);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   <span class="keyword">delete</span> lds;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   <span class="keywordflow">return</span> out;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;}</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="classTLimit.html#ab78b02034ec235a1b93bd4fa3e1df09e">  362</a></span>&#160;<a class="code" href="classTConfidenceLevel.html">TConfidenceLevel</a> *<a class="code" href="classTLimit.html#a7860cad8588ad6b5a3d9a404c25a5e56">TLimit::ComputeLimit</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>,</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                       <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nmc,</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                       <span class="keywordtype">bool</span> stat,</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                       <a class="code" href="classTRandom.html">TRandom</a> * generator)</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;{</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="comment">// Compute limit.</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <a class="code" href="classTH1D.html">TH1D</a>* sh = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;__sh&quot;</span>,<span class="stringliteral">&quot;__sh&quot;</span>,1,0,2);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   sh-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(1,<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   <a class="code" href="classTH1D.html">TH1D</a>* bh = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;__bh&quot;</span>,<span class="stringliteral">&quot;__bh&quot;</span>,1,0,2);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   bh-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(1,<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <a class="code" href="classTH1D.html">TH1D</a>* dh = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;__dh&quot;</span>,<span class="stringliteral">&quot;__dh&quot;</span>,1,0,2);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   dh-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(1,<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>* lds = <span class="keyword">new</span> <a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>(sh,bh,dh);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   <a class="code" href="classTConfidenceLevel.html">TConfidenceLevel</a>* out = <a class="code" href="classTLimit.html#a7860cad8588ad6b5a3d9a404c25a5e56">ComputeLimit</a>(lds,nmc,stat,generator);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   <span class="keyword">delete</span> lds;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <span class="keyword">delete</span> sh;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   <span class="keyword">delete</span> bh;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <span class="keyword">delete</span> dh;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   <span class="keywordflow">return</span> out;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="classTLimit.html#a027c387bf0385af96c6cdc11d5b53751">  384</a></span>&#160;<a class="code" href="classTConfidenceLevel.html">TConfidenceLevel</a> *<a class="code" href="classTLimit.html#a7860cad8588ad6b5a3d9a404c25a5e56">TLimit::ComputeLimit</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>,</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                                       <a class="code" href="classTVectorT.html">TVectorD</a>* se, <a class="code" href="classTVectorT.html">TVectorD</a>* be, <a class="code" href="classTObjArray.html">TObjArray</a>* <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>,</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                                       <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nmc,</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                       <span class="keywordtype">bool</span> stat,</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                       <a class="code" href="classTRandom.html">TRandom</a> * generator)</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;{</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   <span class="comment">// Compute limit.</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   <a class="code" href="classTH1D.html">TH1D</a>* sh = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;__sh&quot;</span>,<span class="stringliteral">&quot;__sh&quot;</span>,1,0,2);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   sh-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(1,<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <a class="code" href="classTH1D.html">TH1D</a>* bh = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;__bh&quot;</span>,<span class="stringliteral">&quot;__bh&quot;</span>,1,0,2);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   bh-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(1,<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <a class="code" href="classTH1D.html">TH1D</a>* dh = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;__dh&quot;</span>,<span class="stringliteral">&quot;__dh&quot;</span>,1,0,2);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   dh-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(1,<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>* lds = <span class="keyword">new</span> <a class="code" href="classTLimitDataSource.html">TLimitDataSource</a>(sh,bh,dh,se,be,<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <a class="code" href="classTConfidenceLevel.html">TConfidenceLevel</a>* out = <a class="code" href="classTLimit.html#a7860cad8588ad6b5a3d9a404c25a5e56">ComputeLimit</a>(lds,nmc,stat,generator);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="keyword">delete</span> lds;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <span class="keyword">delete</span> sh;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;   <span class="keyword">delete</span> bh;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <span class="keyword">delete</span> dh;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <span class="keywordflow">return</span> out;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;}</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="classTLimit.html#a0a42ecf1da76ec9f800d082a0cb518fd">  407</a></span>&#160;<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="classTLimit.html#a0a42ecf1da76ec9f800d082a0cb518fd">TLimit::LogLikelihood</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> b2, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>)</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;{</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   <span class="comment">// Compute LogLikelihood (static function)</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>*<a class="code" href="namespaceTMath.html#a8f07e00d6511f2fbbad41d351d71731a">TMath::Log</a>((<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>+<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>)/b2);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div><div class="ttc" id="TLimit_8h_html"><div class="ttname"><a href="TLimit_8h.html">TLimit.h</a></div></div>
<div class="ttc" id="classTH1_html_add929909dcb3745f6a52e9ae0860bfbd"><div class="ttname"><a href="classTH1.html#add929909dcb3745f6a52e9ae0860bfbd">TH1::Scale</a></div><div class="ttdeci">virtual void Scale(Double_t c1=1, Option_t *option=&quot;&quot;)</div><div class="ttdoc">Multiply this histogram by a constant c1. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l06218">TH1.cxx:6218</a></div></div>
<div class="ttc" id="classTH1_html_a77e71290a82517d317ea8d05e96b6c4a"><div class="ttname"><a href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">TH1::Fill</a></div><div class="ttdeci">virtual Int_t Fill(Double_t x)</div><div class="ttdoc">Increment bin with abscissa X by 1. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l03258">TH1.cxx:3258</a></div></div>
<div class="ttc" id="classTObjArray_html"><div class="ttname"><a href="classTObjArray.html">TObjArray</a></div><div class="ttdoc">An array of TObjects. </div><div class="ttdef"><b>Definition:</b> <a href="TObjArray_8h_source.html#l00037">TObjArray.h:37</a></div></div>
<div class="ttc" id="classTRandom3_html"><div class="ttname"><a href="classTRandom3.html">TRandom3</a></div><div class="ttdoc">  Random number generator class based on M. </div><div class="ttdef"><b>Definition:</b> <a href="TRandom3_8h_source.html#l00027">TRandom3.h:27</a></div></div>
<div class="ttc" id="namespaceTMath_html_a8f07e00d6511f2fbbad41d351d71731a"><div class="ttname"><a href="namespaceTMath.html#a8f07e00d6511f2fbbad41d351d71731a">TMath::Log</a></div><div class="ttdeci">Double_t Log(Double_t x)</div><div class="ttdef"><b>Definition:</b> <a href="TMath_8h_source.html#l00748">TMath.h:748</a></div></div>
<div class="ttc" id="classTObjString_html"><div class="ttname"><a href="classTObjString.html">TObjString</a></div><div class="ttdoc">Collectable string class. </div><div class="ttdef"><b>Definition:</b> <a href="TObjString_8h_source.html#l00028">TObjString.h:28</a></div></div>
<div class="ttc" id="classTH1_html_a0367fe04ae8709fd4b82795d0a5462c3"><div class="ttname"><a href="classTH1.html#a0367fe04ae8709fd4b82795d0a5462c3">TH1::SetDirectory</a></div><div class="ttdeci">virtual void SetDirectory(TDirectory *dir)</div><div class="ttdoc">By default when an histogram is created, it is added to the list of histogram objects in the current ...</div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l08351">TH1.cxx:8351</a></div></div>
<div class="ttc" id="classTRandom_html_a0e445e213eae1343b3d22086ecb87314"><div class="ttname"><a href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">TRandom::Gaus</a></div><div class="ttdeci">virtual Double_t Gaus(Double_t mean=0, Double_t sigma=1)</div><div class="ttdoc">Samples a random number from the standard Normal (Gaussian) Distribution with the given mean and sigm...</div><div class="ttdef"><b>Definition:</b> <a href="TRandom_8cxx_source.html#l00263">TRandom.cxx:263</a></div></div>
<div class="ttc" id="classTOrdCollection_html_a470f9d966fcf5fb18b80244994dfce88"><div class="ttname"><a href="classTOrdCollection.html#a470f9d966fcf5fb18b80244994dfce88">TOrdCollection::AddLast</a></div><div class="ttdeci">void AddLast(TObject *obj)</div><div class="ttdoc">Add object at the end of the collection. </div><div class="ttdef"><b>Definition:</b> <a href="TOrdCollection_8cxx_source.html#l00100">TOrdCollection.cxx:100</a></div></div>
<div class="ttc" id="classTH1_html_ac70dcb4082bd510f5aa3e6efeb043f39"><div class="ttname"><a href="classTH1.html#ac70dcb4082bd510f5aa3e6efeb043f39">TH1::GetBinContent</a></div><div class="ttdeci">virtual Double_t GetBinContent(Int_t bin) const</div><div class="ttdoc">Return content of bin number bin. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l04882">TH1.cxx:4882</a></div></div>
<div class="ttc" id="classTVectorT_html"><div class="ttname"><a href="classTVectorT.html">TVectorT&lt; Double_t &gt;</a></div></div>
<div class="ttc" id="TOrdCollection_8h_html"><div class="ttname"><a href="TOrdCollection_8h.html">TOrdCollection.h</a></div></div>
<div class="ttc" id="classTLimit_html_a183c83e3e78b7b86716ffd2ac6313098"><div class="ttname"><a href="classTLimit.html#a183c83e3e78b7b86716ffd2ac6313098">TLimit::fgSystNames</a></div><div class="ttdeci">static TOrdCollection * fgSystNames</div><div class="ttdef"><b>Definition:</b> <a href="TLimit_8h_source.html#l00050">TLimit.h:50</a></div></div>
<div class="ttc" id="classTConfidenceLevel_html_a19b253ed2717cb7e76390a846417bd6d"><div class="ttname"><a href="classTConfidenceLevel.html#a19b253ed2717cb7e76390a846417bd6d">TConfidenceLevel::SetLRB</a></div><div class="ttdeci">void SetLRB(Double_t *in)</div><div class="ttdef"><b>Definition:</b> <a href="TConfidenceLevel_8h_source.html#l00029">TConfidenceLevel.h:29</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_a3885b911a54b47a4e61671f45dd45d0b"><div class="ttname"><a href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a></div><div class="ttdeci">int Int_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00041">RtypesCore.h:41</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_aa101f564ac7b845ca31aec2fbc00ce97"><div class="ttname"><a href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a></div><div class="ttdeci">bool Bool_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00059">RtypesCore.h:59</a></div></div>
<div class="ttc" id="classTLimit_html_a0a42ecf1da76ec9f800d082a0cb518fd"><div class="ttname"><a href="classTLimit.html#a0a42ecf1da76ec9f800d082a0cb518fd">TLimit::LogLikelihood</a></div><div class="ttdeci">static Double_t LogLikelihood(Double_t s, Double_t b, Double_t b2, Double_t d)</div><div class="ttdef"><b>Definition:</b> <a href="TLimit_8cxx_source.html#l00407">TLimit.cxx:407</a></div></div>
<div class="ttc" id="classTLimit_html_a7c6119e6a96dd7faf5bc5aaa61b9396f"><div class="ttname"><a href="classTLimit.html#a7c6119e6a96dd7faf5bc5aaa61b9396f">TLimit::Fluctuate</a></div><div class="ttdeci">static bool Fluctuate(TLimitDataSource *input, TLimitDataSource *output, bool init, TRandom *, bool stat=false)</div><div class="ttdef"><b>Definition:</b> <a href="TLimit_8cxx_source.html#l00228">TLimit.cxx:228</a></div></div>
<div class="ttc" id="classTLimitDataSource_html_a3cb541872cea35b83eecb56e97e42bfc"><div class="ttname"><a href="classTLimitDataSource.html#a3cb541872cea35b83eecb56e97e42bfc">TLimitDataSource::GetCandidates</a></div><div class="ttdeci">virtual TObjArray * GetCandidates()</div><div class="ttdef"><b>Definition:</b> <a href="TLimitDataSource_8h_source.html#l00034">TLimitDataSource.h:34</a></div></div>
<div class="ttc" id="classTObjArray_html_afc2e394af1d0f104a67f6cd7f9043c12"><div class="ttname"><a href="classTObjArray.html#afc2e394af1d0f104a67f6cd7f9043c12">TObjArray::At</a></div><div class="ttdeci">TObject * At(Int_t idx) const</div><div class="ttdef"><b>Definition:</b> <a href="TObjArray_8h_source.html#l00166">TObjArray.h:166</a></div></div>
<div class="ttc" id="TObjArray_8h_html"><div class="ttname"><a href="TObjArray_8h.html">TObjArray.h</a></div></div>
<div class="ttc" id="classTLimitDataSource_html"><div class="ttname"><a href="classTLimitDataSource.html">TLimitDataSource</a></div><div class="ttdoc">This class serves as interface to feed data into the TLimit routines. </div><div class="ttdef"><b>Definition:</b> <a href="TLimitDataSource_8h_source.html#l00024">TLimitDataSource.h:24</a></div></div>
<div class="ttc" id="classTConfidenceLevel_html_ad56e5e68231f6d0a3abdeec7168b9ae5"><div class="ttname"><a href="classTConfidenceLevel.html#ad56e5e68231f6d0a3abdeec7168b9ae5">TConfidenceLevel::SetDtot</a></div><div class="ttdeci">void SetDtot(Int_t in)</div><div class="ttdef"><b>Definition:</b> <a href="TConfidenceLevel_8h_source.html#l00032">TConfidenceLevel.h:32</a></div></div>
<div class="ttc" id="classTIterator_html"><div class="ttname"><a href="classTIterator.html">TIterator</a></div><div class="ttdoc">Iterator abstract base class. </div><div class="ttdef"><b>Definition:</b> <a href="TIterator_8h_source.html#l00030">TIterator.h:30</a></div></div>
<div class="ttc" id="classTConfidenceLevel_html_a10ab61c3b48a62608a3c25f6321dbdd3"><div class="ttname"><a href="classTConfidenceLevel.html#a10ab61c3b48a62608a3c25f6321dbdd3">TConfidenceLevel::SetStot</a></div><div class="ttdeci">void SetStot(Double_t in)</div><div class="ttdef"><b>Definition:</b> <a href="TConfidenceLevel_8h_source.html#l00031">TConfidenceLevel.h:31</a></div></div>
<div class="ttc" id="TVectorD_8h_html"><div class="ttname"><a href="TVectorD_8h.html">TVectorD.h</a></div></div>
<div class="ttc" id="classTConfidenceLevel_html_a4144b849b381482a271b1dad6d20ccdc"><div class="ttname"><a href="classTConfidenceLevel.html#a4144b849b381482a271b1dad6d20ccdc">TConfidenceLevel::SetLRS</a></div><div class="ttdeci">void SetLRS(Double_t *in)</div><div class="ttdef"><b>Definition:</b> <a href="TConfidenceLevel_8h_source.html#l00028">TConfidenceLevel.h:28</a></div></div>
<div class="ttc" id="classTLimitDataSource_html_a7dd5a9b3bc420f0542ef50e7961f1816"><div class="ttname"><a href="classTLimitDataSource.html#a7dd5a9b3bc420f0542ef50e7961f1816">TLimitDataSource::GetBackground</a></div><div class="ttdeci">virtual TObjArray * GetBackground()</div><div class="ttdef"><b>Definition:</b> <a href="TLimitDataSource_8h_source.html#l00033">TLimitDataSource.h:33</a></div></div>
<div class="ttc" id="classTRandom_html"><div class="ttname"><a href="classTRandom.html">TRandom</a></div><div class="ttdoc"> This is the base class for the ROOT Random number generators. </div><div class="ttdef"><b>Definition:</b> <a href="TRandom_8h_source.html#l00027">TRandom.h:27</a></div></div>
<div class="ttc" id="TLimitDataSource_8h_html"><div class="ttname"><a href="TLimitDataSource_8h.html">TLimitDataSource.h</a></div></div>
<div class="ttc" id="TClassTable_8h_html"><div class="ttname"><a href="TClassTable_8h.html">TClassTable.h</a></div></div>
<div class="ttc" id="namespaceTGeant4Unit_html_a5d450e80998065902b102dca2a69066a"><div class="ttname"><a href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">TGeant4Unit::s</a></div><div class="ttdeci">static constexpr double s</div><div class="ttdef"><b>Definition:</b> <a href="TGeant4SystemOfUnits_8h_source.html#l00162">TGeant4SystemOfUnits.h:162</a></div></div>
<div class="ttc" id="TIterator_8h_html"><div class="ttname"><a href="TIterator_8h.html">TIterator.h</a></div></div>
<div class="ttc" id="classTConfidenceLevel_html_aac900e6679df1053a90133eda027b1a6"><div class="ttname"><a href="classTConfidenceLevel.html#aac900e6679df1053a90133eda027b1a6">TConfidenceLevel::SetTSD</a></div><div class="ttdeci">void SetTSD(Double_t in)</div><div class="ttdef"><b>Definition:</b> <a href="TConfidenceLevel_8h_source.html#l00025">TConfidenceLevel.h:25</a></div></div>
<div class="ttc" id="classTObjArray_html_a9d86066a7071cd85bca8130b65584390"><div class="ttname"><a href="classTObjArray.html#a9d86066a7071cd85bca8130b65584390">TObjArray::GetLast</a></div><div class="ttdeci">Int_t GetLast() const</div><div class="ttdoc">Return index of last object in array. </div><div class="ttdef"><b>Definition:</b> <a href="TObjArray_8cxx_source.html#l00576">TObjArray.cxx:576</a></div></div>
<div class="ttc" id="TObjString_8h_html"><div class="ttname"><a href="TObjString_8h.html">TObjString.h</a></div></div>
<div class="ttc" id="classTConfidenceLevel_html_a177e34e0ad90e57917cdbda086de1d3e"><div class="ttname"><a href="classTConfidenceLevel.html#a177e34e0ad90e57917cdbda086de1d3e">TConfidenceLevel::SetBtot</a></div><div class="ttdeci">void SetBtot(Double_t in)</div><div class="ttdef"><b>Definition:</b> <a href="TConfidenceLevel_8h_source.html#l00030">TConfidenceLevel.h:30</a></div></div>
<div class="ttc" id="classTLimit_html"><div class="ttname"><a href="classTLimit.html">TLimit</a></div><div class="ttdoc">Algorithm to compute 95% C.L. </div><div class="ttdef"><b>Definition:</b> <a href="TLimit_8h_source.html#l00018">TLimit.h:18</a></div></div>
<div class="ttc" id="classTH1_html_a9599e2dae40c574fd9d8970aaf638ee6"><div class="ttname"><a href="classTH1.html#a9599e2dae40c574fd9d8970aaf638ee6">TH1::SetBinContent</a></div><div class="ttdeci">virtual void SetBinContent(Int_t bin, Double_t content)</div><div class="ttdoc">Set bin content see convention for numbering bins in TH1::GetBin In case the bin number is greater th...</div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l08635">TH1.cxx:8635</a></div></div>
<div class="ttc" id="classTOrdCollection_html_a1339e6ac4350d25ae1702f72514f46ce"><div class="ttname"><a href="classTOrdCollection.html#a1339e6ac4350d25ae1702f72514f46ce">TOrdCollection::IndexOf</a></div><div class="ttdeci">Int_t IndexOf(const TObject *obj) const</div><div class="ttdoc">Return index of object in collection. </div><div class="ttdef"><b>Definition:</b> <a href="TOrdCollection_8cxx_source.html#l00255">TOrdCollection.cxx:255</a></div></div>
<div class="ttc" id="classTLimit_html_a7860cad8588ad6b5a3d9a404c25a5e56"><div class="ttname"><a href="classTLimit.html#a7860cad8588ad6b5a3d9a404c25a5e56">TLimit::ComputeLimit</a></div><div class="ttdeci">static TConfidenceLevel * ComputeLimit(TLimitDataSource *data, Int_t nmc=50000, bool stat=false, TRandom *generator=0)</div><div class="ttdef"><b>Definition:</b> <a href="TLimit_8cxx_source.html#l00103">TLimit.cxx:103</a></div></div>
<div class="ttc" id="classTConfidenceLevel_html"><div class="ttname"><a href="classTConfidenceLevel.html">TConfidenceLevel</a></div><div class="ttdoc">Class to compute 95% CL limits. </div><div class="ttdef"><b>Definition:</b> <a href="TConfidenceLevel_8h_source.html#l00020">TConfidenceLevel.h:20</a></div></div>
<div class="ttc" id="classTH1D_html"><div class="ttname"><a href="classTH1D.html">TH1D</a></div><div class="ttdoc">1-D histogram with a double per channel (see TH1 documentation)} </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00614">TH1.h:614</a></div></div>
<div class="ttc" id="classTConfidenceLevel_html_a0fc15c1c4232c205f1d1bc97cc40a231"><div class="ttname"><a href="classTConfidenceLevel.html#a0fc15c1c4232c205f1d1bc97cc40a231">TConfidenceLevel::SetTSS</a></div><div class="ttdeci">void SetTSS(Double_t *in)</div><div class="ttdoc">Set the TSS. </div><div class="ttdef"><b>Definition:</b> <a href="TConfidenceLevel_8cxx_source.html#l00447">TConfidenceLevel.cxx:447</a></div></div>
<div class="ttc" id="classTConfidenceLevel_html_a2fcc04451ee8bd9a46cbb747bcdf1590"><div class="ttname"><a href="classTConfidenceLevel.html#a2fcc04451ee8bd9a46cbb747bcdf1590">TConfidenceLevel::SetTSB</a></div><div class="ttdeci">void SetTSB(Double_t *in)</div><div class="ttdoc">Set the TSB. </div><div class="ttdef"><b>Definition:</b> <a href="TConfidenceLevel_8cxx_source.html#l00437">TConfidenceLevel.cxx:437</a></div></div>
<div class="ttc" id="Riostream_8h_html"><div class="ttname"><a href="Riostream_8h.html">Riostream.h</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_a7e568baf910535e8ffd438acb843434d"><div class="ttname"><a href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a></div><div class="ttdeci">const Bool_t kFALSE</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00088">RtypesCore.h:88</a></div></div>
<div class="ttc" id="classTArrayD_html_a36c45a210c89b13e32179d5a6ed3fe4a"><div class="ttname"><a href="classTArrayD.html#a36c45a210c89b13e32179d5a6ed3fe4a">TArrayD::At</a></div><div class="ttdeci">Double_t At(Int_t i) const</div><div class="ttdef"><b>Definition:</b> <a href="TArrayD_8h_source.html#l00079">TArrayD.h:79</a></div></div>
<div class="ttc" id="classTOrdCollection_html_a623e5b9fef8f4eab9478b3ef63d04058"><div class="ttname"><a href="classTOrdCollection.html#a623e5b9fef8f4eab9478b3ef63d04058">TOrdCollection::Sort</a></div><div class="ttdeci">void Sort()</div><div class="ttdoc">If objects in collection are sortable (i.e. </div><div class="ttdef"><b>Definition:</b> <a href="TOrdCollection_8cxx_source.html#l00397">TOrdCollection.cxx:397</a></div></div>
<div class="ttc" id="RSha256_8hxx_html_a23b5b0a85bf5762c93a855f40c0343ce"><div class="ttname"><a href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a></div><div class="ttdeci">#define d(i)</div><div class="ttdef"><b>Definition:</b> <a href="RSha256_8hxx_source.html#l00102">RSha256.hxx:102</a></div></div>
<div class="ttc" id="namespaceTMath_html_a428950de9bddacfb35915a9603880005"><div class="ttname"><a href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a></div><div class="ttdeci">Double_t Exp(Double_t x)</div><div class="ttdef"><b>Definition:</b> <a href="TMath_8h_source.html#l00715">TMath.h:715</a></div></div>
<div class="ttc" id="classTObjArray_html_a947421098b6079e18faee606dd9c48df"><div class="ttname"><a href="classTObjArray.html#a947421098b6079e18faee606dd9c48df">TObjArray::MakeIterator</a></div><div class="ttdeci">TIterator * MakeIterator(Bool_t dir=kIterForward) const</div><div class="ttdoc">Returns an array iterator. </div><div class="ttdef"><b>Definition:</b> <a href="TObjArray_8cxx_source.html#l00648">TObjArray.cxx:648</a></div></div>
<div class="ttc" id="Rtypes_8h_html_a3f9bf160bbbb44209e95556960836b96"><div class="ttname"><a href="Rtypes_8h.html#a3f9bf160bbbb44209e95556960836b96">ClassImp</a></div><div class="ttdeci">#define ClassImp(name)</div><div class="ttdef"><b>Definition:</b> <a href="Rtypes_8h_source.html#l00365">Rtypes.h:365</a></div></div>
<div class="ttc" id="RooClassFactory_8cxx_html_a7b1f33c3ad9e56861188ab82a77e2bee"><div class="ttname"><a href="RooClassFactory_8cxx.html#a7b1f33c3ad9e56861188ab82a77e2bee">init</a></div><div class="ttdeci">static Int_t init()</div><div class="ttdef"><b>Definition:</b> <a href="RooClassFactory_8cxx_source.html#l00052">RooClassFactory.cxx:52</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_ab9b5334647b78ec4256db251e3ae1fc6"><div class="ttname"><a href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a></div><div class="ttdeci">double Double_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00055">RtypesCore.h:55</a></div></div>
<div class="ttc" id="TConfidenceLevel_8h_html"><div class="ttname"><a href="TConfidenceLevel_8h.html">TConfidenceLevel.h</a></div></div>
<div class="ttc" id="classTH1_html"><div class="ttname"><a href="classTH1.html">TH1</a></div><div class="ttdoc">The TH1 histogram class. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00056">TH1.h:56</a></div></div>
<div class="ttc" id="classTArrayD_html"><div class="ttname"><a href="classTArrayD.html">TArrayD</a></div><div class="ttdoc">Array of doubles (64 bits per element). </div><div class="ttdef"><b>Definition:</b> <a href="TArrayD_8h_source.html#l00027">TArrayD.h:27</a></div></div>
<div class="ttc" id="classTOrdCollection_html_aef394c51779ea6a9153522793d293f20"><div class="ttname"><a href="classTOrdCollection.html#aef394c51779ea6a9153522793d293f20">TOrdCollection::BinarySearch</a></div><div class="ttdeci">Int_t BinarySearch(TObject *obj)</div><div class="ttdoc">Find object using a binary search. </div><div class="ttdef"><b>Definition:</b> <a href="TOrdCollection_8cxx_source.html#l00415">TOrdCollection.cxx:415</a></div></div>
<div class="ttc" id="TArrayD_8h_html"><div class="ttname"><a href="TArrayD_8h.html">TArrayD.h</a></div></div>
<div class="ttc" id="classTObject_html_a4696036d44dcbe28970a13b8f4e5d6b2"><div class="ttname"><a href="classTObject.html#a4696036d44dcbe28970a13b8f4e5d6b2">TObject::Clone</a></div><div class="ttdeci">virtual TObject * Clone(const char *newname=&quot;&quot;) const</div><div class="ttdoc">Make a clone of an object using the Streamer facility. </div><div class="ttdef"><b>Definition:</b> <a href="TObject_8cxx_source.html#l00144">TObject.cxx:144</a></div></div>
<div class="ttc" id="classTLimitDataSource_html_a5a4628ea220f06721c299fe9f1f81260"><div class="ttname"><a href="classTLimitDataSource.html#a5a4628ea220f06721c299fe9f1f81260">TLimitDataSource::GetErrorNames</a></div><div class="ttdeci">virtual TObjArray * GetErrorNames()</div><div class="ttdef"><b>Definition:</b> <a href="TLimitDataSource_8h_source.html#l00037">TLimitDataSource.h:37</a></div></div>
<div class="ttc" id="classTLimitDataSource_html_ab37ffe5cc57f17891f1f39e6f6b6f9ed"><div class="ttname"><a href="classTLimitDataSource.html#ab37ffe5cc57f17891f1f39e6f6b6f9ed">TLimitDataSource::GetErrorOnSignal</a></div><div class="ttdeci">virtual TObjArray * GetErrorOnSignal()</div><div class="ttdef"><b>Definition:</b> <a href="TLimitDataSource_8h_source.html#l00035">TLimitDataSource.h:35</a></div></div>
<div class="ttc" id="classTArrayD_html_a81b42721a4e4922a0af912587fcd733c"><div class="ttname"><a href="classTArrayD.html#a81b42721a4e4922a0af912587fcd733c">TArrayD::AddAt</a></div><div class="ttdeci">void AddAt(Double_t c, Int_t i)</div><div class="ttdoc">Set the double c value at position i in the array. </div><div class="ttdef"><b>Definition:</b> <a href="TArrayD_8cxx_source.html#l00094">TArrayD.cxx:94</a></div></div>
<div class="ttc" id="textangle_8C_html_a3359d7f1aa9fe2f8bc884b02020e8d20"><div class="ttname"><a href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a></div><div class="ttdeci">auto * l</div><div class="ttdef"><b>Definition:</b> <a href="textangle_8C_source.html#l00004">textangle.C:4</a></div></div>
<div class="ttc" id="classTLimitDataSource_html_afa2598dd9e169c24d7be7394836308f7"><div class="ttname"><a href="classTLimitDataSource.html#afa2598dd9e169c24d7be7394836308f7">TLimitDataSource::GetSignal</a></div><div class="ttdeci">virtual TObjArray * GetSignal()</div><div class="ttdef"><b>Definition:</b> <a href="TLimitDataSource_8h_source.html#l00032">TLimitDataSource.h:32</a></div></div>
<div class="ttc" id="classTIterator_html_a84fc49025ff66ab1854d366a2fbc8a90"><div class="ttname"><a href="classTIterator.html#a84fc49025ff66ab1854d366a2fbc8a90">TIterator::Next</a></div><div class="ttdeci">virtual TObject * Next()=0</div></div>
<div class="ttc" id="TRolke_8cxx_html_a1a2354f40e332ad13673b70afc2c0dbf"><div class="ttname"><a href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a></div><div class="ttdeci">you should not use this method at all Int_t Int_t Double_t Double_t Double_t Int_t Double_t Double_t Double_t Double_t b</div><div class="ttdef"><b>Definition:</b> <a href="TRolke_8cxx_source.html#l00630">TRolke.cxx:630</a></div></div>
<div class="ttc" id="TH1_8h_html"><div class="ttname"><a href="TH1_8h.html">TH1.h</a></div></div>
<div class="ttc" id="classTLimitDataSource_html_a67716e4faf2192765830346a70097edb"><div class="ttname"><a href="classTLimitDataSource.html#a67716e4faf2192765830346a70097edb">TLimitDataSource::GetErrorOnBackground</a></div><div class="ttdeci">virtual TObjArray * GetErrorOnBackground()</div><div class="ttdef"><b>Definition:</b> <a href="TLimitDataSource_8h_source.html#l00036">TLimitDataSource.h:36</a></div></div>
<div class="ttc" id="classTH1_html_a68ac42aeb65a689b5b32e1865b4dfd13"><div class="ttname"><a href="classTH1.html#a68ac42aeb65a689b5b32e1865b4dfd13">TH1::GetNbinsX</a></div><div class="ttdeci">virtual Int_t GetNbinsX() const</div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00292">TH1.h:292</a></div></div>
<div class="ttc" id="classTRandom_html_a1529ed28e6ce1230d135548460b12c19"><div class="ttname"><a href="classTRandom.html#a1529ed28e6ce1230d135548460b12c19">TRandom::Poisson</a></div><div class="ttdeci">virtual Int_t Poisson(Double_t mean)</div><div class="ttdoc">Generates a random integer N according to a Poisson law. </div><div class="ttdef"><b>Definition:</b> <a href="TRandom_8cxx_source.html#l00391">TRandom.cxx:391</a></div></div>
<div class="ttc" id="TMath_8h_html"><div class="ttname"><a href="TMath_8h.html">TMath.h</a></div></div>
<div class="ttc" id="classTCollection_html_af0ca154693eeb1e9d9a0ff3a8d43e466"><div class="ttname"><a href="classTCollection.html#af0ca154693eeb1e9d9a0ff3a8d43e466">TCollection::GetSize</a></div><div class="ttdeci">virtual Int_t GetSize() const</div><div class="ttdoc">Return the capacity of the collection, i.e. </div><div class="ttdef"><b>Definition:</b> <a href="TCollection_8h_source.html#l00182">TCollection.h:182</a></div></div>
<div class="ttc" id="win32gdk_2src_2gifencode_8c_html_a606a386e5db616c66c8c8d932d23dc39"><div class="ttname"><a href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a></div><div class="ttdeci">static void output(int code)</div><div class="ttdef"><b>Definition:</b> <a href="win32gdk_2src_2gifencode_8c_source.html#l00226">gifencode.c:226</a></div></div>
<div class="ttc" id="classTOrdCollection_html"><div class="ttname"><a href="classTOrdCollection.html">TOrdCollection</a></div><div class="ttdoc">Ordered collection. </div><div class="ttdef"><b>Definition:</b> <a href="TOrdCollection_8h_source.html#l00032">TOrdCollection.h:32</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_af2f51d30ccd86e85be3e3e69793a86ef"><div class="ttname"><a href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a></div><div class="ttdeci">const Bool_t kTRUE</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00087">RtypesCore.h:87</a></div></div>
<div class="ttc" id="classTArrayD_html_a58be02beec824f27a2c74e153f6fd143"><div class="ttname"><a href="classTArrayD.html#a58be02beec824f27a2c74e153f6fd143">TArrayD::Set</a></div><div class="ttdeci">void Set(Int_t n)</div><div class="ttdoc">Set size of this array to n doubles. </div><div class="ttdef"><b>Definition:</b> <a href="TArrayD_8cxx_source.html#l00106">TArrayD.cxx:106</a></div></div>
<div class="ttc" id="TRandom3_8h_html"><div class="ttname"><a href="TRandom3_8h.html">TRandom3.h</a></div></div>
<div class="ttc" id="classTLimit_html_a71dbfd44284e6f9e65f6caaf57656275"><div class="ttname"><a href="classTLimit.html#a71dbfd44284e6f9e65f6caaf57656275">TLimit::fgTable</a></div><div class="ttdeci">static TArrayD * fgTable</div><div class="ttdef"><b>Definition:</b> <a href="TLimit_8h_source.html#l00049">TLimit.h:49</a></div></div>
<div class="ttc" id="classTH1_html_a3af6cc15ab6c2490428c9b691885d919"><div class="ttname"><a href="classTH1.html#a3af6cc15ab6c2490428c9b691885d919">TH1::GetBinError</a></div><div class="ttdeci">virtual Double_t GetBinError(Int_t bin) const</div><div class="ttdoc">Return value of error associated to bin number bin. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l08476">TH1.cxx:8476</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:09:21 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

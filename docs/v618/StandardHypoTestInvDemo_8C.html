<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/roostats/StandardHypoTestInvDemo.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_87facaa6959ceb8d3dacccaf663f7b84.html">roostats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">StandardHypoTestInvDemo.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__roostats.html">RooStats Tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/StandardHypoTestInvDemo.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/StandardHypoTestInvDemo.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  Standard tutorial macro for performing an inverted hypothesis test for computing an interval </p>
<p>This macro will perform a scan of the p-values for computing the interval or limit</p>
<p>Usage:</p>
<div class="fragment"><div class="line">root&gt;.L StandardHypoTestInvDemo.C</div><div class="line">root&gt; StandardHypoTestInvDemo(<span class="stringliteral">&quot;fileName&quot;</span>,<span class="stringliteral">&quot;workspace name&quot;</span>,<span class="stringliteral">&quot;S+B modelconfig name&quot;</span>,<span class="stringliteral">&quot;B model name&quot;</span>,<span class="stringliteral">&quot;data set</span></div><div class="line"><span class="stringliteral">name&quot;</span>,calculator <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>, <a class="code" href="namespacetest.html">test</a> statistic <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>, use CLS,</div><div class="line">                               number of <a class="code" href="X3DBuffer_8c.html#acdcb482beeccb6520f0040ecf921d1af">points</a>, <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>, <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>, number of toys, use number counting)</div><div class="line"></div><div class="line"><a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> = 0 <a class="code" href="namespaceTMath.html#ae2dee073dca894d3cb39e01437a59854">Freq</a> calculator</div><div class="line"><a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> = 1 <a class="code" href="namespaceRooFit.html#a5cf659ce1d64334611ecf9123991ea5da427424131c27312feb209bd7e211b598">Hybrid</a> calculator</div><div class="line"><a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> = 2 Asymptotic calculator</div><div class="line"><a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> = 3 Asymptotic calculator <span class="keyword">using</span> nominal <a class="code" href="namespaceRooFit.html#a14c36bc4d4e2025dce1c1948a11707f3">Asimov</a> data sets (not <span class="keyword">using</span> fitted parameter values but nominal ones)</div><div class="line"></div><div class="line">testStatType = 0 LEP</div><div class="line">             = 1 Tevatron</div><div class="line">             = 2 Profile Likelihood two sided</div><div class="line">             = 3 Profile Likelihood one sided (i.e. = 0 <span class="keywordflow">if</span> mu &lt; mu_hat)</div><div class="line">             = 4 Profile Likelihood signed ( pll = -pll <span class="keywordflow">if</span> mu &lt; mu_hat)</div><div class="line">             = 5 <a class="code" href="namespaceTMath.html#a38e1c23e08564d17051526d7e0a5364d">Max</a> Likelihood Estimate <a class="code" href="namespaceRcpp.html#ac3aa0bad652173ac9376b32f469a022d">as</a> <a class="code" href="namespacetest.html">test</a> statistic</div><div class="line">             = 6 Number of observed <span class="keyword">event</span> <a class="code" href="namespaceRcpp.html#ac3aa0bad652173ac9376b32f469a022d">as</a> <a class="code" href="namespacetest.html">test</a> statistic</div></div><!-- fragment --><div class="image">
<img src="pict1_StandardHypoTestInvDemo.C.png" alt="pict1_StandardHypoTestInvDemo.C.png" width="700"/>
</div>
 <div class="image">
<img src="pict2_StandardHypoTestInvDemo.C.png" alt="pict2_StandardHypoTestInvDemo.C.png" width="700"/>
</div>
 <div class="fragment"><div class="line"></div><div class="line"></div><div class="line">[1mRooFit v3.60 -- Developed by Wouter Verkerke and David Kirkby[0m </div><div class="line">                Copyright (C) 2000-2013 NIKHEF, University of California &amp; Stanford University</div><div class="line">                All rights reserved, please read http://roofit.sourceforge.net/license.txt</div><div class="line"></div><div class="line">0x41e9f90   results/example_combined_GaussExample_model.root</div><div class="line">Running HypoTestInverter on the workspace combined</div><div class="line"></div><div class="line">RooWorkspace(combined) combined contents</div><div class="line"></div><div class="line">variables</div><div class="line">---------</div><div class="line">(Lumi,SigXsecOverSM,alpha_syst1,alpha_syst2,alpha_syst3,binWidth_obs_x_channel1_0,binWidth_obs_x_channel1_1,binWidth_obs_x_channel1_2,channelCat,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1,nom_alpha_syst1,nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1,nominalLumi,obs_x_channel1,weightVar)</div><div class="line"></div><div class="line">p.d.f.s</div><div class="line">-------</div><div class="line">RooGaussian::alpha_syst1Constraint[ x=alpha_syst1 mean=nom_alpha_syst1 sigma=1 ] = 1</div><div class="line">RooGaussian::alpha_syst2Constraint[ x=alpha_syst2 mean=nom_alpha_syst2 sigma=1 ] = 1</div><div class="line">RooGaussian::alpha_syst3Constraint[ x=alpha_syst3 mean=nom_alpha_syst3 sigma=1 ] = 1</div><div class="line">RooRealSumPdf::channel1_model[ binWidth_obs_x_channel1_0 * L_x_signal_channel1_overallSyst_x_Exp + binWidth_obs_x_channel1_1 * L_x_background1_channel1_overallSyst_x_StatUncert + binWidth_obs_x_channel1_2 * L_x_background2_channel1_overallSyst_x_StatUncert ] = 220</div><div class="line">RooPoisson::gamma_stat_channel1_bin_0_constraint[ x=nom_gamma_stat_channel1_bin_0 mean=gamma_stat_channel1_bin_0_poisMean ] = 0.019943</div><div class="line">RooPoisson::gamma_stat_channel1_bin_1_constraint[ x=nom_gamma_stat_channel1_bin_1 mean=gamma_stat_channel1_bin_1_poisMean ] = 0.039861</div><div class="line">RooGaussian::lumiConstraint[ x=Lumi mean=nominalLumi sigma=0.1 ] = 1</div><div class="line">RooProdPdf::model_channel1[ lumiConstraint * alpha_syst1Constraint * alpha_syst2Constraint * alpha_syst3Constraint * gamma_stat_channel1_bin_0_constraint * gamma_stat_channel1_bin_1_constraint * channel1_model(obs_x_channel1) ] = 0.174888</div><div class="line">RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.174888</div><div class="line"></div><div class="line">functions</div><div class="line">--------</div><div class="line">RooProduct::L_x_background1_channel1_overallSyst_x_StatUncert[ Lumi * background1_channel1_overallSyst_x_StatUncert ] = 0</div><div class="line">RooProduct::L_x_background2_channel1_overallSyst_x_StatUncert[ Lumi * background2_channel1_overallSyst_x_StatUncert ] = 100</div><div class="line">RooProduct::L_x_signal_channel1_overallSyst_x_Exp[ Lumi * signal_channel1_overallSyst_x_Exp ] = 10</div><div class="line">RooStats::HistFactory::FlexibleInterpVar::background1_channel1_epsilon[ paramList=(alpha_syst2) ] = 1</div><div class="line">RooHistFunc::background1_channel1_nominal[ depList=(obs_x_channel1) depList=(obs_x_channel1) ] = 0</div><div class="line">RooProduct::background1_channel1_overallSyst_x_Exp[ background1_channel1_nominal * background1_channel1_epsilon ] = 0</div><div class="line">RooProduct::background1_channel1_overallSyst_x_StatUncert[ mc_stat_channel1 * background1_channel1_overallSyst_x_Exp ] = 0</div><div class="line">RooStats::HistFactory::FlexibleInterpVar::background2_channel1_epsilon[ paramList=(alpha_syst3) ] = 1</div><div class="line">RooHistFunc::background2_channel1_nominal[ depList=(obs_x_channel1) depList=(obs_x_channel1) ] = 100</div><div class="line">RooProduct::background2_channel1_overallSyst_x_Exp[ background2_channel1_nominal * background2_channel1_epsilon ] = 100</div><div class="line">RooProduct::background2_channel1_overallSyst_x_StatUncert[ mc_stat_channel1 * background2_channel1_overallSyst_x_Exp ] = 100</div><div class="line">RooProduct::gamma_stat_channel1_bin_0_poisMean[ gamma_stat_channel1_bin_0 * gamma_stat_channel1_bin_0_tau ] = 400</div><div class="line">RooProduct::gamma_stat_channel1_bin_1_poisMean[ gamma_stat_channel1_bin_1 * gamma_stat_channel1_bin_1_tau ] = 100</div><div class="line">ParamHistFunc::mc_stat_channel1[ ] = 1</div><div class="line">RooStats::HistFactory::FlexibleInterpVar::signal_channel1_epsilon[ paramList=(alpha_syst1) ] = 1</div><div class="line">RooHistFunc::signal_channel1_nominal[ depList=(obs_x_channel1) depList=(obs_x_channel1) ] = 10</div><div class="line">RooProduct::signal_channel1_overallNorm_x_sigma_epsilon[ SigXsecOverSM * signal_channel1_epsilon ] = 1</div><div class="line">RooProduct::signal_channel1_overallSyst_x_Exp[ signal_channel1_nominal * signal_channel1_overallNorm_x_sigma_epsilon ] = 10</div><div class="line"></div><div class="line">datasets</div><div class="line">--------</div><div class="line">RooDataSet::asimovData(obs_x_channel1,weightVar,channelCat)</div><div class="line">RooDataSet::obsData(channelCat,obs_x_channel1)</div><div class="line"></div><div class="line">embedded datasets (in pdfs and functions)</div><div class="line">-----------------------------------------</div><div class="line">RooDataHist::signal_channel1nominalDHist(obs_x_channel1)</div><div class="line">RooDataHist::background1_channel1nominalDHist(obs_x_channel1)</div><div class="line">RooDataHist::background2_channel1nominalDHist(obs_x_channel1)</div><div class="line"></div><div class="line">parameter snapshots</div><div class="line">-------------------</div><div class="line">NominalParamValues = (nom_alpha_syst2=0[C],nom_alpha_syst3=0[C],nom_gamma_stat_channel1_bin_0=400[C],nom_gamma_stat_channel1_bin_1=100[C],weightVar=0,obs_x_channel1=1.75,Lumi=1[C],nominalLumi=1[C],alpha_syst1=0[C],nom_alpha_syst1=0[C],alpha_syst2=0,alpha_syst3=0,gamma_stat_channel1_bin_0=1,gamma_stat_channel1_bin_1=1,SigXsecOverSM=1,binWidth_obs_x_channel1_0=2[C],binWidth_obs_x_channel1_1=2[C],binWidth_obs_x_channel1_2=2[C])</div><div class="line"></div><div class="line">named sets</div><div class="line">----------</div><div class="line">ModelConfig_GlobalObservables:(nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">ModelConfig_NuisParams:(alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">ModelConfig_Observables:(obs_x_channel1,weightVar,channelCat)</div><div class="line">ModelConfig_POI:(SigXsecOverSM)</div><div class="line">globalObservables:(nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">observables:(obs_x_channel1,weightVar,channelCat)</div><div class="line"></div><div class="line">generic objects</div><div class="line">---------------</div><div class="line">RooStats::ModelConfig::ModelConfig</div><div class="line"></div><div class="line">Using data set obsData</div><div class="line">StandardHypoTestInvDemo : POI initial value:   SigXsecOverSM = 1</div><div class="line">[#1] INFO:InputArguments -- HypoTestInverter ---- Input models: </div><div class="line">       using as S+B (null) model     : ModelConfig</div><div class="line">       using as B (alternate) model  : ModelConfig_with_poi_0</div><div class="line"></div><div class="line">Doing a fixed scan  in interval : 0 , 5</div><div class="line">[#1] INFO:Eval -- HypoTestInverter::GetInterval - run a fixed scan</div><div class="line">[#0] WARNING:InputArguments -- HypoTestInverter::RunFixedScan - xMax &gt; upper bound, use xmax = 3</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(combined) replacing previous snapshot with name ModelConfig__snapshot</div><div class="line">[#0] PROGRESS:Eval -- Running for SigXsecOverSM = 0</div><div class="line"></div><div class="line">=== Using the following for ModelConfig ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.158989</div><div class="line">Snapshot:                </div><div class="line">  1) 0x4a54ad0 RooRealVar:: SigXsecOverSM = 0  L(0 - 3)  &quot;SigXsecOverSM&quot;</div><div class="line"></div><div class="line"></div><div class="line">=== Using the following for ModelConfig_with_poi_0 ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.158989</div><div class="line">Snapshot:                </div><div class="line">  1) 0x4a3c5b0 RooRealVar:: SigXsecOverSM = 0  L(0 - 3)  &quot;SigXsecOverSM&quot;</div><div class="line"></div><div class="line">[#0] PROGRESS:Generation -- Test Statistic on data: 0</div><div class="line">[#1] INFO:InputArguments -- Profiling conditional MLEs for Null.</div><div class="line">[#1] INFO:InputArguments -- Using a ToyMCSampler. Now configuring for Null.</div><div class="line">[#0] PROGRESS:Generation -- generated toys: 500 / 1000</div><div class="line">[#1] INFO:InputArguments -- Profiling conditional MLEs for Alt.</div><div class="line">[#1] INFO:InputArguments -- Using a ToyMCSampler. Now configuring for Alt.</div><div class="line">[#0] PROGRESS:Eval -- P values for  SigXsecOverSM =  0</div><div class="line">   CLs      = 1 +/- 0</div><div class="line">   CLb      = 1 +/- 0</div><div class="line">   CLsplusb = 1 +/- 0</div><div class="line"></div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(combined) replacing previous snapshot with name ModelConfig__snapshot</div><div class="line">[#0] PROGRESS:Eval -- Running for SigXsecOverSM = 0.6</div><div class="line"></div><div class="line">=== Using the following for ModelConfig ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.168529</div><div class="line">Snapshot:                </div><div class="line">  1) 0x4b0bec0 RooRealVar:: SigXsecOverSM = 0.6  L(0 - 3)  &quot;SigXsecOverSM&quot;</div><div class="line"></div><div class="line"></div><div class="line">=== Using the following for ModelConfig_with_poi_0 ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.168529</div><div class="line">Snapshot:                </div><div class="line">  1) 0x4a56ce0 RooRealVar:: SigXsecOverSM = 0  L(0 - 3)  &quot;SigXsecOverSM&quot;</div><div class="line"></div><div class="line">[#0] PROGRESS:Generation -- Test Statistic on data: -2.35222</div><div class="line">[#1] INFO:InputArguments -- Profiling conditional MLEs for Null.</div><div class="line">[#1] INFO:InputArguments -- Using a ToyMCSampler. Now configuring for Null.</div><div class="line">[#0] PROGRESS:Generation -- generated toys: 500 / 1000</div><div class="line">[#1] INFO:InputArguments -- Profiling conditional MLEs for Alt.</div><div class="line">[#1] INFO:InputArguments -- Using a ToyMCSampler. Now configuring for Alt.</div><div class="line">[#0] PROGRESS:Eval -- P values for  SigXsecOverSM =  0.6</div><div class="line">   CLs      = 0.819079 +/- 0.0188863</div><div class="line">   CLb      = 0.912 +/- 0.0126693</div><div class="line">   CLsplusb = 0.747 +/- 0.0137474</div><div class="line"></div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(combined) replacing previous snapshot with name ModelConfig__snapshot</div><div class="line">[#0] PROGRESS:Eval -- Running for SigXsecOverSM = 1.2</div><div class="line"></div><div class="line">=== Using the following for ModelConfig ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.178068</div><div class="line">Snapshot:                </div><div class="line">  1) 0x4cc9590 RooRealVar:: SigXsecOverSM = 1.2  L(0 - 3)  &quot;SigXsecOverSM&quot;</div><div class="line"></div><div class="line"></div><div class="line">=== Using the following for ModelConfig_with_poi_0 ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.178068</div><div class="line">Snapshot:                </div><div class="line">  1) 0x4b0ce70 RooRealVar:: SigXsecOverSM = 0  L(0 - 3)  &quot;SigXsecOverSM&quot;</div><div class="line"></div><div class="line">[#0] PROGRESS:Generation -- Test Statistic on data: -2.9364</div><div class="line">[#1] INFO:InputArguments -- Profiling conditional MLEs for Null.</div><div class="line">[#1] INFO:InputArguments -- Using a ToyMCSampler. Now configuring for Null.</div><div class="line">[#0] PROGRESS:Generation -- generated toys: 500 / 1000</div><div class="line">[#1] INFO:InputArguments -- Profiling conditional MLEs for Alt.</div><div class="line">[#1] INFO:InputArguments -- Using a ToyMCSampler. Now configuring for Alt.</div><div class="line">[#0] PROGRESS:Eval -- P values for  SigXsecOverSM =  1.2</div><div class="line">   CLs      = 0.48617 +/- 0.0176356</div><div class="line">   CLb      = 0.94 +/- 0.0106207</div><div class="line">   CLsplusb = 0.457 +/- 0.0157528</div><div class="line"></div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(combined) replacing previous snapshot with name ModelConfig__snapshot</div><div class="line">[#0] PROGRESS:Eval -- Running for SigXsecOverSM = 1.8</div><div class="line"></div><div class="line">=== Using the following for ModelConfig ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.187607</div><div class="line">Snapshot:                </div><div class="line">  1) 0x4b0ea10 RooRealVar:: SigXsecOverSM = 1.8  L(0 - 3)  &quot;SigXsecOverSM&quot;</div><div class="line"></div><div class="line"></div><div class="line">=== Using the following for ModelConfig_with_poi_0 ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.187607</div><div class="line">Snapshot:                </div><div class="line">  1) 0x4a4cd90 RooRealVar:: SigXsecOverSM = 0  L(0 - 3)  &quot;SigXsecOverSM&quot;</div><div class="line"></div><div class="line">[#0] PROGRESS:Generation -- Test Statistic on data: -2.05075</div><div class="line">[#1] INFO:InputArguments -- Profiling conditional MLEs for Null.</div><div class="line">[#1] INFO:InputArguments -- Using a ToyMCSampler. Now configuring for Null.</div><div class="line">[#0] PROGRESS:Generation -- generated toys: 500 / 1000</div><div class="line">[#1] INFO:InputArguments -- Profiling conditional MLEs for Alt.</div><div class="line">[#1] INFO:InputArguments -- Using a ToyMCSampler. Now configuring for Alt.</div><div class="line">[#0] PROGRESS:Eval -- P values for  SigXsecOverSM =  1.8</div><div class="line">   CLs      = 0.190678 +/- 0.0130363</div><div class="line">   CLb      = 0.944 +/- 0.0102824</div><div class="line">   CLsplusb = 0.18 +/- 0.0121491</div><div class="line"></div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(combined) replacing previous snapshot with name ModelConfig__snapshot</div><div class="line">[#0] PROGRESS:Eval -- Running for SigXsecOverSM = 2.4</div><div class="line"></div><div class="line">=== Using the following for ModelConfig ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.197147</div><div class="line">Snapshot:                </div><div class="line">  1) 0x625cd20 RooRealVar:: SigXsecOverSM = 2.4  L(0 - 3)  &quot;SigXsecOverSM&quot;</div><div class="line"></div><div class="line"></div><div class="line">=== Using the following for ModelConfig_with_poi_0 ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.197147</div><div class="line">Snapshot:                </div><div class="line">  1) 0x4b10f80 RooRealVar:: SigXsecOverSM = 0  L(0 - 3)  &quot;SigXsecOverSM&quot;</div><div class="line"></div><div class="line">[#0] PROGRESS:Generation -- Test Statistic on data: 0.0783908</div><div class="line">[#1] INFO:InputArguments -- Profiling conditional MLEs for Null.</div><div class="line">[#1] INFO:InputArguments -- Using a ToyMCSampler. Now configuring for Null.</div><div class="line">[#0] PROGRESS:Generation -- generated toys: 500 / 1000</div><div class="line">[#1] INFO:InputArguments -- Profiling conditional MLEs for Alt.</div><div class="line">[#1] INFO:InputArguments -- Using a ToyMCSampler. Now configuring for Alt.</div><div class="line">[#0] PROGRESS:Eval -- P values for  SigXsecOverSM =  2.4</div><div class="line">   CLs      = 0.0550847 +/- 0.00746178</div><div class="line">   CLb      = 0.944 +/- 0.0102824</div><div class="line">   CLsplusb = 0.052 +/- 0.00702111</div><div class="line"></div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(combined) replacing previous snapshot with name ModelConfig__snapshot</div><div class="line">[#0] PROGRESS:Eval -- Running for SigXsecOverSM = 3</div><div class="line"></div><div class="line">=== Using the following for ModelConfig ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.206686</div><div class="line">Snapshot:                </div><div class="line">  1) 0x4b135d0 RooRealVar:: SigXsecOverSM = 3  L(0 - 3)  &quot;SigXsecOverSM&quot;</div><div class="line"></div><div class="line"></div><div class="line">=== Using the following for ModelConfig_with_poi_0 ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.206686</div><div class="line">Snapshot:                </div><div class="line">  1) 0x4ad7b40 RooRealVar:: SigXsecOverSM = 0  L(0 - 3)  &quot;SigXsecOverSM&quot;</div><div class="line"></div><div class="line">[#0] PROGRESS:Generation -- Test Statistic on data: 3.27476</div><div class="line">[#1] INFO:InputArguments -- Profiling conditional MLEs for Null.</div><div class="line">[#1] INFO:InputArguments -- Using a ToyMCSampler. Now configuring for Null.</div><div class="line">[#0] PROGRESS:Generation -- generated toys: 500 / 1000</div><div class="line">[#1] INFO:InputArguments -- Profiling conditional MLEs for Alt.</div><div class="line">[#1] INFO:InputArguments -- Using a ToyMCSampler. Now configuring for Alt.</div><div class="line">[#0] PROGRESS:Eval -- P values for  SigXsecOverSM =  3</div><div class="line">   CLs      = 0.00535332 +/- 0.00238893</div><div class="line">   CLb      = 0.934 +/- 0.0111035</div><div class="line">   CLsplusb = 0.005 +/- 0.00223047</div><div class="line"></div><div class="line">Time to perform limit scan </div><div class="line">Real time 0:00:09, CP time 9.500</div><div class="line">The computed upper limit is: 2.46135 +/- 0.0596845</div><div class="line">Expected upper limits, using the B (alternate) model : </div><div class="line"> expected limit (median) 1.60988</div><div class="line"> expected limit (-1 sig) 1.34011</div><div class="line"> expected limit (+1 sig) 2.09019</div><div class="line"> expected limit (-2 sig) 1.14968</div><div class="line"> expected limit (+2 sig) 2.79445</div><div class="line">[#0] WARNING:Plotting -- Could not determine xmin and xmax of sampling distribution that was given to plot.</div><div class="line">[#0] WARNING:Plotting -- Could not determine xmin and xmax of sampling distribution that was given to plot.</div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TFile_8h.html">TFile.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooWorkspace_8h.html">RooWorkspace.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooAbsPdf_8h.html">RooAbsPdf.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooRealVar_8h.html">RooRealVar.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooDataSet_8h.html">RooDataSet.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ModelConfig_8h.html">RooStats/ModelConfig.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooRandom_8h.html">RooRandom.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TGraphErrors_8h.html">TGraphErrors.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TGraphAsymmErrors_8h.html">TGraphAsymmErrors.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TLine_8h.html">TLine.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TROOT_8h.html">TROOT.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TSystem_8h.html">TSystem.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="AsymptoticCalculator_8h.html">RooStats/AsymptoticCalculator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="HybridCalculator_8h.html">RooStats/HybridCalculator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="FrequentistCalculator_8h.html">RooStats/FrequentistCalculator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ToyMCSampler_8h.html">RooStats/ToyMCSampler.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="HypoTestPlot_8h.html">RooStats/HypoTestPlot.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="NumEventsTestStat_8h.html">RooStats/NumEventsTestStat.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ProfileLikelihoodTestStat_8h.html">RooStats/ProfileLikelihoodTestStat.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SimpleLikelihoodRatioTestStat_8h.html">RooStats/SimpleLikelihoodRatioTestStat.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RatioOfProfiledLikelihoodsTestStat_8h.html">RooStats/RatioOfProfiledLikelihoodsTestStat.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="MaxLikelihoodEstimateTestStat_8h.html">RooStats/MaxLikelihoodEstimateTestStat.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="NumEventsTestStat_8h.html">RooStats/NumEventsTestStat.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="HypoTestInverter_8h.html">RooStats/HypoTestInverter.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="HypoTestInverterResult_8h.html">RooStats/HypoTestInverterResult.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="HypoTestInverterPlot_8h.html">RooStats/HypoTestInverterPlot.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooFit.html">RooFit</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooStats.html">RooStats</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"></div><div class="line"><span class="comment">// structure defining the options</span></div><div class="line"><span class="keyword">struct </span>HypoTestInvOptions {</div><div class="line"></div><div class="line">   <span class="keywordtype">bool</span> plotHypoTestResult = <span class="keyword">true</span>; <span class="comment">// plot test statistic result at each point</span></div><div class="line">   <span class="keywordtype">bool</span> writeResult = <span class="keyword">true</span>;        <span class="comment">// write HypoTestInverterResult in a file</span></div><div class="line">   <a class="code" href="classTString.html">TString</a> resultFileName; <span class="comment">// file with results (by default is built automatically using the workspace input file name)</span></div><div class="line">   <span class="keywordtype">bool</span> optimize = <span class="keyword">true</span>;   <span class="comment">// optimize evaluation of test statistic</span></div><div class="line">   <span class="keywordtype">bool</span> useVectorStore = <span class="keyword">true</span>;  <span class="comment">// convert data to use new roofit data store</span></div><div class="line">   <span class="keywordtype">bool</span> generateBinned = <span class="keyword">false</span>; <span class="comment">// generate binned data sets</span></div><div class="line">   <span class="keywordtype">bool</span> noSystematics = <span class="keyword">false</span>;  <span class="comment">// force all systematics to be off (i.e. set all nuisance parameters as constat</span></div><div class="line">                                <span class="comment">// to their nominal values)</span></div><div class="line">   <span class="keywordtype">double</span> nToysRatio = 2;       <span class="comment">// ratio Ntoys S+b/ntoysB</span></div><div class="line">   <span class="keywordtype">double</span> maxPOI = -1;          <span class="comment">// max value used of POI (in case of auto scan)</span></div><div class="line">   <span class="keywordtype">bool</span> useProof = <span class="keyword">false</span>;       <span class="comment">// use Proof Lite when using toys (for freq or hybrid)</span></div><div class="line">   <span class="keywordtype">int</span> nworkers = 0;            <span class="comment">// number of worker for ProofLite (default use all available cores)</span></div><div class="line">   <span class="keywordtype">bool</span> enableDetailedOutput =</div><div class="line">      <span class="keyword">false</span>; <span class="comment">// enable detailed output with all fit information for each toys (output will be written in result file)</span></div><div class="line">   <span class="keywordtype">bool</span> rebuild = <span class="keyword">false</span>;       <span class="comment">// re-do extra toys for computing expected limits and rebuild test stat</span></div><div class="line">                               <span class="comment">// distributions (N.B this requires much more CPU (factor is equivalent to nToyToRebuild)</span></div><div class="line">   <span class="keywordtype">int</span> nToyToRebuild = 100;    <span class="comment">// number of toys used to rebuild</span></div><div class="line">   <span class="keywordtype">int</span> rebuildParamValues = 0; <span class="comment">// = 0   do a profile of all the parameters on the B (alt snapshot) before performing a</span></div><div class="line">                               <span class="comment">// rebuild operation (default)</span></div><div class="line">                               <span class="comment">// = 1   use initial workspace parameters with B snapshot values</span></div><div class="line">                               <span class="comment">// = 2   use all initial workspace parameters with B</span></div><div class="line">                               <span class="comment">// Otherwise the rebuild will be performed using</span></div><div class="line">   <span class="keywordtype">int</span> initialFit = -1;        <span class="comment">// do a first  fit to the model (-1 : default, 0 skip fit, 1 do always fit)</span></div><div class="line">   <span class="keywordtype">int</span> randomSeed = -1;        <span class="comment">// random seed (if = -1: use default value, if = 0 always random )</span></div><div class="line">                               <span class="comment">// NOTE: Proof uses automatically a random seed</span></div><div class="line"></div><div class="line">   <span class="keywordtype">int</span> nAsimovBins = 0; <span class="comment">// number of bins in observables used for Asimov data sets (0 is the default and it is given by</span></div><div class="line">                        <span class="comment">// workspace, typically is 100)</span></div><div class="line"></div><div class="line">   <span class="keywordtype">bool</span> reuseAltToys = <span class="keyword">false</span>; <span class="comment">// reuse same toys for alternate hypothesis (if set one gets more stable bands)</span></div><div class="line">   <span class="keywordtype">double</span> confLevel = 0.95;   <span class="comment">// confidence level value</span></div><div class="line"></div><div class="line">   std::string minimizerType =</div><div class="line">      <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// minimizer type (default is what is in ROOT::Math::MinimizerOptions::DefaultMinimizerType()</span></div><div class="line">   std::string massValue = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// extra string to tag output file of result</span></div><div class="line">   <span class="keywordtype">int</span> printLevel = 0;         <span class="comment">// print level for debugging PL test statistics and calculators</span></div><div class="line"></div><div class="line">   <span class="keywordtype">bool</span> useNLLOffset = <span class="keyword">false</span>; <span class="comment">// use NLL offset when fitting (this increase stability of fits)</span></div><div class="line">};</div><div class="line"></div><div class="line">HypoTestInvOptions optHTInv;</div><div class="line"></div><div class="line"><span class="comment">// internal class to run the inverter and more</span></div><div class="line"></div><div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceRooStats.html">RooStats</a> {</div><div class="line"></div><div class="line"><span class="keyword">class </span>HypoTestInvTool {</div><div class="line"></div><div class="line"><span class="keyword">public</span>:</div><div class="line">   HypoTestInvTool();</div><div class="line">   ~HypoTestInvTool(){};</div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1HypoTestInverterResult.html">HypoTestInverterResult</a> *RunInverter(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *w, <span class="keyword">const</span> <span class="keywordtype">char</span> *modelSBName, <span class="keyword">const</span> <span class="keywordtype">char</span> *modelBName,</div><div class="line">                                       <span class="keyword">const</span> <span class="keywordtype">char</span> *dataName, <span class="keywordtype">int</span> <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>, <span class="keywordtype">int</span> testStatType, <span class="keywordtype">bool</span> useCLs, <span class="keywordtype">int</span> npoints,</div><div class="line">                                       <span class="keywordtype">double</span> poimin, <span class="keywordtype">double</span> poimax, <span class="keywordtype">int</span> ntoys, <span class="keywordtype">bool</span> useNumberCounting = <span class="keyword">false</span>,</div><div class="line">                                       <span class="keyword">const</span> <span class="keywordtype">char</span> *nuisPriorName = 0);</div><div class="line"></div><div class="line">   <span class="keywordtype">void</span> AnalyzeResult(<a class="code" href="classRooStats_1_1HypoTestInverterResult.html">HypoTestInverterResult</a> *<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>, <span class="keywordtype">int</span> calculatorType, <span class="keywordtype">int</span> testStatType, <span class="keywordtype">bool</span> useCLs, <span class="keywordtype">int</span> npoints,</div><div class="line">                      <span class="keyword">const</span> <span class="keywordtype">char</span> *fileNameBase = 0);</div><div class="line"></div><div class="line">   <span class="keywordtype">void</span> SetParameter(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keywordtype">char</span> *value);</div><div class="line">   <span class="keywordtype">void</span> SetParameter(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">bool</span> value);</div><div class="line">   <span class="keywordtype">void</span> SetParameter(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">int</span> value);</div><div class="line">   <span class="keywordtype">void</span> SetParameter(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">double</span> value);</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">   <span class="keywordtype">bool</span> mPlotHypoTestResult;</div><div class="line">   <span class="keywordtype">bool</span> mWriteResult;</div><div class="line">   <span class="keywordtype">bool</span> mOptimize;</div><div class="line">   <span class="keywordtype">bool</span> mUseVectorStore;</div><div class="line">   <span class="keywordtype">bool</span> mGenerateBinned;</div><div class="line">   <span class="keywordtype">bool</span> mUseProof;</div><div class="line">   <span class="keywordtype">bool</span> mRebuild;</div><div class="line">   <span class="keywordtype">bool</span> mReuseAltToys;</div><div class="line">   <span class="keywordtype">bool</span> mEnableDetOutput;</div><div class="line">   <span class="keywordtype">int</span> mNWorkers;</div><div class="line">   <span class="keywordtype">int</span> mNToyToRebuild;</div><div class="line">   <span class="keywordtype">int</span> mRebuildParamValues;</div><div class="line">   <span class="keywordtype">int</span> mPrintLevel;</div><div class="line">   <span class="keywordtype">int</span> mInitialFit;</div><div class="line">   <span class="keywordtype">int</span> mRandomSeed;</div><div class="line">   <span class="keywordtype">double</span> mNToysRatio;</div><div class="line">   <span class="keywordtype">double</span> mMaxPoi;</div><div class="line">   <span class="keywordtype">int</span> mAsimovBins;</div><div class="line">   std::string mMassValue;</div><div class="line">   std::string</div><div class="line">      mMinimizerType; <span class="comment">// minimizer type (default is what is in ROOT::Math::MinimizerOptions::DefaultMinimizerType()</span></div><div class="line">   <a class="code" href="classTString.html">TString</a> mResultFileName;</div><div class="line">};</div><div class="line"></div><div class="line">} <span class="comment">// end namespace RooStats</span></div><div class="line"></div><div class="line">RooStats::HypoTestInvTool::HypoTestInvTool()</div><div class="line">   : mPlotHypoTestResult(true), mWriteResult(false), mOptimize(true), mUseVectorStore(true), mGenerateBinned(false),</div><div class="line">     mUseProof(false), mEnableDetOutput(false), mRebuild(false), mReuseAltToys(false), mNWorkers(4),</div><div class="line">     mNToyToRebuild(100), mRebuildParamValues(0), mPrintLevel(0), mInitialFit(-1), mRandomSeed(-1), mNToysRatio(2),</div><div class="line">     mMaxPoi(-1), mAsimovBins(0), mMassValue(<span class="stringliteral">&quot;&quot;</span>), mMinimizerType(<span class="stringliteral">&quot;&quot;</span>), mResultFileName()</div><div class="line">{</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> RooStats::HypoTestInvTool::SetParameter(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">bool</span> value)</div><div class="line">{</div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// set boolean parameters</span></div><div class="line">   <span class="comment">//</span></div><div class="line"></div><div class="line">   std::string s_name(name);</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;PlotHypoTestResult&quot;</span>) != std::string::npos)</div><div class="line">      mPlotHypoTestResult = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;WriteResult&quot;</span>) != std::string::npos)</div><div class="line">      mWriteResult = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;Optimize&quot;</span>) != std::string::npos)</div><div class="line">      mOptimize = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;UseVectorStore&quot;</span>) != std::string::npos)</div><div class="line">      mUseVectorStore = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;GenerateBinned&quot;</span>) != std::string::npos)</div><div class="line">      mGenerateBinned = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;UseProof&quot;</span>) != std::string::npos)</div><div class="line">      mUseProof = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;EnableDetailedOutput&quot;</span>) != std::string::npos)</div><div class="line">      mEnableDetOutput = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;Rebuild&quot;</span>) != std::string::npos)</div><div class="line">      mRebuild = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;ReuseAltToys&quot;</span>) != std::string::npos)</div><div class="line">      mReuseAltToys = value;</div><div class="line"></div><div class="line">   <span class="keywordflow">return</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> RooStats::HypoTestInvTool::SetParameter(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">int</span> value)</div><div class="line">{</div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// set integer parameters</span></div><div class="line">   <span class="comment">//</span></div><div class="line"></div><div class="line">   std::string s_name(name);</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;NWorkers&quot;</span>) != std::string::npos)</div><div class="line">      mNWorkers = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;NToyToRebuild&quot;</span>) != std::string::npos)</div><div class="line">      mNToyToRebuild = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;RebuildParamValues&quot;</span>) != std::string::npos)</div><div class="line">      mRebuildParamValues = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;PrintLevel&quot;</span>) != std::string::npos)</div><div class="line">      mPrintLevel = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;InitialFit&quot;</span>) != std::string::npos)</div><div class="line">      mInitialFit = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;RandomSeed&quot;</span>) != std::string::npos)</div><div class="line">      mRandomSeed = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;AsimovBins&quot;</span>) != std::string::npos)</div><div class="line">      mAsimovBins = value;</div><div class="line"></div><div class="line">   <span class="keywordflow">return</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> RooStats::HypoTestInvTool::SetParameter(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">double</span> value)</div><div class="line">{</div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// set double precision parameters</span></div><div class="line">   <span class="comment">//</span></div><div class="line"></div><div class="line">   std::string s_name(name);</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;NToysRatio&quot;</span>) != std::string::npos)</div><div class="line">      mNToysRatio = value;</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;MaxPOI&quot;</span>) != std::string::npos)</div><div class="line">      mMaxPoi = value;</div><div class="line"></div><div class="line">   <span class="keywordflow">return</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> RooStats::HypoTestInvTool::SetParameter(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keywordtype">char</span> *value)</div><div class="line">{</div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// set string parameters</span></div><div class="line">   <span class="comment">//</span></div><div class="line"></div><div class="line">   std::string s_name(name);</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;MassValue&quot;</span>) != std::string::npos)</div><div class="line">      mMassValue.assign(value);</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;MinimizerType&quot;</span>) != std::string::npos)</div><div class="line">      mMinimizerType.assign(value);</div><div class="line">   <span class="keywordflow">if</span> (s_name.find(<span class="stringliteral">&quot;ResultFileName&quot;</span>) != std::string::npos)</div><div class="line">      mResultFileName = value;</div><div class="line"></div><div class="line">   <span class="keywordflow">return</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> StandardHypoTestInvDemo(<span class="keyword">const</span> <span class="keywordtype">char</span> *infile = 0, <span class="keyword">const</span> <span class="keywordtype">char</span> *wsName = <span class="stringliteral">&quot;combined&quot;</span>,</div><div class="line">                             <span class="keyword">const</span> <span class="keywordtype">char</span> *modelSBName = <span class="stringliteral">&quot;ModelConfig&quot;</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *modelBName = <span class="stringliteral">&quot;&quot;</span>,</div><div class="line">                             <span class="keyword">const</span> <span class="keywordtype">char</span> *dataName = <span class="stringliteral">&quot;obsData&quot;</span>, <span class="keywordtype">int</span> calculatorType = 0, <span class="keywordtype">int</span> testStatType = 0,</div><div class="line">                             <span class="keywordtype">bool</span> useCLs = <span class="keyword">true</span>, <span class="keywordtype">int</span> npoints = 6, <span class="keywordtype">double</span> poimin = 0, <span class="keywordtype">double</span> poimax = 5,</div><div class="line">                             <span class="keywordtype">int</span> ntoys = 1000, <span class="keywordtype">bool</span> useNumberCounting = <span class="keyword">false</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *nuisPriorName = 0)</div><div class="line">{</div><div class="line">   <span class="comment">/*</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">     Other Parameter to pass in tutorial</span></div><div class="line"><span class="comment">     apart from standard for filename, ws, modelconfig and data</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">     type = 0 Freq calculator</span></div><div class="line"><span class="comment">     type = 1 Hybrid calculator</span></div><div class="line"><span class="comment">     type = 2 Asymptotic calculator</span></div><div class="line"><span class="comment">     type = 3 Asymptotic calculator using nominal Asimov data sets (not using fitted parameter values but nominal ones)</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">     testStatType = 0 LEP</span></div><div class="line"><span class="comment">     = 1 Tevatron</span></div><div class="line"><span class="comment">     = 2 Profile Likelihood</span></div><div class="line"><span class="comment">     = 3 Profile Likelihood one sided (i.e. = 0 if mu &lt; mu_hat)</span></div><div class="line"><span class="comment">     = 4 Profiel Likelihood signed ( pll = -pll if mu &lt; mu_hat)</span></div><div class="line"><span class="comment">     = 5 Max Likelihood Estimate as test statistic</span></div><div class="line"><span class="comment">     = 6 Number of observed event as test statistic</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">     useCLs          scan for CLs (otherwise for CLs+b)</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">     npoints:        number of points to scan , for autoscan set npoints = -1</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">     poimin,poimax:  min/max value to scan in case of fixed scans</span></div><div class="line"><span class="comment">     (if min &gt;  max, try to find automatically)</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">     ntoys:         number of toys to use</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">     useNumberCounting:  set to true when using number counting events</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">     nuisPriorName:   name of prior for the nuisance. This is often expressed as constraint term in the global model</span></div><div class="line"><span class="comment">     It is needed only when using the HybridCalculator (type=1)</span></div><div class="line"><span class="comment">     If not given by default the prior pdf from ModelConfig is used.</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">     extra options are available as global parameters of the macro. They major ones are:</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">     plotHypoTestResult   plot result of tests at each point (TS distributions) (default is true)</span></div><div class="line"><span class="comment">     useProof             use Proof   (default is true)</span></div><div class="line"><span class="comment">     writeResult          write result of scan (default is true)</span></div><div class="line"><span class="comment">     rebuild              rebuild scan for expected limits (require extra toys) (default is false)</span></div><div class="line"><span class="comment">     generateBinned       generate binned data sets for toys (default is false) - be careful not to activate with</span></div><div class="line"><span class="comment">     a too large (&gt;=3) number of observables</span></div><div class="line"><span class="comment">     nToyRatio            ratio of S+B/B toys (default is 2)</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   */</span></div><div class="line"></div><div class="line">   <a class="code" href="classTString.html">TString</a> filename(infile);</div><div class="line">   <span class="keywordflow">if</span> (filename.IsNull()) {</div><div class="line">      filename = <span class="stringliteral">&quot;results/example_combined_GaussExample_model.root&quot;</span>;</div><div class="line">      <span class="keywordtype">bool</span> fileExist = !<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(filename); <span class="comment">// note opposite return code</span></div><div class="line">      <span class="comment">// if file does not exists generate with histfactory</span></div><div class="line">      <span class="keywordflow">if</span> (!fileExist) {</div><div class="line"><span class="preprocessor">#ifdef _WIN32</span></div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;HistFactory file cannot be generated on Windows - exit&quot;</span> &lt;&lt; endl;</div><div class="line">         <span class="keywordflow">return</span>;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">         <span class="comment">// Normally this would be run on the command line</span></div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;will run standard hist2workspace example&quot;</span> &lt;&lt; endl;</div><div class="line">         <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLine(<span class="stringliteral">&quot;.! prepareHistFactory .&quot;</span>);</div><div class="line">         <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLine(<span class="stringliteral">&quot;.! hist2workspace config/example.xml&quot;</span>);</div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;\n\n---------------------&quot;</span> &lt;&lt; endl;</div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;Done creating example input&quot;</span> &lt;&lt; endl;</div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;---------------------\n\n&quot;</span> &lt;&lt; endl;</div><div class="line">      }</div><div class="line"></div><div class="line">   } <span class="keywordflow">else</span></div><div class="line">      filename = infile;</div><div class="line"></div><div class="line">   <span class="comment">// Try to open the file</span></div><div class="line">   <a class="code" href="classTFile.html">TFile</a> *<a class="code" href="namespacefile.html">file</a> = <a class="code" href="classTFile.html#aec5f3fae0774aabfc615ebb4b00fe5e0">TFile::Open</a>(filename);</div><div class="line"></div><div class="line">   <span class="comment">// if input file was specified byt not found, quit</span></div><div class="line">   <span class="keywordflow">if</span> (!<a class="code" href="namespacefile.html">file</a>) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;StandardRooStatsDemoMacro: Input file &quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot; is not found&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   HypoTestInvTool calc;</div><div class="line"></div><div class="line">   <span class="comment">// set parameters</span></div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;PlotHypoTestResult&quot;</span>, optHTInv.plotHypoTestResult);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;WriteResult&quot;</span>, optHTInv.writeResult);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;Optimize&quot;</span>, optHTInv.optimize);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;UseVectorStore&quot;</span>, optHTInv.useVectorStore);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;GenerateBinned&quot;</span>, optHTInv.generateBinned);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;NToysRatio&quot;</span>, optHTInv.nToysRatio);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;MaxPOI&quot;</span>, optHTInv.maxPOI);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;UseProof&quot;</span>, optHTInv.useProof);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;EnableDetailedOutput&quot;</span>, optHTInv.enableDetailedOutput);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;NWorkers&quot;</span>, optHTInv.nworkers);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;Rebuild&quot;</span>, optHTInv.rebuild);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;ReuseAltToys&quot;</span>, optHTInv.reuseAltToys);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;NToyToRebuild&quot;</span>, optHTInv.nToyToRebuild);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;RebuildParamValues&quot;</span>, optHTInv.rebuildParamValues);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;MassValue&quot;</span>, optHTInv.massValue.c_str());</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;MinimizerType&quot;</span>, optHTInv.minimizerType.c_str());</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;PrintLevel&quot;</span>, optHTInv.printLevel);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;InitialFit&quot;</span>, optHTInv.initialFit);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;ResultFileName&quot;</span>, optHTInv.resultFileName);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;RandomSeed&quot;</span>, optHTInv.randomSeed);</div><div class="line">   calc.SetParameter(<span class="stringliteral">&quot;AsimovBins&quot;</span>, optHTInv.nAsimovBins);</div><div class="line"></div><div class="line">   <span class="comment">// enable offset for all roostats</span></div><div class="line">   <span class="keywordflow">if</span> (optHTInv.useNLLOffset)</div><div class="line">      <a class="code" href="namespaceRooStats.html#aa3e8e1957a68d767ae126bc21202fe43">RooStats::UseNLLOffset</a>(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">   <a class="code" href="classRooWorkspace.html">RooWorkspace</a> *w = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classRooWorkspace.html">RooWorkspace</a> *<span class="keyword">&gt;</span>(<a class="code" href="namespacefile.html">file</a>-&gt;Get(wsName));</div><div class="line">   <a class="code" href="classRooStats_1_1HypoTestInverterResult.html">HypoTestInverterResult</a> *<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a> = 0;</div><div class="line">   std::cout &lt;&lt; w &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; filename &lt;&lt; std::endl;</div><div class="line">   <span class="keywordflow">if</span> (w != NULL) {</div><div class="line">      <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a> = calc.RunInverter(w, modelSBName, modelBName, dataName, calculatorType, testStatType, useCLs, npoints, poimin,</div><div class="line">                           poimax, ntoys, useNumberCounting, nuisPriorName);</div><div class="line">      <span class="keywordflow">if</span> (!<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>) {</div><div class="line">         std::cerr &lt;&lt; <span class="stringliteral">&quot;Error running the HypoTestInverter - Exit &quot;</span> &lt;&lt; std::endl;</div><div class="line">         <span class="keywordflow">return</span>;</div><div class="line">      }</div><div class="line">   } <span class="keywordflow">else</span> {</div><div class="line">      <span class="comment">// case workspace is not present look for the inverter result</span></div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Reading an HypoTestInverterResult with name &quot;</span> &lt;&lt; wsName &lt;&lt; <span class="stringliteral">&quot; from file &quot;</span> &lt;&lt; filename &lt;&lt; std::endl;</div><div class="line">      <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a> = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classRooStats_1_1HypoTestInverterResult.html">HypoTestInverterResult</a> *<span class="keyword">&gt;</span>(<a class="code" href="namespacefile.html">file</a>-&gt;Get(wsName)); <span class="comment">//</span></div><div class="line">      <span class="keywordflow">if</span> (!<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>) {</div><div class="line">         std::cerr &lt;&lt; <span class="stringliteral">&quot;File &quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot; does not contain a workspace or an HypoTestInverterResult - Exit &quot;</span></div><div class="line">                   &lt;&lt; std::endl;</div><div class="line">         <a class="code" href="namespacefile.html">file</a>-&gt;ls();</div><div class="line">         <span class="keywordflow">return</span>;</div><div class="line">      }</div><div class="line">   }</div><div class="line"></div><div class="line">   calc.AnalyzeResult(<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>, calculatorType, testStatType, useCLs, npoints, infile);</div><div class="line"></div><div class="line">   <span class="keywordflow">return</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> RooStats::HypoTestInvTool::AnalyzeResult(<a class="code" href="classRooStats_1_1HypoTestInverterResult.html">HypoTestInverterResult</a> *<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>, <span class="keywordtype">int</span> calculatorType, <span class="keywordtype">int</span> testStatType,</div><div class="line">                                              <span class="keywordtype">bool</span> useCLs, <span class="keywordtype">int</span> npoints, <span class="keyword">const</span> <span class="keywordtype">char</span> *fileNameBase)</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// analyze result produced by the inverter, optionally save it in a file</span></div><div class="line"></div><div class="line">   <span class="keywordtype">double</span> lowerLimit = 0;</div><div class="line">   <span class="keywordtype">double</span> llError = 0;</div><div class="line"><span class="preprocessor">#if defined ROOT_SVN_VERSION &amp;&amp; ROOT_SVN_VERSION &gt;= 44126</span></div><div class="line">   <span class="keywordflow">if</span> (<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;IsTwoSided()) {</div><div class="line">      lowerLimit = <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;LowerLimit();</div><div class="line">      llError = <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;LowerLimitEstimatedError();</div><div class="line">   }</div><div class="line"><span class="preprocessor">#else</span></div><div class="line">   lowerLimit = <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;LowerLimit();</div><div class="line">   llError = <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;LowerLimitEstimatedError();</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">   <span class="keywordtype">double</span> upperLimit = <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;UpperLimit();</div><div class="line">   <span class="keywordtype">double</span> ulError = <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;UpperLimitEstimatedError();</div><div class="line"></div><div class="line">   <span class="comment">// std::cout &lt;&lt; &quot;DEBUG : [ &quot; &lt;&lt; lowerLimit &lt;&lt; &quot; , &quot; &lt;&lt; upperLimit &lt;&lt; &quot;  ] &quot; &lt;&lt; std::endl;</span></div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (lowerLimit &lt; upperLimit * (1. - 1.<a class="code" href="namespaceTMath.html#a8a8fbe07e94608dbed9e9260283a442f">E</a>-4) &amp;&amp; lowerLimit != 0)</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;The computed lower limit is: &quot;</span> &lt;&lt; lowerLimit &lt;&lt; <span class="stringliteral">&quot; +/- &quot;</span> &lt;&lt; llError &lt;&lt; std::endl;</div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;The computed upper limit is: &quot;</span> &lt;&lt; upperLimit &lt;&lt; <span class="stringliteral">&quot; +/- &quot;</span> &lt;&lt; ulError &lt;&lt; std::endl;</div><div class="line"></div><div class="line">   <span class="comment">// compute expected limit</span></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;Expected upper limits, using the B (alternate) model : &quot;</span> &lt;&lt; std::endl;</div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot; expected limit (median) &quot;</span> &lt;&lt; <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;GetExpectedUpperLimit(0) &lt;&lt; std::endl;</div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot; expected limit (-1 sig) &quot;</span> &lt;&lt; <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;GetExpectedUpperLimit(-1) &lt;&lt; std::endl;</div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot; expected limit (+1 sig) &quot;</span> &lt;&lt; <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;GetExpectedUpperLimit(1) &lt;&lt; std::endl;</div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot; expected limit (-2 sig) &quot;</span> &lt;&lt; <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;GetExpectedUpperLimit(-2) &lt;&lt; std::endl;</div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot; expected limit (+2 sig) &quot;</span> &lt;&lt; <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;GetExpectedUpperLimit(2) &lt;&lt; std::endl;</div><div class="line"></div><div class="line">   <span class="comment">// detailed output</span></div><div class="line">   <span class="keywordflow">if</span> (mEnableDetOutput) {</div><div class="line">      mWriteResult = <span class="keyword">true</span>;</div><div class="line">      <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;detailed output will be written in output result file&quot;</span>);</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// write result in a file</span></div><div class="line">   <span class="keywordflow">if</span> (<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a> != NULL &amp;&amp; mWriteResult) {</div><div class="line"></div><div class="line">      <span class="comment">// write to a file the results</span></div><div class="line">      <span class="keyword">const</span> <span class="keywordtype">char</span> *calcType = (calculatorType == 0) ? <span class="stringliteral">&quot;Freq&quot;</span> : (calculatorType == 1) ? <span class="stringliteral">&quot;Hybr&quot;</span> : <span class="stringliteral">&quot;Asym&quot;</span>;</div><div class="line">      <span class="keyword">const</span> <span class="keywordtype">char</span> *limitType = (useCLs) ? <span class="stringliteral">&quot;CLs&quot;</span> : <span class="stringliteral">&quot;Cls+b&quot;</span>;</div><div class="line">      <span class="keyword">const</span> <span class="keywordtype">char</span> *scanType = (npoints &lt; 0) ? <span class="stringliteral">&quot;auto&quot;</span> : <span class="stringliteral">&quot;grid&quot;</span>;</div><div class="line">      <span class="keywordflow">if</span> (mResultFileName.IsNull()) {</div><div class="line">         mResultFileName = <a class="code" href="classTString.html#ac34bbb89627e20624a416dfbb7a3db70">TString::Format</a>(<span class="stringliteral">&quot;%s_%s_%s_ts%d_&quot;</span>, calcType, limitType, scanType, testStatType);</div><div class="line">         <span class="comment">// strip the / from the filename</span></div><div class="line">         <span class="keywordflow">if</span> (mMassValue.size() &gt; 0) {</div><div class="line">            mResultFileName += mMassValue.c_str();</div><div class="line">            mResultFileName += <span class="stringliteral">&quot;_&quot;</span>;</div><div class="line">         }</div><div class="line"></div><div class="line">         <a class="code" href="classTString.html">TString</a> name = fileNameBase;</div><div class="line">         name.<a class="code" href="classTString.html#a3e9b0bff9cf2054d357533c62f115a1b">Replace</a>(0, name.<a class="code" href="classTString.html#a632fcf337fbd97665dc484cda395d533">Last</a>(<span class="charliteral">&#39;/&#39;</span>) + 1, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line">         mResultFileName += name;</div><div class="line">      }</div><div class="line"></div><div class="line">      <span class="comment">// get (if existing) rebuilt UL distribution</span></div><div class="line">      <a class="code" href="classTString.html">TString</a> uldistFile = <span class="stringliteral">&quot;RULDist.root&quot;</span>;</div><div class="line">      <a class="code" href="classTObject.html">TObject</a> *ulDist = 0;</div><div class="line">      <span class="keywordtype">bool</span> existULDist = !<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(uldistFile);</div><div class="line">      <span class="keywordflow">if</span> (existULDist) {</div><div class="line">         <a class="code" href="classTFile.html">TFile</a> *fileULDist = <a class="code" href="classTFile.html#aec5f3fae0774aabfc615ebb4b00fe5e0">TFile::Open</a>(uldistFile);</div><div class="line">         <span class="keywordflow">if</span> (fileULDist)</div><div class="line">            ulDist = fileULDist-&gt;<a class="code" href="classTDirectoryFile.html#a9472af8730c1694905dbee5c4aa9b65f">Get</a>(<span class="stringliteral">&quot;RULDist&quot;</span>);</div><div class="line">      }</div><div class="line"></div><div class="line">      <a class="code" href="classTFile.html">TFile</a> *fileOut = <span class="keyword">new</span> <a class="code" href="classTFile.html">TFile</a>(mResultFileName, <span class="stringliteral">&quot;RECREATE&quot;</span>);</div><div class="line">      <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;<a class="code" href="classTObject.html#a19782a4717dbfd4857ccd9ffa68aa06d">Write</a>();</div><div class="line">      <span class="keywordflow">if</span> (ulDist)</div><div class="line">         ulDist-&gt;<a class="code" href="classTObject.html#a19782a4717dbfd4857ccd9ffa68aa06d">Write</a>();</div><div class="line">      <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;HypoTestInverterResult has been written in the file %s&quot;</span>, mResultFileName.Data());</div><div class="line"></div><div class="line">      fileOut-&gt;<a class="code" href="classTFile.html#a1eaf64e1803291558efe5d3238c661a4">Close</a>();</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// plot the result ( p values vs scan points)</span></div><div class="line">   std::string typeName = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line">   <span class="keywordflow">if</span> (calculatorType == 0)</div><div class="line">      typeName = <span class="stringliteral">&quot;Frequentist&quot;</span>;</div><div class="line">   <span class="keywordflow">if</span> (calculatorType == 1)</div><div class="line">      typeName = <span class="stringliteral">&quot;Hybrid&quot;</span>;</div><div class="line">   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (calculatorType == 2 || calculatorType == 3) {</div><div class="line">      typeName = <span class="stringliteral">&quot;Asymptotic&quot;</span>;</div><div class="line">      mPlotHypoTestResult = <span class="keyword">false</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keyword">const</span> <span class="keywordtype">char</span> *resultName = <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;<a class="code" href="classTObject.html#a1d6abd2708ecd7578d7ff03c07037bd1">GetName</a>();</div><div class="line">   <a class="code" href="classTString.html">TString</a> plotTitle = <a class="code" href="classTString.html#ac34bbb89627e20624a416dfbb7a3db70">TString::Format</a>(<span class="stringliteral">&quot;%s CL Scan for workspace %s&quot;</span>, typeName.c_str(), resultName);</div><div class="line">   <a class="code" href="classRooStats_1_1HypoTestInverterPlot.html">HypoTestInverterPlot</a> *plot = <span class="keyword">new</span> <a class="code" href="classRooStats_1_1HypoTestInverterPlot.html">HypoTestInverterPlot</a>(<span class="stringliteral">&quot;HTI_Result_Plot&quot;</span>, plotTitle, <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>);</div><div class="line"></div><div class="line">   <span class="comment">// plot in a new canvas with style</span></div><div class="line">   <a class="code" href="classTString.html">TString</a> c1Name = <a class="code" href="classTString.html#ac34bbb89627e20624a416dfbb7a3db70">TString::Format</a>(<span class="stringliteral">&quot;%s_Scan&quot;</span>, typeName.c_str());</div><div class="line">   <a class="code" href="classTCanvas.html">TCanvas</a> *<a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a> = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>(c1Name);</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;SetLogy(<span class="keyword">false</span>);</div><div class="line"></div><div class="line">   plot-&gt;Draw(<span class="stringliteral">&quot;CLb 2CL&quot;</span>); <span class="comment">// plot all and Clb</span></div><div class="line"></div><div class="line">   <span class="comment">// if (useCLs)</span></div><div class="line">   <span class="comment">//    plot-&gt;Draw(&quot;CLb 2CL&quot;);  // plot all and Clb</span></div><div class="line">   <span class="comment">// else</span></div><div class="line">   <span class="comment">//    plot-&gt;Draw(&quot;&quot;);  // plot all and Clb</span></div><div class="line"></div><div class="line">   <span class="keyword">const</span> <span class="keywordtype">int</span> nEntries = <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>-&gt;ArraySize();</div><div class="line"></div><div class="line">   <span class="comment">// plot test statistics distributions for the two hypothesis</span></div><div class="line">   <span class="keywordflow">if</span> (mPlotHypoTestResult) {</div><div class="line">      <a class="code" href="classTCanvas.html">TCanvas</a> *<a class="code" href="legend2_8C.html#a21c4c84fd3ce2681c52ebe3434f93f1e">c2</a> = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>(<span class="stringliteral">&quot;c2&quot;</span>);</div><div class="line">      <span class="keywordflow">if</span> (nEntries &gt; 1) {</div><div class="line">         <span class="keywordtype">int</span> ny = <a class="code" href="namespaceTMath.html#aa0d8bd0abaa8cb975c1df89ecfa31257">TMath::CeilNint</a>(<a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(nEntries));</div><div class="line">         <span class="keywordtype">int</span> nx = <a class="code" href="namespaceTMath.html#aa0d8bd0abaa8cb975c1df89ecfa31257">TMath::CeilNint</a>(<span class="keywordtype">double</span>(nEntries) / ny);</div><div class="line">         <a class="code" href="legend2_8C.html#a21c4c84fd3ce2681c52ebe3434f93f1e">c2</a>-&gt;Divide(nx, ny);</div><div class="line">      }</div><div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nEntries; i++) {</div><div class="line">         <span class="keywordflow">if</span> (nEntries &gt; 1)</div><div class="line">            <a class="code" href="legend2_8C.html#a21c4c84fd3ce2681c52ebe3434f93f1e">c2</a>-&gt;cd(i + 1);</div><div class="line">         <a class="code" href="classRooStats_1_1SamplingDistPlot.html">SamplingDistPlot</a> *pl = plot-&gt;MakeTestStatPlot(i);</div><div class="line">         pl-&gt;<a class="code" href="classRooStats_1_1SamplingDistPlot.html#a38f2bc23bc50d97504364adf50de0d49">SetLogYaxis</a>(<span class="keyword">true</span>);</div><div class="line">         pl-&gt;<a class="code" href="classRooStats_1_1SamplingDistPlot.html#aa7d6b8754c005683cf57b7bb5067fc29">Draw</a>();</div><div class="line">      }</div><div class="line">   }</div><div class="line">   <a class="code" href="TVirtualPad_8h.html#a376b3a920d36f3366fb6a4c9e424aa8c">gPad</a> = <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// internal routine to run the inverter</span></div><div class="line"><a class="code" href="classRooStats_1_1HypoTestInverterResult.html">HypoTestInverterResult</a> *RooStats::HypoTestInvTool::RunInverter(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *w, <span class="keyword">const</span> <span class="keywordtype">char</span> *modelSBName,</div><div class="line">                                                               <span class="keyword">const</span> <span class="keywordtype">char</span> *modelBName, <span class="keyword">const</span> <span class="keywordtype">char</span> *dataName, <span class="keywordtype">int</span> <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>,</div><div class="line">                                                               <span class="keywordtype">int</span> testStatType, <span class="keywordtype">bool</span> useCLs, <span class="keywordtype">int</span> npoints,</div><div class="line">                                                               <span class="keywordtype">double</span> poimin, <span class="keywordtype">double</span> poimax, <span class="keywordtype">int</span> ntoys,</div><div class="line">                                                               <span class="keywordtype">bool</span> useNumberCounting, <span class="keyword">const</span> <span class="keywordtype">char</span> *nuisPriorName)</div><div class="line">{</div><div class="line"></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;Running HypoTestInverter on the workspace &quot;</span> &lt;&lt; w-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>() &lt;&lt; std::endl;</div><div class="line"></div><div class="line">   w-&gt;<a class="code" href="classRooWorkspace.html#a9131cf30e7ea371b14a619ebf0d7e18f">Print</a>();</div><div class="line"></div><div class="line">   <a class="code" href="classRooAbsData.html">RooAbsData</a> *data = w-&gt;<a class="code" href="classRooWorkspace.html#a2e0683ca1b7375eaa434a9cc1298e736">data</a>(dataName);</div><div class="line">   <span class="keywordflow">if</span> (!data) {</div><div class="line">      <a class="code" href="TError_8h.html#a66cc228e173b5602f3733072c52266b0">Error</a>(<span class="stringliteral">&quot;StandardHypoTestDemo&quot;</span>, <span class="stringliteral">&quot;Not existing data %s&quot;</span>, dataName);</div><div class="line">      <span class="keywordflow">return</span> 0;</div><div class="line">   } <span class="keywordflow">else</span></div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Using data set &quot;</span> &lt;&lt; dataName &lt;&lt; std::endl;</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (mUseVectorStore) {</div><div class="line">      <a class="code" href="classRooAbsData.html#a1633278044b85f5f98aef4e68dbcfacb">RooAbsData::setDefaultStorageType</a>(<a class="code" href="classRooAbsData.html#a49eb6b477a355831ed3e57aa48fed47da4dddb128097ee8376025367a13e85040">RooAbsData::Vector</a>);</div><div class="line">      data-&gt;<a class="code" href="classRooAbsData.html#aac46640204af9b51376117df52818e1f">convertToVectorStore</a>();</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// get models from WS</span></div><div class="line">   <span class="comment">// get the modelConfig out of the file</span></div><div class="line">   <a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> *bModel = (<a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> *)w-&gt;<a class="code" href="classRooWorkspace.html#af56548d1c16301ebaf951c452d52f5c3">obj</a>(modelBName);</div><div class="line">   <a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> *sbModel = (<a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> *)w-&gt;<a class="code" href="classRooWorkspace.html#af56548d1c16301ebaf951c452d52f5c3">obj</a>(modelSBName);</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (!sbModel) {</div><div class="line">      <a class="code" href="TError_8h.html#a66cc228e173b5602f3733072c52266b0">Error</a>(<span class="stringliteral">&quot;StandardHypoTestDemo&quot;</span>, <span class="stringliteral">&quot;Not existing ModelConfig %s&quot;</span>, modelSBName);</div><div class="line">      <span class="keywordflow">return</span> 0;</div><div class="line">   }</div><div class="line">   <span class="comment">// check the model</span></div><div class="line">   <span class="keywordflow">if</span> (!sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()) {</div><div class="line">      <a class="code" href="TError_8h.html#a66cc228e173b5602f3733072c52266b0">Error</a>(<span class="stringliteral">&quot;StandardHypoTestDemo&quot;</span>, <span class="stringliteral">&quot;Model %s has no pdf &quot;</span>, modelSBName);</div><div class="line">      <span class="keywordflow">return</span> 0;</div><div class="line">   }</div><div class="line">   <span class="keywordflow">if</span> (!sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>()) {</div><div class="line">      <a class="code" href="TError_8h.html#a66cc228e173b5602f3733072c52266b0">Error</a>(<span class="stringliteral">&quot;StandardHypoTestDemo&quot;</span>, <span class="stringliteral">&quot;Model %s has no poi &quot;</span>, modelSBName);</div><div class="line">      <span class="keywordflow">return</span> 0;</div><div class="line">   }</div><div class="line">   <span class="keywordflow">if</span> (!sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a658c1a5b9ba572686d72acf76587e913">GetObservables</a>()) {</div><div class="line">      <a class="code" href="TError_8h.html#a66cc228e173b5602f3733072c52266b0">Error</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Model %s has no observables &quot;</span>, modelSBName);</div><div class="line">      <span class="keywordflow">return</span> 0;</div><div class="line">   }</div><div class="line">   <span class="keywordflow">if</span> (!sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ad1b62a60d30d7044e46cd4ba686ef46f">GetSnapshot</a>()) {</div><div class="line">      <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Model %s has no snapshot  - make one using model poi&quot;</span>, modelSBName);</div><div class="line">      sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a0b39d97ff2a13e209899dbcc34d2aab7">SetSnapshot</a>(*sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>());</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// case of no systematics</span></div><div class="line">   <span class="comment">// remove nuisance parameters from model</span></div><div class="line">   <span class="keywordflow">if</span> (optHTInv.noSystematics) {</div><div class="line">      <span class="keyword">const</span> <a class="code" href="classRooArgSet.html">RooArgSet</a> *nuisPar = sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>();</div><div class="line">      <span class="keywordflow">if</span> (nuisPar &amp;&amp; nuisPar-&gt;<a class="code" href="classRooAbsCollection.html#a4cd5c184f7be3a6a1ec80d7f8ff5842e">getSize</a>() &gt; 0) {</div><div class="line">         std::cout &lt;&lt; <span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span></div><div class="line">                   &lt;&lt; <span class="stringliteral">&quot;  -  Switch off all systematics by setting them constant to their initial values&quot;</span> &lt;&lt; std::endl;</div><div class="line">         <a class="code" href="namespaceRooStats.html#a14d2a56679ea82a01577e16b27796dc5">RooStats::SetAllConstant</a>(*nuisPar);</div><div class="line">      }</div><div class="line">      <span class="keywordflow">if</span> (bModel) {</div><div class="line">         <span class="keyword">const</span> <a class="code" href="classRooArgSet.html">RooArgSet</a> *bnuisPar = bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>();</div><div class="line">         <span class="keywordflow">if</span> (bnuisPar)</div><div class="line">            <a class="code" href="namespaceRooStats.html#a14d2a56679ea82a01577e16b27796dc5">RooStats::SetAllConstant</a>(*bnuisPar);</div><div class="line">      }</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (!bModel || bModel == sbModel) {</div><div class="line">      <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;The background model %s does not exist&quot;</span>, modelBName);</div><div class="line">      <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Copy it from ModelConfig %s and set POI to zero&quot;</span>, modelSBName);</div><div class="line">      bModel = (<a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> *)sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a1ebcb7fe6c916c02e78bd823b9a50599">Clone</a>();</div><div class="line">      bModel-&gt;<a class="code" href="classTNamed.html#ac9ab37338859e070a2695e3b2db8d217">SetName</a>(<a class="code" href="classTString.html">TString</a>(modelSBName) + <a class="code" href="classTString.html">TString</a>(<span class="stringliteral">&quot;_with_poi_0&quot;</span>));</div><div class="line">      <a class="code" href="classRooRealVar.html">RooRealVar</a> *var = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classRooRealVar.html">RooRealVar</a> *<span class="keyword">&gt;</span>(bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>()-&gt;<a class="code" href="classRooAbsCollection.html#a225c780c4c32077d6923e956225e437a">first</a>());</div><div class="line">      <span class="keywordflow">if</span> (!var)</div><div class="line">         <span class="keywordflow">return</span> 0;</div><div class="line">      <span class="keywordtype">double</span> oldval = var-&gt;<a class="code" href="classRooAbsReal.html#a8881da431598c6d15e06cc80518d323d">getVal</a>();</div><div class="line">      var-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(0);</div><div class="line">      bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a0b39d97ff2a13e209899dbcc34d2aab7">SetSnapshot</a>(<a class="code" href="classRooArgSet.html">RooArgSet</a>(*var));</div><div class="line">      var-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(oldval);</div><div class="line">   } <span class="keywordflow">else</span> {</div><div class="line">      <span class="keywordflow">if</span> (!bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ad1b62a60d30d7044e46cd4ba686ef46f">GetSnapshot</a>()) {</div><div class="line">         <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Model %s has no snapshot  - make one using model poi and 0 values &quot;</span>,</div><div class="line">              modelBName);</div><div class="line">         <a class="code" href="classRooRealVar.html">RooRealVar</a> *var = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classRooRealVar.html">RooRealVar</a> *<span class="keyword">&gt;</span>(bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>()-&gt;<a class="code" href="classRooAbsCollection.html#a225c780c4c32077d6923e956225e437a">first</a>());</div><div class="line">         <span class="keywordflow">if</span> (var) {</div><div class="line">            <span class="keywordtype">double</span> oldval = var-&gt;<a class="code" href="classRooAbsReal.html#a8881da431598c6d15e06cc80518d323d">getVal</a>();</div><div class="line">            var-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(0);</div><div class="line">            bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a0b39d97ff2a13e209899dbcc34d2aab7">SetSnapshot</a>(<a class="code" href="classRooArgSet.html">RooArgSet</a>(*var));</div><div class="line">            var-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(oldval);</div><div class="line">         } <span class="keywordflow">else</span> {</div><div class="line">            <a class="code" href="TError_8h.html#a66cc228e173b5602f3733072c52266b0">Error</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Model %s has no valid poi&quot;</span>, modelBName);</div><div class="line">            <span class="keywordflow">return</span> 0;</div><div class="line">         }</div><div class="line">      }</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// check model  has global observables when there are nuisance pdf</span></div><div class="line">   <span class="comment">// for the hybrid case the globals are not needed</span></div><div class="line">   <span class="keywordflow">if</span> (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> != 1) {</div><div class="line">      <span class="keywordtype">bool</span> hasNuisParam = (sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>() &amp;&amp; sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>()-&gt;<a class="code" href="classRooAbsCollection.html#a4cd5c184f7be3a6a1ec80d7f8ff5842e">getSize</a>() &gt; 0);</div><div class="line">      <span class="keywordtype">bool</span> hasGlobalObs = (sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>() &amp;&amp; sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>()-&gt;<a class="code" href="classRooAbsCollection.html#a4cd5c184f7be3a6a1ec80d7f8ff5842e">getSize</a>() &gt; 0);</div><div class="line">      <span class="keywordflow">if</span> (hasNuisParam &amp;&amp; !hasGlobalObs) {</div><div class="line">         <span class="comment">// try to see if model has nuisance parameters first</span></div><div class="line">         <a class="code" href="classRooAbsPdf.html">RooAbsPdf</a> *constrPdf = <a class="code" href="namespaceRooStats.html#a4b89011fc0e036841cb0a83022c4adf0">RooStats::MakeNuisancePdf</a>(*sbModel, <span class="stringliteral">&quot;nuisanceConstraintPdf_sbmodel&quot;</span>);</div><div class="line">         <span class="keywordflow">if</span> (constrPdf) {</div><div class="line">            <a class="code" href="TError_8h.html#ada27a9a7b710bd062829ec0a12341e09">Warning</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Model %s has nuisance parameters but no global observables associated&quot;</span>,</div><div class="line">                    sbModel-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>());</div><div class="line">            <a class="code" href="TError_8h.html#ada27a9a7b710bd062829ec0a12341e09">Warning</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>,</div><div class="line">                    <span class="stringliteral">&quot;\tThe effect of the nuisance parameters will not be treated correctly &quot;</span>);</div><div class="line">         }</div><div class="line">      }</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// save all initial parameters of the model including the global observables</span></div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> initialParameters;</div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *allParams = sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsArg.html#a710bc6c06210e7d9be3c043f6115570a">getParameters</a>(*data);</div><div class="line">   allParams-&gt;<a class="code" href="classRooArgSet.html#a3b35aea24edd191f95e24ec17d0fdb35">snapshot</a>(initialParameters);</div><div class="line">   <span class="keyword">delete</span> allParams;</div><div class="line"></div><div class="line">   <span class="comment">// run first a data fit</span></div><div class="line"></div><div class="line">   <span class="keyword">const</span> <a class="code" href="classRooArgSet.html">RooArgSet</a> *poiSet = sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>();</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *poi = (<a class="code" href="classRooRealVar.html">RooRealVar</a> *)poiSet-&gt;<a class="code" href="classRooAbsCollection.html#a225c780c4c32077d6923e956225e437a">first</a>();</div><div class="line"></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;StandardHypoTestInvDemo : POI initial value:   &quot;</span> &lt;&lt; poi-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>() &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; poi-&gt;<a class="code" href="classRooAbsReal.html#a8881da431598c6d15e06cc80518d323d">getVal</a>()</div><div class="line">             &lt;&lt; std::endl;</div><div class="line"></div><div class="line">   <span class="comment">// fit the data first (need to use constraint )</span></div><div class="line">   <a class="code" href="classTStopwatch.html">TStopwatch</a> tw;</div><div class="line"></div><div class="line">   <span class="keywordtype">bool</span> doFit = mInitialFit;</div><div class="line">   <span class="keywordflow">if</span> (testStatType == 0 &amp;&amp; mInitialFit == -1)</div><div class="line">      doFit = <span class="keyword">false</span>; <span class="comment">// case of LEP test statistic</span></div><div class="line">   <span class="keywordflow">if</span> (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 3 &amp;&amp; mInitialFit == -1)</div><div class="line">      doFit = <span class="keyword">false</span>; <span class="comment">// case of Asymptoticcalculator with nominal Asimov</span></div><div class="line">   <span class="keywordtype">double</span> poihat = 0;</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (mMinimizerType.size() == 0)</div><div class="line">      mMinimizerType = <a class="code" href="classROOT_1_1Math_1_1MinimizerOptions.html#a79e6f20462fe6221e662fb3a6a59c844">ROOT::Math::MinimizerOptions::DefaultMinimizerType</a>();</div><div class="line">   <span class="keywordflow">else</span></div><div class="line">      <a class="code" href="classROOT_1_1Math_1_1MinimizerOptions.html#a18f305ee5af8d3947cab2848ff52944a">ROOT::Math::MinimizerOptions::SetDefaultMinimizer</a>(mMinimizerType.c_str());</div><div class="line"></div><div class="line">   <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Using %s as minimizer for computing the test statistic&quot;</span>,</div><div class="line">        <a class="code" href="classROOT_1_1Math_1_1MinimizerOptions.html#a79e6f20462fe6221e662fb3a6a59c844">ROOT::Math::MinimizerOptions::DefaultMinimizerType</a>().c_str());</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (doFit) {</div><div class="line"></div><div class="line">      <span class="comment">// do the fit : By doing a fit the POI snapshot (for S+B)  is set to the fit value</span></div><div class="line">      <span class="comment">// and the nuisance parameters nominal values will be set to the fit value.</span></div><div class="line">      <span class="comment">// This is relevant when using LEP test statistics</span></div><div class="line"></div><div class="line">      <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot; Doing a first fit to the observed data &quot;</span>);</div><div class="line">      <a class="code" href="classRooArgSet.html">RooArgSet</a> constrainParams;</div><div class="line">      <span class="keywordflow">if</span> (sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>())</div><div class="line">         constrainParams.<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>());</div><div class="line">      <a class="code" href="namespaceRooStats.html#a26c7b63c360fd8c208423b292a4cdae1">RooStats::RemoveConstantParameters</a>(&amp;constrainParams);</div><div class="line">      tw.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">      <a class="code" href="classRooFitResult.html">RooFitResult</a> *fitres = sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#a8f802a3a93467d5b7b089e3ccaec0fa8">fitTo</a>(</div><div class="line">         *data, <a class="code" href="namespaceRooFit.html#a905e910644ce7a5f27a9cacbd49f0775">InitialHesse</a>(<span class="keyword">false</span>), <a class="code" href="namespaceRooFit.html#a848284da2f0155b04dbdbbc82936ba23">Hesse</a>(<span class="keyword">false</span>), <a class="code" href="namespaceRooFit.html#afac78d31d10b7e7396b999e4ea3af76c">Minimizer</a>(mMinimizerType.c_str(), <span class="stringliteral">&quot;Migrad&quot;</span>), <a class="code" href="namespaceRooFit.html#a3fab95c634bde6f6e3b91f5632d427c4">Strategy</a>(0),</div><div class="line">         <a class="code" href="namespaceRooFit.html#aaec91c86d0bb20f56844412530e5c9fb">PrintLevel</a>(mPrintLevel), <a class="code" href="namespaceRooFit.html#a30b2f29c6489a3b32c17b8587d568530">Constrain</a>(constrainParams), <a class="code" href="namespaceRooFit.html#aaccf9043976e51d28313a373a022f003">Save</a>(<span class="keyword">true</span>), <a class="code" href="namespaceRooFit.html#aed083f34465ce276cba1f3cfd7d3badc">Offset</a>(<a class="code" href="namespaceRooStats.html#abc3b1ac0175189f1e00204c6bdfa87af">RooStats::IsNLLOffset</a>()));</div><div class="line">      <span class="keywordflow">if</span> (fitres-&gt;<a class="code" href="classRooFitResult.html#ade303d8549700880224906837fb1e2c5">status</a>() != 0) {</div><div class="line">         <a class="code" href="TError_8h.html#ada27a9a7b710bd062829ec0a12341e09">Warning</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>,</div><div class="line">                 <span class="stringliteral">&quot;Fit to the model failed - try with strategy 1 and perform first an Hesse computation&quot;</span>);</div><div class="line">         fitres = sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#a8f802a3a93467d5b7b089e3ccaec0fa8">fitTo</a>(</div><div class="line">            *data, <a class="code" href="namespaceRooFit.html#a905e910644ce7a5f27a9cacbd49f0775">InitialHesse</a>(<span class="keyword">true</span>), <a class="code" href="namespaceRooFit.html#a848284da2f0155b04dbdbbc82936ba23">Hesse</a>(<span class="keyword">false</span>), <a class="code" href="namespaceRooFit.html#afac78d31d10b7e7396b999e4ea3af76c">Minimizer</a>(mMinimizerType.c_str(), <span class="stringliteral">&quot;Migrad&quot;</span>), <a class="code" href="namespaceRooFit.html#a3fab95c634bde6f6e3b91f5632d427c4">Strategy</a>(1),</div><div class="line">            <a class="code" href="namespaceRooFit.html#aaec91c86d0bb20f56844412530e5c9fb">PrintLevel</a>(mPrintLevel + 1), <a class="code" href="namespaceRooFit.html#a30b2f29c6489a3b32c17b8587d568530">Constrain</a>(constrainParams), <a class="code" href="namespaceRooFit.html#aaccf9043976e51d28313a373a022f003">Save</a>(<span class="keyword">true</span>), <a class="code" href="namespaceRooFit.html#aed083f34465ce276cba1f3cfd7d3badc">Offset</a>(<a class="code" href="namespaceRooStats.html#abc3b1ac0175189f1e00204c6bdfa87af">RooStats::IsNLLOffset</a>()));</div><div class="line">      }</div><div class="line">      <span class="keywordflow">if</span> (fitres-&gt;<a class="code" href="classRooFitResult.html#ade303d8549700880224906837fb1e2c5">status</a>() != 0)</div><div class="line">         <a class="code" href="TError_8h.html#ada27a9a7b710bd062829ec0a12341e09">Warning</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot; Fit still failed - continue anyway.....&quot;</span>);</div><div class="line"></div><div class="line">      poihat = poi-&gt;<a class="code" href="classRooAbsReal.html#a8881da431598c6d15e06cc80518d323d">getVal</a>();</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;StandardHypoTestInvDemo - Best Fit value : &quot;</span> &lt;&lt; poi-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>() &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; poihat &lt;&lt; <span class="stringliteral">&quot; +/- &quot;</span></div><div class="line">                &lt;&lt; poi-&gt;<a class="code" href="classRooRealVar.html#aca5aeaeeb1570982b2dde80f518b6d05">getError</a>() &lt;&lt; std::endl;</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Time for fitting : &quot;</span>;</div><div class="line">      tw.<a class="code" href="classTStopwatch.html#aa393762ec66c9732940dccf05e8be7ec">Print</a>();</div><div class="line"></div><div class="line">      <span class="comment">// save best fit value in the poi snapshot</span></div><div class="line">      sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a0b39d97ff2a13e209899dbcc34d2aab7">SetSnapshot</a>(*sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>());</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;StandardHypoTestInvo: snapshot of S+B Model &quot;</span> &lt;&lt; sbModel-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>()</div><div class="line">                &lt;&lt; <span class="stringliteral">&quot; is set to the best fit value&quot;</span> &lt;&lt; std::endl;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// print a message in case of LEP test statistics because it affects result by doing or not doing a fit</span></div><div class="line">   <span class="keywordflow">if</span> (testStatType == 0) {</div><div class="line">      <span class="keywordflow">if</span> (!doFit)</div><div class="line">         <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Using LEP test statistic - an initial fit is not done and the TS will use &quot;</span></div><div class="line">                                         <span class="stringliteral">&quot;the nuisances at the model value&quot;</span>);</div><div class="line">      <span class="keywordflow">else</span></div><div class="line">         <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Using LEP test statistic - an initial fit has been done and the TS will use &quot;</span></div><div class="line">                                         <span class="stringliteral">&quot;the nuisances at the best fit value&quot;</span>);</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// build test statistics and hypotest calculators for running the inverter</span></div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1SimpleLikelihoodRatioTestStat.html">SimpleLikelihoodRatioTestStat</a> slrts(*sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>(), *bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>());</div><div class="line"></div><div class="line">   <span class="comment">// null parameters must includes snapshot of poi plus the nuisance values</span></div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> nullParams(*sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ad1b62a60d30d7044e46cd4ba686ef46f">GetSnapshot</a>());</div><div class="line">   <span class="keywordflow">if</span> (sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>())</div><div class="line">      nullParams.<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>());</div><div class="line">   <span class="keywordflow">if</span> (sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ad1b62a60d30d7044e46cd4ba686ef46f">GetSnapshot</a>())</div><div class="line">      slrts.<a class="code" href="classRooStats_1_1SimpleLikelihoodRatioTestStat.html#a8621a7126cc9d0d704e68e3ed172d766">SetNullParameters</a>(nullParams);</div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> altParams(*bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ad1b62a60d30d7044e46cd4ba686ef46f">GetSnapshot</a>());</div><div class="line">   <span class="keywordflow">if</span> (bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>())</div><div class="line">      altParams.<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>());</div><div class="line">   <span class="keywordflow">if</span> (bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ad1b62a60d30d7044e46cd4ba686ef46f">GetSnapshot</a>())</div><div class="line">      slrts.<a class="code" href="classRooStats_1_1SimpleLikelihoodRatioTestStat.html#aec32142f957657342e1b6a8b0f360613">SetAltParameters</a>(altParams);</div><div class="line">   <span class="keywordflow">if</span> (mEnableDetOutput)</div><div class="line">      slrts.<a class="code" href="classRooStats_1_1SimpleLikelihoodRatioTestStat.html#a450ac544d09b7e23c8f3384ae3b606b0">EnableDetailedOutput</a>();</div><div class="line"></div><div class="line">   <span class="comment">// ratio of profile likelihood - need to pass snapshot for the alt</span></div><div class="line">   <a class="code" href="classRooStats_1_1RatioOfProfiledLikelihoodsTestStat.html">RatioOfProfiledLikelihoodsTestStat</a> ropl(*sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>(), *bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>(), bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ad1b62a60d30d7044e46cd4ba686ef46f">GetSnapshot</a>());</div><div class="line">   ropl.<a class="code" href="classRooStats_1_1RatioOfProfiledLikelihoodsTestStat.html#a3bc53f51a81c4ea2bef39106a899a1a9">SetSubtractMLE</a>(<span class="keyword">false</span>);</div><div class="line">   <span class="keywordflow">if</span> (testStatType == 11)</div><div class="line">      ropl.SetSubtractMLE(<span class="keyword">true</span>);</div><div class="line">   ropl.SetPrintLevel(mPrintLevel);</div><div class="line">   ropl.SetMinimizer(mMinimizerType.c_str());</div><div class="line">   <span class="keywordflow">if</span> (mEnableDetOutput)</div><div class="line">      ropl.EnableDetailedOutput();</div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1ProfileLikelihoodTestStat.html">ProfileLikelihoodTestStat</a> profll(*sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>());</div><div class="line">   <span class="keywordflow">if</span> (testStatType == 3)</div><div class="line">      profll.<a class="code" href="classRooStats_1_1ProfileLikelihoodTestStat.html#ac9ebe2bcbbcf47d550e5d08b483e7c23">SetOneSided</a>(<span class="keyword">true</span>);</div><div class="line">   <span class="keywordflow">if</span> (testStatType == 4)</div><div class="line">      profll.<a class="code" href="classRooStats_1_1ProfileLikelihoodTestStat.html#a9e081bf2293a58fa8e5cdeac5c57f783">SetSigned</a>(<span class="keyword">true</span>);</div><div class="line">   profll.<a class="code" href="classRooStats_1_1ProfileLikelihoodTestStat.html#af5298eedb6b9d7e653b1213520d39635">SetMinimizer</a>(mMinimizerType.c_str());</div><div class="line">   profll.<a class="code" href="classRooStats_1_1ProfileLikelihoodTestStat.html#a05d67e85a3d11c5adda0aff86056d489">SetPrintLevel</a>(mPrintLevel);</div><div class="line">   <span class="keywordflow">if</span> (mEnableDetOutput)</div><div class="line">      profll.<a class="code" href="classRooStats_1_1ProfileLikelihoodTestStat.html#a426e0030cc9d814be9175e6c773092ce">EnableDetailedOutput</a>();</div><div class="line"></div><div class="line">   profll.<a class="code" href="classRooStats_1_1ProfileLikelihoodTestStat.html#a570f86fd41cd9704e4b498ebae40f906">SetReuseNLL</a>(mOptimize);</div><div class="line">   slrts.<a class="code" href="classRooStats_1_1SimpleLikelihoodRatioTestStat.html#a618cbc36e6b31d98b6c3dbb4ed0f603f">SetReuseNLL</a>(mOptimize);</div><div class="line">   ropl.SetReuseNLL(mOptimize);</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (mOptimize) {</div><div class="line">      profll.<a class="code" href="classRooStats_1_1ProfileLikelihoodTestStat.html#af5fe41976c048ef2ea9bbb7f884d029f">SetStrategy</a>(0);</div><div class="line">      ropl.SetStrategy(0);</div><div class="line">      <a class="code" href="classROOT_1_1Math_1_1MinimizerOptions.html#a71d6827f47b0fb57e143038fc9886c5c">ROOT::Math::MinimizerOptions::SetDefaultStrategy</a>(0);</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (mMaxPoi &gt; 0)</div><div class="line">      poi-&gt;<a class="code" href="classRooRealVar.html#aa47324878cc9173799075781b7de3987">setMax</a>(mMaxPoi); <span class="comment">// increase limit</span></div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1MaxLikelihoodEstimateTestStat.html">MaxLikelihoodEstimateTestStat</a> maxll(*sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>(), *poi);</div><div class="line">   <a class="code" href="classRooStats_1_1NumEventsTestStat.html">NumEventsTestStat</a> nevtts;</div><div class="line"></div><div class="line">   AsymptoticCalculator::SetPrintLevel(mPrintLevel);</div><div class="line"></div><div class="line">   <span class="comment">// create the HypoTest calculator class</span></div><div class="line">   <a class="code" href="classRooStats_1_1HypoTestCalculatorGeneric.html">HypoTestCalculatorGeneric</a> *hc = 0;</div><div class="line">   <span class="keywordflow">if</span> (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 0)</div><div class="line">      hc = <span class="keyword">new</span> <a class="code" href="classRooStats_1_1FrequentistCalculator.html">FrequentistCalculator</a>(*data, *bModel, *sbModel);</div><div class="line">   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 1)</div><div class="line">      hc = <span class="keyword">new</span> <a class="code" href="classRooStats_1_1HybridCalculator.html">HybridCalculator</a>(*data, *bModel, *sbModel);</div><div class="line">   <span class="comment">// else if (type == 2 ) hc = new AsymptoticCalculator(*data, *bModel, *sbModel, false, mAsimovBins);</span></div><div class="line">   <span class="comment">// else if (type == 3 ) hc = new AsymptoticCalculator(*data, *bModel, *sbModel, true, mAsimovBins);  // for using</span></div><div class="line">   <span class="comment">// Asimov data generated with nominal values</span></div><div class="line">   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 2)</div><div class="line">      hc = <span class="keyword">new</span> <a class="code" href="classRooStats_1_1AsymptoticCalculator.html">AsymptoticCalculator</a>(*data, *bModel, *sbModel, <span class="keyword">false</span>);</div><div class="line">   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 3)</div><div class="line">      hc = <span class="keyword">new</span> <a class="code" href="classRooStats_1_1AsymptoticCalculator.html">AsymptoticCalculator</a>(*data, *bModel, *sbModel,</div><div class="line">                                    <span class="keyword">true</span>); <span class="comment">// for using Asimov data generated with nominal values</span></div><div class="line">   <span class="keywordflow">else</span> {</div><div class="line">      <a class="code" href="TError_8h.html#a66cc228e173b5602f3733072c52266b0">Error</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Invalid - calculator type = %d supported values are only :\n\t\t\t 0 &quot;</span></div><div class="line">                                       <span class="stringliteral">&quot;(Frequentist) , 1 (Hybrid) , 2 (Asymptotic) &quot;</span>,</div><div class="line">            <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>);</div><div class="line">      <span class="keywordflow">return</span> 0;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// set the test statistic</span></div><div class="line">   <a class="code" href="classRooStats_1_1TestStatistic.html">TestStatistic</a> *testStat = 0;</div><div class="line">   <span class="keywordflow">if</span> (testStatType == 0)</div><div class="line">      testStat = &amp;slrts;</div><div class="line">   <span class="keywordflow">if</span> (testStatType == 1 || testStatType == 11)</div><div class="line">      testStat = &amp;ropl;</div><div class="line">   <span class="keywordflow">if</span> (testStatType == 2 || testStatType == 3 || testStatType == 4)</div><div class="line">      testStat = &amp;profll;</div><div class="line">   <span class="keywordflow">if</span> (testStatType == 5)</div><div class="line">      testStat = &amp;maxll;</div><div class="line">   <span class="keywordflow">if</span> (testStatType == 6)</div><div class="line">      testStat = &amp;nevtts;</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (testStat == 0) {</div><div class="line">      <a class="code" href="TError_8h.html#a66cc228e173b5602f3733072c52266b0">Error</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Invalid - test statistic type = %d supported values are only :\n\t\t\t 0 (SLR) &quot;</span></div><div class="line">                                       <span class="stringliteral">&quot;, 1 (Tevatron) , 2 (PLR), 3 (PLR1), 4(MLE)&quot;</span>,</div><div class="line">            testStatType);</div><div class="line">      <span class="keywordflow">return</span> 0;</div><div class="line">   }</div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1ToyMCSampler.html">ToyMCSampler</a> *toymcs = (<a class="code" href="classRooStats_1_1ToyMCSampler.html">ToyMCSampler</a> *)hc-&gt;<a class="code" href="classRooStats_1_1HypoTestCalculatorGeneric.html#ad0cc2b56249f3a09e42b45116d42ead7">GetTestStatSampler</a>();</div><div class="line">   <span class="keywordflow">if</span> (toymcs &amp;&amp; (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 0 || <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 1)) {</div><div class="line">      <span class="comment">// look if pdf is number counting or extended</span></div><div class="line">      <span class="keywordflow">if</span> (sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#a69d77200d6313129397ac2aa8deef408">canBeExtended</a>()) {</div><div class="line">         <span class="keywordflow">if</span> (useNumberCounting)</div><div class="line">            <a class="code" href="TError_8h.html#ada27a9a7b710bd062829ec0a12341e09">Warning</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Pdf is extended: but number counting flag is set: ignore it &quot;</span>);</div><div class="line">      } <span class="keywordflow">else</span> {</div><div class="line">         <span class="comment">// for not extended pdf</span></div><div class="line">         <span class="keywordflow">if</span> (!useNumberCounting) {</div><div class="line">            <span class="keywordtype">int</span> nEvents = data-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>();</div><div class="line">            <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>,</div><div class="line">                 <span class="stringliteral">&quot;Pdf is not extended: number of events to generate taken  from observed data set is %d&quot;</span>, nEvents);</div><div class="line">            toymcs-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#adce3c86f2a53dab084118e650e743cd4">SetNEventsPerToy</a>(nEvents);</div><div class="line">         } <span class="keywordflow">else</span> {</div><div class="line">            <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;using a number counting pdf&quot;</span>);</div><div class="line">            toymcs-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#adce3c86f2a53dab084118e650e743cd4">SetNEventsPerToy</a>(1);</div><div class="line">         }</div><div class="line">      }</div><div class="line"></div><div class="line">      toymcs-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#a9fe8958b3d1f1b72f3e2fc20c5a674ad">SetTestStatistic</a>(testStat);</div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> (data-&gt;<a class="code" href="classRooAbsData.html#a8c21c14dfcac5e0a83142a84e7d9ba40">isWeighted</a>() &amp;&amp; !mGenerateBinned) {</div><div class="line">         <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Data set is weighted, nentries = %d and sum of weights = %8.1f but toy &quot;</span></div><div class="line">                                         <span class="stringliteral">&quot;generation is unbinned - it would be faster to set mGenerateBinned to true\n&quot;</span>,</div><div class="line">              data-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>(), data-&gt;<a class="code" href="classRooAbsData.html#a4f6efa1199ae635129be1d8bef780c35">sumEntries</a>());</div><div class="line">      }</div><div class="line">      toymcs-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#ab479680dd025217e7ed3d562f7d97e75">SetGenerateBinned</a>(mGenerateBinned);</div><div class="line"></div><div class="line">      toymcs-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#aca924931aefd9eb12e30a4e4eea3e974">SetUseMultiGen</a>(mOptimize);</div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> (mGenerateBinned &amp;&amp; sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a658c1a5b9ba572686d72acf76587e913">GetObservables</a>()-&gt;<a class="code" href="classRooAbsCollection.html#a4cd5c184f7be3a6a1ec80d7f8ff5842e">getSize</a>() &gt; 2) {</div><div class="line">         <a class="code" href="TError_8h.html#ada27a9a7b710bd062829ec0a12341e09">Warning</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;generate binned is activated but the number of observable is %d. Too much &quot;</span></div><div class="line">                                            <span class="stringliteral">&quot;memory could be needed for allocating all the bins&quot;</span>,</div><div class="line">                 sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a658c1a5b9ba572686d72acf76587e913">GetObservables</a>()-&gt;<a class="code" href="classRooAbsCollection.html#a4cd5c184f7be3a6a1ec80d7f8ff5842e">getSize</a>());</div><div class="line">      }</div><div class="line"></div><div class="line">      <span class="comment">// set the random seed if needed</span></div><div class="line">      <span class="keywordflow">if</span> (mRandomSeed &gt;= 0)</div><div class="line">         <a class="code" href="classRooRandom.html#af8d5482a5fd444ed2a20beb1d248a25e">RooRandom::randomGenerator</a>()-&gt;<a class="code" href="classTRandom.html#a2007ae15ce828266aecb783ed3410e8b">SetSeed</a>(mRandomSeed);</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// specify if need to re-use same toys</span></div><div class="line">   <span class="keywordflow">if</span> (mReuseAltToys) {</div><div class="line">      hc-&gt;<a class="code" href="classRooStats_1_1HypoTestCalculatorGeneric.html#ab98801050025980b336bcbc1c5f3a919">UseSameAltToys</a>();</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 1) {</div><div class="line">      <a class="code" href="classRooStats_1_1HybridCalculator.html">HybridCalculator</a> *hhc = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classRooStats_1_1HybridCalculator.html">HybridCalculator</a> *<span class="keyword">&gt;</span>(hc);</div><div class="line">      assert(hhc);</div><div class="line"></div><div class="line">      hhc-&gt;<a class="code" href="classRooStats_1_1HybridCalculator.html#a8d9ac51e7776db9321a5a562491e9f90">SetToys</a>(ntoys, ntoys / mNToysRatio); <span class="comment">// can use less ntoys for b hypothesis</span></div><div class="line"></div><div class="line">      <span class="comment">// remove global observables from ModelConfig (this is probably not needed anymore in 5.32)</span></div><div class="line">      bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a98323297e0b37d6a99db4b4eda0ea1c5">SetGlobalObservables</a>(<a class="code" href="classRooArgSet.html">RooArgSet</a>());</div><div class="line">      sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a98323297e0b37d6a99db4b4eda0ea1c5">SetGlobalObservables</a>(<a class="code" href="classRooArgSet.html">RooArgSet</a>());</div><div class="line"></div><div class="line">      <span class="comment">// check for nuisance prior pdf in case of nuisance parameters</span></div><div class="line">      <span class="keywordflow">if</span> (bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>() || sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>()) {</div><div class="line"></div><div class="line">         <span class="comment">// fix for using multigen (does not work in this case)</span></div><div class="line">         toymcs-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#aca924931aefd9eb12e30a4e4eea3e974">SetUseMultiGen</a>(<span class="keyword">false</span>);</div><div class="line">         ToyMCSampler::SetAlwaysUseMultiGen(<span class="keyword">false</span>);</div><div class="line"></div><div class="line">         <a class="code" href="classRooAbsPdf.html">RooAbsPdf</a> *nuisPdf = 0;</div><div class="line">         <span class="keywordflow">if</span> (nuisPriorName)</div><div class="line">            nuisPdf = w-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(nuisPriorName);</div><div class="line">         <span class="comment">// use prior defined first in bModel (then in SbModel)</span></div><div class="line">         <span class="keywordflow">if</span> (!nuisPdf) {</div><div class="line">            <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>,</div><div class="line">                 <span class="stringliteral">&quot;No nuisance pdf given for the HybridCalculator - try to deduce  pdf from the model&quot;</span>);</div><div class="line">            <span class="keywordflow">if</span> (bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>() &amp;&amp; bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a658c1a5b9ba572686d72acf76587e913">GetObservables</a>())</div><div class="line">               nuisPdf = <a class="code" href="namespaceRooStats.html#a4b89011fc0e036841cb0a83022c4adf0">RooStats::MakeNuisancePdf</a>(*bModel, <span class="stringliteral">&quot;nuisancePdf_bmodel&quot;</span>);</div><div class="line">            <span class="keywordflow">else</span></div><div class="line">               nuisPdf = <a class="code" href="namespaceRooStats.html#a4b89011fc0e036841cb0a83022c4adf0">RooStats::MakeNuisancePdf</a>(*sbModel, <span class="stringliteral">&quot;nuisancePdf_sbmodel&quot;</span>);</div><div class="line">         }</div><div class="line">         <span class="keywordflow">if</span> (!nuisPdf) {</div><div class="line">            <span class="keywordflow">if</span> (bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#aec9c70c704e7b47fd4f4a3fb3c354011">GetPriorPdf</a>()) {</div><div class="line">               nuisPdf = bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#aec9c70c704e7b47fd4f4a3fb3c354011">GetPriorPdf</a>();</div><div class="line">               <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>,</div><div class="line">                    <span class="stringliteral">&quot;No nuisance pdf given - try to use %s that is defined as a prior pdf in the B model&quot;</span>,</div><div class="line">                    nuisPdf-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>());</div><div class="line">            } <span class="keywordflow">else</span> {</div><div class="line">               <a class="code" href="TError_8h.html#a66cc228e173b5602f3733072c52266b0">Error</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Cannot run Hybrid calculator because no prior on the nuisance &quot;</span></div><div class="line">                                                <span class="stringliteral">&quot;parameter is specified or can be derived&quot;</span>);</div><div class="line">               <span class="keywordflow">return</span> 0;</div><div class="line">            }</div><div class="line">         }</div><div class="line">         assert(nuisPdf);</div><div class="line">         <a class="code" href="TError_8h.html#a39df8069c2b64976c8e9330743e1b145">Info</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>, <span class="stringliteral">&quot;Using as nuisance Pdf ... &quot;</span>);</div><div class="line">         nuisPdf-&gt;<a class="code" href="classRooAbsArg.html#a6b3b4deb1fe5d9cf935ca49a78426623">Print</a>();</div><div class="line"></div><div class="line">         <span class="keyword">const</span> <a class="code" href="classRooArgSet.html">RooArgSet</a> *nuisParams =</div><div class="line">            (bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>()) ? bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>() : sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>();</div><div class="line">         <a class="code" href="classRooArgSet.html">RooArgSet</a> *np = nuisPdf-&gt;<a class="code" href="classRooAbsArg.html#a774e108868fca1a6819275f0a304fc0d">getObservables</a>(*nuisParams);</div><div class="line">         <span class="keywordflow">if</span> (np-&gt;<a class="code" href="classRooAbsCollection.html#a4cd5c184f7be3a6a1ec80d7f8ff5842e">getSize</a>() == 0) {</div><div class="line">            <a class="code" href="TError_8h.html#ada27a9a7b710bd062829ec0a12341e09">Warning</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>,</div><div class="line">                    <span class="stringliteral">&quot;Prior nuisance does not depend on nuisance parameters. They will be smeared in their full range&quot;</span>);</div><div class="line">         }</div><div class="line">         <span class="keyword">delete</span> np;</div><div class="line"></div><div class="line">         hhc-&gt;<a class="code" href="classRooStats_1_1HybridCalculator.html#a6aa1cd32ed14b7cfb668d873adf660a2">ForcePriorNuisanceAlt</a>(*nuisPdf);</div><div class="line">         hhc-&gt;<a class="code" href="classRooStats_1_1HybridCalculator.html#a13f53281662321e579d7bd3578532bfc">ForcePriorNuisanceNull</a>(*nuisPdf);</div><div class="line">      }</div><div class="line">   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 2 || <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 3) {</div><div class="line">      <span class="keywordflow">if</span> (testStatType == 3)</div><div class="line">         ((<a class="code" href="classRooStats_1_1AsymptoticCalculator.html">AsymptoticCalculator</a> *)hc)-&gt;SetOneSided(<span class="keyword">true</span>);</div><div class="line">      <span class="keywordflow">if</span> (testStatType != 2 &amp;&amp; testStatType != 3)</div><div class="line">         <a class="code" href="TError_8h.html#ada27a9a7b710bd062829ec0a12341e09">Warning</a>(<span class="stringliteral">&quot;StandardHypoTestInvDemo&quot;</span>,</div><div class="line">                 <span class="stringliteral">&quot;Only the PL test statistic can be used with AsymptoticCalculator - use by default a two-sided PL&quot;</span>);</div><div class="line">   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 0) {</div><div class="line">      ((<a class="code" href="classRooStats_1_1FrequentistCalculator.html">FrequentistCalculator</a> *)hc)-&gt;SetToys(ntoys, ntoys / mNToysRatio);</div><div class="line">      <span class="comment">// store also the fit information for each poi point used by calculator based on toys</span></div><div class="line">      <span class="keywordflow">if</span> (mEnableDetOutput)</div><div class="line">         ((<a class="code" href="classRooStats_1_1FrequentistCalculator.html">FrequentistCalculator</a> *)hc)-&gt;StoreFitInfo(<span class="keyword">true</span>);</div><div class="line">   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 1) {</div><div class="line">      ((<a class="code" href="classRooStats_1_1HybridCalculator.html">HybridCalculator</a> *)hc)-&gt;SetToys(ntoys, ntoys / mNToysRatio);</div><div class="line">      <span class="comment">// store also the fit information for each poi point used by calculator based on toys</span></div><div class="line">      <span class="comment">// if (mEnableDetOutput) ((HybridCalculator*) hc)-&gt;StoreFitInfo(true);</span></div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// Get the result</span></div><div class="line">   <a class="code" href="classRooMsgService.html#a1aa4beeeda7e2aab5de645f2b8774c9c">RooMsgService::instance</a>().<a class="code" href="classRooMsgService.html#ae7188f7334fd5da361b961cc39521966">getStream</a>(1).<a class="code" href="structRooMsgService_1_1StreamConfig.html#adcefd36d542ccb3063df77e3c654afce">removeTopic</a>(<a class="code" href="namespaceRooFit.html#a9924e612cb358cd013b50c0e1e6d6148a43857a409d2112a5b67569a5fa018b56">RooFit::NumIntegration</a>);</div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1HypoTestInverter.html">HypoTestInverter</a> calc(*hc);</div><div class="line">   calc.SetConfidenceLevel(optHTInv.confLevel);</div><div class="line"></div><div class="line">   calc.UseCLs(useCLs);</div><div class="line">   calc.SetVerbose(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">   <span class="comment">// can speed up using proof-lite</span></div><div class="line">   <span class="keywordflow">if</span> (mUseProof) {</div><div class="line">      <a class="code" href="classRooStats_1_1ProofConfig.html">ProofConfig</a> <a class="code" href="namespaceTGeant4Unit.html#a9b9c22ca28407dfecdc404f99df537bb">pc</a>(*w, mNWorkers, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>);</div><div class="line">      toymcs-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#a3518c12aaf49b74d3ef58e22b41de58c">SetProofConfig</a>(&amp;<a class="code" href="namespaceTGeant4Unit.html#a9b9c22ca28407dfecdc404f99df537bb">pc</a>); <span class="comment">// enable proof</span></div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (npoints &gt; 0) {</div><div class="line">      <span class="keywordflow">if</span> (poimin &gt; poimax) {</div><div class="line">         <span class="comment">// if no min/max given scan between MLE and +4 sigma</span></div><div class="line">         poimin = int(poihat);</div><div class="line">         poimax = int(poihat + 4 * poi-&gt;<a class="code" href="classRooRealVar.html#aca5aeaeeb1570982b2dde80f518b6d05">getError</a>());</div><div class="line">      }</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Doing a fixed scan  in interval : &quot;</span> &lt;&lt; poimin &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; poimax &lt;&lt; std::endl;</div><div class="line">      calc.SetFixedScan(npoints, poimin, poimax);</div><div class="line">   } <span class="keywordflow">else</span> {</div><div class="line">      <span class="comment">// poi-&gt;setMax(10*int( (poihat+ 10 *poi-&gt;getError() )/10 ) );</span></div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Doing an  automatic scan  in interval : &quot;</span> &lt;&lt; poi-&gt;<a class="code" href="classRooAbsRealLValue.html#af16e9d798cdd32874357e57430803a82">getMin</a>() &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; poi-&gt;<a class="code" href="classRooAbsRealLValue.html#a07d826bfa29ecd48e8e31ed28bd0bc48">getMax</a>() &lt;&lt; std::endl;</div><div class="line">   }</div><div class="line"></div><div class="line">   tw.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">   <a class="code" href="classRooStats_1_1HypoTestInverterResult.html">HypoTestInverterResult</a> *<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a> = calc.GetInterval();</div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;Time to perform limit scan \n&quot;</span>;</div><div class="line">   tw.<a class="code" href="classTStopwatch.html#aa393762ec66c9732940dccf05e8be7ec">Print</a>();</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (mRebuild) {</div><div class="line"></div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;\n***************************************************************\n&quot;</span>;</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Rebuild the upper limit distribution by re-generating new set of pseudo-experiment and re-compute &quot;</span></div><div class="line">                   <span class="stringliteral">&quot;for each of them a new upper limit\n\n&quot;</span>;</div><div class="line"></div><div class="line">      allParams = sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsArg.html#a710bc6c06210e7d9be3c043f6115570a">getParameters</a>(*data);</div><div class="line"></div><div class="line">      <span class="comment">// define on which value of nuisance parameters to do the rebuild</span></div><div class="line">      <span class="comment">// default is best fit value for bmodel snapshot</span></div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> (mRebuildParamValues != 0) {</div><div class="line">         <span class="comment">// set all parameters to their initial workspace values</span></div><div class="line">         *allParams = initialParameters;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">if</span> (mRebuildParamValues == 0 || mRebuildParamValues == 1) {</div><div class="line">         <a class="code" href="classRooArgSet.html">RooArgSet</a> constrainParams;</div><div class="line">         <span class="keywordflow">if</span> (sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>())</div><div class="line">            constrainParams.<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>());</div><div class="line">         <a class="code" href="namespaceRooStats.html#a26c7b63c360fd8c208423b292a4cdae1">RooStats::RemoveConstantParameters</a>(&amp;constrainParams);</div><div class="line"></div><div class="line">         <span class="keyword">const</span> <a class="code" href="classRooArgSet.html">RooArgSet</a> *poiModel = sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>();</div><div class="line">         bModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#aaed14656d3afc7c9c7099cb4b2a194e0">LoadSnapshot</a>();</div><div class="line"></div><div class="line">         <span class="comment">// do a profile using the B model snapshot</span></div><div class="line">         <span class="keywordflow">if</span> (mRebuildParamValues == 0) {</div><div class="line"></div><div class="line">            <a class="code" href="namespaceRooStats.html#a14d2a56679ea82a01577e16b27796dc5">RooStats::SetAllConstant</a>(*poiModel, <span class="keyword">true</span>);</div><div class="line"></div><div class="line">            sbModel-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#a8f802a3a93467d5b7b089e3ccaec0fa8">fitTo</a>(*data, <a class="code" href="namespaceRooFit.html#a905e910644ce7a5f27a9cacbd49f0775">InitialHesse</a>(<span class="keyword">false</span>), <a class="code" href="namespaceRooFit.html#a848284da2f0155b04dbdbbc82936ba23">Hesse</a>(<span class="keyword">false</span>),</div><div class="line">                                     <a class="code" href="namespaceRooFit.html#afac78d31d10b7e7396b999e4ea3af76c">Minimizer</a>(mMinimizerType.c_str(), <span class="stringliteral">&quot;Migrad&quot;</span>), <a class="code" href="namespaceRooFit.html#a3fab95c634bde6f6e3b91f5632d427c4">Strategy</a>(0), <a class="code" href="namespaceRooFit.html#aaec91c86d0bb20f56844412530e5c9fb">PrintLevel</a>(mPrintLevel),</div><div class="line">                                     <a class="code" href="namespaceRooFit.html#a30b2f29c6489a3b32c17b8587d568530">Constrain</a>(constrainParams), <a class="code" href="namespaceRooFit.html#aed083f34465ce276cba1f3cfd7d3badc">Offset</a>(<a class="code" href="namespaceRooStats.html#abc3b1ac0175189f1e00204c6bdfa87af">RooStats::IsNLLOffset</a>()));</div><div class="line"></div><div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;rebuild using fitted parameter value for B-model snapshot&quot;</span> &lt;&lt; std::endl;</div><div class="line">            constrainParams.<a class="code" href="classRooAbsCollection.html#ab988655a6fe646baa9c6a6b5456c3aa0">Print</a>(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"></div><div class="line">            <a class="code" href="namespaceRooStats.html#a14d2a56679ea82a01577e16b27796dc5">RooStats::SetAllConstant</a>(*poiModel, <span class="keyword">false</span>);</div><div class="line">         }</div><div class="line">      }</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;StandardHypoTestInvDemo: Initial parameters used for rebuilding: &quot;</span>;</div><div class="line">      <a class="code" href="namespaceRooStats.html#af93dc9c6ee86dc47f4a4f915af487f87">RooStats::PrintListContent</a>(*allParams, std::cout);</div><div class="line">      <span class="keyword">delete</span> allParams;</div><div class="line"></div><div class="line">      calc.SetCloseProof(1);</div><div class="line">      tw.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">      <a class="code" href="classRooStats_1_1SamplingDistribution.html">SamplingDistribution</a> *limDist = calc.GetUpperLimitDistribution(<span class="keyword">true</span>, mNToyToRebuild);</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Time to rebuild distributions &quot;</span> &lt;&lt; std::endl;</div><div class="line">      tw.<a class="code" href="classTStopwatch.html#aa393762ec66c9732940dccf05e8be7ec">Print</a>();</div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> (limDist) {</div><div class="line">         std::cout &lt;&lt; <span class="stringliteral">&quot;Expected limits after rebuild distribution &quot;</span> &lt;&lt; std::endl;</div><div class="line">         std::cout &lt;&lt; <span class="stringliteral">&quot;expected upper limit  (median of limit distribution) &quot;</span> &lt;&lt; limDist-&gt;<a class="code" href="classRooStats_1_1SamplingDistribution.html#a1fa3f062b8b63d806820f686506f8647">InverseCDF</a>(0.5) &lt;&lt; std::endl;</div><div class="line">         std::cout &lt;&lt; <span class="stringliteral">&quot;expected -1 sig limit (0.16% quantile of limit dist) &quot;</span></div><div class="line">                   &lt;&lt; limDist-&gt;<a class="code" href="classRooStats_1_1SamplingDistribution.html#a1fa3f062b8b63d806820f686506f8647">InverseCDF</a>(<a class="code" href="group__ProbFunc.html#ga87b8f827f201c75eeb002a632fc67840">ROOT::Math::normal_cdf</a>(-1)) &lt;&lt; std::endl;</div><div class="line">         std::cout &lt;&lt; <span class="stringliteral">&quot;expected +1 sig limit (0.84% quantile of limit dist) &quot;</span></div><div class="line">                   &lt;&lt; limDist-&gt;<a class="code" href="classRooStats_1_1SamplingDistribution.html#a1fa3f062b8b63d806820f686506f8647">InverseCDF</a>(<a class="code" href="group__ProbFunc.html#ga87b8f827f201c75eeb002a632fc67840">ROOT::Math::normal_cdf</a>(1)) &lt;&lt; std::endl;</div><div class="line">         std::cout &lt;&lt; <span class="stringliteral">&quot;expected -2 sig limit (.025% quantile of limit dist) &quot;</span></div><div class="line">                   &lt;&lt; limDist-&gt;<a class="code" href="classRooStats_1_1SamplingDistribution.html#a1fa3f062b8b63d806820f686506f8647">InverseCDF</a>(<a class="code" href="group__ProbFunc.html#ga87b8f827f201c75eeb002a632fc67840">ROOT::Math::normal_cdf</a>(-2)) &lt;&lt; std::endl;</div><div class="line">         std::cout &lt;&lt; <span class="stringliteral">&quot;expected +2 sig limit (.975% quantile of limit dist) &quot;</span></div><div class="line">                   &lt;&lt; limDist-&gt;<a class="code" href="classRooStats_1_1SamplingDistribution.html#a1fa3f062b8b63d806820f686506f8647">InverseCDF</a>(<a class="code" href="group__ProbFunc.html#ga87b8f827f201c75eeb002a632fc67840">ROOT::Math::normal_cdf</a>(2)) &lt;&lt; std::endl;</div><div class="line"></div><div class="line">         <span class="comment">// Plot the upper limit distribution</span></div><div class="line">         <a class="code" href="classRooStats_1_1SamplingDistPlot.html">SamplingDistPlot</a> limPlot((mNToyToRebuild &lt; 200) ? 50 : 100);</div><div class="line">         limPlot.AddSamplingDistribution(limDist);</div><div class="line">         limPlot.GetTH1F()-&gt;SetStats(<span class="keyword">true</span>); <span class="comment">// display statistics</span></div><div class="line">         limPlot.SetLineColor(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8aab48c32302f7159d81e081c41dc2d3d2">kBlue</a>);</div><div class="line">         <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>(<span class="stringliteral">&quot;limPlot&quot;</span>, <span class="stringliteral">&quot;Upper Limit Distribution&quot;</span>);</div><div class="line">         limPlot.Draw();</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">         /// save result in a file</span></div><div class="line"><span class="comment"></span>         limDist-&gt;<a class="code" href="classTNamed.html#ac9ab37338859e070a2695e3b2db8d217">SetName</a>(<span class="stringliteral">&quot;RULDist&quot;</span>);</div><div class="line">         <a class="code" href="classTFile.html">TFile</a> *fileOut = <span class="keyword">new</span> <a class="code" href="classTFile.html">TFile</a>(<span class="stringliteral">&quot;RULDist.root&quot;</span>, <span class="stringliteral">&quot;RECREATE&quot;</span>);</div><div class="line">         limDist-&gt;<a class="code" href="classTObject.html#a19782a4717dbfd4857ccd9ffa68aa06d">Write</a>();</div><div class="line">         fileOut-&gt;<a class="code" href="classTFile.html#a1eaf64e1803291558efe5d3238c661a4">Close</a>();</div><div class="line"></div><div class="line">         <span class="comment">// update r to a new updated result object containing the rebuilt expected p-values distributions</span></div><div class="line">         <span class="comment">// (it will not recompute the expected limit)</span></div><div class="line">         <span class="keywordflow">if</span> (<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>)</div><div class="line">            <span class="keyword">delete</span> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>; <span class="comment">// need to delete previous object since GetInterval will return a cloned copy</span></div><div class="line">         <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a> = calc.GetInterval();</div><div class="line"></div><div class="line">      } <span class="keywordflow">else</span></div><div class="line">         std::cout &lt;&lt; <span class="stringliteral">&quot;ERROR : failed to re-build distributions &quot;</span> &lt;&lt; std::endl;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">return</span> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> ReadResult(<span class="keyword">const</span> <span class="keywordtype">char</span> *fileName, <span class="keyword">const</span> <span class="keywordtype">char</span> *resultName = <span class="stringliteral">&quot;&quot;</span>, <span class="keywordtype">bool</span> useCLs = <span class="keyword">true</span>)</div><div class="line">{</div><div class="line">   <span class="comment">// read a previous stored result from a file given the result name</span></div><div class="line"></div><div class="line">   StandardHypoTestInvDemo(fileName, resultName, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0, 0, useCLs);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef USE_AS_MAIN</span></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="histspeedtest_8cxx.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div><div class="line">{</div><div class="line">   StandardHypoTestInvDemo();</div><div class="line">}</div><div class="line"><span class="preprocessor">#endif</span></div></div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>Lorenzo Moneta </dd></dl>

<p class="definition">Definition in file <a class="el" href="StandardHypoTestInvDemo_8C_source.html">StandardHypoTestInvDemo.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:28 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

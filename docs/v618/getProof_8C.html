<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/proof/getProof.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_29929efa3f3fb53099f7c28d426fadac.html">proof</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">getProof.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__proof.html">Proof tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Attaches to a PROOF session, possibly at the indicated URL. </p>
<p>If no existing PROOF session is found and no URL is given, try to start a local PROOF session.</p>
<p>Arguments: 'url' URL of the master where to start/attach the PROOF session; this is also the place where to force creation of a new session, if needed (use option 'N', e.g. "proof://mymaster:myport/?N")</p>
<p>The following arguments apply to xrootd responding at 'refloc' only: 'nwrks' Number of workers to be started. [] 'dir' Directory to be used for the files and working areas []. When starting a new instance of the daemon this directory is cleaned with 'rm -fr'. If 'dir' is null, the default is used: '/tmp/&lt;user&gt;/.getproof' 'opt' Defines what to do if an existing xrootd uses the same ports; possible options are: "ask", ask the user; "force", kill the xrootd and start a new one; if any other string is specified the existing xrootd will be used ["ask"]. NB: for a change in 'nwrks' to be effective you need to specify opt = "force" 'dyn' This flag can be used to switch on dynamic, per-job worker setup scheduling [kFALSE]. 'tutords' This flag can be used to force a dataset dir under the tutorial dir [kFALSE]</p>
<p>It is possible to trigger the automatic valgrind setup by defining the env GETPROOF_VALGRIND. E.g. to run the master in valgrind do </p><pre class="fragment">$ export GETPROOF_VALGRIND="valgrind=master"
</pre><p>(or $ export GETPROOF_VALGRIND="valgrind=master valgrind_opts:--leak-check=full"</p>
<p>to set some options) before running getProof. Note that 'getProof' is also called by 'stressProof', so this holds for 'stressProof' runs too.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Bytes_8h.html">Bytes.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;Getline.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TEnv_8h.html">TEnv.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TProof_8h.html">TProof.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TSocket_8h.html">TSocket.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TString_8h.html">TString.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TSystem_8h.html">TSystem.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="comment">// Auxilliary functions</span></div><div class="line"><span class="keywordtype">int</span> getDebugEnum(<span class="keyword">const</span> <span class="keywordtype">char</span> *what);</div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> getXrootdPid(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> port, <span class="keyword">const</span> <span class="keywordtype">char</span> *subdir = <span class="stringliteral">&quot;xpdtut&quot;</span>);</div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> checkXrootdAt(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> port, <span class="keyword">const</span> <span class="keywordtype">char</span> *host = <span class="stringliteral">&quot;localhost&quot;</span>);</div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> checkXproofdAt(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> port, <span class="keyword">const</span> <span class="keywordtype">char</span> *host = <span class="stringliteral">&quot;localhost&quot;</span>);</div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> startXrootdAt(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> port, <span class="keyword">const</span> <span class="keywordtype">char</span> *exportdirs = 0, <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> force = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>);</div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> killXrootdAt(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> port, <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = 0);</div><div class="line"></div><div class="line"><span class="comment">// Auxilliary structures for Xrootd/Xproofd pinging ...</span></div><div class="line"><span class="comment">// The client request</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div><div class="line">   <span class="keywordtype">int</span> <a class="code" href="namespacefirst.html">first</a>;</div><div class="line">   <span class="keywordtype">int</span> <a class="code" href="namespaceTGeant4Unit.html#aa18ae1c4d49745eafcc4767baf9397af">second</a>;</div><div class="line">   <span class="keywordtype">int</span> third;</div><div class="line">   <span class="keywordtype">int</span> fourth;</div><div class="line">   <span class="keywordtype">int</span> fifth;</div><div class="line">} clnt_HS_t;</div><div class="line"><span class="comment">// The body received after the first handshake&#39;s header</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div><div class="line">   <span class="keywordtype">int</span> msglen;</div><div class="line">   <span class="keywordtype">int</span> protover;</div><div class="line">   <span class="keywordtype">int</span> msgval;</div><div class="line">} srv_HS_t;</div><div class="line"></div><div class="line"><span class="comment">// By default we start a cluster on the local machine</span></div><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *refloc = <span class="stringliteral">&quot;proof://localhost:40000&quot;</span>;</div><div class="line"></div><div class="line"><a class="code" href="classTProof.html">TProof</a> *getProof(<span class="keyword">const</span> <span class="keywordtype">char</span> *url = <span class="stringliteral">&quot;proof://localhost:40000&quot;</span>, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nwrks = -1, <span class="keyword">const</span> <span class="keywordtype">char</span> *dir = 0,</div><div class="line">                 <span class="keyword">const</span> <span class="keywordtype">char</span> *opt = <span class="stringliteral">&quot;ask&quot;</span>, <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> dyn = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>, <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> tutords = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>)</div><div class="line">{</div><div class="line"></div><div class="line"></div><div class="line">   <a class="code" href="classTProof.html">TProof</a> *p = 0;</div><div class="line"></div><div class="line">   <span class="comment">// Valgrind options, if any</span></div><div class="line">   <a class="code" href="classTString.html">TString</a> vopt, vopts;</div><div class="line"><span class="preprocessor">#ifndef WIN32</span></div><div class="line">   <span class="keywordflow">if</span> (<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a4ae57a039e0d61296c386e89d6e4dce8">Getenv</a>(<span class="stringliteral">&quot;GETPROOF_VALGRIND&quot;</span>)) {</div><div class="line">      <a class="code" href="classTString.html">TString</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>(<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a4ae57a039e0d61296c386e89d6e4dce8">Getenv</a>(<span class="stringliteral">&quot;GETPROOF_VALGRIND&quot;</span>)), t;</div><div class="line">      <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> from = 0;</div><div class="line">      <span class="keywordflow">while</span> (<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>.Tokenize(t, from , <span class="stringliteral">&quot; &quot;</span>)) {</div><div class="line">         <span class="keywordflow">if</span> (t.BeginsWith(<span class="stringliteral">&quot;valgrind_opts:&quot;</span>))</div><div class="line">            vopts = t;</div><div class="line">         <span class="keywordflow">else</span></div><div class="line">            vopt = t;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">if</span> (vopts.<a class="code" href="classTString.html#a85b40d2d4ea6be7b6d3881145bb178b8">IsNull</a>()) vopts = <span class="stringliteral">&quot;valgrind_opts:--leak-check=full --track-origins=yes&quot;</span>;</div><div class="line">      <a class="code" href="classTProof.html#a60720f5f2c01cb830f5d749c6d5d5337">TProof::AddEnvVar</a>(<span class="stringliteral">&quot;PROOF_WRAPPERCMD&quot;</span>, vopts.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line">      <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: valgrind run: &#39;%s&#39; (opts: &#39;%s&#39;)&quot;</span>, vopt.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>(), vopts.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line">   }</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">   <span class="comment">// If an URL has specified get a session there</span></div><div class="line">   <a class="code" href="classTUrl.html">TUrl</a> uu(url), uref(refloc);</div><div class="line">   <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> ext = (strcmp(uu.GetHost(), uref.GetHost()) ||</div><div class="line">                 (uu.GetPort() != uref.GetPort())) ? <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a> : <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> lite = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line">   <span class="keywordflow">if</span> (ext &amp;&amp; url) {</div><div class="line">      <span class="keywordflow">if</span> (!strcmp(url, <span class="stringliteral">&quot;lite://&quot;</span>) || !url[0]) {</div><div class="line">         <span class="keywordflow">if</span> (!url[0]) uu.SetUrl(<span class="stringliteral">&quot;lite://&quot;</span>);</div><div class="line">         <span class="keywordflow">if</span> (dir &amp;&amp; strlen(dir) &gt; 0) <a class="code" href="TEnv_8h.html#a11202e6eff8457ae349087e34c0549c9">gEnv</a>-&gt;<a class="code" href="classTEnv.html#a9a475d58efbf47b9304783b0bb156461">SetValue</a>(<span class="stringliteral">&quot;Proof.Sandbox&quot;</span>, dir);</div><div class="line">         <a class="code" href="classTString.html">TString</a> swrk(<span class="stringliteral">&quot;&lt;default&gt; workers&quot;</span>);</div><div class="line">         <span class="keywordflow">if</span> (nwrks &gt; 0) {</div><div class="line">            uu.SetOptions(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;workers=%d&quot;</span>, nwrks));</div><div class="line">            swrk.Form(<span class="stringliteral">&quot;%d workers&quot;</span>, nwrks);</div><div class="line">         }</div><div class="line">         lite = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line">         <a class="code" href="TEnv_8h.html#a11202e6eff8457ae349087e34c0549c9">gEnv</a>-&gt;<a class="code" href="classTEnv.html#a9a475d58efbf47b9304783b0bb156461">SetValue</a>(<span class="stringliteral">&quot;Proof.MaxOldSessions&quot;</span>, 1);</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: trying to open a PROOF-Lite session with %s&quot;</span>, swrk.Data());</div><div class="line">      } <span class="keywordflow">else</span> {</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: trying to open a session on the external cluster at &#39;%s&#39;&quot;</span>, url);</div><div class="line">      }</div><div class="line">      p = <a class="code" href="classTProof.html#a504051c971e1034d3ee68bd0682313e4">TProof::Open</a>(uu.GetUrl(), vopt);</div><div class="line">      <span class="keywordflow">if</span> (p &amp;&amp; p-&gt;<a class="code" href="classTProof.html#a55a308eff1393ca99941054a9a548e03">IsValid</a>()) {</div><div class="line">         <span class="comment">// Check consistency</span></div><div class="line">         <span class="keywordflow">if</span> (ext &amp;&amp; !lite &amp;&amp; nwrks &gt; 0) {</div><div class="line">            <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: WARNING: started/attached a session on external cluster (%s):&quot;</span></div><div class="line">                   <span class="stringliteral">&quot; &#39;nwrks=%d&#39; ignored&quot;</span>, url, nwrks);</div><div class="line">         }</div><div class="line">         <span class="keywordflow">if</span> (ext &amp;&amp; !lite &amp;&amp; dir &amp;&amp; strlen(dir) &gt; 0) {</div><div class="line">            <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: WARNING: started/attached a session on external cluster (%s):&quot;</span></div><div class="line">                   <span class="stringliteral">&quot; &#39;dir=\&quot;%s\&quot;&#39; ignored&quot;</span>, url, dir);</div><div class="line">         }</div><div class="line">         <span class="keywordflow">if</span> (ext &amp;&amp; !strcmp(opt,<span class="stringliteral">&quot;force&quot;</span>)) {</div><div class="line">            <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: WARNING: started/attached a session on external cluster (%s):&quot;</span></div><div class="line">                   <span class="stringliteral">&quot; &#39;opt=\&quot;force\&quot;&#39; ignored&quot;</span>, url);</div><div class="line">         }</div><div class="line">         <span class="keywordflow">if</span> (ext &amp;&amp; dyn) {</div><div class="line">            <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: WARNING: started/attached a session on external cluster (%s):&quot;</span></div><div class="line">                   <span class="stringliteral">&quot; &#39;dyn=kTRUE&#39; ignored&quot;</span>, url);</div><div class="line">         }</div><div class="line">      } <span class="keywordflow">else</span> {</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: could not get/start a valid session at %s&quot;</span>, url);</div><div class="line">         <span class="keywordflow">if</span> (p) <span class="keyword">delete</span> p;</div><div class="line">         p = 0;</div><div class="line">      }</div><div class="line">      <span class="comment">// Done</span></div><div class="line">      <span class="keywordflow">return</span> p;</div><div class="line">   }</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef WIN32</span></div><div class="line">   <span class="comment">// No support for local PROOF on Win32 (yet; the optimized local Proof will work there too)</span></div><div class="line">   <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: local PROOF not yet supported on Windows, sorry!&quot;</span>);</div><div class="line">   <span class="keywordflow">return</span> p;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line"></div><div class="line">   <span class="comment">// Temp dir for tutorial daemons</span></div><div class="line">   <a class="code" href="classTString.html">TString</a> tutdir = dir;</div><div class="line">   <span class="keywordflow">if</span> (!tutdir.<a class="code" href="classTString.html#a85b40d2d4ea6be7b6d3881145bb178b8">IsNull</a>()) {</div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(tutdir)) {</div><div class="line">         <span class="comment">// Directory does not exist: try to make it</span></div><div class="line">         <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a5bd72c8b0e57e0aed8b418adf4650475">mkdir</a>(tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>(), <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>);</div><div class="line">         <span class="keywordflow">if</span> (<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(tutdir, <a class="code" href="TSystem_8h.html#a5ea512734402935ca6e68723f6398862a6bbfbcbc91e3111f9439d326d5520c22">kWritePermission</a>)) {</div><div class="line">            <span class="keywordflow">if</span> (<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(tutdir)) {</div><div class="line">               <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: unable to create the working area at the requested path: &#39;%s&#39;&quot;</span></div><div class="line">                      <span class="stringliteral">&quot; - cannot continue&quot;</span>, tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line">            } <span class="keywordflow">else</span> {</div><div class="line">               <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: working area at the requested path &#39;%s&#39;&quot;</span></div><div class="line">                      <span class="stringliteral">&quot; created but it is not writable - cannot continue&quot;</span>, tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line">            }</div><div class="line">            <span class="keywordflow">return</span> p;</div><div class="line">         }</div><div class="line">      } <span class="keywordflow">else</span> {</div><div class="line">         <span class="comment">// Check if it is writable ...</span></div><div class="line">         <span class="keywordflow">if</span> (<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(dir, <a class="code" href="TSystem_8h.html#a5ea512734402935ca6e68723f6398862a6bbfbcbc91e3111f9439d326d5520c22">kWritePermission</a>)) {</div><div class="line">            <span class="comment">// ... fail if not</span></div><div class="line">            <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: working area at the requested path &#39;%s&#39;&quot;</span></div><div class="line">                      <span class="stringliteral">&quot; exists but is not writable - cannot continue&quot;</span>, tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line">            <span class="keywordflow">return</span> p;</div><div class="line">         }</div><div class="line">      }</div><div class="line">   } <span class="keywordflow">else</span> {</div><div class="line">      <span class="comment">// Notify</span></div><div class="line">      <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: working area not specified temp &quot;</span>);</div><div class="line">      <span class="comment">// Force &quot;/tmp/&lt;user&gt;&quot; whenever possible to avoid length problems on MacOsX</span></div><div class="line">      tutdir=<span class="stringliteral">&quot;/tmp&quot;</span>;</div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(tutdir, <a class="code" href="TSystem_8h.html#a5ea512734402935ca6e68723f6398862a6bbfbcbc91e3111f9439d326d5520c22">kWritePermission</a>)) tutdir = <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#af7a7b489e21d45c75948e1cc58bdf73c">TempDirectory</a>();</div><div class="line">      <a class="code" href="classTString.html">TString</a> <a class="code" href="namespaceTGeant4Unit.html#a51e773a12804883ce6e6702e975a636b">us</a>;</div><div class="line">      <a class="code" href="structUserGroup__t.html">UserGroup_t</a> *ug = <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#af2028da5e7644a078cc7fb1160c1024c">GetUserInfo</a>(<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#adfcda8afc1264159bb4edff77199e475">GetUid</a>());</div><div class="line">      <span class="keywordflow">if</span> (!ug) {</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: could not get user info&quot;</span>);</div><div class="line">         <span class="keywordflow">return</span> p;</div><div class="line">      }</div><div class="line">      <a class="code" href="namespaceTGeant4Unit.html#a51e773a12804883ce6e6702e975a636b">us</a>.Form(<span class="stringliteral">&quot;/%s&quot;</span>, ug-&gt;<a class="code" href="structUserGroup__t.html#a88e91a97f4f89643973b41466774daf1">fUser</a>.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line">      <span class="keywordflow">if</span> (!tutdir.<a class="code" href="classTString.html#a2b2e907b9681d08cec32c853171c06a1">EndsWith</a>(<a class="code" href="namespaceTGeant4Unit.html#a51e773a12804883ce6e6702e975a636b">us</a>.Data())) tutdir += <a class="code" href="namespaceTGeant4Unit.html#a51e773a12804883ce6e6702e975a636b">us</a>;</div><div class="line">      <span class="comment">// Add our own subdir</span></div><div class="line">      tutdir += <span class="stringliteral">&quot;/.getproof&quot;</span>;</div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(tutdir)) {</div><div class="line">         <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a5bd72c8b0e57e0aed8b418adf4650475">mkdir</a>(tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>(), <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>);</div><div class="line">         <span class="keywordflow">if</span> (<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(tutdir, <a class="code" href="TSystem_8h.html#a5ea512734402935ca6e68723f6398862a6bbfbcbc91e3111f9439d326d5520c22">kWritePermission</a>)) {</div><div class="line">            <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: unable to get a writable working area (tried: %s)&quot;</span></div><div class="line">                  <span class="stringliteral">&quot; - cannot continue&quot;</span>, tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line">            <span class="keywordflow">return</span> p;</div><div class="line">         }</div><div class="line">      }</div><div class="line">   }</div><div class="line">   <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: working area (tutorial dir): %s&quot;</span>, tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line"></div><div class="line">   <span class="comment">// Dataset dir</span></div><div class="line">   <a class="code" href="classTString.html">TString</a> datasetdir;</div><div class="line">   <span class="keywordflow">if</span> (tutords) {</div><div class="line">      datasetdir = <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;%s/dataset&quot;</span>, tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(datasetdir, <a class="code" href="TSystem_8h.html#a5ea512734402935ca6e68723f6398862a6bbfbcbc91e3111f9439d326d5520c22">kWritePermission</a>)) {</div><div class="line">         <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a5bd72c8b0e57e0aed8b418adf4650475">mkdir</a>(datasetdir, <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>);</div><div class="line">         <span class="keywordflow">if</span> (<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(datasetdir, <a class="code" href="TSystem_8h.html#a5ea512734402935ca6e68723f6398862a6bbfbcbc91e3111f9439d326d5520c22">kWritePermission</a>)) {</div><div class="line">            <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: unable to get a writable dataset directory (tried: %s)&quot;</span></div><div class="line">                   <span class="stringliteral">&quot; - cannot continue&quot;</span>, datasetdir.Data());</div><div class="line">            <span class="keywordflow">return</span> p;</div><div class="line">         }</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: dataset dir: %s&quot;</span>, datasetdir.Data());</div><div class="line">      }</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// Local url (use a special port to try to not disturb running daemons)</span></div><div class="line">   <a class="code" href="classTUrl.html">TUrl</a> u(refloc);</div><div class="line">   u.SetProtocol(<span class="stringliteral">&quot;proof&quot;</span>);</div><div class="line">   <span class="keywordflow">if</span> (!strcmp(uu.GetHost(), uref.GetHost()) &amp;&amp; (uu.GetPort() != uref.GetPort()))</div><div class="line">      u.SetPort(uu.GetPort());</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> lportp = u.GetPort();</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> lportx = lportp + 1;</div><div class="line">   <a class="code" href="classTString.html">TString</a> lurl = u.GetUrl();</div><div class="line"></div><div class="line">   <span class="comment">// Prepare to start the daemon</span></div><div class="line">   <a class="code" href="classTString.html">TString</a> workarea = <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;%s/proof&quot;</span>, tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line">   <a class="code" href="classTString.html">TString</a> xpdcf(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;%s/xpd.cf&quot;</span>,tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>()));</div><div class="line">   <a class="code" href="classTString.html">TString</a> xpdlog(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;%s/xpd.log&quot;</span>,tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>()));</div><div class="line">   <a class="code" href="classTString.html">TString</a> xpdlogprt(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;%s/xpdtut/xpd.log&quot;</span>,tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>()));</div><div class="line">   <a class="code" href="classTString.html">TString</a> xpdpid(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;%s/xpd.pid&quot;</span>,tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>()));</div><div class="line">   <a class="code" href="classTString.html">TString</a> proofsessions(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;%s/sessions&quot;</span>,tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>()));</div><div class="line">   <a class="code" href="classTString.html">TString</a> cmd;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> rc = 0;</div><div class="line"></div><div class="line">   <span class="comment">// Is there something listening already ?</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> pid = -1;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> restart = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line">   <span class="keywordflow">if</span> ((rc = checkXproofdAt(lportp)) == 1) {</div><div class="line">      <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: something else the a XProofd service is running on&quot;</span></div><div class="line">             <span class="stringliteral">&quot; port %d - cannot continue&quot;</span>, lportp);</div><div class="line">      <span class="keywordflow">return</span> p;</div><div class="line"></div><div class="line">   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == 0) {</div><div class="line"></div><div class="line">      restart = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"></div><div class="line">      pid = getXrootdPid(lportx);</div><div class="line">      <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: daemon found listening on dedicated ports {%d,%d} (pid: %d)&quot;</span>,</div><div class="line">              lportx, lportp, pid);</div><div class="line">      <span class="keywordflow">if</span> (isatty(0) == 0 || isatty(1) == 0) {</div><div class="line">         <span class="comment">// Cannot ask: always restart</span></div><div class="line">         restart = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line">      } <span class="keywordflow">else</span> {</div><div class="line">         <span class="keywordflow">if</span> (!strcmp(opt,<span class="stringliteral">&quot;ask&quot;</span>)) {</div><div class="line">            <span class="keywordtype">char</span> *answer = (<span class="keywordtype">char</span> *) Getline(<span class="stringliteral">&quot;getProof: would you like to restart it (N,Y)? [N] &quot;</span>);</div><div class="line">            <span class="keywordflow">if</span> (answer &amp;&amp; (answer[0] == <span class="charliteral">&#39;Y&#39;</span> || answer[0] == <span class="charliteral">&#39;y&#39;</span>))</div><div class="line">               restart = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line">         }</div><div class="line">      }</div><div class="line">      <span class="keywordflow">if</span> (!strcmp(opt,<span class="stringliteral">&quot;force&quot;</span>))</div><div class="line">         <span class="comment">// Always restart</span></div><div class="line">         restart = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line"></div><div class="line">      <span class="comment">// Cleanup, if required</span></div><div class="line">      <span class="keywordflow">if</span> (restart) {</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: cleaning existing instance ...&quot;</span>);</div><div class="line">         <span class="comment">// Cleaning up existing daemon</span></div><div class="line">         cmd = <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;kill -9 %d&quot;</span>, pid);</div><div class="line">         <span class="keywordflow">if</span> ((rc = <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a63e6caab0ecc66f251061d879243a868">Exec</a>(cmd)) != 0)</div><div class="line">            <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: problems stopping xrootd process %d (%d)&quot;</span>, pid, rc);</div><div class="line">         <span class="comment">// Wait for all previous connections being cleaned</span></div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: wait 5 secs so that previous connections are cleaned ...&quot;</span>);</div><div class="line">         <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#ac0e054dbdb09a0e2d31289db9751d72f">Sleep</a>(5000);</div><div class="line">      }</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (restart) {</div><div class="line"></div><div class="line">      <span class="comment">// Try to start something locally; make sure that everything is there</span></div><div class="line">      <span class="keywordtype">char</span> *xpd = <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#ac6c754bc2ea46cf01473c6b3439200f4">Which</a>(<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a4ae57a039e0d61296c386e89d6e4dce8">Getenv</a>(<span class="stringliteral">&quot;PATH&quot;</span>), <span class="stringliteral">&quot;xproofd&quot;</span>, <a class="code" href="TSystem_8h.html#a5ea512734402935ca6e68723f6398862a4e0f29e362565d37458b75699a46e53f">kExecutePermission</a>);</div><div class="line">      <span class="keywordflow">if</span> (!xpd) {</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: xproofd not found: please check the environment!&quot;</span>);</div><div class="line">         <span class="keywordflow">return</span> p;</div><div class="line">      }</div><div class="line"></div><div class="line">      <span class="comment">// Cleanup the working area</span></div><div class="line">      cmd = <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;rm -fr %s/xpdtut %s %s %s %s&quot;</span>, tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>(), workarea.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>(),</div><div class="line">                                                 xpdcf.Data(), xpdpid.Data(), proofsessions.Data());</div><div class="line">      <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a63e6caab0ecc66f251061d879243a868">Exec</a>(cmd);</div><div class="line"></div><div class="line">      <span class="comment">// Try to start something locally; create the xproofd config file</span></div><div class="line">      FILE *fcf = fopen(xpdcf.Data(), <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line">      <span class="keywordflow">if</span> (!fcf) {</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: could not create config file for XPD (%s)&quot;</span>, xpdcf.Data());</div><div class="line">         <span class="keywordflow">return</span> p;</div><div class="line">      }</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;### Use admin path at %s/admin to avoid interferences with other users\n&quot;</span>, tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;xrd.adminpath %s/admin\n&quot;</span>, tutdir.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line"><span class="preprocessor">#if defined(R__MACOSX)</span></div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;### Use dedicated socket path under /tmp to avoid length problems\n&quot;</span>);</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;xpd.sockpathdir /tmp/xpd-sock\n&quot;</span>);</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;### Load the XrdProofd protocol on port %d\n&quot;</span>, lportp);</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;xrd.protocol xproofd libXrdProofd.so\n&quot;</span>);</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;xpd.port %d\n&quot;</span>, lportp);</div><div class="line">      <span class="keywordflow">if</span> (nwrks &gt; 0) {</div><div class="line">         fprintf(fcf,<span class="stringliteral">&quot;### Force number of local workers\n&quot;</span>);</div><div class="line">         fprintf(fcf,<span class="stringliteral">&quot;xpd.localwrks %d\n&quot;</span>, nwrks);</div><div class="line">      }</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;### Root path for working dir\n&quot;</span>);</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;xpd.workdir %s\n&quot;</span>, workarea.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;### Allow different users to connect\n&quot;</span>);</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;xpd.multiuser 1\n&quot;</span>);</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;### Limit the number of query results kept in the master sandbox\n&quot;</span>);</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;xpd.putrc ProofServ.UserQuotas: maxquerykept=2\n&quot;</span>);</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;### Limit the number of sessions kept in the sandbox\n&quot;</span>);</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;xpd.putrc Proof.MaxOldSessions: 1\n&quot;</span>);</div><div class="line">      <span class="keywordflow">if</span> (tutords) {</div><div class="line">         fprintf(fcf,<span class="stringliteral">&quot;### Use dataset directory under the tutorial dir\n&quot;</span>);</div><div class="line">         fprintf(fcf,<span class="stringliteral">&quot;xpd.datasetsrc file url:%s opt:-Cq:Av:As:\n&quot;</span>, datasetdir.Data());</div><div class="line">      }</div><div class="line">      <span class="keywordflow">if</span> (dyn) {</div><div class="line">         fprintf(fcf,<span class="stringliteral">&quot;### Use dynamic, per-job scheduling\n&quot;</span>);</div><div class="line">         fprintf(fcf,<span class="stringliteral">&quot;xpd.putrc Proof.DynamicStartup 1\n&quot;</span>);</div><div class="line">      }</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;### For internal file serving use the xrootd protocol on the same port\n&quot;</span>);</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;xpd.xrootd libXrdXrootd-4.so\n&quot;</span>);</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;### Set the local data server for the temporary output files accordingly\n&quot;</span>);</div><div class="line">      fprintf(fcf,<span class="stringliteral">&quot;xpd.putenv LOCALDATASERVER=root://%s:%d\n&quot;</span>, <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#aab4a8ac24bc42a135aa6584be2cb415c">HostName</a>(), lportp);</div><div class="line">      fclose(fcf);</div><div class="line">      <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: xproofd config file at %s&quot;</span>, xpdcf.Data());</div><div class="line"></div><div class="line">      <span class="comment">// Start xrootd in the background</span></div><div class="line">      <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: xproofd log file at %s&quot;</span>, xpdlogprt.Data());</div><div class="line">      cmd = <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;%s -c %s -b -l %s -n xpdtut -p %d&quot;</span>,</div><div class="line">               xpd, xpdcf.Data(), xpdlog.Data(), lportp);</div><div class="line">      <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;(NB: any error line from XrdClientSock::RecvRaw and XrdClientMessage::ReadRaw should be ignored)&quot;</span>);</div><div class="line">      <span class="keywordflow">if</span> ((rc = <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a63e6caab0ecc66f251061d879243a868">Exec</a>(cmd)) != 0) {</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: problems starting xproofd (%d)&quot;</span>, rc);</div><div class="line">         <span class="keywordflow">return</span> p;</div><div class="line">      }</div><div class="line">      <span class="keyword">delete</span>[] xpd;</div><div class="line"></div><div class="line">      <span class="comment">// Wait a bit</span></div><div class="line">      <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: waiting for xproofd to start ...&quot;</span>);</div><div class="line">      <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#ac0e054dbdb09a0e2d31289db9751d72f">Sleep</a>(2000);</div><div class="line"></div><div class="line">      pid = getXrootdPid(lportp);</div><div class="line">      <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: xproofd pid: %d&quot;</span>, pid);</div><div class="line"></div><div class="line">      <span class="comment">// Save it in the PID file</span></div><div class="line">      FILE *fpid = fopen(xpdpid.Data(), <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line">      <span class="keywordflow">if</span> (!fpid) {</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: could not create pid file for XPD&quot;</span>);</div><div class="line">      } <span class="keywordflow">else</span> {</div><div class="line">         fprintf(fpid,<span class="stringliteral">&quot;%d\n&quot;</span>, pid);</div><div class="line">         fclose(fpid);</div><div class="line">      }</div><div class="line">   }</div><div class="line">   <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: start / attach the PROOF session ...&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Start / attach the session now</span></div><div class="line">   p = <a class="code" href="classTProof.html#a504051c971e1034d3ee68bd0682313e4">TProof::Open</a>(lurl, vopt.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line">   <span class="keywordflow">if</span> (!p || !(p-&gt;<a class="code" href="classTProof.html#a55a308eff1393ca99941054a9a548e03">IsValid</a>())) {</div><div class="line">      <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getProof: starting local session failed&quot;</span>);</div><div class="line">      <span class="keywordflow">if</span> (p) <span class="keyword">delete</span> p;</div><div class="line">      p = 0;</div><div class="line">      <span class="keywordflow">return</span> p;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// Return the session</span></div><div class="line">   <span class="keywordflow">return</span> p;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> getXrootdPid(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> port, <span class="keyword">const</span> <span class="keywordtype">char</span> *subdir)</div><div class="line">{</div><div class="line"><span class="preprocessor">#ifdef WIN32</span></div><div class="line">   <span class="comment">// No support for Xrootd/Proof on Win32 (yet; the optimized local Proof will work there too)</span></div><div class="line">   <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;getXrootdPid: Xrootd/Proof not supported on Windows, sorry!&quot;</span>);</div><div class="line">   <span class="keywordflow">return</span> -1;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line">   <span class="comment">// Get the pid of the started xrootd process</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> pid = -1;</div><div class="line"><span class="preprocessor">#if defined(__sun)</span></div><div class="line">   <span class="keyword">const</span> <span class="keywordtype">char</span> *com = <span class="stringliteral">&quot;-eo pid,comm&quot;</span>;</div><div class="line"><span class="preprocessor">#elif defined(__FreeBSD__) || defined(__OpenBSD__) || defined(__APPLE__)</span></div><div class="line">   <span class="keyword">const</span> <span class="keywordtype">char</span> *com = <span class="stringliteral">&quot;ax -w -w&quot;</span>;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line">   <span class="keyword">const</span> <span class="keywordtype">char</span> *com = <span class="stringliteral">&quot;-w -w -eo pid,command&quot;</span>;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">   <a class="code" href="classTString.html">TString</a> cmd;</div><div class="line">   <span class="keywordflow">if</span> (subdir &amp;&amp; strlen(subdir) &gt; 0) {</div><div class="line">      cmd.<a class="code" href="classTString.html#aeb44d6183d8b1f1b7090dbd3c93f5e39">Form</a>(<span class="stringliteral">&quot;ps %s | grep xrootd | grep \&quot;\\-p %d\&quot; | grep %s&quot;</span>, com, port, subdir);</div><div class="line">   } <span class="keywordflow">else</span> {</div><div class="line">      cmd.<a class="code" href="classTString.html#aeb44d6183d8b1f1b7090dbd3c93f5e39">Form</a>(<span class="stringliteral">&quot;ps %s | grep xrootd | grep \&quot;\\-p %d\&quot;&quot;</span>, com, port);</div><div class="line">   }</div><div class="line">   FILE *fp = <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a8080245164a7e09587f1d61939482da9">OpenPipe</a>(cmd.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>(), <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line">   <span class="keywordflow">if</span> (fp) {</div><div class="line">      <span class="keywordtype">char</span> <a class="code" href="entrylistblock__figure1_8C.html#a4fa05b1f00fcde100685cc887554b93b">line</a>[2048], rest[2048];</div><div class="line">      <span class="keywordflow">while</span> (fgets(<a class="code" href="entrylistblock__figure1_8C.html#a4fa05b1f00fcde100685cc887554b93b">line</a>, <span class="keyword">sizeof</span>(<a class="code" href="entrylistblock__figure1_8C.html#a4fa05b1f00fcde100685cc887554b93b">line</a>), fp)) {</div><div class="line">         sscanf(<a class="code" href="entrylistblock__figure1_8C.html#a4fa05b1f00fcde100685cc887554b93b">line</a>,<span class="stringliteral">&quot;%d %s&quot;</span>, &amp;pid, rest);</div><div class="line">         <span class="keywordflow">break</span>;</div><div class="line">      }</div><div class="line">      <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a98287c9829d986cbc531730223b58e72">ClosePipe</a>(fp);</div><div class="line">   }</div><div class="line">   <span class="comment">// Done</span></div><div class="line">   <span class="keywordflow">return</span> pid;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> checkXrootdAt(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> port, <span class="keyword">const</span> <span class="keywordtype">char</span> *host)</div><div class="line">{</div><div class="line">   <span class="comment">// Check if a XrdXrootd service is running on &#39;port&#39; at &#39;host&#39;</span></div><div class="line">   <span class="comment">// Return</span></div><div class="line">   <span class="comment">//        0 if OK</span></div><div class="line">   <span class="comment">//       -1 if nothing is listening on the port (connection cannot be open)</span></div><div class="line">   <span class="comment">//        1 if something is listening but not XROOTD</span></div><div class="line"></div><div class="line">   <span class="comment">// Open the connection</span></div><div class="line">   <a class="code" href="classTSocket.html">TSocket</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>(host, port);</div><div class="line">   <span class="keywordflow">if</span> (!(<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>.IsValid())) {</div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#ad611664b9a0b9de80e76e795779839be">gDebug</a> &gt; 0)</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;checkXrootdAt: could not open connection to %s:%d&quot;</span>, host, port);</div><div class="line">      <span class="keywordflow">return</span> -1;</div><div class="line">   }</div><div class="line">   <span class="comment">// Send the first bytes</span></div><div class="line">   clnt_HS_t initHS;</div><div class="line">   memset(&amp;initHS, 0, <span class="keyword">sizeof</span>(initHS));</div><div class="line">   initHS.fourth = <a class="code" href="Bytes_8h.html#a2d498541eb3ee8349f8065944dd3a671">host2net</a>((<span class="keywordtype">int</span>)4);</div><div class="line">   initHS.fifth  = <a class="code" href="Bytes_8h.html#a2d498541eb3ee8349f8065944dd3a671">host2net</a>((<span class="keywordtype">int</span>)2012);</div><div class="line">   <span class="keywordtype">int</span> len = <span class="keyword">sizeof</span>(initHS);</div><div class="line">   <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>.SendRaw(&amp;initHS, len);</div><div class="line">   <span class="comment">// Read first server response</span></div><div class="line">   <span class="keywordtype">int</span> <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>;</div><div class="line">   len = <span class="keyword">sizeof</span>(<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>);</div><div class="line">   <span class="keywordtype">int</span> readCount = <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>.RecvRaw(&amp;<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>, len); <span class="comment">// 4(2+2) bytes</span></div><div class="line">   <span class="keywordflow">if</span> (readCount != len) {</div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#ad611664b9a0b9de80e76e795779839be">gDebug</a> &gt; 0)</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;checkXrootdAt: 1st: wrong number of bytes read: %d (expected: %d)&quot;</span>,</div><div class="line">                                readCount, len);</div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">   }</div><div class="line">   <span class="comment">// to host byte order</span></div><div class="line">   <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> = <a class="code" href="Bytes_8h.html#abe42555e08b9d7157f743e2043039fb2">net2host</a>(<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>);</div><div class="line">   <span class="comment">// Check if the server is the eXtended proofd</span></div><div class="line">   <span class="keywordflow">if</span> (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 0) {</div><div class="line">      srv_HS_t xbody;</div><div class="line">      len = <span class="keyword">sizeof</span>(xbody);</div><div class="line">      readCount = <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>.RecvRaw(&amp;xbody, len); <span class="comment">// 12(4+4+4) bytes</span></div><div class="line">      <span class="keywordflow">if</span> (readCount != len) {</div><div class="line">         <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#ad611664b9a0b9de80e76e795779839be">gDebug</a> &gt; 0)</div><div class="line">            <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;checkXrootdAt: 2nd: wrong number of bytes read: %d (expected: %d)&quot;</span>,</div><div class="line">                                   readCount, len);</div><div class="line">         <span class="keywordflow">return</span> 1;</div><div class="line">      }</div><div class="line"></div><div class="line">   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 8) {</div><div class="line">      <span class="comment">// Standard proofd</span></div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#ad611664b9a0b9de80e76e795779839be">gDebug</a> &gt; 0)</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;checkXrootdAt: server is ROOTD&quot;</span>);</div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">   } <span class="keywordflow">else</span> {</div><div class="line">      <span class="comment">// We don&#39;t know the server type</span></div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#ad611664b9a0b9de80e76e795779839be">gDebug</a> &gt; 0)</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;checkXrootdAt: unknown server type: %d&quot;</span>, <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>);</div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">   }</div><div class="line">   <span class="comment">// Done</span></div><div class="line">   <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> checkXproofdAt(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> port, <span class="keyword">const</span> <span class="keywordtype">char</span> *host)</div><div class="line">{</div><div class="line">   <span class="comment">// Check if a XrdProofd service is running on &#39;port&#39; at &#39;host&#39;</span></div><div class="line">   <span class="comment">// Return</span></div><div class="line">   <span class="comment">//        0 if OK</span></div><div class="line">   <span class="comment">//       -1 if nothing is listening on the port (connection cannot be open)</span></div><div class="line">   <span class="comment">//        1 if something is listening but not XPROOFD</span></div><div class="line"></div><div class="line">   <span class="comment">// Open the connection</span></div><div class="line">   <a class="code" href="classTSocket.html">TSocket</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>(host, port);</div><div class="line">   <span class="keywordflow">if</span> (!(<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>.IsValid())) {</div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#ad611664b9a0b9de80e76e795779839be">gDebug</a> &gt; 0)</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;checkXproofdAt: could not open connection to %s:%d&quot;</span>, host, port);</div><div class="line">      <span class="keywordflow">return</span> -1;</div><div class="line">   }</div><div class="line">   <span class="comment">// Send the first bytes</span></div><div class="line">   clnt_HS_t initHS;</div><div class="line">   memset(&amp;initHS, 0, <span class="keyword">sizeof</span>(initHS));</div><div class="line">   initHS.third  = (int)<a class="code" href="Bytes_8h.html#a2d498541eb3ee8349f8065944dd3a671">host2net</a>((<span class="keywordtype">int</span>)1);</div><div class="line">   <span class="keywordtype">int</span> len = <span class="keyword">sizeof</span>(initHS);</div><div class="line">   <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>.SendRaw(&amp;initHS, len);</div><div class="line">   <span class="comment">// These 8 bytes are need by &#39;proofd&#39; and discarded by XPD</span></div><div class="line">   <span class="keywordtype">int</span> dum[2];</div><div class="line">   dum[0] = (int)<a class="code" href="Bytes_8h.html#a2d498541eb3ee8349f8065944dd3a671">host2net</a>((<span class="keywordtype">int</span>)4);</div><div class="line">   dum[1] = (int)<a class="code" href="Bytes_8h.html#a2d498541eb3ee8349f8065944dd3a671">host2net</a>((<span class="keywordtype">int</span>)2012);</div><div class="line">   <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>.SendRaw(&amp;dum[0], <span class="keyword">sizeof</span>(dum));</div><div class="line">   <span class="comment">// Read first server response</span></div><div class="line">   <span class="keywordtype">int</span> <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>;</div><div class="line">   len = <span class="keyword">sizeof</span>(<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>);</div><div class="line">   <span class="keywordtype">int</span> readCount = <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>.RecvRaw(&amp;<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>, len); <span class="comment">// 4(2+2) bytes</span></div><div class="line">   <span class="keywordflow">if</span> (readCount != len) {</div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#ad611664b9a0b9de80e76e795779839be">gDebug</a> &gt; 0)</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;checkXproofdAt: 1st: wrong number of bytes read: %d (expected: %d)&quot;</span>,</div><div class="line">                                 readCount, len);</div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">   }</div><div class="line">   <span class="comment">// to host byte order</span></div><div class="line">   <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> = <a class="code" href="Bytes_8h.html#abe42555e08b9d7157f743e2043039fb2">net2host</a>(<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>);</div><div class="line">   <span class="comment">// Check if the server is the eXtended proofd</span></div><div class="line">   <span class="keywordflow">if</span> (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 0) {</div><div class="line">      srv_HS_t xbody;</div><div class="line">      len = <span class="keyword">sizeof</span>(xbody);</div><div class="line">      readCount = <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>.RecvRaw(&amp;xbody, len); <span class="comment">// 12(4+4+4) bytes</span></div><div class="line">      <span class="keywordflow">if</span> (readCount != len) {</div><div class="line">         <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#ad611664b9a0b9de80e76e795779839be">gDebug</a> &gt; 0)</div><div class="line">            <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;checkXproofdAt: 2nd: wrong number of bytes read: %d (expected: %d)&quot;</span>,</div><div class="line">                                    readCount, len);</div><div class="line">         <span class="keywordflow">return</span> 1;</div><div class="line">      }</div><div class="line">      xbody.protover = <a class="code" href="Bytes_8h.html#abe42555e08b9d7157f743e2043039fb2">net2host</a>(xbody.protover);</div><div class="line">      xbody.msgval = <a class="code" href="Bytes_8h.html#abe42555e08b9d7157f743e2043039fb2">net2host</a>(xbody.msglen);</div><div class="line">      xbody.msglen = <a class="code" href="Bytes_8h.html#abe42555e08b9d7157f743e2043039fb2">net2host</a>(xbody.msgval);</div><div class="line"></div><div class="line">   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a> == 8) {</div><div class="line">      <span class="comment">// Standard proofd</span></div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#ad611664b9a0b9de80e76e795779839be">gDebug</a> &gt; 0)</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;checkXproofdAt: server is PROOFD&quot;</span>);</div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">   } <span class="keywordflow">else</span> {</div><div class="line">      <span class="comment">// We don&#39;t know the server type</span></div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#ad611664b9a0b9de80e76e795779839be">gDebug</a> &gt; 0)</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;checkXproofdAt: unknown server type: %d&quot;</span>, <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>);</div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">   }</div><div class="line">   <span class="comment">// Done</span></div><div class="line">   <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> startXrootdAt(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> port, <span class="keyword">const</span> <span class="keywordtype">char</span> *exportdirs, <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> force)</div><div class="line">{</div><div class="line">   <span class="comment">// Start a basic xrootd service on &#39;port&#39; exporting the dirs in &#39;exportdirs&#39;</span></div><div class="line">   <span class="comment">// (blank separated list)</span></div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef WIN32</span></div><div class="line">   <span class="comment">// No support for Xrootd on Win32 (yet; the optimized local Proof will work there too)</span></div><div class="line">   <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;startXrootdAt: Xrootd not supported on Windows, sorry!&quot;</span>);</div><div class="line">   <span class="keywordflow">return</span> -1;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> restart = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line"></div><div class="line">   <span class="comment">// Already there?</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> rc = 0;</div><div class="line">   <span class="keywordflow">if</span> ((rc = checkXrootdAt(port)) == 1) {</div><div class="line"></div><div class="line">      <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;startXrootdAt: some other service running on port %d - cannot proceed &quot;</span>, port);</div><div class="line">      <span class="keywordflow">return</span> -1;</div><div class="line"></div><div class="line">   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == 0) {</div><div class="line"></div><div class="line">      restart = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> (force) {</div><div class="line">         <span class="comment">// Always restart</span></div><div class="line">         restart = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line">      } <span class="keywordflow">else</span> {</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;startXrootdAt: xrootd service already available on port %d: &quot;</span>, port);</div><div class="line">         <span class="keywordtype">char</span> *answer = (<span class="keywordtype">char</span> *) Getline(<span class="stringliteral">&quot;startXrootdAt: would you like to restart it (N,Y)? [N] &quot;</span>);</div><div class="line">         <span class="keywordflow">if</span> (answer &amp;&amp; (answer[0] == <span class="charliteral">&#39;Y&#39;</span> || answer[0] == <span class="charliteral">&#39;y&#39;</span>)) {</div><div class="line">            restart = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line">         }</div><div class="line">      }</div><div class="line"></div><div class="line">      <span class="comment">// Cleanup, if required</span></div><div class="line">      <span class="keywordflow">if</span> (restart) {</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;startXrootdAt: cleaning existing instance ...&quot;</span>);</div><div class="line"></div><div class="line">         <span class="comment">// Get the Pid</span></div><div class="line">         <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> pid = getXrootdPid(port, <span class="stringliteral">&quot;xrd-basic&quot;</span>);</div><div class="line"></div><div class="line">         <span class="comment">// Cleanimg up existing daemon</span></div><div class="line">         <a class="code" href="classTString.html">TString</a> cmd = <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;kill -9 %d&quot;</span>, pid);</div><div class="line">         <span class="keywordflow">if</span> ((rc = <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a63e6caab0ecc66f251061d879243a868">Exec</a>(cmd)) != 0)</div><div class="line">            <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;startXrootdAt: problems stopping xrootd process %d (%d)&quot;</span>, pid, rc);</div><div class="line">      }</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (restart) {</div><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(<span class="stringliteral">&quot;/tmp/xrd-basic&quot;</span>)) {</div><div class="line">         <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a5bd72c8b0e57e0aed8b418adf4650475">mkdir</a>(<span class="stringliteral">&quot;/tmp/xrd-basic&quot;</span>);</div><div class="line">         <span class="keywordflow">if</span> (<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(<span class="stringliteral">&quot;/tmp/xrd-basic&quot;</span>)) {</div><div class="line">            <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;startXrootdAt: could not assert dir for log file&quot;</span>);</div><div class="line">            <span class="keywordflow">return</span> -1;</div><div class="line">         }</div><div class="line">      }</div><div class="line">      <a class="code" href="classTString.html">TString</a> cmd;</div><div class="line">      cmd.<a class="code" href="classTString.html#aeb44d6183d8b1f1b7090dbd3c93f5e39">Form</a>(<span class="stringliteral">&quot;xrootd -d -p %d -b -l /tmp/xrd-basic/xrootd.log&quot;</span>, port);</div><div class="line">      <span class="keywordflow">if</span> (exportdirs &amp;&amp; strlen(exportdirs) &gt; 0) {</div><div class="line">         <a class="code" href="classTString.html">TString</a> dirs(exportdirs), <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>;</div><div class="line">         <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> from = 0;</div><div class="line">         <span class="keywordflow">while</span> (dirs.Tokenize(<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>, from, <span class="stringliteral">&quot; &quot;</span>)) {</div><div class="line">            <span class="keywordflow">if</span> (!<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>.IsNull()) {</div><div class="line">               cmd += <span class="stringliteral">&quot; &quot;</span>;</div><div class="line">               cmd += <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>;</div><div class="line">            }</div><div class="line">         }</div><div class="line">      }</div><div class="line">      <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;cmd: %s&quot;</span>, cmd.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line">      <span class="keywordflow">if</span> ((rc = <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a63e6caab0ecc66f251061d879243a868">Exec</a>(cmd)) != 0) {</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;startXrootdAt: problems executing starting command (%d)&quot;</span>, rc);</div><div class="line">         <span class="keywordflow">return</span> -1;</div><div class="line">      }</div><div class="line">      <span class="comment">// Wait a bit</span></div><div class="line">      <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;startXrootdAt: waiting for xrootd to start ...&quot;</span>);</div><div class="line">      <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#ac0e054dbdb09a0e2d31289db9751d72f">Sleep</a>(2000);</div><div class="line">      <span class="comment">// Check the result</span></div><div class="line">      <span class="keywordflow">if</span> ((rc = checkXrootdAt(port)) != 0) {</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;startXrootdAt: xrootd service not available at %d (rc = %d) - startup failed&quot;</span>,</div><div class="line">                                port, rc);</div><div class="line">         <span class="keywordflow">return</span> -1;</div><div class="line">      }</div><div class="line">      <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;startXrootdAt: basic xrootd started!&quot;</span>);</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// Done</span></div><div class="line">   <span class="keywordflow">return</span> 0;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> killXrootdAt(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> port, <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span>)</div><div class="line">{</div><div class="line">   <span class="comment">// Kill running xrootd service on &#39;port&#39;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef WIN32</span></div><div class="line">   <span class="comment">// No support for Xrootd on Win32 (yet; the optimized local Proof will work there too)</span></div><div class="line">   <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;killXrootdAt: Xrootd not supported on Windows, sorry!&quot;</span>);</div><div class="line">   <span class="keywordflow">return</span> -1;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line"></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> pid = -1, rc= 0;</div><div class="line">   <span class="keywordflow">if</span> ((pid = getXrootdPid(port, <span class="keywordtype">id</span>)) &gt; 0) {</div><div class="line"></div><div class="line">      <span class="comment">// Cleanimg up existing daemon</span></div><div class="line">      <a class="code" href="classTString.html">TString</a> cmd = <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;kill -9 %d&quot;</span>, pid);</div><div class="line">      <span class="keywordflow">if</span> ((rc = <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a63e6caab0ecc66f251061d879243a868">Exec</a>(cmd)) != 0)</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;killXrootdAt: problems stopping xrootd process %d (%d)&quot;</span>, pid, rc);</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// Done</span></div><div class="line">   <span class="keywordflow">return</span> rc;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> getDebugEnum(<span class="keyword">const</span> <span class="keywordtype">char</span> *what)</div><div class="line">{</div><div class="line">   <span class="comment">// Check if &#39;what&#39; matches one of the TProofDebug enum and return the corresponding</span></div><div class="line">   <span class="comment">// integer. Relies on a perfect synchronization with the content of TProofDebug.h .</span></div><div class="line"></div><div class="line">   <a class="code" href="classTString.html">TString</a> sws(what), sw;</div><div class="line">   <span class="keywordtype">int</span> rcmask = 0;</div><div class="line">   <span class="keywordtype">int</span> from = 0;</div><div class="line">   <span class="keywordflow">while</span> (sws.Tokenize(sw, from , <span class="stringliteral">&quot;|&quot;</span>)) {</div><div class="line">      <span class="keywordflow">if</span> (sw.<a class="code" href="classTString.html#a6d92a45f8b4c0c4d2ed7f318a2cb6f95">BeginsWith</a>(<span class="stringliteral">&quot;k&quot;</span>)) sw.<a class="code" href="classTString.html#ab13a8694c4221435f86b85ae452ed376">Remove</a>(0,1);</div><div class="line"></div><div class="line">      <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;None&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939a0f6c83aa78f049ea7c9e77c75afa5f5a">TProofDebug::kNone</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Packetizer&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939acbfbc3ec63d4d87a47b2be3c29ed9510">TProofDebug::kPacketizer</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Loop&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939a20e0d6bb682db3e5f1a0ebde2bca86c2">TProofDebug::kLoop</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Selector&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939a868990fd92351271b1cc838aabf2aaf2">TProofDebug::kSelector</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Output&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939ae7f2a4823339c8bb781eb2034346c43b">TProofDebug::kOutput</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Input&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939a2a5d027178529f1176c6affff32aba12">TProofDebug::kInput</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Global&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939a76829d5234973a6c36a61d060d561a09">TProofDebug::kGlobal</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Package&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939a0bd95fdfa65484988d3334d682a842f7">TProofDebug::kPackage</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Feedback&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939a86c673ff170efa6f5325d3117f421bc4">TProofDebug::kFeedback</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Condor&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939ad8ed583ab075dd458448d3cb71512046">TProofDebug::kCondor</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Draw&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939ab163389b13c57cfbf55e5bb31a5b544d">TProofDebug::kDraw</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Asyn&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939a5879f64be7a4a4fe44faf4d1c72075ee">TProofDebug::kAsyn</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Cache&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939a7584e02363b640e65cd8f4b9ae453f8e">TProofDebug::kCache</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Collect&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939a19e5639467648be64894d214a28bedac">TProofDebug::kCollect</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Dataset&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939a3fda60a0fb2dc81eb11789989ac31afd">TProofDebug::kDataset</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Submerger&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939abd8a4f172af93da916b6e986d96ead91">TProofDebug::kSubmerger</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;Monitoring&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939a8747e1da70dde54b507278d1600e7f15">TProofDebug::kMonitoring</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sw == <span class="stringliteral">&quot;All&quot;</span>) {</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939afd0dcc7f15c775468993d5dae3a66ea0">TProofDebug::kAll</a>;</div><div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!sw.<a class="code" href="classTString.html#a85b40d2d4ea6be7b6d3881145bb178b8">IsNull</a>()) {</div><div class="line">         <a class="code" href="TString_8h.html#a9f6318c6fe972e019d46777b7026dce2">Printf</a>(<span class="stringliteral">&quot;WARNING: requested debug enum name &#39;%s&#39; does not exist: assuming &#39;All&#39;&quot;</span>, sw.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>());</div><div class="line">         rcmask |= <a class="code" href="classTProofDebug.html#a71a38a507d22cb80172c1f59efab7939afd0dcc7f15c775468993d5dae3a66ea0">TProofDebug::kAll</a>;</div><div class="line">      }</div><div class="line">   }</div><div class="line">   <span class="comment">// Done</span></div><div class="line">   <span class="keywordflow">return</span> rcmask;</div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>Gerardo Ganis </dd></dl>

<p class="definition">Definition in file <a class="el" href="getProof_8C_source.html">getProof.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:20 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

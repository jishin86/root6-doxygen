<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/fit/multidimfit.C Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_6012cc17ed1f4568bbcf0a0e185e84c7.html">fit</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">multidimfit.C</div>  </div>
</div><!--header-->
<div class="contents">
<a href="multidimfit_8C.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/// \file</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">/// \ingroup tutorial_fit</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span><span class="comment">/// \notebook -nodraw</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span><span class="comment">/// Multi-Dimensional Parametrisation and Fitting</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span><span class="comment">/// \macro_output</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span><span class="comment">/// \macro_code</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span><span class="comment">/// \authors Rene Brun, Christian Holm Christensen</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Riostream_8h.html">Riostream.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TROOT_8h.html">TROOT.h</a>&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TApplication_8h.html">TApplication.h</a>&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TH1_8h.html">TH1.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TSystem_8h.html">TSystem.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TBrowser_8h.html">TBrowser.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TFile_8h.html">TFile.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TRandom_8h.html">TRandom.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TMultiDimFit_8h.html">TMultiDimFit.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TVectorD_8h.html">TVectorD.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TMath_8h.html">TMath.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//____________________________________________________________________</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keywordtype">void</span> makeData(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>* <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>&amp; <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>&amp; <a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>)</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="comment">// Make data points</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> upp[5] = { 10, 10, 10, 10,  1 };</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> low[5] = {  0,  0,  0,  0, .1 };</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i] = (upp[i] - low[i]) * <a class="code" href="TRandom_8h.html#a9ee275021031e1e27291bb36baa0e3e2">gRandom</a>-&gt;<a class="code" href="classTRandom.html#af504d4f838ab09eb48b7c252615563aa">Rndm</a>() + low[i];</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0] * <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[1] * <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[1] + <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[2] * <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[2] + <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[3] * <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[3]);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a> = <a class="code" href="TRandom_8h.html#a9ee275021031e1e27291bb36baa0e3e2">gRandom</a>-&gt;<a class="code" href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">Gaus</a>(upp[4],low[4]);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//____________________________________________________________________</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keywordtype">int</span> CompareResults(<a class="code" href="classTMultiDimFit.html">TMultiDimFit</a> *fit, <span class="keywordtype">bool</span> doFit)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="comment">//Compare results with reference run</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="comment">// the right coefficients (before fit)</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   <span class="keywordtype">double</span> GoodCoeffsNoFit[] = {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   -4.37056,</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   43.1468,</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   13.432,</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   13.4632,</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   13.3964,</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   13.328,</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   13.3016,</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   13.3519,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   4.49724,</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   4.63876,</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   4.89036,</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   -3.69982,</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   -3.98618,</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   -3.86195,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   4.36054,</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   -4.02597,</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   4.57037,</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   4.69845,</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   2.83819,</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   -3.48855,</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   -3.97612</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   };</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="comment">// the right coefficients (after fit)</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <span class="keywordtype">double</span> GoodCoeffs[] = {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      -4.399,</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      43.15,</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      13.41,</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      13.49,</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      13.4,</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      13.23,</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      13.34,</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      13.29,</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      4.523,</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      4.659,</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      4.948,</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      -4.026,</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      -4.045,</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      -3.939,</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      4.421,</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      -4.006,</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      4.626,</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      4.378,</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      3.516,</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      -4.111,</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      -3.823,</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   };</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="comment">// Good Powers</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="keywordtype">int</span> GoodPower[] = {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   1,  1,  1,  1,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   2,  1,  1,  1,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   1,  1,  1,  2,</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   1,  1,  2,  1,</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   1,  2,  1,  1,</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   2,  2,  1,  1,</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   2,  1,  1,  2,</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   2,  1,  2,  1,</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   1,  1,  1,  3,</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   1,  3,  1,  1,</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   1,  1,  5,  1,</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   1,  1,  2,  2,</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   1,  2,  1,  2,</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   1,  2,  2,  1,</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   2,  1,  1,  3,</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   2,  2,  1,  2,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   2,  1,  3,  1,</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   2,  3,  1,  1,</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   1,  2,  2,  2,</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   2,  1,  2,  2,</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   2,  2,  2,  1</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   };</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nc = fit-&gt;<a class="code" href="classTMultiDimFit.html#a05022f855a32fc5316c58bd73f3d4fb5">GetNCoefficients</a>();</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nv = fit-&gt;<a class="code" href="classTMultiDimFit.html#a5548d9131c541140f629e1dfe5cb491b">GetNVariables</a>();</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   <span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> *powers = fit-&gt;<a class="code" href="classTMultiDimFit.html#afc9026986e661cdc53c5e9da07ef903e">GetPowers</a>();</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   <span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> *pindex = fit-&gt;<a class="code" href="classTMultiDimFit.html#a8ac246d0269feff0a81b2856303c7ad1">GetPowerIndex</a>();</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <span class="keywordflow">if</span> (nc != 21) <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   <span class="keyword">const</span> <a class="code" href="classTVectorT.html">TVectorD</a> *coeffs = fit-&gt;<a class="code" href="classTMultiDimFit.html#a8dd1595241675b6e92136db7d075eee9">GetCoefficients</a>();</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   <span class="keywordtype">int</span> k = 0;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i=0;i&lt;nc;i++) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">if</span> (doFit) {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="namespaceTMath.html#aba442ea8aa2b658f88ef7f4ce3cc7b89">TMath::AreEqualRel</a>((*coeffs)[i],GoodCoeffs[i],1<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-3)) <span class="keywordflow">return</span> 2;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespaceTMath.html#af682354cea223351f1306bf98a858dfd">TMath::Abs</a>((*coeffs)[i] - GoodCoeffsNoFit[i]) &gt; 5<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-5) <span class="keywordflow">return</span> 2;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> j=0;j&lt;nv;j++) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;         <span class="keywordflow">if</span> (powers[pindex[i]*nv+j] != GoodPower[k]) <span class="keywordflow">return</span> 3;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;         k++;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <span class="comment">// now test the result of the generated function</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLine(<span class="stringliteral">&quot;.L MDF.C&quot;</span>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> refMDF = (doFit) ? 43.95 : 43.98;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="comment">// this does not work in CLing since the function is not defined</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <span class="comment">//Double_t x[]    = {5,5,5,5};</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <span class="comment">//Double_t rMDF   = MDF(x);</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <span class="comment">//LM:  need to return the address of the result since it is casted to a long (this should not be in a tutorial !)</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> iret = <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLine(<span class="stringliteral">&quot; Double_t xvalues[] = {5,5,5,5}; double result=MDF(xvalues); &amp;result;&quot;</span>);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> rMDF = * ( (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>*)iret);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <span class="comment">//printf(&quot;%f\n&quot;,rMDF);</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespaceTMath.html#af682354cea223351f1306bf98a858dfd">TMath::Abs</a>(rMDF -refMDF) &gt; 1<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-2) <span class="keywordflow">return</span> 4;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">//____________________________________________________________________</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> multidimfit(<span class="keywordtype">bool</span> doFit = <span class="keyword">true</span>)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;{</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;*************************************************&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;*             Multidimensional Fit              *&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;*                                               *&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;* By Christian Holm &lt;cholm@nbi.dk&gt; 14/10/00     *&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;*************************************************&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   cout &lt;&lt; endl;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <span class="comment">// Initialize global TRannom object.</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <a class="code" href="TRandom_8h.html#a9ee275021031e1e27291bb36baa0e3e2">gRandom</a> = <span class="keyword">new</span> <a class="code" href="classTRandom.html">TRandom</a>();</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   <span class="comment">// Open output file</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <a class="code" href="classTFile.html">TFile</a>* <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a> = <span class="keyword">new</span> <a class="code" href="classTFile.html">TFile</a>(<span class="stringliteral">&quot;mdf.root&quot;</span>, <span class="stringliteral">&quot;RECREATE&quot;</span>);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   <span class="comment">// Global data parameters</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nVars       = 4;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nData       = 500;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[4];</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="comment">// make fit object and set parameters on it.</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <a class="code" href="classTMultiDimFit.html">TMultiDimFit</a>* fit = <span class="keyword">new</span> <a class="code" href="classTMultiDimFit.html">TMultiDimFit</a>(nVars, <a class="code" href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152ea01c4c4c755c598880447ca3ce72b0950">TMultiDimFit::kMonomials</a>,<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> mPowers[]   = { 6 , 6, 6, 6 };</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#a86d869eb42826e07457c0fc10604776c">SetMaxPowers</a>(mPowers);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#a12d443e8b20d116b7510863e0fbf2a99">SetMaxFunctions</a>(1000);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#a0b7d068098688409595bf0ca53449d45">SetMaxStudy</a>(1000);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#a3ffa2fd7bc7b430d87abe0ef35871add">SetMaxTerms</a>(30);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#a6bc775ada70124b1e5aa1d61e4f07f52">SetPowerLimit</a>(1);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#adc46df2e9e96fbf1c7bcf4f0386e1641">SetMinAngle</a>(10);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#aa9b31c2a4a4c02dbcb21dc4e4147755f">SetMaxAngle</a>(10);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#aa0d8c58be3bf2a36465b65d015f4cb83">SetMinRelativeError</a>(.01);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   <span class="comment">// variables to hold the temporary input data</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <span class="comment">// Print out the start parameters</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#ae18eb732b7f700f28365e074d2685096">Print</a>(<span class="stringliteral">&quot;p&quot;</span>);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   printf(<span class="stringliteral">&quot;======================================\n&quot;</span>);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <span class="comment">// Create training sample</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; nData ; i++) {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="comment">// Make some data</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      makeData(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>,<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="comment">// Add the row to the fit object</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      fit-&gt;<a class="code" href="classTMultiDimFit.html#a74720b6e5b76b417cf809cf57401ef3c">AddRow</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>,<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <span class="comment">// Print out the statistics</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#ae18eb732b7f700f28365e074d2685096">Print</a>(<span class="stringliteral">&quot;s&quot;</span>);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   <span class="comment">// Book histograms</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#af062a8ff2b0850e9b25edd065b4d9b2e">MakeHistograms</a>();</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <span class="comment">// Find the parameterization</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#a6fcbef530e89fe295103c1f84107ef33">FindParameterization</a>();</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <span class="comment">// Print coefficents</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#ae18eb732b7f700f28365e074d2685096">Print</a>(<span class="stringliteral">&quot;rc&quot;</span>);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   <span class="comment">// Get the min and max of variables from the training sample, used</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   <span class="comment">// for cuts in test sample.</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *xMax = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[nVars];</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *xMin = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[nVars];</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; nVars; i++) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      xMax[i] = (*fit-&gt;<a class="code" href="classTMultiDimFit.html#a62926112e2f9dbbe761aa760c0010092">GetMaxVariables</a>())(i);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      xMin[i] = (*fit-&gt;<a class="code" href="classTMultiDimFit.html#a01c04e3d23e33c41f0e958c928059ec4">GetMinVariables</a>())(i);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   nData = fit-&gt;<a class="code" href="classTMultiDimFit.html#a05022f855a32fc5316c58bd73f3d4fb5">GetNCoefficients</a>() * 100;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> j;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   <span class="comment">// Create test sample</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; nData ; i++) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="comment">// Make some data</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      makeData(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>,<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; nVars; j++)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[j] &lt; xMin[j] || <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[j] &gt; xMax[j])</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="comment">// If we get through the loop above, all variables are in range</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">if</span> (j == nVars)</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;         <span class="comment">// Add the row to the fit object</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;         fit-&gt;<a class="code" href="classTMultiDimFit.html#a963c212eef6e1910fd9fd2f3f05d4bdd">AddTestRow</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>,<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;         i--;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   <span class="comment">//delete gRandom;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;   <span class="comment">// Test the parameterizatio and coefficents using the test sample.</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <span class="keywordflow">if</span> (doFit)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      fit-&gt;<a class="code" href="classTMultiDimFit.html#a995a6ac6f1cf39c8b2ba59fcd26641b3">Fit</a>(<span class="stringliteral">&quot;M&quot;</span>);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   <span class="comment">// Print result</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#ae18eb732b7f700f28365e074d2685096">Print</a>(<span class="stringliteral">&quot;fc v&quot;</span>);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   <span class="comment">// Write code to file</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   fit-&gt;<a class="code" href="classTMultiDimFit.html#a62d9ca99ba267dc7d2d80fa88f041b1f">MakeCode</a>();</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   <span class="comment">// Write histograms to disk, and close file</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>-&gt;Write();</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>-&gt;Close();</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   <span class="keyword">delete</span> <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <span class="comment">// Compare results with reference run</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> compare = CompareResults(fit, doFit);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   <span class="keywordflow">if</span> (!compare) {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      printf(<span class="stringliteral">&quot;\nmultidimfit ..............................................  OK\n&quot;</span>);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      printf(<span class="stringliteral">&quot;\nmultidimfit ..............................................  fails case %d\n&quot;</span>,compare);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   }</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <span class="comment">// We&#39;re done</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   <span class="keyword">delete</span> fit;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <span class="keywordflow">return</span> compare;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div><div class="ttc" id="classTRandom_html_a0e445e213eae1343b3d22086ecb87314"><div class="ttname"><a href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">TRandom::Gaus</a></div><div class="ttdeci">virtual Double_t Gaus(Double_t mean=0, Double_t sigma=1)</div><div class="ttdoc">Samples a random number from the standard Normal (Gaussian) Distribution with the given mean and sigm...</div><div class="ttdef"><b>Definition:</b> <a href="TRandom_8cxx_source.html#l00263">TRandom.cxx:263</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a995a6ac6f1cf39c8b2ba59fcd26641b3"><div class="ttname"><a href="classTMultiDimFit.html#a995a6ac6f1cf39c8b2ba59fcd26641b3">TMultiDimFit::Fit</a></div><div class="ttdeci">virtual void Fit(Option_t *option=&quot;&quot;)</div><div class="ttdoc">Try to fit the found parameterisation to the test sample. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01010">TMultiDimFit.cxx:1010</a></div></div>
<div class="ttc" id="TBrowser_8h_html"><div class="ttname"><a href="TBrowser_8h.html">TBrowser.h</a></div></div>
<div class="ttc" id="classTFile_html"><div class="ttname"><a href="classTFile.html">TFile</a></div><div class="ttdoc">A ROOT file is a suite of consecutive data records (TKey instances) with a well defined format...</div><div class="ttdef"><b>Definition:</b> <a href="TFile_8h_source.html#l00048">TFile.h:48</a></div></div>
<div class="ttc" id="classTVectorT_html"><div class="ttname"><a href="classTVectorT.html">TVectorT</a></div><div class="ttdoc">TVectorT. </div><div class="ttdef"><b>Definition:</b> <a href="TMatrixTBase_8h_source.html#l00079">TMatrixTBase.h:79</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a86d869eb42826e07457c0fc10604776c"><div class="ttname"><a href="classTMultiDimFit.html#a86d869eb42826e07457c0fc10604776c">TMultiDimFit::SetMaxPowers</a></div><div class="ttdeci">void SetMaxPowers(const Int_t *powers)</div><div class="ttdoc">Set the maximum power to be considered in the fit for each variable. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02436">TMultiDimFit.cxx:2436</a></div></div>
<div class="ttc" id="TROOT_8h_html_a851dd11b3478372a25ba6eff6dcfa5b1"><div class="ttname"><a href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a></div><div class="ttdeci">#define gROOT</div><div class="ttdef"><b>Definition:</b> <a href="TROOT_8h_source.html#l00413">TROOT.h:413</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_afc9026986e661cdc53c5e9da07ef903e"><div class="ttname"><a href="classTMultiDimFit.html#afc9026986e661cdc53c5e9da07ef903e">TMultiDimFit::GetPowers</a></div><div class="ttdeci">const Int_t * GetPowers() const</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00166">TMultiDimFit.h:166</a></div></div>
<div class="ttc" id="TFile_8h_html"><div class="ttname"><a href="TFile_8h.html">TFile.h</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_a3885b911a54b47a4e61671f45dd45d0b"><div class="ttname"><a href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a></div><div class="ttdeci">int Int_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00041">RtypesCore.h:41</a></div></div>
<div class="ttc" id="TMultiDimFit_8h_html"><div class="ttname"><a href="TMultiDimFit_8h.html">TMultiDimFit.h</a></div></div>
<div class="ttc" id="namespaceTMath_html_af682354cea223351f1306bf98a858dfd"><div class="ttname"><a href="namespaceTMath.html#af682354cea223351f1306bf98a858dfd">TMath::Abs</a></div><div class="ttdeci">Short_t Abs(Short_t d)</div><div class="ttdef"><b>Definition:</b> <a href="TMathBase_8h_source.html#l00120">TMathBase.h:120</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a01c04e3d23e33c41f0e958c928059ec4"><div class="ttname"><a href="classTMultiDimFit.html#a01c04e3d23e33c41f0e958c928059ec4">TMultiDimFit::GetMinVariables</a></div><div class="ttdeci">const TVectorD * GetMinVariables() const</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00160">TMultiDimFit.h:160</a></div></div>
<div class="ttc" id="TVectorD_8h_html"><div class="ttname"><a href="TVectorD_8h.html">TVectorD.h</a></div></div>
<div class="ttc" id="legend1_8C_html_a13c6713ae496caa8195647f76887f926"><div class="ttname"><a href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a></div><div class="ttdeci">Double_t x[n]</div><div class="ttdef"><b>Definition:</b> <a href="legend1_8C_source.html#l00017">legend1.C:17</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a6bc775ada70124b1e5aa1d61e4f07f52"><div class="ttname"><a href="classTMultiDimFit.html#a6bc775ada70124b1e5aa1d61e4f07f52">TMultiDimFit::SetPowerLimit</a></div><div class="ttdeci">void SetPowerLimit(Double_t limit=1e-3)</div><div class="ttdoc">Set the user parameter for the function selection. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02426">TMultiDimFit.cxx:2426</a></div></div>
<div class="ttc" id="classTRandom_html"><div class="ttname"><a href="classTRandom.html">TRandom</a></div><div class="ttdoc"> This is the base class for the ROOT Random number generators. </div><div class="ttdef"><b>Definition:</b> <a href="TRandom_8h_source.html#l00027">TRandom.h:27</a></div></div>
<div class="ttc" id="TSystem_8h_html"><div class="ttname"><a href="TSystem_8h.html">TSystem.h</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a05022f855a32fc5316c58bd73f3d4fb5"><div class="ttname"><a href="classTMultiDimFit.html#a05022f855a32fc5316c58bd73f3d4fb5">TMultiDimFit::GetNCoefficients</a></div><div class="ttdeci">Int_t GetNCoefficients() const</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00162">TMultiDimFit.h:162</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_adc46df2e9e96fbf1c7bcf4f0386e1641"><div class="ttname"><a href="classTMultiDimFit.html#adc46df2e9e96fbf1c7bcf4f0386e1641">TMultiDimFit::SetMinAngle</a></div><div class="ttdeci">void SetMinAngle(Double_t angle=1)</div><div class="ttdoc">Set the min angle (in degrees) between a new candidate function and the subspace spanned by the previ...</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02386">TMultiDimFit.cxx:2386</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_aa9b31c2a4a4c02dbcb21dc4e4147755f"><div class="ttname"><a href="classTMultiDimFit.html#aa9b31c2a4a4c02dbcb21dc4e4147755f">TMultiDimFit::SetMaxAngle</a></div><div class="ttdeci">void SetMaxAngle(Double_t angle=0)</div><div class="ttdoc">Set the max angle (in degrees) between the initial data vector to be fitted, and the new candidate fu...</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02370">TMultiDimFit.cxx:2370</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a8dd1595241675b6e92136db7d075eee9"><div class="ttname"><a href="classTMultiDimFit.html#a8dd1595241675b6e92136db7d075eee9">TMultiDimFit::GetCoefficients</a></div><div class="ttdeci">const TVectorD * GetCoefficients() const</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00142">TMultiDimFit.h:142</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a74720b6e5b76b417cf809cf57401ef3c"><div class="ttname"><a href="classTMultiDimFit.html#a74720b6e5b76b417cf809cf57401ef3c">TMultiDimFit::AddRow</a></div><div class="ttdeci">virtual void AddRow(const Double_t *x, Double_t D, Double_t E=0)</div><div class="ttdoc">Add a row consisting of fNVariables independent variables, the known, dependent quantity, and optionally, the square error in the dependent quantity, to the training sample to be used for the parameterization. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00608">TMultiDimFit.cxx:608</a></div></div>
<div class="ttc" id="TCanvas_8h_html"><div class="ttname"><a href="TCanvas_8h.html">TCanvas.h</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a62926112e2f9dbbe761aa760c0010092"><div class="ttname"><a href="classTMultiDimFit.html#a62926112e2f9dbbe761aa760c0010092">TMultiDimFit::GetMaxVariables</a></div><div class="ttdeci">const TVectorD * GetMaxVariables() const</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00154">TMultiDimFit.h:154</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a3ffa2fd7bc7b430d87abe0ef35871add"><div class="ttname"><a href="classTMultiDimFit.html#a3ffa2fd7bc7b430d87abe0ef35871add">TMultiDimFit::SetMaxTerms</a></div><div class="ttdeci">void SetMaxTerms(Int_t terms)</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00201">TMultiDimFit.h:201</a></div></div>
<div class="ttc" id="classTRandom_html_af504d4f838ab09eb48b7c252615563aa"><div class="ttname"><a href="classTRandom.html#af504d4f838ab09eb48b7c252615563aa">TRandom::Rndm</a></div><div class="ttdeci">virtual Double_t Rndm()</div><div class="ttdoc">Machine independent random number generator. </div><div class="ttdef"><b>Definition:</b> <a href="TRandom_8cxx_source.html#l00541">TRandom.cxx:541</a></div></div>
<div class="ttc" id="namespaceTMath_html_aba442ea8aa2b658f88ef7f4ce3cc7b89"><div class="ttname"><a href="namespaceTMath.html#aba442ea8aa2b658f88ef7f4ce3cc7b89">TMath::AreEqualRel</a></div><div class="ttdeci">Bool_t AreEqualRel(Double_t af, Double_t bf, Double_t relPrec)</div><div class="ttdef"><b>Definition:</b> <a href="TMath_8h_source.html#l00416">TMath.h:416</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a5548d9131c541140f629e1dfe5cb491b"><div class="ttname"><a href="classTMultiDimFit.html#a5548d9131c541140f629e1dfe5cb491b">TMultiDimFit::GetNVariables</a></div><div class="ttdeci">Int_t GetNVariables() const</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00161">TMultiDimFit.h:161</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ae18eb732b7f700f28365e074d2685096"><div class="ttname"><a href="classTMultiDimFit.html#ae18eb732b7f700f28365e074d2685096">TMultiDimFit::Print</a></div><div class="ttdeci">virtual void Print(Option_t *option=&quot;ps&quot;) const</div><div class="ttdoc">Print statistics etc. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02151">TMultiDimFit.cxx:2151</a></div></div>
<div class="ttc" id="TROOT_8h_html"><div class="ttname"><a href="TROOT_8h.html">TROOT.h</a></div></div>
<div class="ttc" id="classTMultiDimFit_html"><div class="ttname"><a href="classTMultiDimFit.html">TMultiDimFit</a></div><div class="ttdoc">Multidimensional Fits in ROOT. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00015">TMultiDimFit.h:15</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a6fcbef530e89fe295103c1f84107ef33"><div class="ttname"><a href="classTMultiDimFit.html#a6fcbef530e89fe295103c1f84107ef33">TMultiDimFit::FindParameterization</a></div><div class="ttdeci">virtual void FindParameterization(Option_t *option=&quot;&quot;)</div><div class="ttdoc">Find the parameterization. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00991">TMultiDimFit.cxx:991</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a8ac246d0269feff0a81b2856303c7ad1"><div class="ttname"><a href="classTMultiDimFit.html#a8ac246d0269feff0a81b2856303c7ad1">TMultiDimFit::GetPowerIndex</a></div><div class="ttdeci">Int_t * GetPowerIndex() const</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00164">TMultiDimFit.h:164</a></div></div>
<div class="ttc" id="TRandom_8h_html_a9ee275021031e1e27291bb36baa0e3e2"><div class="ttname"><a href="TRandom_8h.html#a9ee275021031e1e27291bb36baa0e3e2">gRandom</a></div><div class="ttdeci">R__EXTERN TRandom * gRandom</div><div class="ttdef"><b>Definition:</b> <a href="TRandom_8h_source.html#l00062">TRandom.h:62</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a963c212eef6e1910fd9fd2f3f05d4bdd"><div class="ttname"><a href="classTMultiDimFit.html#a963c212eef6e1910fd9fd2f3f05d4bdd">TMultiDimFit::AddTestRow</a></div><div class="ttdeci">virtual void AddTestRow(const Double_t *x, Double_t D, Double_t E=0)</div><div class="ttdoc">Add a row consisting of fNVariables independent variables, the known, dependent quantity, and optionally, the square error in the dependent quantity, to the test sample to be used for the test of the parameterization. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00687">TMultiDimFit.cxx:687</a></div></div>
<div class="ttc" id="Riostream_8h_html"><div class="ttname"><a href="Riostream_8h.html">Riostream.h</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_af062a8ff2b0850e9b25edd065b4d9b2e"><div class="ttname"><a href="classTMultiDimFit.html#af062a8ff2b0850e9b25edd065b4d9b2e">TMultiDimFit::MakeHistograms</a></div><div class="ttdeci">virtual void MakeHistograms(Option_t *option=&quot;A&quot;)</div><div class="ttdoc">Make histograms of the result of the analysis. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01594">TMultiDimFit.cxx:1594</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_a84701346fdad56d1d91e06fcbc1b87dc"><div class="ttname"><a href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a></div><div class="ttdeci">long Long_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00050">RtypesCore.h:50</a></div></div>
<div class="ttc" id="RSha256_8hxx_html_a23b5b0a85bf5762c93a855f40c0343ce"><div class="ttname"><a href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a></div><div class="ttdeci">#define d(i)</div><div class="ttdef"><b>Definition:</b> <a href="RSha256_8hxx_source.html#l00102">RSha256.hxx:102</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_ab9b5334647b78ec4256db251e3ae1fc6"><div class="ttname"><a href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a></div><div class="ttdeci">double Double_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00055">RtypesCore.h:55</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_aa0d8c58be3bf2a36465b65d015f4cb83"><div class="ttname"><a href="classTMultiDimFit.html#aa0d8c58be3bf2a36465b65d015f4cb83">TMultiDimFit::SetMinRelativeError</a></div><div class="ttdeci">void SetMinRelativeError(Double_t error)</div><div class="ttdoc">Set the acceptable relative error for when sum of square residuals is considered minimized. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02451">TMultiDimFit.cxx:2451</a></div></div>
<div class="ttc" id="TRandom_8h_html"><div class="ttname"><a href="TRandom_8h.html">TRandom.h</a></div></div>
<div class="ttc" id="TRolke_8cxx_html_a680432d265de4ea2534f8ec32f1aa417"><div class="ttname"><a href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a></div><div class="ttdeci">you should not use this method at all Int_t Int_t Double_t Double_t Double_t e</div><div class="ttdef"><b>Definition:</b> <a href="TRolke_8cxx_source.html#l00630">TRolke.cxx:630</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a62d9ca99ba267dc7d2d80fa88f041b1f"><div class="ttname"><a href="classTMultiDimFit.html#a62d9ca99ba267dc7d2d80fa88f041b1f">TMultiDimFit::MakeCode</a></div><div class="ttdeci">virtual void MakeCode(const char *functionName=&quot;MDF&quot;, Option_t *option=&quot;&quot;)</div><div class="ttdoc">Generate the file &lt;filename&gt; with .C appended if argument doesn&amp;#39;t end in .cxx or .C. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01287">TMultiDimFit.cxx:1287</a></div></div>
<div class="ttc" id="TH1_8h_html"><div class="ttname"><a href="TH1_8h.html">TH1.h</a></div></div>
<div class="ttc" id="namespaceTMath_html_a9ea900c956031cb12057acf7c322b0fa"><div class="ttname"><a href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a></div><div class="ttdeci">Double_t Sqrt(Double_t x)</div><div class="ttdef"><b>Definition:</b> <a href="TMath_8h_source.html#l00679">TMath.h:679</a></div></div>
<div class="ttc" id="TMath_8h_html"><div class="ttname"><a href="TMath_8h.html">TMath.h</a></div></div>
<div class="ttc" id="win32gdk_2src_2gifencode_8c_html_a606a386e5db616c66c8c8d932d23dc39"><div class="ttname"><a href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a></div><div class="ttdeci">static void output(int code)</div><div class="ttdef"><b>Definition:</b> <a href="win32gdk_2src_2gifencode_8c_source.html#l00226">gifencode.c:226</a></div></div>
<div class="ttc" id="TApplication_8h_html"><div class="ttname"><a href="TApplication_8h.html">TApplication.h</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a0b7d068098688409595bf0ca53449d45"><div class="ttname"><a href="classTMultiDimFit.html#a0b7d068098688409595bf0ca53449d45">TMultiDimFit::SetMaxStudy</a></div><div class="ttdeci">void SetMaxStudy(Int_t n)</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00200">TMultiDimFit.h:200</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a8c4c287c72e9ea58d80223b927cd152ea01c4c4c755c598880447ca3ce72b0950"><div class="ttname"><a href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152ea01c4c4c755c598880447ca3ce72b0950">TMultiDimFit::kMonomials</a></div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00019">TMultiDimFit.h:19</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a12d443e8b20d116b7510863e0fbf2a99"><div class="ttname"><a href="classTMultiDimFit.html#a12d443e8b20d116b7510863e0fbf2a99">TMultiDimFit::SetMaxFunctions</a></div><div class="ttdeci">void SetMaxFunctions(Int_t n)</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00198">TMultiDimFit.h:198</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:09:51 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

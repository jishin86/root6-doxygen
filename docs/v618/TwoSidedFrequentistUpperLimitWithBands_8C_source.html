<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/roostats/TwoSidedFrequentistUpperLimitWithBands.C Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_87facaa6959ceb8d3dacccaf663f7b84.html">roostats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TwoSidedFrequentistUpperLimitWithBands.C</div>  </div>
</div><!--header-->
<div class="contents">
<a href="TwoSidedFrequentistUpperLimitWithBands_8C.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/// \file</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="comment">/// \ingroup tutorial_roostats</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span><span class="comment">/// \notebook -js</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span><span class="comment">/// TwoSidedFrequentistUpperLimitWithBands</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span><span class="comment">/// This is a standard demo that can be used with any ROOT file</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span><span class="comment">/// prepared in the standard way.  You specify:</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span><span class="comment">///  - name for input ROOT file</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span><span class="comment">///  - name of workspace inside ROOT file that holds model and data</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"></span><span class="comment">///  - name of ModelConfig that specifies details for calculator tools</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span><span class="comment">///  - name of dataset</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span><span class="comment">/// With default parameters the macro will attempt to run the</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span><span class="comment">/// standard hist2workspace example and read the ROOT file</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span><span class="comment">/// that it produces.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span><span class="comment">/// You may want to control:</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"></span><span class="comment">/// ~~~{.cpp}</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span><span class="comment">///   double confidenceLevel=0.95;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span><span class="comment">///   double additionalToysFac = 1.;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span><span class="comment">///   int nPointsToScan = 12;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"></span><span class="comment">///   int nToyMC = 200;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"></span><span class="comment">/// ~~~</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span><span class="comment">/// This uses a modified version of the profile likelihood ratio as</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"></span><span class="comment">/// a test statistic for upper limits (eg. test stat = 0 if muhat&gt;mu).</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span><span class="comment">/// Based on the observed data, one defines a set of parameter points</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"></span><span class="comment">/// to be tested based on the value of the parameter of interest</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span><span class="comment">/// and the conditional MLE (eg. profiled) values of the nuisance parameters.</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"></span><span class="comment">/// At each parameter point, pseudo-experiments are generated using this</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"></span><span class="comment">/// fixed reference model and then the test statistic is evaluated.</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"></span><span class="comment">/// The auxiliary measurements (global observables) associated with the</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span><span class="comment">/// constraint terms in nuisance parameters are also fluctuated in the</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span><span class="comment">/// process of generating the pseudo-experiments in a frequentist manner</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span><span class="comment">/// forming an &#39;unconditional ensemble&#39;.  One could form a &#39;conditional&#39;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"></span><span class="comment">/// ensemble in which these auxiliary measurements are fixed.  Note that the</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"></span><span class="comment">/// nuisance parameters are not randomized, which is a Bayesian procedure.</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span><span class="comment">/// Note, the nuisance parameters are floating in the fits.  For each point,</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"></span><span class="comment">/// the threshold that defines the 95% acceptance region is found.  This</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"></span><span class="comment">/// forms a &quot;Confidence Belt&quot;.</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span><span class="comment">/// After constructing the confidence belt, one can find the confidence</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"></span><span class="comment">/// interval for any particular dataset by finding the intersection</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"></span><span class="comment">/// of the observed test statistic and the confidence belt.  First</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"></span><span class="comment">/// this is done on the observed data to get an observed 1-sided upper limt.</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span><span class="comment">/// Finally, there expected limit and bands (from background-only) are</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"></span><span class="comment">/// formed by generating background-only data and finding the upper limit.</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"></span><span class="comment">/// The background-only is defined as such that the nuisance parameters are</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span><span class="comment">/// fixed to their best fit value based on the data with the signal rate fixed to 0.</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"></span><span class="comment">/// The bands are done by hand for now, will later be part of the RooStats tools.</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span><span class="comment">/// On a technical note, this technique IS the generalization of Feldman-Cousins</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"></span><span class="comment">/// with nuisance parameters.</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"></span><span class="comment">/// Building the confidence belt can be computationally expensive.</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span><span class="comment">/// Once it is built, one could save it to a file and use it in a separate step.</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"></span><span class="comment">/// We can use PROOF to speed things along in parallel, however,</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"></span><span class="comment">/// the test statistic has to be installed on the workers</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span><span class="comment">/// so either turn off PROOF or include the modified test statistic</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"></span><span class="comment">/// in your $ROOTSYS/roofit/roostats/inc directory,</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span><span class="comment">/// add the additional line to the LinkDef.h file,</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span><span class="comment">/// and recompile root.</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"></span><span class="comment">/// Note, if you have a boundary on the parameter of interest (eg. cross-section)</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"></span><span class="comment">/// the threshold on the two-sided test statistic starts off at moderate values and plateaus.</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span><span class="comment">/// [#0] PROGRESS:Generation -- generated toys: 500 / 999</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span><span class="comment">/// NeymanConstruction: Prog: 12/50 total MC = 39 this test stat = 0</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span><span class="comment">///  SigXsecOverSM=0.69 alpha_syst1=0.136515 alpha_syst3=0.425415 beta_syst2=1.08496 [-1e+30, 0.011215]  in interval = 1</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span><span class="comment">/// this tells you the values of the parameters being used to generate the pseudo-experiments</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"></span><span class="comment">/// and the threshold in this case is 0.011215.  One would expect for 95% that the threshold</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"></span><span class="comment">/// would be ~1.35 once the cross-section is far enough away from 0 that it is essentially</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span><span class="comment">/// unaffected by the boundary.  As one reaches the last points in the scan, the</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"></span><span class="comment">/// theshold starts to get artificially high.  This is because the range of the parameter in</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"></span><span class="comment">/// the fit is the same as the range in the scan.  In the future, these should be independently</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"></span><span class="comment">/// controlled, but they are not now.  As a result the ~50% of pseudo-experiments that have an</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"></span><span class="comment">/// upward fluctuation end up with muhat = muMax.  Because of this, the upper range of the</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"></span><span class="comment">/// parameter should be well above the expected upper limit... but not too high or one will</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span><span class="comment">/// need a very large value of nPointsToScan to resolve the relevant region.  This can be</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"></span><span class="comment">/// improved, but this is the first version of this script.</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"></span><span class="comment">/// Important note: when the model includes external constraint terms, like a Gaussian</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span><span class="comment">/// constraint to a nuisance parameter centered around some nominal value there is</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span><span class="comment">/// a subtlety.  The asymptotic results are all based on the assumption that all the</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"></span><span class="comment">/// measurements fluctuate... including the nominal values from auxiliary measurements.</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span><span class="comment">/// If these do not fluctuate, this corresponds to an &quot;conditional ensemble&quot;.  The</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"></span><span class="comment">/// result is that the distribution of the test statistic can become very non-chi^2.</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span><span class="comment">/// This results in thresholds that become very large.</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span><span class="comment">/// \macro_image</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"></span><span class="comment">/// \macro_output</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"></span><span class="comment">/// \macro_code</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span><span class="comment">///</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span><span class="comment">/// \author Kyle Cranmer,Contributions from Aaron Armbruster, Haoshuang Ji, Haichen Wang and Daniel Whiteson</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TFile_8h.html">TFile.h</a>&quot;</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TROOT_8h.html">TROOT.h</a>&quot;</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TH1F_8h.html">TH1F.h</a>&quot;</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TSystem_8h.html">TSystem.h</a>&quot;</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RooWorkspace_8h.html">RooWorkspace.h</a>&quot;</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RooSimultaneous_8h.html">RooSimultaneous.h</a>&quot;</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RooAbsData_8h.html">RooAbsData.h</a>&quot;</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ModelConfig_8h.html">RooStats/ModelConfig.h</a>&quot;</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="FeldmanCousins_8h.html">RooStats/FeldmanCousins.h</a>&quot;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ToyMCSampler_8h.html">RooStats/ToyMCSampler.h</a>&quot;</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PointSetInterval_8h.html">RooStats/PointSetInterval.h</a>&quot;</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ConfidenceBelt_8h.html">RooStats/ConfidenceBelt.h</a>&quot;</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RooStatsUtils_8h.html">RooStats/RooStatsUtils.h</a>&quot;</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProfileLikelihoodTestStat_8h.html">RooStats/ProfileLikelihoodTestStat.h</a>&quot;</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceRooFit.html">RooFit</a>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceRooStats.html">RooStats</a>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keywordtype">bool</span> useProof = <span class="keyword">false</span>; <span class="comment">// flag to control whether to use Proof</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keywordtype">int</span> nworkers = 0;      <span class="comment">// number of workers (default use all available cores)</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">// -------------------------------------------------------</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keywordtype">void</span> TwoSidedFrequentistUpperLimitWithBands(<span class="keyword">const</span> <span class="keywordtype">char</span> *infile = <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *workspaceName = <span class="stringliteral">&quot;combined&quot;</span>,</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">char</span> *modelConfigName = <span class="stringliteral">&quot;ModelConfig&quot;</span>,</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">char</span> *dataName = <span class="stringliteral">&quot;obsData&quot;</span>)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;{</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <span class="keywordtype">double</span> confidenceLevel = 0.95;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <span class="comment">// degrade/improve number of pseudo-experiments used to define the confidence belt.</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <span class="comment">// value of 1 corresponds to default number of toys in the tail, which is 50/(1-confidenceLevel)</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="keywordtype">double</span> additionalToysFac = 0.5;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <span class="keywordtype">int</span> nPointsToScan = 20; <span class="comment">// number of steps in the parameter of interest</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   <span class="keywordtype">int</span> nToyMC = 200;       <span class="comment">// number of toys used to define the expected limit and band</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="comment">// -------------------------------------------------------</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="comment">// First part is just to access a user-defined file</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <span class="comment">// or create the standard example file if it doesn&#39;t exist</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *filename = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <span class="keywordflow">if</span> (!strcmp(infile, <span class="stringliteral">&quot;&quot;</span>)) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      filename = <span class="stringliteral">&quot;results/example_combined_GaussExample_model.root&quot;</span>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordtype">bool</span> fileExist = !<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(filename); <span class="comment">// note opposite return code</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="comment">// if file does not exists generate with histfactory</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">if</span> (!fileExist) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;HistFactory file cannot be generated on Windows - exit&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;         <span class="comment">// Normally this would be run on the command line</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;will run standard hist2workspace example&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;         <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLine(<span class="stringliteral">&quot;.! prepareHistFactory .&quot;</span>);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;         <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLine(<span class="stringliteral">&quot;.! hist2workspace config/example.xml&quot;</span>);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;\n\n---------------------&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;Done creating example input&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;---------------------\n\n&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   } <span class="keywordflow">else</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      filename = infile;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="comment">// Try to open the file</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   <a class="code" href="classTFile.html">TFile</a> *<a class="code" href="namespacefile.html">file</a> = <a class="code" href="classTFile.html#aec5f3fae0774aabfc615ebb4b00fe5e0">TFile::Open</a>(filename);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <span class="comment">// if input file was specified byt not found, quit</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="namespacefile.html">file</a>) {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;StandardRooStatsDemoMacro: Input file &quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot; is not found&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="comment">// -------------------------------------------------------</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <span class="comment">// Now get the data and workspace</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <span class="comment">// get the workspace out of the file</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <a class="code" href="classRooWorkspace.html">RooWorkspace</a> *w = (<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *)<a class="code" href="namespacefile.html">file</a>-&gt;Get(workspaceName);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   <span class="keywordflow">if</span> (!w) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;workspace not found&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   <span class="comment">// get the modelConfig out of the file</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   <a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> *mc = (<a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> *)w-&gt;<a class="code" href="classRooWorkspace.html#af56548d1c16301ebaf951c452d52f5c3">obj</a>(modelConfigName);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   <span class="comment">// get the modelConfig out of the file</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <a class="code" href="classRooAbsData.html">RooAbsData</a> *data = w-&gt;<a class="code" href="classRooWorkspace.html#a2e0683ca1b7375eaa434a9cc1298e736">data</a>(dataName);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   <span class="comment">// make sure ingredients are found</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <span class="keywordflow">if</span> (!data || !mc) {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      w-&gt;<a class="code" href="classRooWorkspace.html#a9131cf30e7ea371b14a619ebf0d7e18f">Print</a>();</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;data or ModelConfig was not found&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;Found data and ModelConfig:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ab2661258bee58609834f02ab52b1e634">Print</a>();</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   <span class="comment">// -------------------------------------------------------</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <span class="comment">// Now get the POI for convenience</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   <span class="comment">// you may want to adjust the range of your POI</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   <a class="code" href="classRooRealVar.html">RooRealVar</a> *firstPOI = (<a class="code" href="classRooRealVar.html">RooRealVar</a> *)mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>()-&gt;<a class="code" href="classRooAbsCollection.html#a225c780c4c32077d6923e956225e437a">first</a>();</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   <span class="comment">/*  firstPOI-&gt;setMin(0);*/</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   <span class="comment">/*  firstPOI-&gt;setMax(10);*/</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <span class="comment">// -------------------------------------------------------</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <span class="comment">// create and use the FeldmanCousins tool</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   <span class="comment">// to find and plot the 95% confidence interval</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   <span class="comment">// on the parameter of interest as specified</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   <span class="comment">// in the model config</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <span class="comment">// REMEMBER, we will change the test statistic</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <span class="comment">// so this is NOT a Feldman-Cousins interval</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <a class="code" href="classRooStats_1_1FeldmanCousins.html">FeldmanCousins</a> <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>(*data, *mc);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.SetConfidenceLevel(confidenceLevel);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.AdditionalNToysFactor(additionalToysFac); <span class="comment">// improve sampling that defines confidence belt</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <span class="comment">//  fc.UseAdaptiveSampling(true); // speed it up a bit, but don&#39;t use for expected limits</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.SetNBins(nPointsToScan); <span class="comment">// set how many points per parameter of interest to scan</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.CreateConfBelt(<span class="keyword">true</span>);    <span class="comment">// save the information in the belt for plotting</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <span class="comment">// -------------------------------------------------------</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   <span class="comment">// Feldman-Cousins is a unified limit by definition</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   <span class="comment">// but the tool takes care of a few things for us like which values</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   <span class="comment">// of the nuisance parameters should be used to generate toys.</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   <span class="comment">// so let&#39;s just change the test statistic and realize this is</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   <span class="comment">// no longer &quot;Feldman-Cousins&quot; but is a fully frequentist Neyman-Construction.</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <span class="comment">//  fc.GetTestStatSampler()-&gt;SetTestStatistic(&amp;onesided);</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   <span class="comment">// ((ToyMCSampler*) fc.GetTestStatSampler())-&gt;SetGenerateBinned(true);</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   <a class="code" href="classRooStats_1_1ToyMCSampler.html">ToyMCSampler</a> *toymcsampler = (<a class="code" href="classRooStats_1_1ToyMCSampler.html">ToyMCSampler</a> *)<a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetTestStatSampler();</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   <a class="code" href="classRooStats_1_1ProfileLikelihoodTestStat.html">ProfileLikelihoodTestStat</a> *testStat = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classRooStats_1_1ProfileLikelihoodTestStat.html">ProfileLikelihoodTestStat</a> *<span class="keyword">&gt;</span>(toymcsampler-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#a4290c66879dd450673e16265fbc2caa6">GetTestStatistic</a>());</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   <span class="comment">// Since this tool needs to throw toy MC the PDF needs to be</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;   <span class="comment">// extended or the tool needs to know how many entries in a dataset</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   <span class="comment">// per pseudo experiment.</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <span class="comment">// In the &#39;number counting form&#39; where the entries in the dataset</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   <span class="comment">// are counts, and not values of discriminating variables, the</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   <span class="comment">// datasets typically only have one entry and the PDF is not</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   <span class="comment">// extended.</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   <span class="keywordflow">if</span> (!mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#a69d77200d6313129397ac2aa8deef408">canBeExtended</a>()) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">if</span> (data-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>() == 1)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;         <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.FluctuateNumDataEntries(<span class="keyword">false</span>);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;Not sure what to do about this model&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="comment">// We can use PROOF to speed things along in parallel</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   <span class="comment">// However, the test statistic has to be installed on the workers</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   <span class="comment">// so either turn off PROOF or include the modified test statistic</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;   <span class="comment">// in your $ROOTSYS/roofit/roostats/inc directory,</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <span class="comment">// add the additional line to the LinkDef.h file,</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   <span class="comment">// and recompile root.</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keywordflow">if</span> (useProof) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <a class="code" href="classRooStats_1_1ProofConfig.html">ProofConfig</a> <a class="code" href="namespaceTGeant4Unit.html#a9b9c22ca28407dfecdc404f99df537bb">pc</a>(*w, nworkers, <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">false</span>);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      toymcsampler-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#a3518c12aaf49b74d3ef58e22b41de58c">SetProofConfig</a>(&amp;<a class="code" href="namespaceTGeant4Unit.html#a9b9c22ca28407dfecdc404f99df537bb">pc</a>); <span class="comment">// enable proof</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   <span class="keywordflow">if</span> (mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>()) {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;will use global observables for unconditional ensemble&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>()-&gt;<a class="code" href="classRooAbsCollection.html#ab988655a6fe646baa9c6a6b5456c3aa0">Print</a>();</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      toymcsampler-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#aa838b03fde977cb8363cdacf1cf9c56f">SetGlobalObservables</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>());</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <span class="comment">// Now get the interval</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <a class="code" href="classRooStats_1_1PointSetInterval.html">PointSetInterval</a> *interval = <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetInterval();</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <a class="code" href="classRooStats_1_1ConfidenceBelt.html">ConfidenceBelt</a> *belt = <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetConfidenceBelt();</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   <span class="comment">// print out the interval on the first Parameter of Interest</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;\n95% interval on &quot;</span> &lt;&lt; firstPOI-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>() &lt;&lt; <span class="stringliteral">&quot; is : [&quot;</span> &lt;&lt; interval-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#aa221cea064f8013ff5f7fde218a226e3">LowerLimit</a>(*firstPOI) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        &lt;&lt; interval-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#a8c43f888bbc5ba55ec8553a0506dcfc6">UpperLimit</a>(*firstPOI) &lt;&lt; <span class="stringliteral">&quot;] &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   <span class="comment">// get observed UL and value of test statistic evaluated there</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <a class="code" href="classRooArgSet.html">RooArgSet</a> tmpPOI(*firstPOI);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   <span class="keywordtype">double</span> observedUL = interval-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#a8c43f888bbc5ba55ec8553a0506dcfc6">UpperLimit</a>(*firstPOI);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   firstPOI-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(observedUL);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   <span class="keywordtype">double</span> obsTSatObsUL = <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetTestStatSampler()-&gt;EvaluateTestStatistic(*data, tmpPOI);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   <span class="comment">// Ask the calculator which points were scanned</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   <a class="code" href="classRooDataSet.html">RooDataSet</a> *parameterScan = (<a class="code" href="classRooDataSet.html">RooDataSet</a> *)<a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetPointsToScan();</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   <a class="code" href="classRooArgSet.html">RooArgSet</a> *tmpPoint;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <span class="comment">// make a histogram of parameter vs. threshold</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   <a class="code" href="classTH1F.html">TH1F</a> *histOfThresholds =</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keyword">new</span> <a class="code" href="classTH1F.html">TH1F</a>(<span class="stringliteral">&quot;histOfThresholds&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, parameterScan-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>(), firstPOI-&gt;<a class="code" href="classRooAbsRealLValue.html#af16e9d798cdd32874357e57430803a82">getMin</a>(), firstPOI-&gt;<a class="code" href="classRooAbsRealLValue.html#a07d826bfa29ecd48e8e31ed28bd0bc48">getMax</a>());</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   histOfThresholds-&gt;<a class="code" href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">GetXaxis</a>()-&gt;<a class="code" href="classTNamed.html#a72f4d419b48a5fbfef07485b335139ca">SetTitle</a>(firstPOI-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>());</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   histOfThresholds-&gt;<a class="code" href="classTH1.html#a5cadfed83a4db70b4eae6b0a1cea3532">GetYaxis</a>()-&gt;<a class="code" href="classTNamed.html#a72f4d419b48a5fbfef07485b335139ca">SetTitle</a>(<span class="stringliteral">&quot;Threshold&quot;</span>);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <span class="comment">// loop through the points that were tested and ask confidence belt</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <span class="comment">// what the upper/lower thresholds were.</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   <span class="comment">// For FeldmanCousins, the lower cut off is always 0</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0; i &lt; parameterScan-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>(); ++i) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      tmpPoint = (<a class="code" href="classRooArgSet.html">RooArgSet</a> *)parameterScan-&gt;<a class="code" href="classRooDataSet.html#a2d2355b7a32be47b906312f113ee75c0">get</a>(i)-&gt;<a class="code" href="classRooArgSet.html#a693748866f98afb0b4e9efd40de6b405">clone</a>(<span class="stringliteral">&quot;temp&quot;</span>);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">// cout &lt;&lt;&quot;get threshold&quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordtype">double</span> arMax = belt-&gt;<a class="code" href="classRooStats_1_1ConfidenceBelt.html#ad465a9878549db5398cabbffb57ff7fb">GetAcceptanceRegionMax</a>(*tmpPoint);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keywordtype">double</span> poiVal = tmpPoint-&gt;<a class="code" href="classRooArgSet.html#a72568bf2b2726891810ba3b3e8251f0b">getRealValue</a>(firstPOI-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>());</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      histOfThresholds-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(poiVal, arMax);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <a class="code" href="classTCanvas.html">TCanvas</a> *<a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a> = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>();</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;Divide(2);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(1);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   histOfThresholds-&gt;<a class="code" href="classTH1.html#a89a5d8fc84154b504566f367ba8d0238">SetMinimum</a>(0);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   histOfThresholds-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(2);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <span class="comment">// -------------------------------------------------------</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   <span class="comment">// Now we generate the expected bands and power-constraint</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   <span class="comment">// First: find parameter point for mu=0, with conditional MLEs for nuisance parameters</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   <a class="code" href="classRooAbsReal.html">RooAbsReal</a> *nll = mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#a44f3ac4e956a5ba4abb0b74841f22704">createNLL</a>(*data);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   <a class="code" href="classRooAbsReal.html">RooAbsReal</a> *profile = nll-&gt;<a class="code" href="classRooAbsReal.html#a391d1fa138cca9d2ccc3cb80f26944a3">createProfile</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>());</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   firstPOI-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(0.);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   profile-&gt;<a class="code" href="classRooAbsReal.html#a8881da431598c6d15e06cc80518d323d">getVal</a>(); <span class="comment">// this will do fit and set nuisance parameters to profiled values</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   <a class="code" href="classRooArgSet.html">RooArgSet</a> *poiAndNuisance = <span class="keyword">new</span> <a class="code" href="classRooArgSet.html">RooArgSet</a>();</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <span class="keywordflow">if</span> (mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>())</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      poiAndNuisance-&gt;<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>());</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   poiAndNuisance-&gt;<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>());</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   w-&gt;<a class="code" href="classRooWorkspace.html#ac7892f937bf7e2135f4b318897a9b4e9">saveSnapshot</a>(<span class="stringliteral">&quot;paramsToGenerateData&quot;</span>, *poiAndNuisance);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   <a class="code" href="classRooArgSet.html">RooArgSet</a> *paramsToGenerateData = (<a class="code" href="classRooArgSet.html">RooArgSet</a> *)poiAndNuisance-&gt;<a class="code" href="classRooArgSet.html#a3b35aea24edd191f95e24ec17d0fdb35">snapshot</a>();</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;\nWill use these parameter points to generate pseudo data for bkg only&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   paramsToGenerateData-&gt;<a class="code" href="classRooAbsCollection.html#ab988655a6fe646baa9c6a6b5456c3aa0">Print</a>(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   <a class="code" href="classRooArgSet.html">RooArgSet</a> unconditionalObs;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   unconditionalObs.<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a658c1a5b9ba572686d72acf76587e913">GetObservables</a>());</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   unconditionalObs.<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>()); <span class="comment">// comment this out for the original conditional ensemble</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   <span class="keywordtype">double</span> CLb = 0;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   <span class="keywordtype">double</span> CLbinclusive = 0;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   <span class="comment">// Now we generate background only and find distribution of upper limits</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   <a class="code" href="classTH1F.html">TH1F</a> *histOfUL = <span class="keyword">new</span> <a class="code" href="classTH1F.html">TH1F</a>(<span class="stringliteral">&quot;histOfUL&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 100, 0, firstPOI-&gt;<a class="code" href="classRooAbsRealLValue.html#a07d826bfa29ecd48e8e31ed28bd0bc48">getMax</a>());</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   histOfUL-&gt;<a class="code" href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">GetXaxis</a>()-&gt;<a class="code" href="classTNamed.html#a72f4d419b48a5fbfef07485b335139ca">SetTitle</a>(<span class="stringliteral">&quot;Upper Limit (background only)&quot;</span>);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   histOfUL-&gt;<a class="code" href="classTH1.html#a5cadfed83a4db70b4eae6b0a1cea3532">GetYaxis</a>()-&gt;<a class="code" href="classTNamed.html#a72f4d419b48a5fbfef07485b335139ca">SetTitle</a>(<span class="stringliteral">&quot;Entries&quot;</span>);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> imc = 0; imc &lt; nToyMC; ++imc) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="comment">// set parameters back to values for generating pseudo data</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="comment">//    cout &lt;&lt; &quot;\n get current nuis, set vals, print again&quot; &lt;&lt; endl;</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      w-&gt;<a class="code" href="classRooWorkspace.html#ac8768aaaa04a55beaafbdcc4c074b728">loadSnapshot</a>(<span class="stringliteral">&quot;paramsToGenerateData&quot;</span>);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="comment">//    poiAndNuisance-&gt;Print(&quot;v&quot;);</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <a class="code" href="classRooDataSet.html">RooDataSet</a> *toyData = 0;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="comment">// now generate a toy dataset for the main measurement</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">if</span> (!mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#a69d77200d6313129397ac2aa8deef408">canBeExtended</a>()) {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;         <span class="keywordflow">if</span> (data-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>() == 1)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            toyData = mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#aff9a0b0fd2e1cab5124bd0d209ecbb18">generate</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a658c1a5b9ba572686d72acf76587e913">GetObservables</a>(), 1);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;Not sure what to do about this model&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;         <span class="comment">//      cout &lt;&lt; &quot;generating extended dataset&quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;         toyData = mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#aff9a0b0fd2e1cab5124bd0d209ecbb18">generate</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a658c1a5b9ba572686d72acf76587e913">GetObservables</a>(), <a class="code" href="namespaceRooFit.html#a5b78dee63fd4e5fcdb5e8992f726cfc8">Extended</a>());</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="comment">// generate global observables</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="comment">// need to be careful for simpdf.</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="comment">// In ROOT 5.28 there is a problem with generating global observables</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="comment">// with a simultaneous PDF.  In 5.29 there is a solution with</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="comment">// RooSimultaneous::generateSimGlobal, but this may change to</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="comment">// the standard generate interface in 5.30.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <a class="code" href="classRooSimultaneous.html">RooSimultaneous</a> *simPdf = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classRooSimultaneous.html">RooSimultaneous</a> *<span class="keyword">&gt;</span>(mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>());</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">if</span> (!simPdf) {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;         <a class="code" href="classRooDataSet.html">RooDataSet</a> *one = mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#aff9a0b0fd2e1cab5124bd0d209ecbb18">generate</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>(), 1);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;         <span class="keyword">const</span> <a class="code" href="classRooArgSet.html">RooArgSet</a> *values = one-&gt;<a class="code" href="classRooDataSet.html#a2d2355b7a32be47b906312f113ee75c0">get</a>();</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;         <a class="code" href="classRooArgSet.html">RooArgSet</a> *allVars = mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsArg.html#a84863f9944bb01b6614a0898cab944e8">getVariables</a>();</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;         *allVars = *values;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;         <span class="keyword">delete</span> allVars;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;         <span class="keyword">delete</span> one;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;         <a class="code" href="classRooDataSet.html">RooDataSet</a> *one = simPdf-&gt;<a class="code" href="classRooSimultaneous.html#a3148b10cf457130f12c0102644a8d5f5">generateSimGlobal</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>(), 1);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;         <span class="keyword">const</span> <a class="code" href="classRooArgSet.html">RooArgSet</a> *values = one-&gt;<a class="code" href="classRooDataSet.html#a2d2355b7a32be47b906312f113ee75c0">get</a>();</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;         <a class="code" href="classRooArgSet.html">RooArgSet</a> *allVars = mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsArg.html#a84863f9944bb01b6614a0898cab944e8">getVariables</a>();</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;         *allVars = *values;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;         <span class="keyword">delete</span> allVars;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;         <span class="keyword">delete</span> one;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="comment">// get test stat at observed UL in observed data</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      firstPOI-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(observedUL);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keywordtype">double</span> toyTSatObsUL = <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetTestStatSampler()-&gt;EvaluateTestStatistic(*toyData, tmpPOI);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="comment">//    toyData-&gt;get()-&gt;Print(&quot;v&quot;);</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="comment">//    cout &lt;&lt;&quot;obsTSatObsUL &quot; &lt;&lt;obsTSatObsUL &lt;&lt; &quot;toyTS &quot; &lt;&lt; toyTSatObsUL &lt;&lt; endl;</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">if</span> (obsTSatObsUL &lt; toyTSatObsUL) <span class="comment">// not sure about &lt;= part yet</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;         CLb += (1.) / nToyMC;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordflow">if</span> (obsTSatObsUL &lt;= toyTSatObsUL) <span class="comment">// not sure about &lt;= part yet</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;         CLbinclusive += (1.) / nToyMC;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="comment">// loop over points in belt to find upper limit for this toy data</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordtype">double</span> thisUL = 0;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0; i &lt; parameterScan-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>(); ++i) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;         tmpPoint = (<a class="code" href="classRooArgSet.html">RooArgSet</a> *)parameterScan-&gt;<a class="code" href="classRooDataSet.html#a2d2355b7a32be47b906312f113ee75c0">get</a>(i)-&gt;<a class="code" href="classRooArgSet.html#a693748866f98afb0b4e9efd40de6b405">clone</a>(<span class="stringliteral">&quot;temp&quot;</span>);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;         <span class="keywordtype">double</span> arMax = belt-&gt;<a class="code" href="classRooStats_1_1ConfidenceBelt.html#ad465a9878549db5398cabbffb57ff7fb">GetAcceptanceRegionMax</a>(*tmpPoint);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;         firstPOI-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(tmpPoint-&gt;<a class="code" href="classRooArgSet.html#a72568bf2b2726891810ba3b3e8251f0b">getRealValue</a>(firstPOI-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>()));</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;         <span class="comment">//   double thisTS = profile-&gt;getVal();</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;         <span class="keywordtype">double</span> thisTS = <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetTestStatSampler()-&gt;EvaluateTestStatistic(*toyData, tmpPOI);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;         <span class="comment">//   cout &lt;&lt; &quot;poi = &quot; &lt;&lt; firstPOI-&gt;getVal()</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;         <span class="comment">// &lt;&lt; &quot; max is &quot; &lt;&lt; arMax &lt;&lt; &quot; this profile = &quot; &lt;&lt; thisTS &lt;&lt; endl;</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;         <span class="comment">//      cout &lt;&lt; &quot;thisTS = &quot; &lt;&lt; thisTS&lt;&lt;endl;</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;         <span class="keywordflow">if</span> (thisTS &lt;= arMax) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            thisUL = firstPOI-&gt;<a class="code" href="classRooAbsReal.html#a8881da431598c6d15e06cc80518d323d">getVal</a>();</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;         }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      histOfUL-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(thisUL);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="comment">// for few events, data is often the same, and UL is often the same</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="comment">//    cout &lt;&lt; &quot;thisUL = &quot; &lt;&lt; thisUL&lt;&lt;endl;</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keyword">delete</span> toyData;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   histOfUL-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;SaveAs(<span class="stringliteral">&quot;two-sided_upper_limit_output.pdf&quot;</span>);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <span class="comment">// if you want to see a plot of the sampling distribution for a particular scan point:</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">   SamplingDistPlot sampPlot;</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">   int indexInScan = 0;</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">   tmpPoint = (RooArgSet*) parameterScan-&gt;get(indexInScan)-&gt;clone(&quot;temp&quot;);</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">   firstPOI-&gt;setVal( tmpPoint-&gt;getRealValue(firstPOI-&gt;GetName()) );</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">   toymcsampler-&gt;SetParametersForTestStat(tmpPOI);</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">   SamplingDistribution* samp = toymcsampler-&gt;GetSamplingDistribution(*tmpPoint);</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">   sampPlot.AddSamplingDistribution(samp);</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">   sampPlot.Draw();</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   <span class="comment">// Now find bands and power constraint</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *bins = histOfUL-&gt;<a class="code" href="classTH1.html#ac16748d3e7ba02e47772cd2eecdcbbbb">GetIntegral</a>();</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <a class="code" href="classTH1F.html">TH1F</a> *cumulative = (<a class="code" href="classTH1F.html">TH1F</a> *)histOfUL-&gt;<a class="code" href="classTH1.html#a61f001c11f9b4a6dabc96af989009c40">Clone</a>(<span class="stringliteral">&quot;cumulative&quot;</span>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   cumulative-&gt;<a class="code" href="classTH1.html#a828aa3b97264611a20c3849e1820b28b">SetContent</a>(bins);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keywordtype">double</span> band2sigDown = 0, band1sigDown = 0, bandMedian = 0, band1sigUp = 0, band2sigUp = 0;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= cumulative-&gt;<a class="code" href="classTH1.html#a68ac42aeb65a689b5b32e1865b4dfd13">GetNbinsX</a>(); ++i) {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordflow">if</span> (bins[i] &lt; <a class="code" href="namespaceRooStats.html#af3f5718b59a3add827d2d3b322e4d5d3">RooStats::SignificanceToPValue</a>(2))</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;         band2sigDown = cumulative-&gt;<a class="code" href="classTH1.html#a0ee88e02b75d885985097dcde0a9eaa1">GetBinCenter</a>(i);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordflow">if</span> (bins[i] &lt; <a class="code" href="namespaceRooStats.html#af3f5718b59a3add827d2d3b322e4d5d3">RooStats::SignificanceToPValue</a>(1))</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;         band1sigDown = cumulative-&gt;<a class="code" href="classTH1.html#a0ee88e02b75d885985097dcde0a9eaa1">GetBinCenter</a>(i);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">if</span> (bins[i] &lt; 0.5)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;         bandMedian = cumulative-&gt;<a class="code" href="classTH1.html#a0ee88e02b75d885985097dcde0a9eaa1">GetBinCenter</a>(i);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">if</span> (bins[i] &lt; <a class="code" href="namespaceRooStats.html#af3f5718b59a3add827d2d3b322e4d5d3">RooStats::SignificanceToPValue</a>(-1))</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;         band1sigUp = cumulative-&gt;<a class="code" href="classTH1.html#a0ee88e02b75d885985097dcde0a9eaa1">GetBinCenter</a>(i);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keywordflow">if</span> (bins[i] &lt; <a class="code" href="namespaceRooStats.html#af3f5718b59a3add827d2d3b322e4d5d3">RooStats::SignificanceToPValue</a>(-2))</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;         band2sigUp = cumulative-&gt;<a class="code" href="classTH1.html#a0ee88e02b75d885985097dcde0a9eaa1">GetBinCenter</a>(i);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;-2 sigma  band &quot;</span> &lt;&lt; band2sigDown &lt;&lt; endl;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;-1 sigma  band &quot;</span> &lt;&lt; band1sigDown &lt;&lt; <span class="stringliteral">&quot; [Power Constraint)]&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;median of band &quot;</span> &lt;&lt; bandMedian &lt;&lt; endl;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;+1 sigma  band &quot;</span> &lt;&lt; band1sigUp &lt;&lt; endl;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;+2 sigma  band &quot;</span> &lt;&lt; band2sigUp &lt;&lt; endl;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <span class="comment">// print out the interval on the first Parameter of Interest</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;\nobserved 95% upper-limit &quot;</span> &lt;&lt; interval-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#a8c43f888bbc5ba55ec8553a0506dcfc6">UpperLimit</a>(*firstPOI) &lt;&lt; endl;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;CLb strict [P(toy&gt;obs|0)] for observed 95% upper-limit &quot;</span> &lt;&lt; CLb &lt;&lt; endl;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;CLb inclusive [P(toy&gt;=obs|0)] for observed 95% upper-limit &quot;</span> &lt;&lt; CLbinclusive &lt;&lt; endl;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   <span class="keyword">delete</span> profile;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   <span class="keyword">delete</span> nll;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;}</div><div class="ttc" id="classRooAbsPdf_html_a44f3ac4e956a5ba4abb0b74841f22704"><div class="ttname"><a href="classRooAbsPdf.html#a44f3ac4e956a5ba4abb0b74841f22704">RooAbsPdf::createNLL</a></div><div class="ttdeci">virtual RooAbsReal * createNLL(RooAbsData &amp;data, const RooLinkedList &amp;cmdList)</div><div class="ttdoc">Construct representation of -log(L) of PDFwith given dataset. </div><div class="ttdef"><b>Definition:</b> <a href="RooAbsPdf_8cxx_source.html#l00800">RooAbsPdf.cxx:800</a></div></div>
<div class="ttc" id="classRooAbsRealLValue_html_af16e9d798cdd32874357e57430803a82"><div class="ttname"><a href="classRooAbsRealLValue.html#af16e9d798cdd32874357e57430803a82">RooAbsRealLValue::getMin</a></div><div class="ttdeci">virtual Double_t getMin(const char *name=0) const</div><div class="ttdoc">Get miniminum of currently defined range. </div><div class="ttdef"><b>Definition:</b> <a href="RooAbsRealLValue_8h_source.html#l00079">RooAbsRealLValue.h:79</a></div></div>
<div class="ttc" id="classRooAbsArg_html_a84863f9944bb01b6614a0898cab944e8"><div class="ttname"><a href="classRooAbsArg.html#a84863f9944bb01b6614a0898cab944e8">RooAbsArg::getVariables</a></div><div class="ttdeci">RooArgSet * getVariables(Bool_t stripDisconnected=kTRUE) const</div><div class="ttdoc">Return RooArgSet with all variables (tree leaf nodes of expresssion tree) </div><div class="ttdef"><b>Definition:</b> <a href="RooAbsArg_8cxx_source.html#l02009">RooAbsArg.cxx:2009</a></div></div>
<div class="ttc" id="classTNamed_html_a42e3142d30b08fed1b07216d4a36b090"><div class="ttname"><a href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">TNamed::GetName</a></div><div class="ttdeci">virtual const char * GetName() const</div><div class="ttdoc">Returns name of object. </div><div class="ttdef"><b>Definition:</b> <a href="TNamed_8h_source.html#l00047">TNamed.h:47</a></div></div>
<div class="ttc" id="classTSystem_html_a849c28ea0dd3b3aa3310a4d447c7b21a"><div class="ttname"><a href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">TSystem::AccessPathName</a></div><div class="ttdeci">virtual Bool_t AccessPathName(const char *path, EAccessMode mode=kFileExists)</div><div class="ttdoc">Returns FALSE if one can access a file using the specified access mode. </div><div class="ttdef"><b>Definition:</b> <a href="TSystem_8cxx_source.html#l01278">TSystem.cxx:1278</a></div></div>
<div class="ttc" id="classRooWorkspace_html_ac7892f937bf7e2135f4b318897a9b4e9"><div class="ttname"><a href="classRooWorkspace.html#ac7892f937bf7e2135f4b318897a9b4e9">RooWorkspace::saveSnapshot</a></div><div class="ttdeci">Bool_t saveSnapshot(const char *name, const char *paramNames)</div><div class="ttdoc">Save snapshot of values and attributes (including &quot;Constant&quot;) of parameters &amp;#39;params&amp;#39; If importValues ...</div><div class="ttdef"><b>Definition:</b> <a href="RooWorkspace_8cxx_source.html#l01185">RooWorkspace.cxx:1185</a></div></div>
<div class="ttc" id="classRooAbsPdf_html_aff9a0b0fd2e1cab5124bd0d209ecbb18"><div class="ttname"><a href="classRooAbsPdf.html#aff9a0b0fd2e1cab5124bd0d209ecbb18">RooAbsPdf::generate</a></div><div class="ttdeci">RooDataSet * generate(const RooArgSet &amp;whatVars, Int_t nEvents, const RooCmdArg &amp;arg1, const RooCmdArg &amp;arg2=RooCmdArg::none(), const RooCmdArg &amp;arg3=RooCmdArg::none(), const RooCmdArg &amp;arg4=RooCmdArg::none(), const RooCmdArg &amp;arg5=RooCmdArg::none())</div><div class="ttdoc">See RooAbsPdf::generate(const RooArgSet&amp;,const RooCmdArg&amp;,const RooCmdArg&amp;,const RooCmdArg&amp;,const RooCmdArg&amp;,const RooCmdArg&amp;,const RooCmdArg&amp;) </div><div class="ttdef"><b>Definition:</b> <a href="RooAbsPdf_8h_source.html#l00056">RooAbsPdf.h:56</a></div></div>
<div class="ttc" id="classTH1_html_a77e71290a82517d317ea8d05e96b6c4a"><div class="ttname"><a href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">TH1::Fill</a></div><div class="ttdeci">virtual Int_t Fill(Double_t x)</div><div class="ttdoc">Increment bin with abscissa X by 1. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l03258">TH1.cxx:3258</a></div></div>
<div class="ttc" id="classRooStats_1_1ProofConfig_html"><div class="ttname"><a href="classRooStats_1_1ProofConfig.html">RooStats::ProofConfig</a></div><div class="ttdoc">Holds configuration options for proof and proof-lite. </div><div class="ttdef"><b>Definition:</b> <a href="ProofConfig_8h_source.html#l00046">ProofConfig.h:46</a></div></div>
<div class="ttc" id="classTH1_html_a0ee88e02b75d885985097dcde0a9eaa1"><div class="ttname"><a href="classTH1.html#a0ee88e02b75d885985097dcde0a9eaa1">TH1::GetBinCenter</a></div><div class="ttdeci">virtual Double_t GetBinCenter(Int_t bin) const</div><div class="ttdoc">Return bin center for 1D histogram. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l08554">TH1.cxx:8554</a></div></div>
<div class="ttc" id="classRooStats_1_1ModelConfig_html"><div class="ttname"><a href="classRooStats_1_1ModelConfig.html">RooStats::ModelConfig</a></div><div class="ttdoc">ModelConfig is a simple class that holds configuration information specifying how a model should be u...</div><div class="ttdef"><b>Definition:</b> <a href="ModelConfig_8h_source.html#l00030">ModelConfig.h:30</a></div></div>
<div class="ttc" id="classRooStats_1_1ModelConfig_html_a658c1a5b9ba572686d72acf76587e913"><div class="ttname"><a href="classRooStats_1_1ModelConfig.html#a658c1a5b9ba572686d72acf76587e913">RooStats::ModelConfig::GetObservables</a></div><div class="ttdeci">const RooArgSet * GetObservables() const</div><div class="ttdoc">get RooArgSet for observables (return NULL if not existing) </div><div class="ttdef"><b>Definition:</b> <a href="ModelConfig_8h_source.html#l00243">ModelConfig.h:243</a></div></div>
<div class="ttc" id="classRooAbsRealLValue_html_a07d826bfa29ecd48e8e31ed28bd0bc48"><div class="ttname"><a href="classRooAbsRealLValue.html#a07d826bfa29ecd48e8e31ed28bd0bc48">RooAbsRealLValue::getMax</a></div><div class="ttdeci">virtual Double_t getMax(const char *name=0) const</div><div class="ttdoc">Get maximum of currently defined range. </div><div class="ttdef"><b>Definition:</b> <a href="RooAbsRealLValue_8h_source.html#l00082">RooAbsRealLValue.h:82</a></div></div>
<div class="ttc" id="classRooArgSet_html_abbf07d101f0bce2a8b43545e336bd08c"><div class="ttname"><a href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">RooArgSet::add</a></div><div class="ttdeci">virtual Bool_t add(const RooAbsCollection &amp;col, Bool_t silent=kFALSE)</div><div class="ttdoc">Add a collection of arguments to this collection by calling add() for each element in the source coll...</div><div class="ttdef"><b>Definition:</b> <a href="RooArgSet_8h_source.html#l00088">RooArgSet.h:88</a></div></div>
<div class="ttc" id="RooAbsData_8h_html"><div class="ttname"><a href="RooAbsData_8h.html">RooAbsData.h</a></div></div>
<div class="ttc" id="classRooStats_1_1ToyMCSampler_html_aa838b03fde977cb8363cdacf1cf9c56f"><div class="ttname"><a href="classRooStats_1_1ToyMCSampler.html#aa838b03fde977cb8363cdacf1cf9c56f">RooStats::ToyMCSampler::SetGlobalObservables</a></div><div class="ttdeci">virtual void SetGlobalObservables(const RooArgSet &amp;o)</div><div class="ttdef"><b>Definition:</b> <a href="ToyMCSampler_8h_source.html#l00175">ToyMCSampler.h:175</a></div></div>
<div class="ttc" id="legend1_8C_html_a1259eec59a19080ae1da77e79182c60e"><div class="ttname"><a href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a></div><div class="ttdeci">return c1</div><div class="ttdef"><b>Definition:</b> <a href="legend1_8C_source.html#l00041">legend1.C:41</a></div></div>
<div class="ttc" id="classRooArgSet_html"><div class="ttname"><a href="classRooArgSet.html">RooArgSet</a></div><div class="ttdoc">RooArgSet is a container object that can hold multiple RooAbsArg objects. </div><div class="ttdef"><b>Definition:</b> <a href="RooArgSet_8h_source.html#l00028">RooArgSet.h:28</a></div></div>
<div class="ttc" id="classTFile_html"><div class="ttname"><a href="classTFile.html">TFile</a></div><div class="ttdoc">A ROOT file is a suite of consecutive data records (TKey instances) with a well defined format...</div><div class="ttdef"><b>Definition:</b> <a href="TFile_8h_source.html#l00048">TFile.h:48</a></div></div>
<div class="ttc" id="classTH1_html_a89a5d8fc84154b504566f367ba8d0238"><div class="ttname"><a href="classTH1.html#a89a5d8fc84154b504566f367ba8d0238">TH1::SetMinimum</a></div><div class="ttdeci">virtual void SetMinimum(Double_t minimum=-1111)</div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00395">TH1.h:395</a></div></div>
<div class="ttc" id="TROOT_8h_html_a851dd11b3478372a25ba6eff6dcfa5b1"><div class="ttname"><a href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a></div><div class="ttdeci">#define gROOT</div><div class="ttdef"><b>Definition:</b> <a href="TROOT_8h_source.html#l00413">TROOT.h:413</a></div></div>
<div class="ttc" id="TFile_8h_html"><div class="ttname"><a href="TFile_8h.html">TFile.h</a></div></div>
<div class="ttc" id="classTH1F_html"><div class="ttname"><a href="classTH1F.html">TH1F</a></div><div class="ttdoc">1-D histogram with a float per channel (see TH1 documentation)} </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00571">TH1.h:571</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_a3885b911a54b47a4e61671f45dd45d0b"><div class="ttname"><a href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a></div><div class="ttdeci">int Int_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00041">RtypesCore.h:41</a></div></div>
<div class="ttc" id="ConfidenceBelt_8h_html"><div class="ttname"><a href="ConfidenceBelt_8h.html">ConfidenceBelt.h</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="classRooStats_1_1ToyMCSampler_html_a4290c66879dd450673e16265fbc2caa6"><div class="ttname"><a href="classRooStats_1_1ToyMCSampler.html#a4290c66879dd450673e16265fbc2caa6">RooStats::ToyMCSampler::GetTestStatistic</a></div><div class="ttdeci">virtual TestStatistic * GetTestStatistic(unsigned int i) const</div><div class="ttdef"><b>Definition:</b> <a href="ToyMCSampler_8h_source.html#l00132">ToyMCSampler.h:132</a></div></div>
<div class="ttc" id="ProfileLikelihoodTestStat_8h_html"><div class="ttname"><a href="ProfileLikelihoodTestStat_8h.html">ProfileLikelihoodTestStat.h</a></div></div>
<div class="ttc" id="namespaceRooFit_html_a5b78dee63fd4e5fcdb5e8992f726cfc8"><div class="ttname"><a href="namespaceRooFit.html#a5b78dee63fd4e5fcdb5e8992f726cfc8">RooFit::Extended</a></div><div class="ttdeci">RooCmdArg Extended(Bool_t flag=kTRUE)</div><div class="ttdef"><b>Definition:</b> <a href="RooGlobalFunc_8cxx_source.html#l00154">RooGlobalFunc.cxx:154</a></div></div>
<div class="ttc" id="civetweb_8c_html_a4d1e08e68d8456f97fbfe21f3e3c85bd"><div class="ttname"><a href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a></div><div class="ttdeci">static struct mg_connection * fc(struct mg_context *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="civetweb_8c_source.html#l03728">civetweb.c:3728</a></div></div>
<div class="ttc" id="classRooStats_1_1ModelConfig_html_ab2661258bee58609834f02ab52b1e634"><div class="ttname"><a href="classRooStats_1_1ModelConfig.html#ab2661258bee58609834f02ab52b1e634">RooStats::ModelConfig::Print</a></div><div class="ttdeci">virtual void Print(Option_t *option=&quot;&quot;) const override</div><div class="ttdoc">overload the print method </div><div class="ttdef"><b>Definition:</b> <a href="ModelConfig_8cxx_source.html#l00101">ModelConfig.cxx:101</a></div></div>
<div class="ttc" id="TSystem_8h_html"><div class="ttname"><a href="TSystem_8h.html">TSystem.h</a></div></div>
<div class="ttc" id="namespaceRooFit_html"><div class="ttname"><a href="namespaceRooFit.html">RooFit</a></div><div class="ttdoc">Template specialisation used in RooAbsArg: </div><div class="ttdef"><b>Definition:</b> <a href="RooCFunction1Binding_8h_source.html#l00029">RooCFunction1Binding.h:29</a></div></div>
<div class="ttc" id="RooStatsUtils_8h_html"><div class="ttname"><a href="RooStatsUtils_8h.html">RooStatsUtils.h</a></div></div>
<div class="ttc" id="classRooStats_1_1ConfidenceBelt_html"><div class="ttname"><a href="classRooStats_1_1ConfidenceBelt.html">RooStats::ConfidenceBelt</a></div><div class="ttdoc">ConfidenceBelt is a concrete implementation of the ConfInterval interface. </div><div class="ttdef"><b>Definition:</b> <a href="ConfidenceBelt_8h_source.html#l00156">ConfidenceBelt.h:156</a></div></div>
<div class="ttc" id="TCanvas_8h_html"><div class="ttname"><a href="TCanvas_8h.html">TCanvas.h</a></div></div>
<div class="ttc" id="classRooAbsCollection_html_ab988655a6fe646baa9c6a6b5456c3aa0"><div class="ttname"><a href="classRooAbsCollection.html#ab988655a6fe646baa9c6a6b5456c3aa0">RooAbsCollection::Print</a></div><div class="ttdeci">virtual void Print(Option_t *options=0) const</div><div class="ttdoc">This method must be overridden when a class wants to print itself. </div><div class="ttdef"><b>Definition:</b> <a href="RooAbsCollection_8h_source.html#l00167">RooAbsCollection.h:167</a></div></div>
<div class="ttc" id="classTH1_html_a828aa3b97264611a20c3849e1820b28b"><div class="ttname"><a href="classTH1.html#a828aa3b97264611a20c3849e1820b28b">TH1::SetContent</a></div><div class="ttdeci">virtual void SetContent(const Double_t *content)</div><div class="ttdoc">Replace bin contents by the contents of array content. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l07820">TH1.cxx:7820</a></div></div>
<div class="ttc" id="namespaceRooStats_html_af3f5718b59a3add827d2d3b322e4d5d3"><div class="ttname"><a href="namespaceRooStats.html#af3f5718b59a3add827d2d3b322e4d5d3">RooStats::SignificanceToPValue</a></div><div class="ttdeci">Double_t SignificanceToPValue(Double_t Z)</div><div class="ttdoc">returns p-value corresponding to a 1-sided significance </div><div class="ttdef"><b>Definition:</b> <a href="RooStatsUtils_8h_source.html#l00049">RooStatsUtils.h:49</a></div></div>
<div class="ttc" id="classRooArgSet_html_a693748866f98afb0b4e9efd40de6b405"><div class="ttname"><a href="classRooArgSet.html#a693748866f98afb0b4e9efd40de6b405">RooArgSet::clone</a></div><div class="ttdeci">virtual TObject * clone(const char *newname) const</div><div class="ttdef"><b>Definition:</b> <a href="RooArgSet_8h_source.html#l00084">RooArgSet.h:84</a></div></div>
<div class="ttc" id="classRooRealVar_html"><div class="ttname"><a href="classRooRealVar.html">RooRealVar</a></div><div class="ttdoc">RooRealVar represents a fundamental (non-derived) real valued object. </div><div class="ttdef"><b>Definition:</b> <a href="RooRealVar_8h_source.html#l00036">RooRealVar.h:36</a></div></div>
<div class="ttc" id="classRooWorkspace_html_a2e0683ca1b7375eaa434a9cc1298e736"><div class="ttname"><a href="classRooWorkspace.html#a2e0683ca1b7375eaa434a9cc1298e736">RooWorkspace::data</a></div><div class="ttdeci">RooAbsData * data(const char *name) const</div><div class="ttdoc">Retrieve dataset (binned or unbinned) with given name. A null pointer is returned if not found...</div><div class="ttdef"><b>Definition:</b> <a href="RooWorkspace_8cxx_source.html#l01391">RooWorkspace.cxx:1391</a></div></div>
<div class="ttc" id="ToyMCSampler_8h_html"><div class="ttname"><a href="ToyMCSampler_8h.html">ToyMCSampler.h</a></div></div>
<div class="ttc" id="classRooRealVar_html_af248c231ad6b7f3ad854ca12197cec48"><div class="ttname"><a href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">RooRealVar::setVal</a></div><div class="ttdeci">virtual void setVal(Double_t value)</div><div class="ttdoc">Set value of variable to &amp;#39;value&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="RooRealVar_8cxx_source.html#l00204">RooRealVar.cxx:204</a></div></div>
<div class="ttc" id="classRooStats_1_1PointSetInterval_html_aa221cea064f8013ff5f7fde218a226e3"><div class="ttname"><a href="classRooStats_1_1PointSetInterval.html#aa221cea064f8013ff5f7fde218a226e3">RooStats::PointSetInterval::LowerLimit</a></div><div class="ttdeci">Double_t LowerLimit(RooRealVar &amp;param)</div><div class="ttdoc">return lower limit on a given parameter </div><div class="ttdef"><b>Definition:</b> <a href="PointSetInterval_8cxx_source.html#l00160">PointSetInterval.cxx:160</a></div></div>
<div class="ttc" id="classTH1_html_ac16748d3e7ba02e47772cd2eecdcbbbb"><div class="ttname"><a href="classTH1.html#ac16748d3e7ba02e47772cd2eecdcbbbb">TH1::GetIntegral</a></div><div class="ttdeci">virtual Double_t * GetIntegral()</div><div class="ttdoc">Return a pointer to the array of bins integral. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l02522">TH1.cxx:2522</a></div></div>
<div class="ttc" id="TSystem_8h_html_ab7182c9ab5a9236e2bc1ed8b3fcb045f"><div class="ttname"><a href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a></div><div class="ttdeci">R__EXTERN TSystem * gSystem</div><div class="ttdef"><b>Definition:</b> <a href="TSystem_8h_source.html#l00560">TSystem.h:560</a></div></div>
<div class="ttc" id="classTH1_html_aa53a024a9e94d5ec91e3ef49e49563da"><div class="ttname"><a href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">TH1::Draw</a></div><div class="ttdeci">virtual void Draw(Option_t *option=&quot;&quot;)</div><div class="ttdoc">Draw this histogram with options. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l02981">TH1.cxx:2981</a></div></div>
<div class="ttc" id="namespaceTGeant4Unit_html_a9b9c22ca28407dfecdc404f99df537bb"><div class="ttname"><a href="namespaceTGeant4Unit.html#a9b9c22ca28407dfecdc404f99df537bb">TGeant4Unit::pc</a></div><div class="ttdeci">static constexpr double pc</div><div class="ttdef"><b>Definition:</b> <a href="TGeant4SystemOfUnits_8h_source.html#l00130">TGeant4SystemOfUnits.h:130</a></div></div>
<div class="ttc" id="TROOT_8h_html"><div class="ttname"><a href="TROOT_8h.html">TROOT.h</a></div></div>
<div class="ttc" id="classRooAbsCollection_html_a225c780c4c32077d6923e956225e437a"><div class="ttname"><a href="classRooAbsCollection.html#a225c780c4c32077d6923e956225e437a">RooAbsCollection::first</a></div><div class="ttdeci">RooAbsArg * first() const</div><div class="ttdef"><b>Definition:</b> <a href="RooAbsCollection_8h_source.html#l00158">RooAbsCollection.h:158</a></div></div>
<div class="ttc" id="ModelConfig_8h_html"><div class="ttname"><a href="ModelConfig_8h.html">ModelConfig.h</a></div></div>
<div class="ttc" id="classRooAbsReal_html_a8881da431598c6d15e06cc80518d323d"><div class="ttname"><a href="classRooAbsReal.html#a8881da431598c6d15e06cc80518d323d">RooAbsReal::getVal</a></div><div class="ttdeci">Double_t getVal(const RooArgSet *normalisationSet=nullptr) const</div><div class="ttdoc">Evaluate object. </div><div class="ttdef"><b>Definition:</b> <a href="RooAbsReal_8h_source.html#l00080">RooAbsReal.h:80</a></div></div>
<div class="ttc" id="classRooStats_1_1ToyMCSampler_html_a3518c12aaf49b74d3ef58e22b41de58c"><div class="ttname"><a href="classRooStats_1_1ToyMCSampler.html#a3518c12aaf49b74d3ef58e22b41de58c">RooStats::ToyMCSampler::SetProofConfig</a></div><div class="ttdeci">void SetProofConfig(ProofConfig *pc=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="ToyMCSampler_8h_source.html#l00233">ToyMCSampler.h:233</a></div></div>
<div class="ttc" id="PointSetInterval_8h_html"><div class="ttname"><a href="PointSetInterval_8h.html">PointSetInterval.h</a></div></div>
<div class="ttc" id="classTH1_html_a5cadfed83a4db70b4eae6b0a1cea3532"><div class="ttname"><a href="classTH1.html#a5cadfed83a4db70b4eae6b0a1cea3532">TH1::GetYaxis</a></div><div class="ttdeci">TAxis * GetYaxis()</div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00317">TH1.h:317</a></div></div>
<div class="ttc" id="classRooAbsData_html"><div class="ttname"><a href="classRooAbsData.html">RooAbsData</a></div><div class="ttdoc">RooAbsData is the common abstract base class for binned and unbinned datasets. </div><div class="ttdef"><b>Definition:</b> <a href="RooAbsData_8h_source.html#l00037">RooAbsData.h:37</a></div></div>
<div class="ttc" id="classRooWorkspace_html_ac8768aaaa04a55beaafbdcc4c074b728"><div class="ttname"><a href="classRooWorkspace.html#ac8768aaaa04a55beaafbdcc4c074b728">RooWorkspace::loadSnapshot</a></div><div class="ttdeci">Bool_t loadSnapshot(const char *name)</div><div class="ttdoc">Load the values and attributes of the parameters in the snapshot saved with the given name...</div><div class="ttdef"><b>Definition:</b> <a href="RooWorkspace_8cxx_source.html#l01231">RooWorkspace.cxx:1231</a></div></div>
<div class="ttc" id="classRooStats_1_1ProfileLikelihoodTestStat_html"><div class="ttname"><a href="classRooStats_1_1ProfileLikelihoodTestStat.html">RooStats::ProfileLikelihoodTestStat</a></div><div class="ttdoc">ProfileLikelihoodTestStat is an implementation of the TestStatistic interface that calculates the pro...</div><div class="ttdef"><b>Definition:</b> <a href="ProfileLikelihoodTestStat_8h_source.html#l00032">ProfileLikelihoodTestStat.h:32</a></div></div>
<div class="ttc" id="classRooStats_1_1ToyMCSampler_html"><div class="ttname"><a href="classRooStats_1_1ToyMCSampler.html">RooStats::ToyMCSampler</a></div><div class="ttdoc">ToyMCSampler is an implementation of the TestStatSampler interface. </div><div class="ttdef"><b>Definition:</b> <a href="ToyMCSampler_8h_source.html#l00071">ToyMCSampler.h:71</a></div></div>
<div class="ttc" id="classRooDataSet_html"><div class="ttname"><a href="classRooDataSet.html">RooDataSet</a></div><div class="ttdoc">RooDataSet is a container class to hold unbinned data. </div><div class="ttdef"><b>Definition:</b> <a href="RooDataSet_8h_source.html#l00031">RooDataSet.h:31</a></div></div>
<div class="ttc" id="classRooAbsPdf_html_a69d77200d6313129397ac2aa8deef408"><div class="ttname"><a href="classRooAbsPdf.html#a69d77200d6313129397ac2aa8deef408">RooAbsPdf::canBeExtended</a></div><div class="ttdeci">Bool_t canBeExtended() const</div><div class="ttdef"><b>Definition:</b> <a href="RooAbsPdf_8h_source.html#l00230">RooAbsPdf.h:230</a></div></div>
<div class="ttc" id="classRooDataSet_html_a2d2355b7a32be47b906312f113ee75c0"><div class="ttname"><a href="classRooDataSet.html#a2d2355b7a32be47b906312f113ee75c0">RooDataSet::get</a></div><div class="ttdeci">virtual const RooArgSet * get(Int_t index) const</div><div class="ttdoc">Return RooArgSet with coordinates of event &amp;#39;index&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="RooDataSet_8cxx_source.html#l01017">RooDataSet.cxx:1017</a></div></div>
<div class="ttc" id="classRooWorkspace_html_af56548d1c16301ebaf951c452d52f5c3"><div class="ttname"><a href="classRooWorkspace.html#af56548d1c16301ebaf951c452d52f5c3">RooWorkspace::obj</a></div><div class="ttdeci">TObject * obj(const char *name) const</div><div class="ttdoc">Return any type of object (RooAbsArg, RooAbsData or generic object) with given name) ...</div><div class="ttdef"><b>Definition:</b> <a href="RooWorkspace_8cxx_source.html#l02130">RooWorkspace.cxx:2130</a></div></div>
<div class="ttc" id="RooWorkspace_8h_html"><div class="ttname"><a href="RooWorkspace_8h.html">RooWorkspace.h</a></div></div>
<div class="ttc" id="classRooStats_1_1PointSetInterval_html_a8c43f888bbc5ba55ec8553a0506dcfc6"><div class="ttname"><a href="classRooStats_1_1PointSetInterval.html#a8c43f888bbc5ba55ec8553a0506dcfc6">RooStats::PointSetInterval::UpperLimit</a></div><div class="ttdeci">Double_t UpperLimit(RooRealVar &amp;param)</div><div class="ttdoc">return upper limit on a given parameter </div><div class="ttdef"><b>Definition:</b> <a href="PointSetInterval_8cxx_source.html#l00147">PointSetInterval.cxx:147</a></div></div>
<div class="ttc" id="classRooStats_1_1FeldmanCousins_html"><div class="ttname"><a href="classRooStats_1_1FeldmanCousins.html">RooStats::FeldmanCousins</a></div><div class="ttdoc">The FeldmanCousins class (like the Feldman-Cousins technique) is essentially a specific configuration...</div><div class="ttdef"><b>Definition:</b> <a href="FeldmanCousins_8h_source.html#l00034">FeldmanCousins.h:34</a></div></div>
<div class="ttc" id="classRooArgSet_html_a3b35aea24edd191f95e24ec17d0fdb35"><div class="ttname"><a href="classRooArgSet.html#a3b35aea24edd191f95e24ec17d0fdb35">RooArgSet::snapshot</a></div><div class="ttdeci">RooArgSet * snapshot(bool deepCopy=true) const</div><div class="ttdoc">Use RooAbsCollection::snapshot(), but return as RooArgSet. </div><div class="ttdef"><b>Definition:</b> <a href="RooArgSet_8h_source.html#l00134">RooArgSet.h:134</a></div></div>
<div class="ttc" id="classTCanvas_html"><div class="ttname"><a href="classTCanvas.html">TCanvas</a></div><div class="ttdoc">The Canvas class. </div><div class="ttdef"><b>Definition:</b> <a href="TCanvas_8h_source.html#l00031">TCanvas.h:31</a></div></div>
<div class="ttc" id="namespaceRooStats_html"><div class="ttname"><a href="namespaceRooStats.html">RooStats</a></div><div class="ttdoc">Namespace for the RooStats classes. </div><div class="ttdef"><b>Definition:</b> <a href="Asimov_8h_source.html#l00020">Asimov.h:20</a></div></div>
<div class="ttc" id="TH1F_8h_html"><div class="ttname"><a href="TH1F_8h.html">TH1F.h</a></div></div>
<div class="ttc" id="classRooStats_1_1ModelConfig_html_a2341cf8446e32485934d7428f84b2900"><div class="ttname"><a href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">RooStats::ModelConfig::GetPdf</a></div><div class="ttdeci">RooAbsPdf * GetPdf() const</div><div class="ttdoc">get model PDF (return NULL if pdf has not been specified or does not exist) </div><div class="ttdef"><b>Definition:</b> <a href="ModelConfig_8h_source.html#l00228">ModelConfig.h:228</a></div></div>
<div class="ttc" id="classRooStats_1_1ModelConfig_html_ac7cfabdd34b5a35c4252f665d7f132ce"><div class="ttname"><a href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">RooStats::ModelConfig::GetParametersOfInterest</a></div><div class="ttdeci">const RooArgSet * GetParametersOfInterest() const</div><div class="ttdoc">get RooArgSet containing the parameter of interest (return NULL if not existing) </div><div class="ttdef"><b>Definition:</b> <a href="ModelConfig_8h_source.html#l00231">ModelConfig.h:231</a></div></div>
<div class="ttc" id="classRooStats_1_1PointSetInterval_html"><div class="ttname"><a href="classRooStats_1_1PointSetInterval.html">RooStats::PointSetInterval</a></div><div class="ttdoc">PointSetInterval is a concrete implementation of the ConfInterval interface. </div><div class="ttdef"><b>Definition:</b> <a href="PointSetInterval_8h_source.html#l00021">PointSetInterval.h:21</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_ab9b5334647b78ec4256db251e3ae1fc6"><div class="ttname"><a href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a></div><div class="ttdeci">double Double_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00055">RtypesCore.h:55</a></div></div>
<div class="ttc" id="classRooAbsReal_html"><div class="ttname"><a href="classRooAbsReal.html">RooAbsReal</a></div><div class="ttdoc">RooAbsReal is the common abstract base class for objects that represent a real value and implements f...</div><div class="ttdef"><b>Definition:</b> <a href="RooAbsReal_8h_source.html#l00053">RooAbsReal.h:53</a></div></div>
<div class="ttc" id="classTFile_html_aec5f3fae0774aabfc615ebb4b00fe5e0"><div class="ttname"><a href="classTFile.html#aec5f3fae0774aabfc615ebb4b00fe5e0">TFile::Open</a></div><div class="ttdeci">static TFile * Open(const char *name, Option_t *option=&quot;&quot;, const char *ftitle=&quot;&quot;, Int_t compress=ROOT::RCompressionSetting::EDefaults::kUseGeneralPurpose, Int_t netopt=0)</div><div class="ttdoc">Create / open a file. </div><div class="ttdef"><b>Definition:</b> <a href="TFile_8cxx_source.html#l03973">TFile.cxx:3973</a></div></div>
<div class="ttc" id="classRooSimultaneous_html_a3148b10cf457130f12c0102644a8d5f5"><div class="ttname"><a href="classRooSimultaneous.html#a3148b10cf457130f12c0102644a8d5f5">RooSimultaneous::generateSimGlobal</a></div><div class="ttdeci">virtual RooDataSet * generateSimGlobal(const RooArgSet &amp;whatVars, Int_t nEvents)</div><div class="ttdoc">Special generator interface for generation of &amp;#39;global observables&amp;#39; – for RooStats tools...</div><div class="ttdef"><b>Definition:</b> <a href="RooSimultaneous_8cxx_source.html#l01129">RooSimultaneous.cxx:1129</a></div></div>
<div class="ttc" id="RooSimultaneous_8h_html"><div class="ttname"><a href="RooSimultaneous_8h.html">RooSimultaneous.h</a></div></div>
<div class="ttc" id="classRooStats_1_1ModelConfig_html_a97a9dc6d7758e6c08bd54234462f0539"><div class="ttname"><a href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">RooStats::ModelConfig::GetGlobalObservables</a></div><div class="ttdeci">const RooArgSet * GetGlobalObservables() const</div><div class="ttdoc">get RooArgSet for global observables (return NULL if not existing) </div><div class="ttdef"><b>Definition:</b> <a href="ModelConfig_8h_source.html#l00249">ModelConfig.h:249</a></div></div>
<div class="ttc" id="namespacefile_html"><div class="ttname"><a href="namespacefile.html">file</a></div><div class="ttdef"><b>Definition:</b> <a href="file_8py_source.html#l00001">file.py:1</a></div></div>
<div class="ttc" id="classRooStats_1_1ModelConfig_html_a71662b373fbf8bb1c0e41d069f786f42"><div class="ttname"><a href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">RooStats::ModelConfig::GetNuisanceParameters</a></div><div class="ttdeci">const RooArgSet * GetNuisanceParameters() const</div><div class="ttdoc">get RooArgSet containing the nuisance parameters (return NULL if not existing) </div><div class="ttdef"><b>Definition:</b> <a href="ModelConfig_8h_source.html#l00234">ModelConfig.h:234</a></div></div>
<div class="ttc" id="classRooArgSet_html_a72568bf2b2726891810ba3b3e8251f0b"><div class="ttname"><a href="classRooArgSet.html#a72568bf2b2726891810ba3b3e8251f0b">RooArgSet::getRealValue</a></div><div class="ttdeci">Double_t getRealValue(const char *name, Double_t defVal=0, Bool_t verbose=kFALSE) const</div><div class="ttdoc">Get value of a RooAbsReal stored in set with given name. </div><div class="ttdef"><b>Definition:</b> <a href="RooArgSet_8cxx_source.html#l00472">RooArgSet.cxx:472</a></div></div>
<div class="ttc" id="classRooAbsReal_html_a391d1fa138cca9d2ccc3cb80f26944a3"><div class="ttname"><a href="classRooAbsReal.html#a391d1fa138cca9d2ccc3cb80f26944a3">RooAbsReal::createProfile</a></div><div class="ttdeci">virtual RooAbsReal * createProfile(const RooArgSet &amp;paramsOfInterest)</div><div class="ttdoc">Create a RooProfileLL object that eliminates all nuisance parameters in the present function...</div><div class="ttdef"><b>Definition:</b> <a href="RooAbsReal_8cxx_source.html#l00462">RooAbsReal.cxx:462</a></div></div>
<div class="ttc" id="classTH1_html_a61f001c11f9b4a6dabc96af989009c40"><div class="ttname"><a href="classTH1.html#a61f001c11f9b4a6dabc96af989009c40">TH1::Clone</a></div><div class="ttdeci">TObject * Clone(const char *newname=0) const</div><div class="ttdoc">Make a complete copy of the underlying object. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l02664">TH1.cxx:2664</a></div></div>
<div class="ttc" id="classTH1_html_a68ac42aeb65a689b5b32e1865b4dfd13"><div class="ttname"><a href="classTH1.html#a68ac42aeb65a689b5b32e1865b4dfd13">TH1::GetNbinsX</a></div><div class="ttdeci">virtual Int_t GetNbinsX() const</div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00292">TH1.h:292</a></div></div>
<div class="ttc" id="classRooStats_1_1ConfidenceBelt_html_ad465a9878549db5398cabbffb57ff7fb"><div class="ttname"><a href="classRooStats_1_1ConfidenceBelt.html#ad465a9878549db5398cabbffb57ff7fb">RooStats::ConfidenceBelt::GetAcceptanceRegionMax</a></div><div class="ttdeci">Double_t GetAcceptanceRegionMax(RooArgSet &amp;, Double_t cl=-1., Double_t leftside=-1.)</div><div class="ttdef"><b>Definition:</b> <a href="ConfidenceBelt_8cxx_source.html#l00101">ConfidenceBelt.cxx:101</a></div></div>
<div class="ttc" id="classTNamed_html_a72f4d419b48a5fbfef07485b335139ca"><div class="ttname"><a href="classTNamed.html#a72f4d419b48a5fbfef07485b335139ca">TNamed::SetTitle</a></div><div class="ttdeci">virtual void SetTitle(const char *title=&quot;&quot;)</div><div class="ttdoc">Set the title of the TNamed. </div><div class="ttdef"><b>Definition:</b> <a href="TNamed_8cxx_source.html#l00164">TNamed.cxx:164</a></div></div>
<div class="ttc" id="classRooWorkspace_html_a9131cf30e7ea371b14a619ebf0d7e18f"><div class="ttname"><a href="classRooWorkspace.html#a9131cf30e7ea371b14a619ebf0d7e18f">RooWorkspace::Print</a></div><div class="ttdeci">void Print(Option_t *opts=0) const</div><div class="ttdoc">Print contents of the workspace. </div><div class="ttdef"><b>Definition:</b> <a href="RooWorkspace_8cxx_source.html#l02217">RooWorkspace.cxx:2217</a></div></div>
<div class="ttc" id="classRooSimultaneous_html"><div class="ttname"><a href="classRooSimultaneous.html">RooSimultaneous</a></div><div class="ttdoc">RooSimultaneous facilitates simultaneous fitting of multiple PDFs to subsets of a given dataset...</div><div class="ttdef"><b>Definition:</b> <a href="RooSimultaneous_8h_source.html#l00037">RooSimultaneous.h:37</a></div></div>
<div class="ttc" id="FeldmanCousins_8h_html"><div class="ttname"><a href="FeldmanCousins_8h.html">FeldmanCousins.h</a></div></div>
<div class="ttc" id="classTH1_html_a3d91d3762b9789bd6e54e67d8ccce2e6"><div class="ttname"><a href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">TH1::GetXaxis</a></div><div class="ttdeci">TAxis * GetXaxis()</div><div class="ttdoc">Get the behaviour adopted by the object about the statoverflows. See EStatOverflows for more informat...</div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00316">TH1.h:316</a></div></div>
<div class="ttc" id="classRooWorkspace_html"><div class="ttname"><a href="classRooWorkspace.html">RooWorkspace</a></div><div class="ttdoc">The RooWorkspace is a persistable container for RooFit projects. </div><div class="ttdef"><b>Definition:</b> <a href="RooWorkspace_8h_source.html#l00043">RooWorkspace.h:43</a></div></div>
<div class="ttc" id="classRooAbsData_html_ab6f573d74bd8cb6fa1db720a608a3f9e"><div class="ttname"><a href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">RooAbsData::numEntries</a></div><div class="ttdeci">virtual Int_t numEntries() const</div><div class="ttdef"><b>Definition:</b> <a href="RooAbsData_8cxx_source.html#l00306">RooAbsData.cxx:306</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:09:54 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

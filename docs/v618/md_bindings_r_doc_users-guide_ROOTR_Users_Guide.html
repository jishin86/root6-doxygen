<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: ROOTR Users Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ROOTR Users Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>DESCRIPTION</h2>
<p><a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a> R is an interface in <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a> to call R functions using an R C++ interface (<a class="el" href="namespaceRcpp.html" title="This is a class to support deprecated method to pass function to R&#39;s Environment, based in Rcpp::Inte...">Rcpp</a>, see <a href="http://dirk.eddelbuettel.com/code/rcpp.html">http://dirk.eddelbuettel.com/code/rcpp.html</a>). This interface opens the possibility in <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a> to use the very large set of mathematical and statistical tools provided by R. With ROOTR you can perform a conversion from <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a>'s C++ objects to R's objects, transform the returned R objects into <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a>'s C++ objects, then the R functionality can be used directly for statistical studies in <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a>.</p>
<h2>ROOTR BASICS</h2>
<p>ROOTR creates a working environment to execute R coding called from <code>C++</code>. It allows to translate some datatypes from <code>C++</code> to R inside the R environment and vice versa in an easy way to get the most from both R and <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a>. To ease the sending and receiving of data in both environments, I overloaded the operators <code>&lt;&lt;</code>,<code>&gt;&gt;</code> and <code>[]</code> which make look the job as a flow of data between environments, we will see more of that later. With this tool you ca use any library or R package wich allows you to access a big amount of benefits to make statistical analysis. ROOTR also has a R events processing system, which allows to use the R graphical system from <code>C++</code>.</p>
<h2>INSTALLATION</h2>
<p>To install ROOTR please read first.</p>
<ul>
<li><a href="https://root.cern.ch/building-root">https://root.cern.ch/building-root</a></li>
<li><a href="https://root.cern.ch/build-prerequisites">https://root.cern.ch/build-prerequisites</a></li>
</ul>
<h3>COMPILING ROOTR ON MAC WITH CMAKE:</h3>
<p><b>NOTE:</b> Mac OSX Yosemite last xcode and without macports</p>
<p><b>Prerequisites</b></p>
<ul>
<li>xcode</li>
<li><a href="http://xquartz.macosforge.org/">xquartz</a></li>
<li><a href="https://www.r-project.org">R last version</a></li>
<li><a href="https://cmake.org/download/">cmake</a></li>
</ul>
<p>To compile with cmake added into ~/.profile</p>
<div class="fragment"><div class="line">export PATH=$PATH:/Applications/CMake.app/Contents/bin/</div></div><!-- fragment --><p> and</p>
<div class="fragment"><div class="line">source ~/.profile</div></div><!-- fragment --><p>Install needed R packages, open R and in the prompt type</p>
<div class="fragment"><div class="line">install.packages(c(&#39;Rcpp&#39;,&#39;RInside&#39;))</div></div><!-- fragment --><p> select a mirror and install.</p>
<p>Install the next additional packages for R TMVA interface</p>
<div class="fragment"><div class="line">install.packages(c(&#39;C50&#39;,&#39;RSNNS&#39;,&#39;e1071&#39;,&#39;xgboost&#39;))</div></div><!-- fragment --><p>Download code from git repo</p>
<div class="fragment"><div class="line">git clone http://root.cern.ch/git/root.git</div></div><!-- fragment --><p>To compile ROOTR lets to create a compilation directory and to activate it use cmake -Dr=ON ..</p>
<div class="fragment"><div class="line">mkdir compile</div><div class="line">cd compile</div><div class="line">cmake -Dr=ON ..</div><div class="line">make -j 5</div></div><!-- fragment --><h3>Compiling ROOTR on Gnu/Linux with CMake:</h3>
<p><b>NOTE:</b> Tested on Gnu/Linux Debian Jessie with gcc 4.9</p>
<p><b>Prerequisities</b> install (For debian-based distros)</p>
<div class="fragment"><div class="line">apt-get install r-base r-base-dev</div></div><!-- fragment --><p> Install needed R packages, open R and in the prompt type</p>
<div class="fragment"><div class="line">install.packages(c(&#39;Rcpp&#39;,&#39;RInside&#39;))</div></div><!-- fragment --><p> select a mirror and install.</p>
<p>Install the next additional packages for R TMVA interface</p>
<div class="fragment"><div class="line">install.packages(c(&#39;C50&#39;,&#39;RSNNS&#39;,&#39;e1071&#39;,&#39;xgboost&#39;))</div></div><!-- fragment --><p>Download code from git repo</p>
<div class="fragment"><div class="line">git clone http://root.cern.ch/git/root.git</div></div><!-- fragment --><p>To compile ROOTR lets to create a compilation directory and to activate it use cmake -Dr=ON ..</p>
<div class="fragment"><div class="line">mkdir compile</div><div class="line">cd compile</div><div class="line">cmake -Dr=ON ..</div><div class="line">make -j 5</div></div><!-- fragment --><h2>How does it work ?</h2>
<p>There is a class called TRInterface which is located at the header TRInterface.h and uses the namespace <code><a class="el" href="namespaceROOT_1_1R.html" title="  namespace associated R package for ROOT. ">ROOT::R</a></code>, it is in charge of making calls to R to give and obtain data. This class has a series of overcharged operators which ease the passing and obtaining of data and code from R to C++ and vice versa. To create an object of this class the user must use the static methods <code><a class="el" href="classROOT_1_1R_1_1TRInterface.html#a262c8bef6227c938a9ead1fc03af0801" title=" static method to get an TRInterface instance reference ">ROOT::R::TRInterface::Instance</a></code> and <code><a class="el" href="classROOT_1_1R_1_1TRInterface.html#ad282d3fa5e3faa0c88d1521501841d01" title=" static method to get an TRInterface instance pointer ">ROOT::R::TRInterface::InstancePtr</a></code> which return a reference object and a pointer object respectively.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TRInterface_8h.html">TRInterface.h</a>&gt;</span></div><div class="line"><a class="code" href="classROOT_1_1R_1_1TRInterface.html">ROOT::R::TRInterface</a> &amp;<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a262c8bef6227c938a9ead1fc03af0801">ROOT::R::TRInterface::Instance</a>();</div></div><!-- fragment --><h2>Running R code and passing/getting variables.</h2>
<p>We have different ways to run R code and pass/obtain data to/from R environment: using the methods Execute(code) and Eval(code).</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TRInterface_8h.html">TRInterface.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">//creating an instance</span></div><div class="line"><a class="code" href="classROOT_1_1R_1_1TRInterface.html">ROOT::R::TRInterface</a> &amp;<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a262c8bef6227c938a9ead1fc03af0801">ROOT::R::TRInterface::Instance</a>();</div><div class="line"><span class="comment">//executing simple r commands with the operator &lt;&lt;</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(&#39;hello ROOTR&#39;)&quot;</span>;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;vec=c(1,2,3)&quot;</span>&lt;&lt;<span class="stringliteral">&quot;print(vec)&quot;</span>;</div><div class="line"></div><div class="line"><span class="comment">//executing R&#39;s code using the method Execute that doesn&#39;t return anything</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>.<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a254b9b9cdb8193c18cff099fbfd62986">Execute</a>(<span class="stringliteral">&quot;print(&#39;hello ROOTR&#39;)&quot;</span>);</div><div class="line"></div><div class="line"><span class="comment">//We execute the code using the method Eval which returns an instance of TRObjectProxy</span></div><div class="line"><span class="comment">//which can be converted to a ROOTR supported classes</span></div><div class="line">std::vector&lt;Int_t&gt; <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>=<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>.<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a41c45994406e9573d826cd72eba3bef4">Eval</a>(<span class="stringliteral">&quot;c(1,2,3)&quot;</span>);</div><div class="line">std::cout&lt;&lt;<a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>[0]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>[1]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>[2]&lt;&lt;std::endl;</div><div class="line"></div><div class="line">std::vector&lt;Double_t&gt; vd(3);</div><div class="line"></div><div class="line"><span class="comment">//obtaining variables from R environment using the operators [] and &gt;&gt;</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;seq(0,1,0.5)&quot;</span>]&gt;&gt;vd;</div><div class="line">std::cout&lt;&lt;vd[0]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;vd[1]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;vd[2]&lt;&lt;std::endl;</div><div class="line"></div><div class="line">std::vector&lt;Int_t&gt; v1(3);</div><div class="line">v1[0]=0;</div><div class="line">v1[1]=1;</div><div class="line">v1[2]=2;</div><div class="line"></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;v1&quot;</span>]&lt;&lt;v1;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(v1)&quot;</span>;</div><div class="line"></div><div class="line"><a class="code" href="classTMatrixT.html">TMatrixD</a> <a class="code" href="textangle_8C.html#a15eed939eb6efebfc935e895368c847a">m</a>(2,2);</div><div class="line"></div><div class="line"><span class="comment">//Creating a matrix inside r environment and converting it into a TMatrixD</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;mat&lt;-matrix(c(0.1,0.2,0.3,0.4),nrow=2)&quot;</span>;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;mat&quot;</span>]&gt;&gt;<a class="code" href="textangle_8C.html#a15eed939eb6efebfc935e895368c847a">m</a>;</div><div class="line"><a class="code" href="textangle_8C.html#a15eed939eb6efebfc935e895368c847a">m</a>.Print();</div></div><!-- fragment --><p> So, working with ROOTR is like working with flows of data to pass, obtain and process data.</p>
<h2>Passing functions from <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a> to R</h2>
<p>You can pass functions from <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a> to R using the operators <code>&lt;&lt;</code> and <code>=</code> or using the class TRFunction, but the arguments and datatypes of the return value cannot be pointers. They must be ROOTR supported datatypes. So instead of using <code>*Double_t</code> you must use <code>std::vector</code> and instead of <code>*Char_t</code> use <a class="el" href="classTString.html" title="Basic string class. ">TString</a> or <code>std::string</code>.</p>
<p>For this example we need to create a macro, so save it as fun.C</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TRInterface_8h.html">TRInterface.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TMath_8h.html">TMath.h</a>&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> myfun(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>)</div><div class="line">{</div><div class="line">    <span class="keywordflow">return</span> 2*<a class="code" href="TMath_8h.html#a75f4e4dd379376514613d7ec27902d07">cos</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>);</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> myfun2(std::vector&lt;Double_t&gt; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>) <span class="comment">//use std::vector&lt;Double_t&gt; instead Double_t*</span></div><div class="line">{</div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[1]*<a class="code" href="TMath_8h.html#a75f4e4dd379376514613d7ec27902d07">cos</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0]);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> fun()</div><div class="line">{</div><div class="line"><a class="code" href="classROOT_1_1R_1_1TRInterface.html">ROOT::R::TRInterface</a> &amp;<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a262c8bef6227c938a9ead1fc03af0801">ROOT::R::TRInterface::Instance</a>();</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;dilog&quot;</span>]&lt;&lt;<a class="code" href="classROOT_1_1R_1_1TRFunctionExport.html">ROOT::R::TRFunctionExport</a>(<a class="code" href="namespaceTMath.html#a0d3a6803e3cf5b0415be000b024cb9b9">TMath::DiLog</a>);</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;myfun&quot;</span>]&lt;&lt;myfun;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;myfun2&quot;</span>]&lt;&lt;myfun2;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(dilog(0))&quot;</span>;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(myfun(0))&quot;</span>;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(myfun2(c(0,4)))&quot;</span>;</div><div class="line">}</div></div><!-- fragment --><p><b>IMPORTANT</b></p><ul>
<li>For overloaded functions you should pass the function with a explicit cast to the wanted function.</li>
<li>The system works with templates and the template can not resolve the correct type of function because it is overloaded.</li>
<li>If you pass a function without the explicit cast you will get a very ugly traceback.</li>
<li>A lot of common standard functions for example from math.h like sin, cos etc.. are overloaded, take care passing it.</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TRInterface_8h.html">TRInterface.h</a>&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> myfun(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>)</div><div class="line">{</div><div class="line">    <span class="keywordflow">return</span> 2*<a class="code" href="TMath_8h.html#a75f4e4dd379376514613d7ec27902d07">cos</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>);</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> myfun(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>)</div><div class="line">{</div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> fun()</div><div class="line">{</div><div class="line"><a class="code" href="classROOT_1_1R_1_1TRInterface.html">ROOT::R::TRInterface</a> &amp;<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a262c8bef6227c938a9ead1fc03af0801">ROOT::R::TRInterface::Instance</a>();</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;myfund&quot;</span>]&lt;&lt;(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> (*)(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>))myfun;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[&quot;myfuni&quot;]&lt;&lt;(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> (*)(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>))myfun;</div><div class="line"></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;&quot;print(myfund(0.0))&quot;;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;&quot;print(myfuni(1))&quot;;</div><div class="line">}</div></div><!-- fragment --><h2>Wrapping a class</h2>
<p>You can wrap a class and expose it in R environment using only a pair of macrodefinitions and the template class <code><a class="el" href="classROOT_1_1R_1_1class__.html">ROOT::R::class_</a>&lt;&gt;</code> The <code><a class="el" href="RExports_8h.html#a282e6808020bd9298fea3daa3807e1ac">ROOTR_EXPOSED_CLASS(Class)</a></code> macro allows you to expose the class as a new datatype of R, but it has to be alongside the <code><a class="el" href="RExports_8h.html#a6868253f7801fc683bf405939078016d">ROOTR_MODULE(Module)</a></code> macro which allows you to create an internal R module and make the class wrapping To do this you must use inside the <code>ROOTR_MODULE</code> braces the class <code><a class="el" href="classROOT_1_1R_1_1class__.html">ROOT::R::class_</a>&lt;&gt;</code> and specify each constructor, attribute or method that the class to export has. Then the macrodefinition <code><a class="el" href="RExports_8h.html#afd702f4ffea58858e839097b5749fc84">LOAD_ROOTR_MODULE(Module)</a></code> can load the module and the class in R's environment. You can find a more clear instruction by looking at a example below in Functor section.</p>
<h2>DataFrames</h2>
<p>DataFrame? is a very important datatype in R and in ROOTR we have a class to manipulate dataframes called TRDataFrame, with a lot of very useful operators overloaded to work with TRDataFrame's objects in a similar way that in the R environment but from c++ in <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a>. Example:</p>
<p>Lets to create need data to play with dataframe features</p>
<div class="fragment"><div class="line"><span class="comment">////////////////////////</span></div><div class="line"><span class="comment"></span><span class="comment">//creating variables//</span><span class="comment"></span></div><div class="line"><span class="comment">////////////////////////</span></div><div class="line"><span class="comment"></span><a class="code" href="classTVectorT.html">TVectorD</a> v1(3);</div><div class="line">std::vector&lt;Double_t&gt; v2(3);</div><div class="line">std::array&lt;Int_t,3&gt;  v3{ {1,2,3} };</div><div class="line">std::list&lt;std::string&gt; names;</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">//////////////////////</span></div><div class="line"><span class="comment"></span><span class="comment">//assigning values//</span><span class="comment"></span></div><div class="line"><span class="comment">//////////////////////</span></div><div class="line"><span class="comment"></span>v1[0]=1;</div><div class="line">v1[1]=2;</div><div class="line">v1[2]=3;</div><div class="line"></div><div class="line">v2[0]=0.101;</div><div class="line">v2[1]=0.202;</div><div class="line">v2[2]=0.303;</div><div class="line"></div><div class="line">names.push_back(<span class="stringliteral">&quot;v1&quot;</span>);</div><div class="line">names.push_back(<span class="stringliteral">&quot;v2&quot;</span>);</div><div class="line">names.push_back(<span class="stringliteral">&quot;v3&quot;</span>);</div><div class="line"></div><div class="line"><a class="code" href="classROOT_1_1R_1_1TRInterface.html">ROOT::R::TRInterface</a> &amp;<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a262c8bef6227c938a9ead1fc03af0801">ROOT::R::TRInterface::Instance</a>();</div></div><!-- fragment --><p> In R the dataframe have associate to every column a label, in ROOTR you can have the same label using the class <a class="el" href="namespaceROOT_1_1R.html#a76771ec73923faa8b8850004d7430f8a">ROOT::R::Label</a> to create a TRDataFrame where you data have a label associate.</p>
<div class="fragment"><div class="line"><span class="comment">/////////////////////////////////////////////////</span></div><div class="line"><span class="comment"></span><span class="comment">//creating dataframe object with its labels//</span><span class="comment"></span></div><div class="line"><span class="comment">/////////////////////////////////////////////////</span></div><div class="line"><span class="comment"></span></div><div class="line"><a class="code" href="classROOT_1_1R_1_1TRDataFrame.html">ROOT::R::TRDataFrame</a>  df1(<a class="code" href="namespaceROOT_1_1R.html#a76771ec73923faa8b8850004d7430f8a">ROOT::R::Label</a>[<span class="stringliteral">&quot;var1&quot;</span>]=v1,<a class="code" href="namespaceROOT_1_1R.html#a76771ec73923faa8b8850004d7430f8a">ROOT::R::Label</a>[<span class="stringliteral">&quot;var2&quot;</span>]=v2,<a class="code" href="namespaceROOT_1_1R.html#a76771ec73923faa8b8850004d7430f8a">ROOT::R::Label</a>[<span class="stringliteral">&quot;var3&quot;</span>]=v3,<a class="code" href="namespaceROOT_1_1R.html#a76771ec73923faa8b8850004d7430f8a">ROOT::R::Label</a>[<span class="stringliteral">&quot;strings&quot;</span>]=names);</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">//////////////////////////////////////////////</span></div><div class="line"><span class="comment"></span><span class="comment">//Passing dataframe to R&#39;s environment//</span><span class="comment"></span></div><div class="line"><span class="comment">//////////////////////////////////////////////</span></div><div class="line"><span class="comment"></span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;df1&quot;</span>]&lt;&lt;df1;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(df1)&quot;</span>;</div></div><!-- fragment --><p> Output</p>
<div class="fragment"><div class="line">var1  var2 var3 strings</div><div class="line">1    1 0.101    1      v1</div><div class="line">2    2 0.202    2      v2</div><div class="line">3    3 0.303    3      v3</div></div><!-- fragment --><p> Manipulating data between dataframes</p>
<div class="fragment"><div class="line"><span class="comment">////////////////////////////////</span></div><div class="line"><span class="comment"></span><span class="comment">//Adding columns to dataframe //</span><span class="comment"></span></div><div class="line"><span class="comment">////////////////////////////////</span></div><div class="line"><span class="comment"></span></div><div class="line"><a class="code" href="classTVectorT.html">TVectorD</a> v4(3);</div><div class="line"><span class="comment">//filling the vector fro R&#39;s environment</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;c(-1,-2,-3)&quot;</span>]&gt;&gt;v4;</div><div class="line"><span class="comment">//adding new column to df1 with name var4</span></div><div class="line">df1[<span class="stringliteral">&quot;var4&quot;</span>]=v4;</div><div class="line"><span class="comment">//updating df1 in R&#39;s environment</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;df1&quot;</span>]&lt;&lt;df1;</div><div class="line"><span class="comment">//printing df1</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(df1)&quot;</span>;</div></div><!-- fragment --><p> Output</p>
<div class="fragment"><div class="line">var1  var2 var3 strings var4</div><div class="line">1    1 0.101    1      v1   -1</div><div class="line">2    2 0.202    2      v2   -2</div><div class="line">3    3 0.303    3      v3   -3</div></div><!-- fragment --><p>Getting data frames from R's environment</p>
<div class="fragment"><div class="line"><span class="comment">//////////////////////////////////////////</span></div><div class="line"><span class="comment"></span><span class="comment">//Getting dataframe from R&#39;s environment//</span><span class="comment"></span></div><div class="line"><span class="comment">//////////////////////////////////////////</span></div><div class="line"><span class="comment"></span><a class="code" href="classROOT_1_1R_1_1TRDataFrame.html">ROOT::R::TRDataFrame</a> df2;</div><div class="line"></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;df2&lt;-data.frame(v1=c(0.1,0.2,0.3),v2=c(3,2,1))&quot;</span>;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;df2&quot;</span>]&gt;&gt;df2;</div><div class="line"></div><div class="line"><a class="code" href="classTVectorT.html">TVectorD</a> <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>(3);</div><div class="line">df2[<span class="stringliteral">&quot;v1&quot;</span>]&gt;&gt;<a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>;</div><div class="line"><a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>.Print();</div><div class="line"></div><div class="line">df2[<span class="stringliteral">&quot;v2&quot;</span>]&gt;&gt;<a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>;</div><div class="line"><a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>.Print();</div></div><!-- fragment --><p>Output</p>
<div class="fragment"><div class="line">Vector (3)  is as follows</div><div class="line"></div><div class="line">     |        1  |</div><div class="line">------------------</div><div class="line">   0 |0.1</div><div class="line">   1 |0.2</div><div class="line">   2 |0.3</div><div class="line"></div><div class="line">Vector (3)  is as follows</div><div class="line"></div><div class="line">     |        1  |</div><div class="line">------------------</div><div class="line">   0 |3</div><div class="line">   1 |2</div><div class="line">   2 |1</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">///////////////////////////////////////////</span></div><div class="line"><span class="comment"></span><span class="comment">//Working with columns between dataframes//</span><span class="comment"></span></div><div class="line"><span class="comment">///////////////////////////////////////////</span></div><div class="line"><span class="comment"></span></div><div class="line">df2[<span class="stringliteral">&quot;v3&quot;</span>]&lt;&lt;df1[<span class="stringliteral">&quot;strings&quot;</span>];</div><div class="line"></div><div class="line"><span class="comment">//updating df2 in R&#39;s environment</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;df2&quot;</span>]&lt;&lt;df2;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(df2)&quot;</span>;</div></div><!-- fragment --><p> Output</p>
<div class="fragment"><div class="line">v1 v2 v3</div><div class="line">1 0.1  3 v1</div><div class="line">2 0.2  2 v2</div><div class="line">3 0.3  1 v3</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">///////////////////////////////////////////</span></div><div class="line"><span class="comment"></span><span class="comment">//Working with columns between dataframes//</span><span class="comment"></span></div><div class="line"><span class="comment">///////////////////////////////////////////</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">//passing values from column v3 of df2 to var1 of df1</span></div><div class="line">df2[<span class="stringliteral">&quot;v3&quot;</span>]&gt;&gt;df1[<span class="stringliteral">&quot;var1&quot;</span>];</div><div class="line"><span class="comment">//updating df1 in R&#39;s environment</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;df1&quot;</span>]&lt;&lt;df1;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(df1)&quot;</span>;</div></div><!-- fragment --><p>Output</p>
<div class="fragment"><div class="line">var1  var2 var3 strings var4</div><div class="line">1   v1 0.101    1      v1   -1</div><div class="line">2   v2 0.202    2      v2   -2</div><div class="line">3   v3 0.303    3      v3   -3</div></div><!-- fragment --><h2>Plotting with R's graphical system.</h2>
<p>ROOTR supports an eventloop for R's graphical system which allows plotting using the R functions to the graphical system or generating images(ps, pdf png, etc). You can find a demo in Interpolation below in examples section.</p>
<h2>Interactive Mode</h2>
<p>The interactive mode lets you get the R's command line within <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a>'s command line to run R code with tab completion support. The variables created in the interactive mode can be passed to <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a> with TRObjectProxy and the method ParseEval?. To initialize the interactive mode just call Interactive() method and type ".q" to exit from R's prompt and to go to the <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a>'s prompt again.</p>
<div class="fragment"><div class="line">[omazapa] [tuxhome] [~]$ root -<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a></div><div class="line">root [0] #include&lt;TRInterface.h&gt;</div><div class="line">root [1] <a class="code" href="classROOT_1_1R_1_1TRInterface.html">ROOT::R::TRInterface</a> &amp;<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a262c8bef6227c938a9ead1fc03af0801">ROOT::R::TRInterface::Instance</a>();</div><div class="line">root [2] <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>.<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a5c98829ae47fb280e25f323fbedc6afc">Interactive</a>()</div><div class="line">[<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>]:<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>=seq</div><div class="line">seq          seq_along    seq.Date     seq.default  seq.int      seq_len      seq.POSIXt   sequence</div><div class="line">[<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>]:<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>=seq(1,5,0.5)</div><div class="line">[<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>]:.q</div><div class="line">root [3] <a class="code" href="classTVectorT.html">TVectorD</a> <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>=<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>.ParseEval(<span class="stringliteral">&quot;a&quot;</span>);</div><div class="line">root [4] <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>.Print()</div><div class="line"></div><div class="line">Vector (9)  is <a class="code" href="namespaceRcpp.html#ac3aa0bad652173ac9376b32f469a022d">as</a> follows</div><div class="line"></div><div class="line">     |        1  |</div><div class="line">------------------</div><div class="line">   0 |1</div><div class="line">   1 |1.5</div><div class="line">   2 |2</div><div class="line">   3 |2.5</div><div class="line">   4 |3</div><div class="line">   5 |3.5</div><div class="line">   6 |4</div><div class="line">   7 |4.5</div><div class="line">   8 |5</div><div class="line"></div><div class="line">root [4]</div></div><!-- fragment --><h2>Examples</h2>
<p>The examples can also be found in <code>$ROOTSYS/tutorials/r</code></p>
<h2>Creating a Functor</h2>
<p>A functor is a class which wraps a function, very useful when states and properties associated to that function are needed. In this example I show how to give support to a custom class to be used in R's environment, which at the same time is a functor.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TRInterface_8h.html">TRInterface.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TMath_8h.html">TMath.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> (*<a class="code" href="bindings_2r_2tests_2Functor_8C.html#a0c577f19f0476bcfd51080f86326db0f">Function</a>)(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>);</div><div class="line"></div><div class="line"><span class="comment">//Functor class with the function inside</span></div><div class="line"><span class="keyword">class </span>MyFunctor{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  MyFunctor(){</div><div class="line">    status=<span class="keyword">false</span>;</div><div class="line">    <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>=<a class="code" href="namespaceTMath.html#af67b49393a0864eeda6ead0629af8210">TMath::BesselY1</a>;</div><div class="line">  }</div><div class="line">  <span class="keywordtype">void</span> setFunction(<a class="code" href="bindings_2r_2tests_2Functor_8C.html#a0c577f19f0476bcfd51080f86326db0f">Function</a> fun)</div><div class="line">  {</div><div class="line">    <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>=fun;</div><div class="line">    status=<span class="keyword">true</span>;</div><div class="line">  }</div><div class="line">  <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> getStatus(){<span class="keywordflow">return</span> status;}</div><div class="line">  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> doEval(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>) {</div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>);</div><div class="line">  }</div><div class="line"><span class="keyword">private</span>:</div><div class="line">   <a class="code" href="bindings_2r_2tests_2Functor_8C.html#a0c577f19f0476bcfd51080f86326db0f">Function</a> <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> status;</div><div class="line">};</div><div class="line"><span class="comment">//this macro exposes the class into R&#39;s environment</span></div><div class="line"><span class="comment">// and lets you pass objects directly.</span></div><div class="line"><a class="code" href="RExports_8h.html#a282e6808020bd9298fea3daa3807e1ac">ROOTR_EXPOSED_CLASS</a>(MyFunctor)</div><div class="line"></div><div class="line"><span class="comment">//Macro to create a module</span></div><div class="line"><a class="code" href="RExports_8h.html#a6868253f7801fc683bf405939078016d">ROOTR_MODULE</a>(MyFunctorModule) {</div><div class="line">    <a class="code" href="classROOT_1_1R_1_1class__.html">ROOT::R::class_&lt;MyFunctor&gt;</a>( <span class="stringliteral">&quot;MyFunctor&quot;</span> )</div><div class="line">    <span class="comment">//creating a default constructor</span></div><div class="line">    .constructor()</div><div class="line">    <span class="comment">//adding the method doEval to evaluate the internal function</span></div><div class="line">    .method( <span class="stringliteral">&quot;doEval&quot;</span>, &amp;MyFunctor::doEval )</div><div class="line">    .method( <span class="stringliteral">&quot;getStatus&quot;</span>, &amp;MyFunctor::getStatus)</div><div class="line">    ;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> <a class="code" href="bindings_2r_2tests_2Functor_8C.html#acfeda9281d500f7040a08a6257adc9fc">Functor</a>()</div><div class="line">{</div><div class="line">   <a class="code" href="classROOT_1_1R_1_1TRInterface.html">ROOT::R::TRInterface</a> &amp;<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a262c8bef6227c938a9ead1fc03af0801">ROOT::R::TRInterface::Instance</a>();<span class="comment"></span></div><div class="line"><span class="comment">   ////////////////////////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">//Creating a functor with default function TMath::BesselY1//</span></div><div class="line">   <span class="comment">// and status false from R&#39;s environment                  //</span><span class="comment"></span></div><div class="line"><span class="comment">   ////////////////////////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">//Loading module into R&#39;s environment</span></div><div class="line">   <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;MyFunctorModule&quot;</span>]&lt;&lt;<a class="code" href="RExports_8h.html#afd702f4ffea58858e839097b5749fc84">LOAD_ROOTR_MODULE</a>(MyFunctorModule);</div><div class="line"></div><div class="line">   <span class="comment">//creating a class variable from the module</span></div><div class="line">   <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;MyFunctor &lt;- MyFunctorModule$MyFunctor&quot;</span>;</div><div class="line">   <span class="comment">//creating a MyFunctor&#39;s object</span></div><div class="line">   <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;u &lt;- new(MyFunctor)&quot;</span>;</div><div class="line"></div><div class="line">   <span class="comment">//printing status</span></div><div class="line">   <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(u$getStatus())&quot;</span>;</div><div class="line"></div><div class="line">   <span class="comment">//printing values from Functor and Function</span></div><div class="line">   <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(sprintf(&#39;value in R = %f&#39;,u$doEval( 1 )))&quot;</span>;</div><div class="line">   std::cout&lt;&lt;<span class="stringliteral">&quot;value in ROOT = &quot;</span>&lt;&lt;<a class="code" href="namespaceTMath.html#af67b49393a0864eeda6ead0629af8210">TMath::BesselY1</a>(1)&lt;&lt;std::endl;</div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   ////////////////////////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   <span class="comment">//creating a MyFunctor&#39;s object and passing object to R&#39;s //</span></div><div class="line">   <span class="comment">//environment, the status should be true because is not   //</span></div><div class="line">   <span class="comment">//using the default function                              //</span><span class="comment"></span></div><div class="line"><span class="comment">   ////////////////////////////////////////////////////////////</span></div><div class="line"><span class="comment"></span>   MyFunctor functor;</div><div class="line">   functor.setFunction(<a class="code" href="namespaceTMath.html#a44e82992cba4684280c72679f0f39adc">TMath::Erf</a>);</div><div class="line">   <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;functor&quot;</span>]&lt;&lt;functor;</div><div class="line">   <span class="comment">//printing the status that should be true</span></div><div class="line">   <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(functor$getStatus())&quot;</span>;</div><div class="line">   <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(sprintf(&#39;value in R = %f&#39;,functor$doEval( 1 )))&quot;</span>;</div><div class="line">   std::cout&lt;&lt;<span class="stringliteral">&quot;value in ROOT = &quot;</span>&lt;&lt;<a class="code" href="namespaceTMath.html#a44e82992cba4684280c72679f0f39adc">TMath::Erf</a>(1)&lt;&lt;std::endl;</div><div class="line">}</div></div><!-- fragment --><h2>Simple fitting in R and plot in <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a></h2>
<p>The next example creates an exponential fit. The idea is to create a set of numbers x,y with noise from <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a>, pass them to R and fit the data to <code>x^3</code>, get the fitted coefficient(power) and plot the data, the known function and the fitted function using <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a>'s classes.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TRInterface_8h.html">TRInterface.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TRandom_8h.html">TRandom.h</a>&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="classTCanvas.html">TCanvas</a> *SimpleFitting(){</div><div class="line">   <a class="code" href="classTCanvas.html">TCanvas</a> *<a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a> = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>(<span class="stringliteral">&quot;c1&quot;</span>,<span class="stringliteral">&quot;Curve Fitting&quot;</span>,700,500);</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;SetGrid();</div><div class="line"></div><div class="line">   <span class="comment">// draw a frame to define the range</span></div><div class="line">   <a class="code" href="classTMultiGraph.html">TMultiGraph</a> *<a class="code" href="namespaceTGeant4Unit.html#ada17cfd94c2f3395cd15e3118f80291c">mg</a> = <span class="keyword">new</span> <a class="code" href="classTMultiGraph.html">TMultiGraph</a>();</div><div class="line"></div><div class="line">   <span class="comment">// create the first graph (points with gaussian noise)</span></div><div class="line">   <span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a> = 24;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="RooGaussKronrodIntegrator1D_8cxx.html#a568bf3de18e110c0e059ae112eb1996b">x1</a>[<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>] ;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> y1[<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>] ;</div><div class="line">   <span class="comment">//Generate the points along a X^3 with noise</span></div><div class="line">   <a class="code" href="classTRandom.html">TRandom</a> rg;</div><div class="line">   rg.<a class="code" href="classTRandom.html#a2007ae15ce828266aecb783ed3410e8b">SetSeed</a>(520);</div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0; i &lt; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; i++) {</div><div class="line">      <a class="code" href="RooGaussKronrodIntegrator1D_8cxx.html#a568bf3de18e110c0e059ae112eb1996b">x1</a>[i] = rg.<a class="code" href="classTRandom.html#a86cf3a4ff3fdc44b26298f1984a9a9c7">Uniform</a>(0, 1);</div><div class="line">      y1[i] = <a class="code" href="namespaceTMath.html#a9f3bcefa095d69086d20e7b76bc9bfc6">TMath::Power</a>(<a class="code" href="RooGaussKronrodIntegrator1D_8cxx.html#a568bf3de18e110c0e059ae112eb1996b">x1</a>[i], 3) + rg.<a class="code" href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">Gaus</a>() * 0.06;</div><div class="line">   }</div><div class="line"></div><div class="line">   <a class="code" href="classTGraph.html">TGraph</a> *gr1 = <span class="keyword">new</span> <a class="code" href="classTGraph.html">TGraph</a>(<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>,<a class="code" href="RooGaussKronrodIntegrator1D_8cxx.html#a568bf3de18e110c0e059ae112eb1996b">x1</a>,y1);</div><div class="line">   gr1-&gt;<a class="code" href="classTAttMarker.html#a27f1eae16a3f990024e8a401ed034fa3">SetMarkerColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8aab48c32302f7159d81e081c41dc2d3d2">kBlue</a>);</div><div class="line">   gr1-&gt;<a class="code" href="classTAttMarker.html#a697e1a65975ff344c9dca7618fd44de4">SetMarkerStyle</a>(8);</div><div class="line">   gr1-&gt;<a class="code" href="classTAttMarker.html#a95522acfc3fa6157f317f9993edfa047">SetMarkerSize</a>(1);</div><div class="line">   <a class="code" href="namespaceTGeant4Unit.html#ada17cfd94c2f3395cd15e3118f80291c">mg</a>-&gt;Add(gr1);</div><div class="line"></div><div class="line">      <span class="comment">// create the second graph</span></div><div class="line">   <a class="code" href="classTF1.html">TF1</a> *f_known=<span class="keyword">new</span> <a class="code" href="classTF1.html">TF1</a>(<span class="stringliteral">&quot;f_known&quot;</span>,<span class="stringliteral">&quot;pow(x,3)&quot;</span>,0,1);</div><div class="line">   <a class="code" href="classTGraph.html">TGraph</a> *gr2 = <span class="keyword">new</span> <a class="code" href="classTGraph.html">TGraph</a>(f_known);</div><div class="line">   gr2-&gt;<a class="code" href="classTAttMarker.html#a27f1eae16a3f990024e8a401ed034fa3">SetMarkerColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a5a655b1a02e5b0311571ca57ce4f3900">kRed</a>);</div><div class="line">   gr2-&gt;<a class="code" href="classTAttMarker.html#a697e1a65975ff344c9dca7618fd44de4">SetMarkerStyle</a>(8);</div><div class="line">   gr2-&gt;<a class="code" href="classTAttMarker.html#a95522acfc3fa6157f317f9993edfa047">SetMarkerSize</a>(1);</div><div class="line">   <a class="code" href="namespaceTGeant4Unit.html#ada17cfd94c2f3395cd15e3118f80291c">mg</a>-&gt;Add(gr2);</div><div class="line">   <span class="comment">//passing data to Rfot fitting</span></div><div class="line">     <a class="code" href="classROOT_1_1R_1_1TRInterface.html">ROOT::R::TRInterface</a> &amp;<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a262c8bef6227c938a9ead1fc03af0801">ROOT::R::TRInterface::Instance</a>();</div><div class="line">   <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;x&quot;</span>]&lt;&lt;<a class="code" href="TVectorDfwd_8h.html#a901d7ac901e3fd3b94ba0aef558b4a0e">TVectorD</a>(<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>, <a class="code" href="RooGaussKronrodIntegrator1D_8cxx.html#a568bf3de18e110c0e059ae112eb1996b">x1</a>);</div><div class="line">   <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;y&quot;</span>]&lt;&lt;<a class="code" href="TVectorDfwd_8h.html#a901d7ac901e3fd3b94ba0aef558b4a0e">TVectorD</a>(<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>, y1);</div><div class="line">   <span class="comment">//creating a R data frame</span></div><div class="line">   <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;ds&lt;-data.frame(x=x,y=y)&quot;</span>;</div><div class="line">   <span class="comment">//fitting x and y to X^power using Nonlinear Least Squares</span></div><div class="line">   <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;m &lt;- nls(y ~ I(x^power),data = ds, start = list(power = 1),trace = T)&quot;</span>;</div><div class="line">   <span class="comment">//getting the exponent</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> power;</div><div class="line">   <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;summary(m)$coefficients[1]&quot;</span>]&gt;&gt;power;</div><div class="line"></div><div class="line">   <a class="code" href="classTF1.html">TF1</a> *f_fitted=<span class="keyword">new</span> <a class="code" href="classTF1.html">TF1</a>(<span class="stringliteral">&quot;f_fitted&quot;</span>,<span class="stringliteral">&quot;pow(x,[0])&quot;</span>,0,1);</div><div class="line">   f_fitted-&gt;<a class="code" href="classTF1.html#ade6e54171210c6b1b955c9f813040eb8">SetParameter</a>(0,power);</div><div class="line">   <span class="comment">//plotting the fitted function</span></div><div class="line">   <a class="code" href="classTGraph.html">TGraph</a> *gr3 = <span class="keyword">new</span> <a class="code" href="classTGraph.html">TGraph</a>(f_fitted);</div><div class="line">   gr3-&gt;<a class="code" href="classTAttMarker.html#a27f1eae16a3f990024e8a401ed034fa3">SetMarkerColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a8ea4b941d1d41f4bd88387c38e13e9d3">kGreen</a>);</div><div class="line">   gr3-&gt;<a class="code" href="classTAttMarker.html#a697e1a65975ff344c9dca7618fd44de4">SetMarkerStyle</a>(8);</div><div class="line">   gr3-&gt;<a class="code" href="classTAttMarker.html#a95522acfc3fa6157f317f9993edfa047">SetMarkerSize</a>(1);</div><div class="line"></div><div class="line">   <a class="code" href="namespaceTGeant4Unit.html#ada17cfd94c2f3395cd15e3118f80291c">mg</a>-&gt;Add(gr3);</div><div class="line">   <a class="code" href="namespaceTGeant4Unit.html#ada17cfd94c2f3395cd15e3118f80291c">mg</a>-&gt;Draw(<span class="stringliteral">&quot;ap&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">//displaying basic results</span></div><div class="line">   <a class="code" href="classTPaveText.html">TPaveText</a> *<a class="code" href="entrylist__figure1_8C.html#ac0ca150b0e000602a104bc1ca56005e3">pt</a> = <span class="keyword">new</span> <a class="code" href="classTPaveText.html">TPaveText</a>(0.1,0.6,0.5,0.9,<span class="stringliteral">&quot;brNDC&quot;</span>);</div><div class="line">   <a class="code" href="entrylist__figure1_8C.html#ac0ca150b0e000602a104bc1ca56005e3">pt</a>-&gt;<a class="code" href="classTAttFill.html#a4c21db248e10de0dca2300f07f379ec9">SetFillColor</a>(18);</div><div class="line">   <a class="code" href="entrylist__figure1_8C.html#ac0ca150b0e000602a104bc1ca56005e3">pt</a>-&gt;<a class="code" href="classTAttText.html#a3ccefe554f443f21fa9695afca230275">SetTextAlign</a>(12);</div><div class="line">   <a class="code" href="entrylist__figure1_8C.html#ac0ca150b0e000602a104bc1ca56005e3">pt</a>-&gt;<a class="code" href="classTPaveText.html#a0358c389da35224e49876ca14d422860">AddText</a>(<span class="stringliteral">&quot;Fitting x^power &quot;</span>);</div><div class="line">   <a class="code" href="entrylist__figure1_8C.html#ac0ca150b0e000602a104bc1ca56005e3">pt</a>-&gt;<a class="code" href="classTPaveText.html#a0358c389da35224e49876ca14d422860">AddText</a>(<span class="stringliteral">&quot; \&quot;Blue\&quot;   Points with gaussian noise to be fitted&quot;</span>);</div><div class="line">   <a class="code" href="entrylist__figure1_8C.html#ac0ca150b0e000602a104bc1ca56005e3">pt</a>-&gt;<a class="code" href="classTPaveText.html#a0358c389da35224e49876ca14d422860">AddText</a>(<span class="stringliteral">&quot; \&quot;Red\&quot;    Known function x^3&quot;</span>);</div><div class="line">   <a class="code" href="classTString.html">TString</a> fmsg;</div><div class="line">   fmsg.<a class="code" href="classTString.html#aeb44d6183d8b1f1b7090dbd3c93f5e39">Form</a>(<span class="stringliteral">&quot; \&quot;Green\&quot;  Fitted function with power=%.4lf&quot;</span>,power);</div><div class="line">   <a class="code" href="entrylist__figure1_8C.html#ac0ca150b0e000602a104bc1ca56005e3">pt</a>-&gt;<a class="code" href="classTPaveText.html#a0358c389da35224e49876ca14d422860">AddText</a>(fmsg);</div><div class="line">   <a class="code" href="entrylist__figure1_8C.html#ac0ca150b0e000602a104bc1ca56005e3">pt</a>-&gt;<a class="code" href="classTPaveText.html#a0af35def1a3f2f0f9ef5e796e08e04e4">Draw</a>();</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;Update();</div><div class="line">   <span class="keywordflow">return</span> <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>;</div><div class="line">}</div></div><!-- fragment --><p> In the first image you can see the blue dots which are the function <code>x^3</code> with gaussian noise, the red dots correspond to the original function and the green ones correspond to the fitted function.</p>
<div class="image">
<img src="R_image1.png" alt="R_image1.png"/>
</div>
<h2>Global Minimization in R using the package DEoptim</h2>
<p>DEoptim is a R package for Differential Evolution Minimization that lets you do global Minimization. To install this package you just need to run:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TRInterface_8h.html">TRInterface.h</a>&gt;</span></div><div class="line"><a class="code" href="classROOT_1_1R_1_1TRInterface.html">ROOT::R::TRInterface</a> &amp;<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a262c8bef6227c938a9ead1fc03af0801">ROOT::R::TRInterface::Instance</a>();</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;install.packages(&#39;DEoptim&#39;,repos=&#39;http://cran.rstudio.com/&#39;)&quot;</span>;</div></div><!-- fragment --><p>Then create a macro named <a class="el" href="GlobalMinimization_8C.html" title=" &lt;a href=&quot;http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/GlobalMinimization.C.nbconvert.ipynb&quot; target=&quot;_blank&quot;&gt;&lt;img src= notebook.gif alt=&quot;View in nbviewer&quot; style=&quot;height:1em&quot; &gt;&lt;/a&gt; &lt;a href=&quot;https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/GlobalMinimization.C.nbconvert.ipynb&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png&quot;  alt=&quot;Open in SWAN&quot; style=&quot;height:1em&quot; &gt;&lt;/a&gt;  Example based in http://cran.r-project.org/web/packages/DEoptim/DEoptim.pdf Please install the R package DEoptim before run this example. ">GlobalMinimization.C</a> with the next code.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TRInterface_8h.html">TRInterface.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TBenchmark_8h.html">TBenchmark.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include&lt;math.h&gt;</span></div><div class="line"><span class="preprocessor">#include&lt;stdlib.h&gt;</span></div><div class="line"><span class="comment">//In the next function the *double pointer should be changed by a TVectorD datatype,</span></div><div class="line"><span class="comment">//because the pointer has no meaning in the R environment.</span></div><div class="line"><span class="comment">//This is a generalization of the RosenBrock function, with the min xi=1 and i&gt;0.</span></div><div class="line"><a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> GenRosenBrock(<span class="keyword">const</span> <a class="code" href="classTVectorT.html">TVectorD</a> xx )</div><div class="line">{</div><div class="line">  <span class="keywordtype">int</span> length=xx.<a class="code" href="classTVectorT.html#acc2b9d8c47dd6a5b1da14ee3b844f801">GetNoElements</a>();</div><div class="line"></div><div class="line">  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> result=0;</div><div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;(length-1);i++)</div><div class="line">  {</div><div class="line">    result+=<a class="code" href="TMath_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e">pow</a>(1-xx[i],2)+100*<a class="code" href="TMath_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e">pow</a>(xx[i+1]-<a class="code" href="TMath_8h.html#a96ae9abed439401fd6dd28a1e2c2f94e">pow</a>(xx[i],2),2);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> result;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//the min xi=0 i&gt;0</span></div><div class="line"><a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> Rastrigin(<span class="keyword">const</span> <a class="code" href="classTVectorT.html">TVectorD</a> xx)</div><div class="line">{</div><div class="line">  <span class="keywordtype">int</span> length=xx.<a class="code" href="classTVectorT.html#acc2b9d8c47dd6a5b1da14ee3b844f801">GetNoElements</a>();</div><div class="line">  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> result=10*length;</div><div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;length;i++)</div><div class="line">  {</div><div class="line">    result+=xx[i]*xx[i]-10*<a class="code" href="TMath_8h.html#a75f4e4dd379376514613d7ec27902d07">cos</a>(6.2831853*xx[i]);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> result;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> GlobalMinimization()</div><div class="line">{</div><div class="line"> <a class="code" href="classTBenchmark.html">TBenchmark</a> bench;</div><div class="line"> <a class="code" href="classROOT_1_1R_1_1TRInterface.html">ROOT::R::TRInterface</a> &amp;<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a262c8bef6227c938a9ead1fc03af0801">ROOT::R::TRInterface::Instance</a>();</div><div class="line"></div><div class="line"> <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> installed=<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>.<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a41c45994406e9573d826cd72eba3bef4">Eval</a>(<span class="stringliteral">&quot;is.element(&#39;DEoptim&#39;, installed.packages()[,1])&quot;</span>);</div><div class="line"> <span class="keywordflow">if</span>(!installed)</div><div class="line"> {</div><div class="line">    std::cout&lt;&lt;<span class="stringliteral">&quot;Package DEoptim no installed in R&quot;</span>&lt;&lt;std::endl;</div><div class="line">    std::cout&lt;&lt;<span class="stringliteral">&quot;Run install.packages(&#39;DEoptim&#39;) in R&#39;s environment&quot;</span>&lt;&lt;std::endl;</div><div class="line">    <span class="keywordflow">return</span>;</div><div class="line"> }</div><div class="line"></div><div class="line"> <span class="comment">//loading DEoptim</span></div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;suppressMessages(library(DEoptim, quietly = TRUE))&quot;</span>;</div><div class="line"></div><div class="line"><span class="comment">//  passing RosenBrock function to R</span></div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;GenRosenBrock&quot;</span>]&lt;&lt;GenRosenBrock;</div><div class="line"></div><div class="line"> <span class="comment">//maximun number of iterations</span></div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;MaxIter&quot;</span>]&lt;&lt;5000;</div><div class="line"> <span class="comment">//n = size of vector that is an argument for GenRosenBrock</span></div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;n&quot;</span>]&lt;&lt;3;</div><div class="line"> <span class="comment">//lower limits</span></div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;ll&lt;-rep(-25, n)&quot;</span>;</div><div class="line"> <span class="comment">//upper limits</span></div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;ul&lt;-rep(25, n)&quot;</span>;</div><div class="line"></div><div class="line"> bench.<a class="code" href="classTBenchmark.html#a7596451ade84dc5d6712a754239f7e0b">Start</a>(<span class="stringliteral">&quot;GlobalMinimizationRosenBrock&quot;</span>);</div><div class="line"> <span class="comment">//calling minimization and timing it.</span></div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;result1&lt;-DEoptim(fn=GenRosenBrock,lower=ll,upper=ul,control=list(NP=10*n,itermax=MaxIter,trace=FALSE))&quot;</span>;</div><div class="line"> std::cout&lt;&lt;<span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt;std::endl;</div><div class="line"> std::cout&lt;&lt;<span class="stringliteral">&quot;RosenBrock&#39;s minimum in: &quot;</span>&lt;&lt;std::endl;</div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(result1$optim$bestmem)&quot;</span>;</div><div class="line"> std::cout&lt;&lt;<span class="stringliteral">&quot;Bechmark Times&quot;</span>&lt;&lt;std::endl;</div><div class="line"><span class="comment">//  printing times</span></div><div class="line"> bench.<a class="code" href="classTBenchmark.html#ad14bad185e0ade9b7289459c0356b01c">Show</a>(<span class="stringliteral">&quot;GlobalMinimizationRosenBrock&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line"> <span class="comment">//passing RosenBrock function to R</span></div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;Rastrigin&quot;</span>]&lt;&lt;Rastrigin;</div><div class="line"> <span class="comment">//maximun number of iterations</span></div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;MaxIter&quot;</span>]&lt;&lt;2000;</div><div class="line"> <span class="comment">//n = size of a vector which is an argument for Rastrigin</span></div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;n&quot;</span>]&lt;&lt;3;</div><div class="line"> <span class="comment">//lower limits</span></div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;ll&lt;-rep(-5, n)&quot;</span>;</div><div class="line"> <span class="comment">//upper limits</span></div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;ul&lt;-rep(5, n)&quot;</span>;</div><div class="line"></div><div class="line"> bench.<a class="code" href="classTBenchmark.html#a7596451ade84dc5d6712a754239f7e0b">Start</a>(<span class="stringliteral">&quot;GlobalMinimizationRastrigin&quot;</span>);</div><div class="line"> <span class="comment">//calling minimization and timing it.</span></div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;result2&lt;-DEoptim(fn=Rastrigin,lower=ll,upper=ul,control=list(NP=10*n,itermax=MaxIter,trace=FALSE))&quot;</span>;</div><div class="line"> std::cout&lt;&lt;<span class="stringliteral">&quot;-----------------------------------------&quot;</span>&lt;&lt;std::endl;</div><div class="line"> std::cout&lt;&lt;<span class="stringliteral">&quot;Rastrigin&#39;s minimum in: &quot;</span>&lt;&lt;std::endl;</div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;print(result2$optim$bestmem)&quot;</span>;</div><div class="line"> std::cout&lt;&lt;<span class="stringliteral">&quot;Bechmark Times&quot;</span>&lt;&lt;std::endl;</div><div class="line"> <span class="comment">//printing times</span></div><div class="line"> bench.<a class="code" href="classTBenchmark.html#ad14bad185e0ade9b7289459c0356b01c">Show</a>(<span class="stringliteral">&quot;GlobalMinimizationRastrigin&quot;</span>);</div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;dev.new(title=&#39;RosenBrock Convergence&#39;)&quot;</span>;</div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;plot(result1,type=&#39;o&#39;,pch=&#39;.&#39;)&quot;</span>;</div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;dev.new(title=&#39;Rastrigin Convergence&#39;)&quot;</span>;</div><div class="line"> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;plot(result2,type=&#39;o&#39;,pch=&#39;.&#39;)&quot;</span>;</div><div class="line">}</div></div><!-- fragment --><p> In the image you can see the convergence plots of the functions and their minimum. For RosenBrock is (1,1,1) and for Rastrigin is (0,0,0).</p>
<div class="image">
<img src="R_image2.png" alt="R_image2.png"/>
</div>
<h2>Interpolation (Plotting in R)</h2>
<p>This example shows an interpolation using the function aproxfun and how to make a plot with R's graphical functions.</p>
<p>More Information on R interpolation <a href="http://stat.ethz.ch/R-manual/R-patched/library/stats/html/approxfun.html">here</a>.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TRInterface_8h.html">TRInterface.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TRandom_8h.html">TRandom.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include&lt;vector&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Interpolation()</div><div class="line">{</div><div class="line"> <a class="code" href="classROOT_1_1R_1_1TRInterface.html">ROOT::R::TRInterface</a> &amp;<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a262c8bef6227c938a9ead1fc03af0801">ROOT::R::TRInterface::Instance</a>();</div><div class="line"><span class="comment">//Creating points</span></div><div class="line"><a class="code" href="classTRandom.html">TRandom</a> rg;</div><div class="line">std::vector&lt;Double_t&gt; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>(10),<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>(10);</div><div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;10;i++)</div><div class="line">{</div><div class="line">  <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i]=i;</div><div class="line">  <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>[i]=rg.<a class="code" href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">Gaus</a>();</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;x&quot;</span>]=<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;y&quot;</span>]=<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>;</div><div class="line"></div><div class="line"></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;dev.new()&quot;</span>;<span class="comment">//Required to activate new window for plotting</span></div><div class="line"><span class="comment">//Plot parameter. Plotting using two rows and one column</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;par(mfrow = c(2,1))&quot;</span>;</div><div class="line"></div><div class="line"><span class="comment">//plotting the points</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;plot(x, y, main = &#39;approx(.) and approxfun(.)&#39;)&quot;</span>;</div><div class="line"></div><div class="line"><span class="comment">//The function &quot;approx&quot; returns a list with components x and y,</span></div><div class="line"><span class="comment">//containing n coordinates which interpolate the given data points according to the method (and rule) desired.</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;points(approx(x, y), col = 2, pch = &#39;*&#39;)&quot;</span>;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;points(approx(x, y, method = &#39;constant&#39;), col = 4, pch = &#39;*&#39;)&quot;</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//The function &quot;approxfun&quot; returns a function performing (linear or constant)</span></div><div class="line"><span class="comment">//interpolation of the given data.</span></div><div class="line"><span class="comment">//For a given set of x values, this function will return the corresponding interpolated values.</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;f &lt;- approxfun(x, y)&quot;</span>;</div><div class="line"></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;curve(f(x), 0, 11, col = &#39;green2&#39;)&quot;</span>;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;points(x, y)&quot;</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//using approxfun with const method</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;fc &lt;- approxfun(x, y, method = &#39;const&#39;)&quot;</span>;</div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;curve(fc(x), 0, 10, col = &#39;darkblue&#39;, add = TRUE)&quot;</span>;</div><div class="line"><span class="comment">// different interpolation on left and right side :</span></div><div class="line"><a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;&lt;<span class="stringliteral">&quot;plot(approxfun(x, y, rule = 2:1), 0, 11,col = &#39;tomato&#39;, add = TRUE, lty = 3, lwd = 2)&quot;</span>;</div><div class="line">}</div></div><!-- fragment --><p> The image shows the interpolated function plotted within R: </p><div class="image">
<img src="R_image3.png" alt="R_image3.png"/>
</div>
<h2>Integration (Passing vectorized function to R)</h2>
<p>Numerical integration using R passing the function from <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a></p>
<div class="fragment"><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TMath_8h.html">TMath.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TRInterface_8h.html">TRInterface.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="Integrator_8h.html">Math/Integrator.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="TF1_8h.html">TF1.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">//To integrate using R the function must be vectorized</span></div><div class="line"><span class="comment">//The idea is just to receive a vector like an argument,to evaluate</span></div><div class="line"><span class="comment">//every element saving the result in another vector</span></div><div class="line"><span class="comment">//and return the resultant vector.</span></div><div class="line">std::vector&lt;Double_t&gt;  BreitWignerVectorized(std::vector&lt;Double_t&gt; xx)</div><div class="line">{</div><div class="line">  std::vector&lt;Double_t&gt; result(xx.size());</div><div class="line">  <span class="keywordflow">for</span>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i=0;i&lt;xx.size();i++)</div><div class="line">  {</div><div class="line">    result[i]=<a class="code" href="namespaceTMath.html#a5dbbb839fede023ba8f1aece82cdbd7a">TMath::BreitWigner</a>(xx[i]);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> result;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">double</span> BreitWignerWrap( <span class="keywordtype">double</span> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>){</div><div class="line">   <span class="keywordflow">return</span> <a class="code" href="namespaceTMath.html#a5dbbb839fede023ba8f1aece82cdbd7a">TMath::BreitWigner</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>);</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> <a class="code" href="namespaceRooFit.html#a9924e612cb358cd013b50c0e1e6d6148ac8b1dda32591d04a0bf26fa63714db0a">Integration</a>()</div><div class="line">{</div><div class="line"></div><div class="line">  <a class="code" href="classROOT_1_1R_1_1TRInterface.html">ROOT::R::TRInterface</a> &amp;<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a262c8bef6227c938a9ead1fc03af0801">ROOT::R::TRInterface::Instance</a>();</div><div class="line"></div><div class="line">  <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>[<span class="stringliteral">&quot;BreitWigner&quot;</span>]=BreitWignerVectorized;</div><div class="line"></div><div class="line">  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> value=<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>.<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a41c45994406e9573d826cd72eba3bef4">Eval</a>(<span class="stringliteral">&quot;integrate(BreitWigner, lower = -2, upper = 2)$value&quot;</span>);</div><div class="line"></div><div class="line">  std::cout.precision(18);</div><div class="line">  std::cout&lt;&lt;<span class="stringliteral">&quot;Integral of the BreitWigner Function in the interval [-2, 2] R        = &quot;</span>&lt;&lt;value&lt;&lt;std::endl;</div><div class="line"></div><div class="line"></div><div class="line">  <a class="code" href="classROOT_1_1Math_1_1WrappedFunction.html">ROOT::Math::WrappedFunction&lt;&gt;</a> wf(BreitWignerWrap);</div><div class="line">  <a class="code" href="classROOT_1_1Math_1_1IntegratorOneDim.html">ROOT::Math::Integrator</a> i(wf);</div><div class="line">  value=i.Integral(-2,2);</div><div class="line">  std::cout&lt;&lt;<span class="stringliteral">&quot;Integral of the BreitWigner Function in the interval [-2, 2] MathMore = &quot;</span>&lt;&lt;value&lt;&lt;std::endl;</div><div class="line"></div><div class="line"></div><div class="line">  <a class="code" href="classTF1.html">TF1</a> <a class="code" href="legend1_8C.html#abeb628b1c10a75ff3a4579f727637979">f1</a>(<span class="stringliteral">&quot;BreitWigner&quot;</span>,<span class="stringliteral">&quot;BreitWignerWrap(x)&quot;</span>);</div><div class="line">  value=<a class="code" href="legend1_8C.html#abeb628b1c10a75ff3a4579f727637979">f1</a>.<a class="code" href="classTF1.html#a596e02742b00f1e265cc2dbe4daf20fe">Integral</a>(-2,2);</div><div class="line">  std::cout&lt;&lt;<span class="stringliteral">&quot;Integral of the BreitWigner Function in the interval [-2, 2] TF1      = &quot;</span>&lt;&lt;value&lt;&lt;std::endl;</div><div class="line"></div><div class="line">  <span class="comment">//infinte limits</span></div><div class="line">  value=<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>.<a class="code" href="classROOT_1_1R_1_1TRInterface.html#a41c45994406e9573d826cd72eba3bef4">Eval</a>(<span class="stringliteral">&quot;integrate(BreitWigner, lower = -Inf, upper = Inf)$value&quot;</span>);</div><div class="line">  std::cout&lt;&lt;<span class="stringliteral">&quot;Integral of BreitWigner Function in the interval [-Inf, Inf] R    = &quot;</span>&lt;&lt;value&lt;&lt;std::endl;</div><div class="line"></div><div class="line">}</div></div><!-- fragment --><h2>Users Guide Sites</h2>
<ul>
<li><a href="http://oproject.org/tiki-index.php?page=ROOT+R+Users+Guide">http://oproject.org/tiki-index.php?page=ROOT+R+Users+Guide</a> </li>
</ul>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:40 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: math/mathcore/src/FitResult.cxx Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_296d53ceaeaa7e099814a6def439fe8a.html">math</a></li><li class="navelem"><a class="el" href="dir_79c030ac71c6516976d5abab51772218.html">mathcore</a></li><li class="navelem"><a class="el" href="dir_abea4d4f336b92c819ab58d3b53766fe.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">FitResult.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="FitResult_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// @(#)root/mathcore:$Id$</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Author: L. Moneta Wed Aug 30 11:05:34 2006</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/**********************************************************************</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *                                                                    *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Copyright (c) 2006  LCG ROOT Math Team, CERN/PH-SFT                *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *                                                                    *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *                                                                    *</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> **********************************************************************/</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// Implementation file for class FitResult</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="FitResult_8h.html">Fit/FitResult.h</a>&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="FitConfig_8h.html">Fit/FitConfig.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BinData_8h.html">Fit/BinData.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//#include &quot;Fit/Chi2FCN.h&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Minimizer_8h.html">Math/Minimizer.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IParamFunction_8h.html">Math/IParamFunction.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OneDimFunctionAdapter_8h.html">Math/OneDimFunctionAdapter.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProbFuncMathCore_8h.html">Math/ProbFuncMathCore.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="QuantFuncMathCore_8h.html">Math/QuantFuncMathCore.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TMath_8h.html">TMath.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RichardsonDerivator_8h.html">Math/RichardsonDerivator.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Error_8h.html">Math/Error.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceROOT.html">ROOT</a> {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <span class="keyword">namespace </span><a class="code" href="namespaceHFit.html#a47800da6993797a237fc1a151eaf92c8">Fit</a> {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="namespaceROOT_1_1Fit.html#a15bc3570f6c3277d8fdd179b4336a4c4">   43</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespaceROOT_1_1Fit.html#a15bc3570f6c3277d8fdd179b4336a4c4">gInitialResultStatus</a> = -99; <span class="comment">// use this special convention to flag it when printing result</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a766724aba85ff02787b5237795c3c0d2">   45</a></span>&#160;<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a766724aba85ff02787b5237795c3c0d2">FitResult::FitResult</a>() :</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   fValid(false), fNormalized(false), fNFree(0), fNdf(0), fNCalls(0),</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   fStatus(-1), fCovStatus(0), fVal(0), fEdm(-1), fChi2(-1)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <span class="comment">// Default constructor implementation.</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#aa989991eca8f208f2be5bd379966b58f">   52</a></span>&#160;<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a766724aba85ff02787b5237795c3c0d2">FitResult::FitResult</a>(<span class="keyword">const</span> <a class="code" href="classROOT_1_1Fit_1_1FitConfig.html">FitConfig</a> &amp; fconfig) :</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   fValid(false),</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   fNormalized(false),</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   fNFree(0),</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   fNdf(0),</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   fNCalls(0),</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   fStatus(<a class="code" href="namespaceROOT_1_1Fit.html#a15bc3570f6c3277d8fdd179b4336a4c4">gInitialResultStatus</a>),</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   fCovStatus(0),</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   fVal(0),</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   fEdm(-1),</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   fChi2(-1),</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   fFitFunc(0),</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   fParams(<a class="code" href="namespacestd.html">std</a>::vector&lt;double&gt;( fconfig.NPar() ) ),</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   fErrors(<a class="code" href="namespacestd.html">std</a>::vector&lt;double&gt;( fconfig.NPar() ) ),</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   fParNames(<a class="code" href="namespacestd.html">std</a>::vector&lt;<a class="code" href="namespacestd.html">std</a>::string&gt; ( fconfig.NPar() ) )</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;{</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="comment">// create a Fit result from a fit config (i.e. with initial parameter values</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <span class="comment">// and errors equal to step values</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   <span class="comment">// The model function is NULL in this case</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   <span class="comment">// set minimizer type and algorithm</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abda58bd0c359b2bb84488f53a076bf63">fMinimType</a> = fconfig.<a class="code" href="classROOT_1_1Fit_1_1FitConfig.html#aae96718f0b8678724f38f21ee199812f">MinimizerType</a>();</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <span class="comment">// append algorithm name for minimizer that support it</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <span class="keywordflow">if</span> ( (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abda58bd0c359b2bb84488f53a076bf63">fMinimType</a>.find(<span class="stringliteral">&quot;Fumili&quot;</span>) == std::string::npos) &amp;&amp;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abda58bd0c359b2bb84488f53a076bf63">fMinimType</a>.find(<span class="stringliteral">&quot;GSLMultiFit&quot;</span>) == std::string::npos)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      ) {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">if</span> (fconfig.<a class="code" href="classROOT_1_1Fit_1_1FitConfig.html#ad487eb70ed9166842c01d5a02006f023">MinimizerAlgoType</a>() != <span class="stringliteral">&quot;&quot;</span>) <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abda58bd0c359b2bb84488f53a076bf63">fMinimType</a> += <span class="stringliteral">&quot; / &quot;</span> + fconfig.<a class="code" href="classROOT_1_1Fit_1_1FitConfig.html#ad487eb70ed9166842c01d5a02006f023">MinimizerAlgoType</a>();</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="comment">// get parameter values and errors (step sizes)</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> npar = fconfig.<a class="code" href="classROOT_1_1Fit_1_1FitConfig.html#a88ec373c3a3e2befa148da37ec37e9bc">NPar</a>();</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; npar; ++i ) {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keyword">const</span> <a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html">ParameterSettings</a> &amp; par = fconfig.<a class="code" href="classROOT_1_1Fit_1_1FitConfig.html#a76f612eb7f7d4d168c1ee58d5c441f68">ParSettings</a>(i);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>[i]   =  par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#ab899ea0a6e32b8334c828ecbb7023d86">Value</a>();</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a3afd3d45feb47b47d8d6dc5c7cf68121">fErrors</a>[i]   =  par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#ad70b6ff0729c5daf60be0fc84fd4ad8a">StepSize</a>();</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af186297121ec413262a8c18fbc34bc4d">fParNames</a>[i] =  par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#a2a9d0c8b26bf81c4051e7b01527d5882">Name</a>();</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">if</span> (par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#a06d3f1a845bd1c32f3689c5280b97db1">IsFixed</a>() ) <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abbbc0366a24ce6354d4a0799c91a41a6">fFixedParams</a>[i] = <span class="keyword">true</span>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">else</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1b13419eb0ff1a7c65f65173ebd092dc">fNFree</a>++;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordflow">if</span> (par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#af3c9d582eb5d9a221b2251b3f5639dbf">IsBound</a>() ) {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;         <span class="keywordtype">double</span> lower = (par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#a736b14510b928a28302017a89f87d595">HasLowerLimit</a>()) ? par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#a3d77a1ec2162f7236bc9c3ba89087d46">LowerLimit</a>() : - std::numeric_limits&lt;double&gt;::infinity() ;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;         <span class="keywordtype">double</span> upper = (par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#a197cec29dba946e337db24a8f4379acb">HasUpperLimit</a>()) ? par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#ae6ba30b421b25ce9a5ef6a1d3eb49bd5">UpperLimit</a>() :   std::numeric_limits&lt;double&gt;::infinity() ;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;         <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1d7a8c0991454bb9073e9420c87926e3">fBoundParams</a>[i] = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a9efd78a90e429e4afd01e4af1961a6a4">fParamBounds</a>.size();</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;         <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a9efd78a90e429e4afd01e4af1961a6a4">fParamBounds</a>.push_back(std::make_pair(lower,upper));</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   std::cout &lt;&lt; <span class="stringliteral">&quot;create fit result from config - nfree &quot;</span> &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1b13419eb0ff1a7c65f65173ebd092dc">fNFree</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a354b03a90c7507d2bca9030f2c37365e">  100</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a354b03a90c7507d2bca9030f2c37365e">FitResult::FillResult</a>(<span class="keyword">const</span> std::shared_ptr&lt;ROOT::Math::Minimizer&gt; &amp; min, <span class="keyword">const</span> <a class="code" href="classROOT_1_1Fit_1_1FitConfig.html">FitConfig</a> &amp; fconfig, <span class="keyword">const</span> std::shared_ptr&lt;IModelFunction&gt; &amp; func,</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                     <span class="keywordtype">bool</span> isValid,  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeOfData, <span class="keywordtype">bool</span> binnedFit, <span class="keyword">const</span>  <a class="code" href="classROOT_1_1Math_1_1IBaseFunctionMultiDimTempl.html">ROOT::Math::IMultiGenFunction</a> * chi2func, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ncalls )</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="comment">// Fill the FitResult after minimization using result from Minimizers</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <span class="comment">// minimizer must exist</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   assert(min);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a483f1d561ada44f18a63522c31cdc81f">fValid</a> = isValid;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1b13419eb0ff1a7c65f65173ebd092dc">fNFree</a>= min-&gt;NFree();</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a973b7262442efb5bc20077e0fbd69308">fNCalls</a> = min-&gt;NCalls();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aa15b32e61bcb3b3b22d3f7e9a897ffbe">fStatus</a> = min-&gt;Status();</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a675eca88348a34f50cdb9ab02a94be0d">fCovStatus</a>= min-&gt;CovMatrixStatus();</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a36408f0f9b0ed36a07cafac15e53b150">fVal</a>  =  min-&gt;MinValue();</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a397a95b508669f124d2456ba72b8113c">fEdm</a> = min-&gt;Edm();</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a46b67d05dbeae55b81082464541da24a">fMinimizer</a>= min;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a> = func;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="comment">// set minimizer type</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abda58bd0c359b2bb84488f53a076bf63">fMinimType</a> = fconfig.<a class="code" href="classROOT_1_1Fit_1_1FitConfig.html#aae96718f0b8678724f38f21ee199812f">MinimizerType</a>();</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <span class="comment">// append algorithm name for minimizer that support it</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   <span class="keywordflow">if</span> ( (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abda58bd0c359b2bb84488f53a076bf63">fMinimType</a>.find(<span class="stringliteral">&quot;Fumili&quot;</span>) == std::string::npos) &amp;&amp;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abda58bd0c359b2bb84488f53a076bf63">fMinimType</a>.find(<span class="stringliteral">&quot;GSLMultiFit&quot;</span>) == std::string::npos)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      ) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">if</span> (fconfig.<a class="code" href="classROOT_1_1Fit_1_1FitConfig.html#ad487eb70ed9166842c01d5a02006f023">MinimizerAlgoType</a>() != <span class="stringliteral">&quot;&quot;</span>) <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abda58bd0c359b2bb84488f53a076bf63">fMinimType</a> += <span class="stringliteral">&quot; / &quot;</span> + fconfig.<a class="code" href="classROOT_1_1Fit_1_1FitConfig.html#ad487eb70ed9166842c01d5a02006f023">MinimizerAlgoType</a>();</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   <span class="comment">// replace ncalls if minimizer does not support it (they are taken then from the FitMethodFunction)</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a973b7262442efb5bc20077e0fbd69308">fNCalls</a> == 0) <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a973b7262442efb5bc20077e0fbd69308">fNCalls</a> = ncalls;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> npar = min-&gt;NDim();</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="keywordflow">if</span> (npar == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <span class="keywordflow">if</span> (min-&gt;X() )</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a> = std::vector&lt;double&gt;(min-&gt;X(), min-&gt;X() + npar);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="comment">// case minimizer does not provide minimum values (it failed) take from configuration</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>.resize(npar);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; npar; ++i ) {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;         <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>[i] = ( fconfig.<a class="code" href="classROOT_1_1Fit_1_1FitConfig.html#a76f612eb7f7d4d168c1ee58d5c441f68">ParSettings</a>(i).<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#ab899ea0a6e32b8334c828ecbb7023d86">Value</a>() );</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   }</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <span class="keywordflow">if</span> (sizeOfData &gt;  min-&gt;NFree() ) <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a57049d840c654a2d8b63bc46477aca68">fNdf</a> = sizeOfData - min-&gt;NFree();</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <span class="comment">// set right parameters in function (in case minimizer did not do before)</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   <span class="comment">// do also when fit is not valid</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keywordflow">if</span> (func ) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="comment">// I think we can avoid cloning the model function</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="comment">//fFitFunc = dynamic_cast&lt;IModelFunction *&gt;( func-&gt;Clone() );</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="comment">//assert(fFitFunc);</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a>-&gt;SetParameters(&amp;<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>.front());</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="comment">// when no fFitFunc is present take parameters from FitConfig</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af186297121ec413262a8c18fbc34bc4d">fParNames</a>.reserve( npar );</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; npar; ++i ) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;         <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af186297121ec413262a8c18fbc34bc4d">fParNames</a>.push_back( fconfig.<a class="code" href="classROOT_1_1Fit_1_1FitConfig.html#a76f612eb7f7d4d168c1ee58d5c441f68">ParSettings</a>(i).<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#a2a9d0c8b26bf81c4051e7b01527d5882">Name</a>() );</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <span class="comment">// check for fixed or limited parameters</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nfree = 0;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar = 0; ipar &lt; npar; ++ipar) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keyword">const</span> <a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html">ParameterSettings</a> &amp; par = fconfig.<a class="code" href="classROOT_1_1Fit_1_1FitConfig.html#a76f612eb7f7d4d168c1ee58d5c441f68">ParSettings</a>(ipar);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">if</span> (par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#a06d3f1a845bd1c32f3689c5280b97db1">IsFixed</a>() ) <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abbbc0366a24ce6354d4a0799c91a41a6">fFixedParams</a>[ipar] = <span class="keyword">true</span>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">else</span> nfree++;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordflow">if</span> (par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#af3c9d582eb5d9a221b2251b3f5639dbf">IsBound</a>() ) {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;         <span class="keywordtype">double</span> lower = (par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#a736b14510b928a28302017a89f87d595">HasLowerLimit</a>()) ? par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#a3d77a1ec2162f7236bc9c3ba89087d46">LowerLimit</a>() : - std::numeric_limits&lt;double&gt;::infinity() ;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;         <span class="keywordtype">double</span> upper = (par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#a197cec29dba946e337db24a8f4379acb">HasUpperLimit</a>()) ? par.<a class="code" href="classROOT_1_1Fit_1_1ParameterSettings.html#ae6ba30b421b25ce9a5ef6a1d3eb49bd5">UpperLimit</a>() :   std::numeric_limits&lt;double&gt;::infinity() ;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;         <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1d7a8c0991454bb9073e9420c87926e3">fBoundParams</a>[ipar] = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a9efd78a90e429e4afd01e4af1961a6a4">fParamBounds</a>.size();</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;         <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a9efd78a90e429e4afd01e4af1961a6a4">fParamBounds</a>.push_back(std::make_pair(lower,upper));</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <span class="comment">// check if nfree (from FitConfig) and fNFree (from minimizer) are consistent</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <span class="keywordflow">if</span> (nfree != <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1b13419eb0ff1a7c65f65173ebd092dc">fNFree</a> ) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <a class="code" href="Error_8h.html#aacf39b83fabf8e530aa6fa4a3cebce28">MATH_ERROR_MSG</a>(<span class="stringliteral">&quot;FitResult&quot;</span>,<span class="stringliteral">&quot;FitConfiguration and Minimizer result are not consistent&quot;</span>);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Number of free parameters from FitConfig = &quot;</span> &lt;&lt; nfree &lt;&lt; std::endl;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Number of free parameters from Minimizer = &quot;</span> &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1b13419eb0ff1a7c65f65173ebd092dc">fNFree</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   <span class="comment">// if flag is binned compute a chi2 when a chi2 function is given</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   <span class="keywordflow">if</span> (binnedFit) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">if</span> (chi2func == 0)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;         <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">fChi2</a> = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a36408f0f9b0ed36a07cafac15e53b150">fVal</a>;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;         <span class="comment">// compute chi2 equivalent for likelihood fits</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;         <span class="comment">// NB: empty bins are considered</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;         <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">fChi2</a> = (*chi2func)(&amp;<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>[0]);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <span class="comment">// fill error matrix</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <span class="comment">// if minimizer provides error provides also error matrix</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <span class="keywordflow">if</span> (min-&gt;Errors() != 0) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a3afd3d45feb47b47d8d6dc5c7cf68121">fErrors</a> = std::vector&lt;double&gt;(min-&gt;Errors(), min-&gt;Errors() + npar ) ;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a675eca88348a34f50cdb9ab02a94be0d">fCovStatus</a> != 0) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a> = npar * (  npar + 1 )/2;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;         <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7f7828f859db9a040c49c087c13efcee">fCovMatrix</a>.reserve(<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; npar; ++i)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;               <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7f7828f859db9a040c49c087c13efcee">fCovMatrix</a>.push_back(min-&gt;CovMatrix(i,j) );</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="comment">// minos errors</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a483f1d561ada44f18a63522c31cdc81f">fValid</a> &amp;&amp; fconfig.<a class="code" href="classROOT_1_1Fit_1_1FitConfig.html#affc69e79d4bd17dbb9eaae3c68ea0ad1">MinosErrors</a>()) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;         <span class="keyword">const</span> std::vector&lt;unsigned int&gt; &amp; ipars = fconfig.<a class="code" href="classROOT_1_1Fit_1_1FitConfig.html#a557466d38bac08618f552f53b2ae54ee">MinosParams</a>();</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a> = (ipars.size() &gt; 0) ? ipars.size() : npar;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; ++i) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          <span class="keywordtype">double</span> elow, eup;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = (ipars.size() &gt; 0) ? ipars[i] : i;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          <span class="keywordtype">bool</span> ret = min-&gt;GetMinosError(index, elow, eup);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          <span class="keywordflow">if</span> (ret) <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a839a75128601d96aa6d20dea994843d2">SetMinosError</a>(index, elow, eup);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;         }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="comment">// globalCC</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a00ad94da224db02fbdc200e2eaa4317e">fGlobalCC</a>.reserve(npar);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; npar; ++i) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;         <span class="keywordtype">double</span> globcc = min-&gt;GlobalCC(i);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;         <span class="keywordflow">if</span> (globcc &lt; 0) <span class="keywordflow">break</span>; <span class="comment">// it is not supported by that minimizer</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;         <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a00ad94da224db02fbdc200e2eaa4317e">fGlobalCC</a>.push_back(globcc);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;}</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#ac8b9f08d063e645cb1627e01a5175ef3">  236</a></span>&#160;<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ac8b9f08d063e645cb1627e01a5175ef3">FitResult::~FitResult</a>() {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   <span class="comment">// destructor. FitResult manages the fit Function pointer</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <span class="comment">//if (fFitFunc) delete fFitFunc;</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a759b73c80443d0f3a4e4b18aa4e5d64c">  241</a></span>&#160;<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a766724aba85ff02787b5237795c3c0d2">FitResult::FitResult</a>(<span class="keyword">const</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html">FitResult</a> &amp;rhs) :</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   fFitFunc(0)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;{</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   <span class="comment">// Implementation of copy constructor</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   (*this) = rhs;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a364b587d561ca0acca410900b841d1b4">  248</a></span>&#160;<a class="code" href="classROOT_1_1Fit_1_1FitResult.html">FitResult</a> &amp; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a364b587d561ca0acca410900b841d1b4">FitResult::operator = </a>(<span class="keyword">const</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html">FitResult</a> &amp;rhs) {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="comment">// Implementation of assignment operator.</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   <span class="keywordflow">if</span> (<span class="keyword">this</span> == &amp;rhs) <span class="keywordflow">return</span> *<span class="keyword">this</span>;  <span class="comment">// time saving self-test</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;   <span class="comment">// Manages the fitted function</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <span class="comment">// if (fFitFunc) delete fFitFunc;</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   <span class="comment">// fFitFunc = 0;</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="comment">// if (rhs.fFitFunc != 0 ) {</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   <span class="comment">//    fFitFunc = dynamic_cast&lt;IModelFunction *&gt;( (rhs.fFitFunc)-&gt;Clone() );</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   <span class="comment">//    assert(fFitFunc != 0);</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   <span class="comment">// }</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   <span class="comment">// copy all other data members</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a483f1d561ada44f18a63522c31cdc81f">fValid</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a483f1d561ada44f18a63522c31cdc81f">fValid</a>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ae109e7130bce34380a40dff3083fff95">fNormalized</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ae109e7130bce34380a40dff3083fff95">fNormalized</a>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1b13419eb0ff1a7c65f65173ebd092dc">fNFree</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1b13419eb0ff1a7c65f65173ebd092dc">fNFree</a>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a57049d840c654a2d8b63bc46477aca68">fNdf</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a57049d840c654a2d8b63bc46477aca68">fNdf</a>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a973b7262442efb5bc20077e0fbd69308">fNCalls</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a973b7262442efb5bc20077e0fbd69308">fNCalls</a>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a675eca88348a34f50cdb9ab02a94be0d">fCovStatus</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a675eca88348a34f50cdb9ab02a94be0d">fCovStatus</a>;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aa15b32e61bcb3b3b22d3f7e9a897ffbe">fStatus</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aa15b32e61bcb3b3b22d3f7e9a897ffbe">fStatus</a>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a36408f0f9b0ed36a07cafac15e53b150">fVal</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a36408f0f9b0ed36a07cafac15e53b150">fVal</a>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a397a95b508669f124d2456ba72b8113c">fEdm</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a397a95b508669f124d2456ba72b8113c">fEdm</a>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">fChi2</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">fChi2</a>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a46b67d05dbeae55b81082464541da24a">fMinimizer</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a46b67d05dbeae55b81082464541da24a">fMinimizer</a>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ac209e8baa1acb75562cbe04f61247862">fObjFunc</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ac209e8baa1acb75562cbe04f61247862">fObjFunc</a>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abbbc0366a24ce6354d4a0799c91a41a6">fFixedParams</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abbbc0366a24ce6354d4a0799c91a41a6">fFixedParams</a>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1d7a8c0991454bb9073e9420c87926e3">fBoundParams</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1d7a8c0991454bb9073e9420c87926e3">fBoundParams</a>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a9efd78a90e429e4afd01e4af1961a6a4">fParamBounds</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a9efd78a90e429e4afd01e4af1961a6a4">fParamBounds</a>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a3afd3d45feb47b47d8d6dc5c7cf68121">fErrors</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a3afd3d45feb47b47d8d6dc5c7cf68121">fErrors</a>;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7f7828f859db9a040c49c087c13efcee">fCovMatrix</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7f7828f859db9a040c49c087c13efcee">fCovMatrix</a>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a00ad94da224db02fbdc200e2eaa4317e">fGlobalCC</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a00ad94da224db02fbdc200e2eaa4317e">fGlobalCC</a>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af5f29bd9c41b01ea5a6a9f87faa6684f">fMinosErrors</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af5f29bd9c41b01ea5a6a9f87faa6684f">fMinosErrors</a>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abda58bd0c359b2bb84488f53a076bf63">fMinimType</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abda58bd0c359b2bb84488f53a076bf63">fMinimType</a>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af186297121ec413262a8c18fbc34bc4d">fParNames</a> = rhs.<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af186297121ec413262a8c18fbc34bc4d">fParNames</a>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#ac16420674a7e4afa75a79ce7b6b4d62e">  291</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ac16420674a7e4afa75a79ce7b6b4d62e">FitResult::Update</a>(<span class="keyword">const</span> std::shared_ptr&lt;ROOT::Math::Minimizer&gt; &amp; min, <span class="keywordtype">bool</span> isValid, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ncalls) {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   <span class="comment">// update fit result with new status from minimizer</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <span class="comment">// ncalls if it is not zero is used instead of value from minimizer</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a46b67d05dbeae55b81082464541da24a">fMinimizer</a> = min;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> npar = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>.size();</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <span class="keywordflow">if</span> (min-&gt;NDim() != npar ) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <a class="code" href="Error_8h.html#aacf39b83fabf8e530aa6fa4a3cebce28">MATH_ERROR_MSG</a>(<span class="stringliteral">&quot;FitResult::Update&quot;</span>,<span class="stringliteral">&quot;Wrong minimizer status &quot;</span>);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <span class="keywordflow">if</span> (min-&gt;X() == 0 ) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <a class="code" href="Error_8h.html#aacf39b83fabf8e530aa6fa4a3cebce28">MATH_ERROR_MSG</a>(<span class="stringliteral">&quot;FitResult::Update&quot;</span>,<span class="stringliteral">&quot;Invalid minimizer status &quot;</span>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <span class="comment">//fNFree = min-&gt;NFree();</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1b13419eb0ff1a7c65f65173ebd092dc">fNFree</a> != min-&gt;NFree() ) {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <a class="code" href="Error_8h.html#aacf39b83fabf8e530aa6fa4a3cebce28">MATH_ERROR_MSG</a>(<span class="stringliteral">&quot;FitResult::Update&quot;</span>,<span class="stringliteral">&quot;Configuration has changed &quot;</span>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a483f1d561ada44f18a63522c31cdc81f">fValid</a> = isValid;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   <span class="comment">// update minimum value</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a36408f0f9b0ed36a07cafac15e53b150">fVal</a> = min-&gt;MinValue();</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a397a95b508669f124d2456ba72b8113c">fEdm</a> = min-&gt;Edm();</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aa15b32e61bcb3b3b22d3f7e9a897ffbe">fStatus</a> = min-&gt;Status();</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a675eca88348a34f50cdb9ab02a94be0d">fCovStatus</a> = min-&gt;CovMatrixStatus();</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   <span class="comment">// update number of function calls</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   <span class="keywordflow">if</span> ( min-&gt;NCalls() &gt; 0)   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a973b7262442efb5bc20077e0fbd69308">fNCalls</a> = min-&gt;NCalls();</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   <span class="keywordflow">else</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a973b7262442efb5bc20077e0fbd69308">fNCalls</a> = ncalls;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   <span class="comment">// copy parameter value and errors</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   std::copy(min-&gt;X(), min-&gt;X() + npar, <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>.begin());</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   <span class="comment">// set parameters  in fit model function</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a>) <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a>-&gt;SetParameters(&amp;<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>.front());</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   <span class="keywordflow">if</span> (min-&gt;Errors() != 0)  {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a3afd3d45feb47b47d8d6dc5c7cf68121">fErrors</a>.size() != npar) <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a3afd3d45feb47b47d8d6dc5c7cf68121">fErrors</a>.resize(npar);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      std::copy(min-&gt;Errors(), min-&gt;Errors() + npar, <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a3afd3d45feb47b47d8d6dc5c7cf68121">fErrors</a>.begin() ) ;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a675eca88348a34f50cdb9ab02a94be0d">fCovStatus</a> != 0) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;         <span class="comment">// update error matrix</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a> = npar * (  npar + 1 )/2;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7f7828f859db9a040c49c087c13efcee">fCovMatrix</a>.size() != <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>) <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7f7828f859db9a040c49c087c13efcee">fCovMatrix</a>.resize(<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = 0;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; npar; ++i) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;               <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7f7828f859db9a040c49c087c13efcee">fCovMatrix</a>[<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>++] = min-&gt;CovMatrix(i,j);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;         }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="comment">// update global CC</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a00ad94da224db02fbdc200e2eaa4317e">fGlobalCC</a>.size() != npar) <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a00ad94da224db02fbdc200e2eaa4317e">fGlobalCC</a>.resize(npar);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; npar; ++i) {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;         <span class="keywordtype">double</span> globcc = min-&gt;GlobalCC(i);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;         <span class="keywordflow">if</span> (globcc &lt; 0) {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a00ad94da224db02fbdc200e2eaa4317e">fGlobalCC</a>.clear();</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="keywordflow">break</span>; <span class="comment">// it is not supported by that minimizer</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;         }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;         <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a00ad94da224db02fbdc200e2eaa4317e">fGlobalCC</a>[i] = globcc;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;}</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#ad15cd641e6a1ba300c6fc507bcc8326a">  363</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ad15cd641e6a1ba300c6fc507bcc8326a">FitResult::NormalizeErrors</a>() {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   <span class="comment">// normalize errors and covariance matrix according to chi2 value</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a57049d840c654a2d8b63bc46477aca68">fNdf</a> == 0 || <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">fChi2</a> &lt;= 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="keywordtype">double</span> s2 = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">fChi2</a>/<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a57049d840c654a2d8b63bc46477aca68">fNdf</a>;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> = <a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">std::sqrt</a>(<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">fChi2</a>/<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a57049d840c654a2d8b63bc46477aca68">fNdf</a>);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a3afd3d45feb47b47d8d6dc5c7cf68121">fErrors</a>.size() ; ++i)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a3afd3d45feb47b47d8d6dc5c7cf68121">fErrors</a>[i] *= <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7f7828f859db9a040c49c087c13efcee">fCovMatrix</a>.size() ; ++i)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7f7828f859db9a040c49c087c13efcee">fCovMatrix</a>[i] *= s2;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ae109e7130bce34380a40dff3083fff95">fNormalized</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#acd54b71c21b0bcea6fbb628d7541bbd2">  377</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#acd54b71c21b0bcea6fbb628d7541bbd2">FitResult::Prob</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <span class="comment">// fit probability</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="group__ProbFunc.html#gae07ba00b57c524cfbbc9923cdff3f9b0">ROOT::Math::chisquared_cdf_c</a>(<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">fChi2</a>, static_cast&lt;double&gt;(<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a57049d840c654a2d8b63bc46477aca68">fNdf</a>) );</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;}</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a9d1fe282135cc9aa6d14ae59b097715c">  382</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a9d1fe282135cc9aa6d14ae59b097715c">FitResult::HasMinosError</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i)<span class="keyword"> const </span>{</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   <span class="comment">// query if the parameter i has the Minos error</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   std::map&lt;unsigned int, std::pair&lt;double,double&gt; &gt;::const_iterator itr = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af5f29bd9c41b01ea5a6a9f87faa6684f">fMinosErrors</a>.find(i);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   <span class="keywordflow">return</span> (itr !=  <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af5f29bd9c41b01ea5a6a9f87faa6684f">fMinosErrors</a>.end() );</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a8ada69c59e80401a7adfd64832e82327">  389</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a8ada69c59e80401a7adfd64832e82327">FitResult::LowerError</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i)<span class="keyword"> const </span>{</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   <span class="comment">// return lower Minos error for parameter i</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   <span class="comment">//  return the parabolic error if Minos error has not been calculated for the parameter i</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   std::map&lt;unsigned int, std::pair&lt;double,double&gt; &gt;::const_iterator itr = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af5f29bd9c41b01ea5a6a9f87faa6684f">fMinosErrors</a>.find(i);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <span class="keywordflow">return</span> ( itr != <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af5f29bd9c41b01ea5a6a9f87faa6684f">fMinosErrors</a>.end() ) ? itr-&gt;second.first : <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a630ee48277cb8124a36404fe934a3918">Error</a>(i) ;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;}</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a321839e88302c7dc0ce9ef0a92ba3c99">  396</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a321839e88302c7dc0ce9ef0a92ba3c99">FitResult::UpperError</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i)<span class="keyword"> const </span>{</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <span class="comment">// return upper Minos error for parameter i</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <span class="comment">//  return the parabolic error if Minos error has not been calculated for the parameter i</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   std::map&lt;unsigned int, std::pair&lt;double,double&gt; &gt;::const_iterator itr = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af5f29bd9c41b01ea5a6a9f87faa6684f">fMinosErrors</a>.find(i);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="keywordflow">return</span> ( itr != <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af5f29bd9c41b01ea5a6a9f87faa6684f">fMinosErrors</a>.end() ) ? itr-&gt;second.second : <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a630ee48277cb8124a36404fe934a3918">Error</a>(i) ;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;}</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a839a75128601d96aa6d20dea994843d2">  403</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a839a75128601d96aa6d20dea994843d2">FitResult::SetMinosError</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, <span class="keywordtype">double</span> elow, <span class="keywordtype">double</span> eup) {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <span class="comment">// set the Minos error for parameter i</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af5f29bd9c41b01ea5a6a9f87faa6684f">fMinosErrors</a>[i] = std::make_pair(elow,eup);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;}</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#ac8d0c7ab3147acf80f5413b5ca6e7a6e">  408</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ac8d0c7ab3147acf80f5413b5ca6e7a6e">FitResult::Index</a>(<span class="keyword">const</span> std::string &amp; name)<span class="keyword"> const </span>{</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   <span class="comment">// find index for given parameter name</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <span class="keywordflow">if</span> (! <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a>) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> npar = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>.size();</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; npar; ++i)</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a>-&gt;ParameterName(i) == name) <span class="keywordflow">return</span> i;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <span class="keywordflow">return</span> -1; <span class="comment">// case name is not found</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#ae2d5929a694261d1912794b97e233c4e">  418</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ae2d5929a694261d1912794b97e233c4e">FitResult::IsParameterBound</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar)<span class="keyword"> const </span>{</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1d7a8c0991454bb9073e9420c87926e3">fBoundParams</a>.find(ipar) != <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1d7a8c0991454bb9073e9420c87926e3">fBoundParams</a>.end();</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a4a4f5098d7853c6b98a5e075d0d0104b">  422</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a4a4f5098d7853c6b98a5e075d0d0104b">FitResult::IsParameterFixed</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar)<span class="keyword"> const </span>{</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abbbc0366a24ce6354d4a0799c91a41a6">fFixedParams</a>.find(ipar) != <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abbbc0366a24ce6354d4a0799c91a41a6">fFixedParams</a>.end();</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;}</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a7b11acee355a264b6b8a158533f280d0">  426</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7b11acee355a264b6b8a158533f280d0">FitResult::ParameterBounds</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar, <span class="keywordtype">double</span> &amp; lower, <span class="keywordtype">double</span> &amp; upper)<span class="keyword"> const </span>{</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   std::map&lt;unsigned int, unsigned int&gt;::const_iterator itr =  <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1d7a8c0991454bb9073e9420c87926e3">fBoundParams</a>.find(ipar);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <span class="keywordflow">if</span> (itr ==  <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1d7a8c0991454bb9073e9420c87926e3">fBoundParams</a>.end() ) {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      lower =  -std::numeric_limits&lt;Double_t&gt;::infinity();</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      upper =  std::numeric_limits&lt;Double_t&gt;::infinity();</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   assert(itr-&gt;second &lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a9efd78a90e429e4afd01e4af1961a6a4">fParamBounds</a>.size() );</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   lower = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a9efd78a90e429e4afd01e4af1961a6a4">fParamBounds</a>[itr-&gt;second].first;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   upper = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a9efd78a90e429e4afd01e4af1961a6a4">fParamBounds</a>[itr-&gt;second].second;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#ad0da8f6d0ba64245a58157915fb79719">  439</a></span>&#160;std::string <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ad0da8f6d0ba64245a58157915fb79719">FitResult::ParName</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar)<span class="keyword"> const </span>{</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   <span class="comment">// return parameter name</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a>) <span class="keywordflow">return</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a>-&gt;ParameterName(ipar);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipar &lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af186297121ec413262a8c18fbc34bc4d">fParNames</a>.size() ) <span class="keywordflow">return</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#af186297121ec413262a8c18fbc34bc4d">fParNames</a>[ipar];</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   <span class="keywordflow">return</span> <span class="stringliteral">&quot;param_&quot;</span> + <a class="code" href="namespaceROOT_1_1Math_1_1Util.html#ae2cc169bb3bf8b060d62776073e21731">ROOT::Math::Util::ToString</a>(ipar);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a879917fed14db36f8d63fb0170d68d1d">  446</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a879917fed14db36f8d63fb0170d68d1d">FitResult::Print</a>(std::ostream &amp; os, <span class="keywordtype">bool</span> doCovMatrix)<span class="keyword"> const </span>{</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <span class="comment">// print the result in the given stream</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   <span class="comment">// need to add also minos errors , globalCC, etc..</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> npar = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>.size();</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   <span class="keywordflow">if</span> (npar == 0) {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;&lt;Empty FitResult&gt;\n&quot;</span>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   }</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   os &lt;&lt; <span class="stringliteral">&quot;\n****************************************\n&quot;</span>;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a483f1d561ada44f18a63522c31cdc81f">fValid</a>) {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aa15b32e61bcb3b3b22d3f7e9a897ffbe">fStatus</a> != <a class="code" href="namespaceROOT_1_1Fit.html#a15bc3570f6c3277d8fdd179b4336a4c4">gInitialResultStatus</a>) {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot;         Invalid FitResult&quot;</span>;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot;  (status = &quot;</span> &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aa15b32e61bcb3b3b22d3f7e9a897ffbe">fStatus</a> &lt;&lt; <span class="stringliteral">&quot; )&quot;</span>;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      }</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot;      FitResult before fitting&quot;</span>;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;\n****************************************\n&quot;</span>;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;   }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   <span class="comment">//os &lt;&lt; &quot;            FitResult                   \n\n&quot;;</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   os &lt;&lt; <span class="stringliteral">&quot;Minimizer is &quot;</span> &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abda58bd0c359b2bb84488f53a076bf63">fMinimType</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nw = 25; <span class="comment">// spacing for text</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nn = 12; <span class="comment">// spacing for numbers</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <span class="keyword">const</span> std::ios_base::fmtflags prFmt = os.setf(std::ios::left,std::ios::adjustfield); <span class="comment">// set left alignment</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a36408f0f9b0ed36a07cafac15e53b150">fVal</a> != <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">fChi2</a> || <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">fChi2</a> &lt; 0)</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      os &lt;&lt; std::left &lt;&lt; std::setw(nw) &lt;&lt; <span class="stringliteral">&quot;MinFCN&quot;</span> &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; std::right &lt;&lt; std::setw(nn) &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a36408f0f9b0ed36a07cafac15e53b150">fVal</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">fChi2</a> &gt;= 0)</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      os &lt;&lt; std::left &lt;&lt; std::setw(nw) &lt;&lt;  <span class="stringliteral">&quot;Chi2&quot;</span>         &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; std::right &lt;&lt; std::setw(nn) &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">fChi2</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   os &lt;&lt; std::left &lt;&lt; std::setw(nw) &lt;&lt; <span class="stringliteral">&quot;NDf&quot;</span>              &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; std::right &lt;&lt; std::setw(nn) &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a57049d840c654a2d8b63bc46477aca68">fNdf</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#abda58bd0c359b2bb84488f53a076bf63">fMinimType</a>.find(<span class="stringliteral">&quot;Linear&quot;</span>) == std::string::npos) {  <span class="comment">// no need to print this for linear fits</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a397a95b508669f124d2456ba72b8113c">fEdm</a> &gt;=0) os &lt;&lt; std::left &lt;&lt; std::setw(nw) &lt;&lt; <span class="stringliteral">&quot;Edm&quot;</span>    &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; std::right &lt;&lt; std::setw(nn) &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a397a95b508669f124d2456ba72b8113c">fEdm</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      os &lt;&lt; std::left &lt;&lt; std::setw(nw) &lt;&lt; <span class="stringliteral">&quot;NCalls&quot;</span> &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; std::right &lt;&lt; std::setw(nn) &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a973b7262442efb5bc20077e0fbd69308">fNCalls</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; npar; ++i) {</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      os &lt;&lt; std::left &lt;&lt; std::setw(nw) &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7aa021ae993d9dd151a480b82351ecb8">GetParameterName</a>(i);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; std::right &lt;&lt; std::setw(nn) &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>[i];</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a4a4f5098d7853c6b98a5e075d0d0104b">IsParameterFixed</a>(i) )</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;         os &lt;&lt; std::setw(9) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>  &lt;&lt; std::setw(nn) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <span class="stringliteral">&quot; \t (fixed)&quot;</span>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a3afd3d45feb47b47d8d6dc5c7cf68121">fErrors</a>.size() != 0)</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            os &lt;&lt; <span class="stringliteral">&quot;   +/-   &quot;</span> &lt;&lt; std::left &lt;&lt; std::setw(nn) &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a3afd3d45feb47b47d8d6dc5c7cf68121">fErrors</a>[i] &lt;&lt; std::right;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ae2d5929a694261d1912794b97e233c4e">IsParameterBound</a>(i) )</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            os &lt;&lt; <span class="stringliteral">&quot; \t (limited)&quot;</span>;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      os &lt;&lt; std::endl;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   }</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   <span class="comment">// restore stremam adjustfield</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <span class="keywordflow">if</span> (prFmt != os.flags() ) os.setf(prFmt, std::ios::adjustfield);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;   <span class="keywordflow">if</span> (doCovMatrix) <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a965b1c9ea0098fcd4cf3b57fbb6ef3a4">PrintCovMatrix</a>(os);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;}</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a965b1c9ea0098fcd4cf3b57fbb6ef3a4">  501</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a965b1c9ea0098fcd4cf3b57fbb6ef3a4">FitResult::PrintCovMatrix</a>(std::ostream &amp;os)<span class="keyword"> const </span>{</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   <span class="comment">// print the covariance and correlation matrix</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a483f1d561ada44f18a63522c31cdc81f">fValid</a>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7f7828f859db9a040c49c087c13efcee">fCovMatrix</a>.size() == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">//   os &lt;&lt; &quot;****************************************\n&quot;;</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   os &lt;&lt; <span class="stringliteral">&quot;\nCovariance Matrix:\n\n&quot;</span>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> npar = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>.size();</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> kPrec = 5;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> kWidth = 8;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> parw = 12;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> matw = kWidth+4;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   <span class="comment">// query previous precision and format flags</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="keywordtype">int</span> prevPrec = os.precision(kPrec);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   <span class="keyword">const</span> std::ios_base::fmtflags prevFmt = os.flags();</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   os &lt;&lt; std::setw(parw) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; npar; ++i) {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a4a4f5098d7853c6b98a5e075d0d0104b">IsParameterFixed</a>(i) ) {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;         os &lt;&lt; std::right  &lt;&lt; std::setw(matw)  &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7aa021ae993d9dd151a480b82351ecb8">GetParameterName</a>(i) ;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   }</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   os &lt;&lt; std::endl;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; npar; ++i) {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a4a4f5098d7853c6b98a5e075d0d0104b">IsParameterFixed</a>(i) ) {</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;         os &lt;&lt; std::left &lt;&lt; std::setw(parw) &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7aa021ae993d9dd151a480b82351ecb8">GetParameterName</a>(i) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; npar; ++j) {</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a4a4f5098d7853c6b98a5e075d0d0104b">IsParameterFixed</a>(j) ) {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;               os.precision(kPrec); os.width(kWidth);  os &lt;&lt; std::right &lt;&lt; std::setw(matw) &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a63529efa94b2d05337fe994805768a08">CovMatrix</a>(i,j);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;         }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;         os &lt;&lt; std::endl;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      }</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">//   os &lt;&lt; &quot;****************************************\n&quot;;</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   os &lt;&lt; <span class="stringliteral">&quot;\nCorrelation Matrix:\n\n&quot;</span>;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   os &lt;&lt; std::setw(parw) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; npar; ++i) {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a4a4f5098d7853c6b98a5e075d0d0104b">IsParameterFixed</a>(i) ) {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;         os &lt;&lt; std::right &lt;&lt; std::setw(matw)  &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7aa021ae993d9dd151a480b82351ecb8">GetParameterName</a>(i) ;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   }</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   os &lt;&lt; std::endl;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; npar; ++i) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a4a4f5098d7853c6b98a5e075d0d0104b">IsParameterFixed</a>(i) ) {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;         os &lt;&lt; std::left &lt;&lt; std::setw(parw) &lt;&lt; std::left &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7aa021ae993d9dd151a480b82351ecb8">GetParameterName</a>(i) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; npar; ++j) {</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a4a4f5098d7853c6b98a5e075d0d0104b">IsParameterFixed</a>(j) ) {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;               os.precision(kPrec); os.width(kWidth);  os &lt;&lt; std::right &lt;&lt; std::setw(matw) &lt;&lt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ac063bda9213e56ff41e80fa0c013c29f">Correlation</a>(i,j);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;         }</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;         os &lt;&lt; std::endl;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   <span class="comment">// restore alignment and precision</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   os.setf(prevFmt, std::ios::adjustfield);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   os.precision(prevPrec);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;}</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a65a77daab276d605373d508479c3b6a7">  560</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a65a77daab276d605373d508479c3b6a7">FitResult::GetConfidenceIntervals</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> stride1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> stride2, <span class="keyword">const</span> <span class="keywordtype">double</span> * <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <span class="keywordtype">double</span> * ci, <span class="keywordtype">double</span> cl, <span class="keywordtype">bool</span> norm )<span class="keyword"> const </span>{</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   <span class="comment">// stride1 stride in coordinate  stride2 stride in dimension space</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <span class="comment">// i.e. i-th point in k-dimension is x[ stride1 * i + stride2 * k]</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   <span class="comment">// compute the confidence interval of the fit on the given data points</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   <span class="comment">// the dimension of the data points must match the dimension of the fit function</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   <span class="comment">// confidence intervals are returned in array ci</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a>) {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="comment">// check if model function exists</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <a class="code" href="Error_8h.html#aacf39b83fabf8e530aa6fa4a3cebce28">MATH_ERROR_MSG</a>(<span class="stringliteral">&quot;FitResult::GetConfidenceIntervals&quot;</span>,<span class="stringliteral">&quot;Cannot compute Confidence Intervals without fit model function&quot;</span>);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   }</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   assert(<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a>);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   <span class="comment">// use student quantile in case of normalized errors</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   <span class="keywordtype">double</span> corrFactor = 1;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">fChi2</a> &lt;= 0 || <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a57049d840c654a2d8b63bc46477aca68">fNdf</a> == 0) norm = <span class="keyword">false</span>;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   <span class="keywordflow">if</span> (norm)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      corrFactor = <a class="code" href="namespaceTMath.html#af59fdde9bc9c1ec1a90d2f514bb7079a">TMath::StudentQuantile</a>(0.5 + cl/2, <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a57049d840c654a2d8b63bc46477aca68">fNdf</a>) * <a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">std::sqrt</a>( <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">fChi2</a>/<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a57049d840c654a2d8b63bc46477aca68">fNdf</a> );</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="comment">// value to go up in chi2 (1: 1 sigma error(CL=0.683) , 4: 2 sigma errors</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      corrFactor = <a class="code" href="group__QuantFunc.html#gac799813b6815345f48ab4a707e56b553">ROOT::Math::chisquared_quantile</a>(cl, 1);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ndim = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a>-&gt;NDim();</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> npar = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a>-&gt;NPar();</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   std::vector&lt;double&gt; xpoint(ndim);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   std::vector&lt;double&gt; grad(npar);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   std::vector&lt;double&gt; vsum(npar);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <span class="comment">// loop on the points</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipoint = 0; ipoint &lt; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; ++ipoint) {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kdim = 0; kdim &lt; ndim; ++kdim) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = ipoint * stride1 + kdim * stride2;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;         assert(i &lt; ndim*<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;         xpoint[kdim] = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i];</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="comment">// calculate gradient of fitted function w.r.t the parameters</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <a class="code" href="classROOT_1_1Math_1_1RichardsonDerivator.html">ROOT::Math::RichardsonDerivator</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar = 0; ipar &lt; npar; ++ipar) {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a4a4f5098d7853c6b98a5e075d0d0104b">IsParameterFixed</a>(ipar)) {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <a class="code" href="classROOT_1_1Math_1_1OneDimParamFunctionAdapter.html">ROOT::Math::OneDimParamFunctionAdapter&lt;const ROOT::Math::IParamMultiFunction &amp;&gt;</a> fadapter(*<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">fFitFunc</a>,&amp;xpoint.front(),&amp;<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>.front(),ipar);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>.SetFunction(fadapter);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="comment">// compute step size as a small fraction of the error</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="comment">// (see numerical recipes in C 5.7.8)   1.E-5 is ~ (eps)^1/3</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a3afd3d45feb47b47d8d6dc5c7cf68121">fErrors</a>[ipar] &gt; 0 )</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;               <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>.SetStepSize( std::max( <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a3afd3d45feb47b47d8d6dc5c7cf68121">fErrors</a>[ipar]*1.<a class="code" href="namespaceTMath.html#a8a8fbe07e94608dbed9e9260283a442f">E</a>-5, 1.<a class="code" href="namespaceTMath.html#a8a8fbe07e94608dbed9e9260283a442f">E</a>-15) );</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;               <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>.SetStepSize( std::min(std::max(<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>[ipar]*1.<a class="code" href="namespaceTMath.html#a8a8fbe07e94608dbed9e9260283a442f">E</a>-5, 1.<a class="code" href="namespaceTMath.html#a8a8fbe07e94608dbed9e9260283a442f">E</a>-15), 0.0001 ) );</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            grad[ipar] = <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>(<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">fParams</a>[ipar] ); <span class="comment">// evaluate df/dp</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;         }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            grad[ipar] = 0.;  <span class="comment">// for fixed parameters</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="comment">// multiply covariance matrix with gradient</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      vsum.assign(npar,0.0);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar = 0; ipar &lt; npar; ++ipar) {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jpar = 0; jpar &lt; npar; ++jpar) {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;             vsum[ipar] += <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a63529efa94b2d05337fe994805768a08">CovMatrix</a>(ipar,jpar) * grad[jpar];</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;         }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="comment">// multiply gradient by vsum</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="keywordtype">double</span> r2 = 0;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar = 0; ipar &lt; npar; ++ipar) {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;         r2 += grad[ipar] * vsum[ipar];</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a> = <a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">std::sqrt</a>(r2);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      ci[ipoint] = <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a> * corrFactor;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;}</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a546a3b6ca8231e2870d1c5082374ad59">  637</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a65a77daab276d605373d508479c3b6a7">FitResult::GetConfidenceIntervals</a>(<span class="keyword">const</span> <a class="code" href="classROOT_1_1Fit_1_1BinData.html">BinData</a> &amp; data, <span class="keywordtype">double</span> * ci, <span class="keywordtype">double</span> cl, <span class="keywordtype">bool</span> norm )<span class="keyword"> const </span>{</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;   <span class="comment">// implement confidence intervals from a given bin data sets</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   <span class="comment">// currently copy the data from Bindata.</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;   <span class="comment">// could implement otherwise directly</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ndim = data.<a class="code" href="classROOT_1_1Fit_1_1FitData.html#abe97d7c530fce05d05c42b88423e1154">NDim</a>();</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> np = data.<a class="code" href="classROOT_1_1Fit_1_1FitData.html#a915e1c3df239935ba03c716d68579832">NPoints</a>();</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   std::vector&lt;double&gt; xdata( ndim * np );</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; np ; ++i) {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> * <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = data.<a class="code" href="classROOT_1_1Fit_1_1FitData.html#a108cf3f7a1fcf54d099d3cfb84e22134">Coords</a>(i);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      std::vector&lt;double&gt;::iterator itr = xdata.begin()+ ndim * i;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      std::copy(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>+ndim,itr);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;   }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;   <span class="comment">// points are arraned as x0,y0,z0, ....xN,yN,zN  (stride1=ndim, stride2=1)</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a65a77daab276d605373d508479c3b6a7">GetConfidenceIntervals</a>(np,ndim,1,&amp;xdata.front(),ci,cl,norm);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;}</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#afddc3ab76b51414d5a9aecd8f19deb7c">  653</a></span>&#160;std::vector&lt;double&gt; <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a65a77daab276d605373d508479c3b6a7">FitResult::GetConfidenceIntervals</a>(<span class="keywordtype">double</span> cl, <span class="keywordtype">bool</span> norm )<span class="keyword"> const </span>{</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;   <span class="comment">// implement confidence intervals using stored data sets (if can be retrieved from objective function)</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   <span class="comment">// it works only in case of chi2 or binned likelihood fits</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keyword">const</span> <a class="code" href="classROOT_1_1Fit_1_1BinData.html">BinData</a> * data = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1d7d2b0c8017fc8d30c2958a46409693">FittedBinData</a>();</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    std::vector&lt;double&gt; result;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">if</span> (data) {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;       result.resize(data-&gt;<a class="code" href="classROOT_1_1Fit_1_1FitData.html#a915e1c3df239935ba03c716d68579832">NPoints</a>() );</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;       <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a65a77daab276d605373d508479c3b6a7">GetConfidenceIntervals</a>(*data, result.data(), cl, norm);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <a class="code" href="Error_8h.html#aacf39b83fabf8e530aa6fa4a3cebce28">MATH_ERROR_MSG</a>(<span class="stringliteral">&quot;FitResult::GetConfidenceIntervals&quot;</span>,<span class="stringliteral">&quot;Cannot compute Confidence Intervals without the fit bin data&quot;</span>);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;}</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">// const BinData * GetFitBinData() const {</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">//    // return a pointer to the binned data used in the fit</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">//    // works only for chi2 or binned likelihood fits</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">//    // thus when the objective function stored is a Chi2Func or a PoissonLikelihood</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">//    ROOT::Math::IMultiGenFunction * f = fObjFunc-&gt;get();</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">//    Chi2Function * chi2func = dynamic_cast&lt;Chi2Function*&gt;(f);</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">//    if (chi2func) return &amp;(chi2func-&gt;Data());</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">//    PoissonLLFunction * pllfunc = dynamic_cast&lt;PoissonLLFunction*&gt;(f);</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">//    if (pllfunc) return &amp;(pllfunc-&gt;Data());</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">//    Chi2GradFunction * chi2gradfunc = dynamic_cast&lt;Chi2GradFunction*&gt;(f);</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">//    if (chi2gradfunc) return &amp;(chi2gradfunc-&gt;Data());</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">//    PoissonLLGradFunction * pllgradfunc = dynamic_cast&lt;PoissonLLFunction*&gt;(f);</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">//    if (pllgradfunc) return &amp;(pllgradfunc-&gt;Data());</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">//    MATH_WARN_MSG(&quot;FitResult::GetFitBinData&quot;,&quot;Cannot retrun fit bin data set if objective function is not of a known type&quot;);</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">//    return nullptr;</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">// }</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a1d7d2b0c8017fc8d30c2958a46409693">  685</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classROOT_1_1Fit_1_1BinData.html">BinData</a> * <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a1d7d2b0c8017fc8d30c2958a46409693">FitResult::FittedBinData</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classROOT_1_1Fit_1_1BinData.html">BinData</a>*<span class="keyword">&gt;</span> ( <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a76a6f3043fa1c3783475477d3b9cf232">fFitData</a>.get() );</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;}</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">///  Scan parameter ipar between value of xmin and xmax</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">///  A array for x and y points should be provided</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a7133a8cd7f9b18286e8f7956e6c9ef27">  693</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a7133a8cd7f9b18286e8f7956e6c9ef27">FitResult::Scan</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;npoints, <span class="keywordtype">double</span> *pntsx, <span class="keywordtype">double</span> *pntsy, <span class="keywordtype">double</span> <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>, <span class="keywordtype">double</span> <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>)</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;{</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   <span class="keywordflow">if</span> (!pntsx || !pntsy || !npoints)</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a46b67d05dbeae55b81082464541da24a">fMinimizer</a>) {</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <a class="code" href="Error_8h.html#aacf39b83fabf8e530aa6fa4a3cebce28">MATH_ERROR_MSG</a>(<span class="stringliteral">&quot;FitResult::Scan&quot;</span>, <span class="stringliteral">&quot;Minimizer is not available - cannot Scan&quot;</span>);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   }</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a46b67d05dbeae55b81082464541da24a">fMinimizer</a>-&gt;Scan(ipar, npoints, pntsx, pntsy, <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>, <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;}</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">/// Create a 2D contour around the minimum for the parameter ipar and jpar</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">/// if a minimum does not exist or is invalid it will return false</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">/// A array for x and y points should be provided</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">/// Pass optionally the confidence level, default is 0.683</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">/// it is assumed that ErrorDef() defines the right error definition</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">/// (i.e 1 sigma error for one parameter). If not the confidence level are scaled to new level</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00714"></a><span class="lineno"><a class="line" href="classROOT_1_1Fit_1_1FitResult.html#a9a35ef696052c16e7eed4b201a579e92">  714</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a9a35ef696052c16e7eed4b201a579e92">FitResult::Contour</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ipar, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jpar, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;npoints, <span class="keywordtype">double</span> *pntsx, <span class="keywordtype">double</span> *pntsy, <span class="keywordtype">double</span> confLevel)</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;{</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;   <span class="keywordflow">if</span> (!pntsx || !pntsy || !npoints)</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a46b67d05dbeae55b81082464541da24a">fMinimizer</a>) {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <a class="code" href="Error_8h.html#aacf39b83fabf8e530aa6fa4a3cebce28">MATH_ERROR_MSG</a>(<span class="stringliteral">&quot;FitResult::Contour&quot;</span>, <span class="stringliteral">&quot;Minimizer is not available - cannot produce Contour&quot;</span>);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;   <span class="comment">// get error level used for fitting</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   <span class="keywordtype">double</span> upScale = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a46b67d05dbeae55b81082464541da24a">fMinimizer</a>-&gt;ErrorDef();</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   <span class="keywordtype">double</span> upVal = <a class="code" href="namespaceTMath.html#ac9062e2d5b6955de15c688ffda0048b4">TMath::ChisquareQuantile</a>(confLevel, 2); <span class="comment">// 2 is number of parameter we do the contour</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   <span class="comment">// set required error definition in minimizer</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a46b67d05dbeae55b81082464541da24a">fMinimizer</a>-&gt;SetErrorDef(upScale * upVal);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;   <span class="keywordtype">bool</span> ret = <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a46b67d05dbeae55b81082464541da24a">fMinimizer</a>-&gt;Contour(ipar, jpar, npoints, pntsx, pntsy);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   <span class="comment">// restore the error level used for fitting</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;   <a class="code" href="classROOT_1_1Fit_1_1FitResult.html#a46b67d05dbeae55b81082464541da24a">fMinimizer</a>-&gt;SetErrorDef(upScale);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;}</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;   } <span class="comment">// end namespace Fit</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;} <span class="comment">// end namespace ROOT</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_ac8d0c7ab3147acf80f5413b5ca6e7a6e"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#ac8d0c7ab3147acf80f5413b5ca6e7a6e">ROOT::Fit::FitResult::Index</a></div><div class="ttdeci">int Index(const std::string &amp;name) const</div><div class="ttdoc">get index for parameter name (return -1 if not found) </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00408">FitResult.cxx:408</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1ParameterSettings_html_a06d3f1a845bd1c32f3689c5280b97db1"><div class="ttname"><a href="classROOT_1_1Fit_1_1ParameterSettings.html#a06d3f1a845bd1c32f3689c5280b97db1">ROOT::Fit::ParameterSettings::IsFixed</a></div><div class="ttdeci">bool IsFixed() const</div><div class="ttdoc">check if is fixed </div><div class="ttdef"><b>Definition:</b> <a href="ParameterSettings_8h_source.html#l00118">ParameterSettings.h:118</a></div></div>
<div class="ttc" id="ProbFuncMathCore_8h_html"><div class="ttname"><a href="ProbFuncMathCore_8h.html">ProbFuncMathCore.h</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_ad0da8f6d0ba64245a58157915fb79719"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#ad0da8f6d0ba64245a58157915fb79719">ROOT::Fit::FitResult::ParName</a></div><div class="ttdeci">std::string ParName(unsigned int i) const</div><div class="ttdoc">name of the parameter </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00439">FitResult.cxx:439</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_aafdbf842041123165d814fe53d1b9ccb"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#aafdbf842041123165d814fe53d1b9ccb">ROOT::Fit::FitResult::fChi2</a></div><div class="ttdeci">double fChi2</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00355">FitResult.h:355</a></div></div>
<div class="ttc" id="THbookFile_8cxx_html_a058f249a5e6d20724cb0784b40a183e8"><div class="ttname"><a href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a></div><div class="ttdeci">float xmin</div><div class="ttdef"><b>Definition:</b> <a href="THbookFile_8cxx_source.html#l00093">THbookFile.cxx:93</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_ac209e8baa1acb75562cbe04f61247862"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#ac209e8baa1acb75562cbe04f61247862">ROOT::Fit::FitResult::fObjFunc</a></div><div class="ttdeci">std::shared_ptr&lt; ROOT::Math::IMultiGenFunction &gt; fObjFunc</div><div class="ttdoc">minimizer object used for fitting </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00357">FitResult.h:357</a></div></div>
<div class="ttc" id="namespaceROOT_html"><div class="ttname"><a href="namespaceROOT.html">ROOT</a></div><div class="ttdoc">Namespace for new ROOT classes and functions. </div><div class="ttdef"><b>Definition:</b> <a href="StringConv_8hxx_source.html#l00021">StringConv.hxx:21</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a63529efa94b2d05337fe994805768a08"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a63529efa94b2d05337fe994805768a08">ROOT::Fit::FitResult::CovMatrix</a></div><div class="ttdeci">double CovMatrix(unsigned int i, unsigned int j) const</div><div class="ttdoc">retrieve covariance matrix element </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00217">FitResult.h:217</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a630ee48277cb8124a36404fe934a3918"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a630ee48277cb8124a36404fe934a3918">ROOT::Fit::FitResult::Error</a></div><div class="ttdeci">double Error(unsigned int i) const</div><div class="ttdoc">parameter error by index </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00187">FitResult.h:187</a></div></div>
<div class="ttc" id="RichardsonDerivator_8h_html"><div class="ttname"><a href="RichardsonDerivator_8h.html">RichardsonDerivator.h</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1ParameterSettings_html"><div class="ttname"><a href="classROOT_1_1Fit_1_1ParameterSettings.html">ROOT::Fit::ParameterSettings</a></div><div class="ttdoc">Class, describing value, limits and step size of the parameters Provides functionality also to set/re...</div><div class="ttdef"><b>Definition:</b> <a href="ParameterSettings_8h_source.html#l00036">ParameterSettings.h:36</a></div></div>
<div class="ttc" id="namespaceTMath_html_af59fdde9bc9c1ec1a90d2f514bb7079a"><div class="ttname"><a href="namespaceTMath.html#af59fdde9bc9c1ec1a90d2f514bb7079a">TMath::StudentQuantile</a></div><div class="ttdeci">Double_t StudentQuantile(Double_t p, Double_t ndf, Bool_t lower_tail=kTRUE)</div><div class="ttdoc">Computes quantiles of the Student&amp;#39;s t-distribution 1st argument is the probability, at which the quantile is computed 2nd argument - the number of degrees of freedom of the Student distribution When the 3rd argument lower_tail is kTRUE (default)- the algorithm returns such x0, that. </div><div class="ttdef"><b>Definition:</b> <a href="TMath_8cxx_source.html#l02640">TMath.cxx:2640</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a36408f0f9b0ed36a07cafac15e53b150"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a36408f0f9b0ed36a07cafac15e53b150">ROOT::Fit::FitResult::fVal</a></div><div class="ttdeci">double fVal</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00353">FitResult.h:353</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a65a77daab276d605373d508479c3b6a7"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a65a77daab276d605373d508479c3b6a7">ROOT::Fit::FitResult::GetConfidenceIntervals</a></div><div class="ttdeci">void GetConfidenceIntervals(unsigned int n, unsigned int stride1, unsigned int stride2, const double *x, double *ci, double cl=0.95, bool norm=false) const</div><div class="ttdoc">get confidence intervals for an array of n points x. </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00560">FitResult.cxx:560</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitConfig_html_a557466d38bac08618f552f53b2ae54ee"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitConfig.html#a557466d38bac08618f552f53b2ae54ee">ROOT::Fit::FitConfig::MinosParams</a></div><div class="ttdeci">const std::vector&lt; unsigned int &gt; &amp; MinosParams() const</div><div class="ttdoc">return vector of parameter indeces for which the Minos Error will be computed </div><div class="ttdef"><b>Definition:</b> <a href="FitConfig_8h_source.html#l00215">FitConfig.h:215</a></div></div>
<div class="ttc" id="namespaceROOT_1_1Fit_html_a15bc3570f6c3277d8fdd179b4336a4c4"><div class="ttname"><a href="namespaceROOT_1_1Fit.html#a15bc3570f6c3277d8fdd179b4336a4c4">ROOT::Fit::gInitialResultStatus</a></div><div class="ttdeci">const int gInitialResultStatus</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00043">FitResult.cxx:43</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1ParameterSettings_html_ab899ea0a6e32b8334c828ecbb7023d86"><div class="ttname"><a href="classROOT_1_1Fit_1_1ParameterSettings.html#ab899ea0a6e32b8334c828ecbb7023d86">ROOT::Fit::ParameterSettings::Value</a></div><div class="ttdeci">double Value() const</div><div class="ttdoc">copy constructor and assignment operators (leave them to the compiler) </div><div class="ttdef"><b>Definition:</b> <a href="ParameterSettings_8h_source.html#l00110">ParameterSettings.h:110</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitConfig_html_a88ec373c3a3e2befa148da37ec37e9bc"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitConfig.html#a88ec373c3a3e2befa148da37ec37e9bc">ROOT::Fit::FitConfig::NPar</a></div><div class="ttdeci">unsigned int NPar() const</div><div class="ttdoc">number of parameters settings </div><div class="ttdef"><b>Definition:</b> <a href="FitConfig_8h_source.html#l00095">FitConfig.h:95</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a354b03a90c7507d2bca9030f2c37365e"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a354b03a90c7507d2bca9030f2c37365e">ROOT::Fit::FitResult::FillResult</a></div><div class="ttdeci">void FillResult(const std::shared_ptr&lt; ROOT::Math::Minimizer &gt; &amp;min, const FitConfig &amp;fconfig, const std::shared_ptr&lt; IModelFunction &gt; &amp;f, bool isValid, unsigned int sizeOfData=0, bool binFit=true, const ROOT::Math::IMultiGenFunction *chi2func=0, unsigned int ncalls=0)</div><div class="ttdoc">Fill the fit result from a Minimizer instance after fitting Run also Minos if requested from the conf...</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00100">FitResult.cxx:100</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a364b587d561ca0acca410900b841d1b4"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a364b587d561ca0acca410900b841d1b4">ROOT::Fit::FitResult::operator=</a></div><div class="ttdeci">FitResult &amp; operator=(const FitResult &amp;rhs)</div><div class="ttdoc">Assignment operator. </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00248">FitResult.cxx:248</a></div></div>
<div class="ttc" id="QuantFuncMathCore_8h_html"><div class="ttname"><a href="QuantFuncMathCore_8h.html">QuantFuncMathCore.h</a></div></div>
<div class="ttc" id="IParamFunction_8h_html"><div class="ttname"><a href="IParamFunction_8h.html">IParamFunction.h</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_acd54b71c21b0bcea6fbb628d7541bbd2"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#acd54b71c21b0bcea6fbb628d7541bbd2">ROOT::Fit::FitResult::Prob</a></div><div class="ttdeci">double Prob() const</div><div class="ttdoc">p value of the fit (chi2 probability) </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00377">FitResult.cxx:377</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a397a95b508669f124d2456ba72b8113c"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a397a95b508669f124d2456ba72b8113c">ROOT::Fit::FitResult::fEdm</a></div><div class="ttdeci">double fEdm</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00354">FitResult.h:354</a></div></div>
<div class="ttc" id="BinData_8h_html"><div class="ttname"><a href="BinData_8h.html">BinData.h</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitConfig_html_a76f612eb7f7d4d168c1ee58d5c441f68"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitConfig.html#a76f612eb7f7d4d168c1ee58d5c441f68">ROOT::Fit::FitConfig::ParSettings</a></div><div class="ttdeci">const ParameterSettings &amp; ParSettings(unsigned int i) const</div><div class="ttdoc">get the parameter settings for the i-th parameter (const method) </div><div class="ttdef"><b>Definition:</b> <a href="FitConfig_8h_source.html#l00075">FitConfig.h:75</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a9d1fe282135cc9aa6d14ae59b097715c"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a9d1fe282135cc9aa6d14ae59b097715c">ROOT::Fit::FitResult::HasMinosError</a></div><div class="ttdeci">bool HasMinosError(unsigned int i) const</div><div class="ttdoc">query if parameter i has the Minos error </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00382">FitResult.cxx:382</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_abbbc0366a24ce6354d4a0799c91a41a6"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#abbbc0366a24ce6354d4a0799c91a41a6">ROOT::Fit::FitResult::fFixedParams</a></div><div class="ttdeci">std::map&lt; unsigned int, bool &gt; fFixedParams</div><div class="ttdoc">data set used in the fit </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00360">FitResult.h:360</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a973b7262442efb5bc20077e0fbd69308"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a973b7262442efb5bc20077e0fbd69308">ROOT::Fit::FitResult::fNCalls</a></div><div class="ttdeci">unsigned int fNCalls</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00350">FitResult.h:350</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_ae109e7130bce34380a40dff3083fff95"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#ae109e7130bce34380a40dff3083fff95">ROOT::Fit::FitResult::fNormalized</a></div><div class="ttdeci">bool fNormalized</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00347">FitResult.h:347</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitData_html_a108cf3f7a1fcf54d099d3cfb84e22134"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitData.html#a108cf3f7a1fcf54d099d3cfb84e22134">ROOT::Fit::FitData::Coords</a></div><div class="ttdeci">const double * Coords(unsigned int ipoint) const</div><div class="ttdoc">return a pointer to the coordinates data for the given fit point </div><div class="ttdef"><b>Definition:</b> <a href="FitData_8h_source.html#l00246">FitData.h:246</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a3afd3d45feb47b47d8d6dc5c7cf68121"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a3afd3d45feb47b47d8d6dc5c7cf68121">ROOT::Fit::FitResult::fErrors</a></div><div class="ttdeci">std::vector&lt; double &gt; fErrors</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00364">FitResult.h:364</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a57049d840c654a2d8b63bc46477aca68"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a57049d840c654a2d8b63bc46477aca68">ROOT::Fit::FitResult::fNdf</a></div><div class="ttdeci">unsigned int fNdf</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00349">FitResult.h:349</a></div></div>
<div class="ttc" id="TMath_8h_html_acdb55c1010a6c379a49db0201bf55d89"><div class="ttname"><a href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a></div><div class="ttdeci">double sqrt(double)</div></div>
<div class="ttc" id="namespaceTMath_html_ac9062e2d5b6955de15c688ffda0048b4"><div class="ttname"><a href="namespaceTMath.html#ac9062e2d5b6955de15c688ffda0048b4">TMath::ChisquareQuantile</a></div><div class="ttdeci">Double_t ChisquareQuantile(Double_t p, Double_t ndf)</div><div class="ttdoc">Evaluate the quantiles of the chi-squared probability distribution function. </div><div class="ttdef"><b>Definition:</b> <a href="TMath_8cxx_source.html#l02164">TMath.cxx:2164</a></div></div>
<div class="ttc" id="legend1_8C_html_a13c6713ae496caa8195647f76887f926"><div class="ttname"><a href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a></div><div class="ttdeci">Double_t x[n]</div><div class="ttdef"><b>Definition:</b> <a href="legend1_8C_source.html#l00017">legend1.C:17</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a7133a8cd7f9b18286e8f7956e6c9ef27"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a7133a8cd7f9b18286e8f7956e6c9ef27">ROOT::Fit::FitResult::Scan</a></div><div class="ttdeci">bool Scan(unsigned int ipar, unsigned int &amp;npoints, double *pntsx, double *pntsy, double xmin=0, double xmax=0)</div><div class="ttdoc">scan likelihood value of parameter and fill the given graph. </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00693">FitResult.cxx:693</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a675eca88348a34f50cdb9ab02a94be0d"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a675eca88348a34f50cdb9ab02a94be0d">ROOT::Fit::FitResult::fCovStatus</a></div><div class="ttdeci">int fCovStatus</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00352">FitResult.h:352</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a76a6f3043fa1c3783475477d3b9cf232"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a76a6f3043fa1c3783475477d3b9cf232">ROOT::Fit::FitResult::fFitData</a></div><div class="ttdeci">std::shared_ptr&lt; FitData &gt; fFitData</div><div class="ttdoc">model function resulting from the fit. </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00359">FitResult.h:359</a></div></div>
<div class="ttc" id="OneDimFunctionAdapter_8h_html"><div class="ttname"><a href="OneDimFunctionAdapter_8h.html">OneDimFunctionAdapter.h</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_ac8b9f08d063e645cb1627e01a5175ef3"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#ac8b9f08d063e645cb1627e01a5175ef3">ROOT::Fit::FitResult::~FitResult</a></div><div class="ttdeci">virtual ~FitResult()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00236">FitResult.cxx:236</a></div></div>
<div class="ttc" id="Error_8h_html"><div class="ttname"><a href="Error_8h.html">Error.h</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a7aa021ae993d9dd151a480b82351ecb8"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a7aa021ae993d9dd151a480b82351ecb8">ROOT::Fit::FitResult::GetParameterName</a></div><div class="ttdeci">std::string GetParameterName(unsigned int ipar) const</div><div class="ttdoc">get name of parameter (deprecated) </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00329">FitResult.h:329</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a8ada69c59e80401a7adfd64832e82327"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a8ada69c59e80401a7adfd64832e82327">ROOT::Fit::FitResult::LowerError</a></div><div class="ttdeci">double LowerError(unsigned int i) const</div><div class="ttdoc">lower Minos error. If Minos has not run for parameter i return the parabolic error ...</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00389">FitResult.cxx:389</a></div></div>
<div class="ttc" id="namespaceTGeant4Unit_html_a5d450e80998065902b102dca2a69066a"><div class="ttname"><a href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">TGeant4Unit::s</a></div><div class="ttdeci">static constexpr double s</div><div class="ttdef"><b>Definition:</b> <a href="TGeant4SystemOfUnits_8h_source.html#l00162">TGeant4SystemOfUnits.h:162</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1ParameterSettings_html_ad70b6ff0729c5daf60be0fc84fd4ad8a"><div class="ttname"><a href="classROOT_1_1Fit_1_1ParameterSettings.html#ad70b6ff0729c5daf60be0fc84fd4ad8a">ROOT::Fit::ParameterSettings::StepSize</a></div><div class="ttdeci">double StepSize() const</div><div class="ttdoc">return step size </div><div class="ttdef"><b>Definition:</b> <a href="ParameterSettings_8h_source.html#l00112">ParameterSettings.h:112</a></div></div>
<div class="ttc" id="Error_8h_html_aacf39b83fabf8e530aa6fa4a3cebce28"><div class="ttname"><a href="Error_8h.html#aacf39b83fabf8e530aa6fa4a3cebce28">MATH_ERROR_MSG</a></div><div class="ttdeci">#define MATH_ERROR_MSG(loc, str)</div><div class="ttdef"><b>Definition:</b> <a href="Error_8h_source.html#l00082">Error.h:82</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_aa15b32e61bcb3b3b22d3f7e9a897ffbe"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#aa15b32e61bcb3b3b22d3f7e9a897ffbe">ROOT::Fit::FitResult::fStatus</a></div><div class="ttdeci">int fStatus</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00351">FitResult.h:351</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a46b67d05dbeae55b81082464541da24a"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a46b67d05dbeae55b81082464541da24a">ROOT::Fit::FitResult::fMinimizer</a></div><div class="ttdeci">std::shared_ptr&lt; ROOT::Math::Minimizer &gt; fMinimizer</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00356">FitResult.h:356</a></div></div>
<div class="ttc" id="classROOT_1_1Math_1_1IBaseFunctionMultiDimTempl_html"><div class="ttname"><a href="classROOT_1_1Math_1_1IBaseFunctionMultiDimTempl.html">ROOT::Math::IBaseFunctionMultiDimTempl</a></div><div class="ttdoc">Documentation for the abstract class IBaseFunctionMultiDim. </div><div class="ttdef"><b>Definition:</b> <a href="IFunction_8h_source.html#l00062">IFunction.h:62</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_ab9ee8bd93aee886457fe6d8214443013"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#ab9ee8bd93aee886457fe6d8214443013">ROOT::Fit::FitResult::fFitFunc</a></div><div class="ttdeci">std::shared_ptr&lt; IModelFunction &gt; fFitFunc</div><div class="ttdoc">objective function used for fitting </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00358">FitResult.h:358</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_ac063bda9213e56ff41e80fa0c013c29f"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#ac063bda9213e56ff41e80fa0c013c29f">ROOT::Fit::FitResult::Correlation</a></div><div class="ttdeci">double Correlation(unsigned int i, unsigned int j) const</div><div class="ttdoc">retrieve correlation elements </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00227">FitResult.h:227</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_af5f29bd9c41b01ea5a6a9f87faa6684f"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#af5f29bd9c41b01ea5a6a9f87faa6684f">ROOT::Fit::FitResult::fMinosErrors</a></div><div class="ttdeci">std::map&lt; unsigned int, std::pair&lt; double, double &gt; &gt; fMinosErrors</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00367">FitResult.h:367</a></div></div>
<div class="ttc" id="Object_8C_html_ac15f01b9c6407e1312dfc196ad4e0870"><div class="ttname"><a href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a></div><div class="ttdeci">ROOT::R::TRInterface &amp; r</div><div class="ttdef"><b>Definition:</b> <a href="Object_8C_source.html#l00004">Object.C:4</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a839a75128601d96aa6d20dea994843d2"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a839a75128601d96aa6d20dea994843d2">ROOT::Fit::FitResult::SetMinosError</a></div><div class="ttdeci">void SetMinosError(unsigned int i, double elow, double eup)</div><div class="ttdoc">set the Minos errors for parameter i (called by the Fitter class when running Minos) ...</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00403">FitResult.cxx:403</a></div></div>
<div class="ttc" id="FitResult_8h_html"><div class="ttname"><a href="FitResult_8h.html">FitResult.h</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1ParameterSettings_html_a197cec29dba946e337db24a8f4379acb"><div class="ttname"><a href="classROOT_1_1Fit_1_1ParameterSettings.html#a197cec29dba946e337db24a8f4379acb">ROOT::Fit::ParameterSettings::HasUpperLimit</a></div><div class="ttdeci">bool HasUpperLimit() const</div><div class="ttdoc">check if parameter has upper limit </div><div class="ttdef"><b>Definition:</b> <a href="ParameterSettings_8h_source.html#l00122">ParameterSettings.h:122</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1BinData_html"><div class="ttname"><a href="classROOT_1_1Fit_1_1BinData.html">ROOT::Fit::BinData</a></div><div class="ttdoc">Class describing the binned data sets : vectors of x coordinates, y values and optionally error on y ...</div><div class="ttdef"><b>Definition:</b> <a href="BinData_8h_source.html#l00053">BinData.h:53</a></div></div>
<div class="ttc" id="THbookFile_8cxx_html_a9c42f51718ed192ed1841a53d2b0e507"><div class="ttname"><a href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a></div><div class="ttdeci">float xmax</div><div class="ttdef"><b>Definition:</b> <a href="THbookFile_8cxx_source.html#l00093">THbookFile.cxx:93</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a321839e88302c7dc0ce9ef0a92ba3c99"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a321839e88302c7dc0ce9ef0a92ba3c99">ROOT::Fit::FitResult::UpperError</a></div><div class="ttdeci">double UpperError(unsigned int i) const</div><div class="ttdoc">upper Minos error. If Minos has not run for parameter i return the parabolic error ...</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00396">FitResult.cxx:396</a></div></div>
<div class="ttc" id="classROOT_1_1Math_1_1OneDimParamFunctionAdapter_html"><div class="ttname"><a href="classROOT_1_1Math_1_1OneDimParamFunctionAdapter.html">ROOT::Math::OneDimParamFunctionAdapter</a></div><div class="ttdoc">OneDimParamFunctionAdapter class to wrap a multi-dim parameteric function in one dimensional one...</div><div class="ttdef"><b>Definition:</b> <a href="OneDimFunctionAdapter_8h_source.html#l00213">OneDimFunctionAdapter.h:213</a></div></div>
<div class="ttc" id="namespaceTMath_html_a8a8fbe07e94608dbed9e9260283a442f"><div class="ttname"><a href="namespaceTMath.html#a8a8fbe07e94608dbed9e9260283a442f">TMath::E</a></div><div class="ttdeci">constexpr Double_t E()</div><div class="ttdoc">Base of natural log: . </div><div class="ttdef"><b>Definition:</b> <a href="TMath_8h_source.html#l00097">TMath.h:97</a></div></div>
<div class="ttc" id="RSha256_8hxx_html_a23b5b0a85bf5762c93a855f40c0343ce"><div class="ttname"><a href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a></div><div class="ttdeci">#define d(i)</div><div class="ttdef"><b>Definition:</b> <a href="RSha256_8hxx_source.html#l00102">RSha256.hxx:102</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1ParameterSettings_html_ae6ba30b421b25ce9a5ef6a1d3eb49bd5"><div class="ttname"><a href="classROOT_1_1Fit_1_1ParameterSettings.html#ae6ba30b421b25ce9a5ef6a1d3eb49bd5">ROOT::Fit::ParameterSettings::UpperLimit</a></div><div class="ttdeci">double UpperLimit() const</div><div class="ttdoc">return upper limit value </div><div class="ttdef"><b>Definition:</b> <a href="ParameterSettings_8h_source.html#l00116">ParameterSettings.h:116</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a1b13419eb0ff1a7c65f65173ebd092dc"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a1b13419eb0ff1a7c65f65173ebd092dc">ROOT::Fit::FitResult::fNFree</a></div><div class="ttdeci">unsigned int fNFree</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00348">FitResult.h:348</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html">ROOT::Fit::FitResult</a></div><div class="ttdoc">class containg the result of the fit and all the related information (fitted parameter values...</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00048">FitResult.h:48</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a965b1c9ea0098fcd4cf3b57fbb6ef3a4"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a965b1c9ea0098fcd4cf3b57fbb6ef3a4">ROOT::Fit::FitResult::PrintCovMatrix</a></div><div class="ttdeci">void PrintCovMatrix(std::ostream &amp;os) const</div><div class="ttdoc">print error matrix and correlations </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00501">FitResult.cxx:501</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1ParameterSettings_html_a2a9d0c8b26bf81c4051e7b01527d5882"><div class="ttname"><a href="classROOT_1_1Fit_1_1ParameterSettings.html#a2a9d0c8b26bf81c4051e7b01527d5882">ROOT::Fit::ParameterSettings::Name</a></div><div class="ttdeci">const std::string &amp; Name() const</div><div class="ttdoc">return name </div><div class="ttdef"><b>Definition:</b> <a href="ParameterSettings_8h_source.html#l00128">ParameterSettings.h:128</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_ad15cd641e6a1ba300c6fc507bcc8326a"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#ad15cd641e6a1ba300c6fc507bcc8326a">ROOT::Fit::FitResult::NormalizeErrors</a></div><div class="ttdeci">void NormalizeErrors()</div><div class="ttdoc">normalize errors using chi2/ndf for chi2 fits </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00363">FitResult.cxx:363</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_abda58bd0c359b2bb84488f53a076bf63"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#abda58bd0c359b2bb84488f53a076bf63">ROOT::Fit::FitResult::fMinimType</a></div><div class="ttdeci">std::string fMinimType</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00368">FitResult.h:368</a></div></div>
<div class="ttc" id="namespaceHFit_html_a47800da6993797a237fc1a151eaf92c8"><div class="ttname"><a href="namespaceHFit.html#a47800da6993797a237fc1a151eaf92c8">HFit::Fit</a></div><div class="ttdeci">TFitResultPtr Fit(FitObject *h1, TF1 *f1, Foption_t &amp;option, const ROOT::Math::MinimizerOptions &amp;moption, const char *goption, ROOT::Fit::DataRange &amp;range)</div><div class="ttdef"><b>Definition:</b> <a href="HFitImpl_8cxx_source.html#l00134">HFitImpl.cxx:134</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a4a4f5098d7853c6b98a5e075d0d0104b"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a4a4f5098d7853c6b98a5e075d0d0104b">ROOT::Fit::FitResult::IsParameterFixed</a></div><div class="ttdeci">bool IsParameterFixed(unsigned int ipar) const</div><div class="ttdoc">query if a parameter is fixed </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00422">FitResult.cxx:422</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitConfig_html_aae96718f0b8678724f38f21ee199812f"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitConfig.html#aae96718f0b8678724f38f21ee199812f">ROOT::Fit::FitConfig::MinimizerType</a></div><div class="ttdeci">const std::string &amp; MinimizerType() const</div><div class="ttdoc">return type of minimizer package </div><div class="ttdef"><b>Definition:</b> <a href="FitConfig_8h_source.html#l00188">FitConfig.h:188</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a9efd78a90e429e4afd01e4af1961a6a4"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a9efd78a90e429e4afd01e4af1961a6a4">ROOT::Fit::FitResult::fParamBounds</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; double, double &gt; &gt; fParamBounds</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00362">FitResult.h:362</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitConfig_html_affc69e79d4bd17dbb9eaae3c68ea0ad1"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitConfig.html#affc69e79d4bd17dbb9eaae3c68ea0ad1">ROOT::Fit::FitConfig::MinosErrors</a></div><div class="ttdeci">bool MinosErrors() const</div><div class="ttdoc">do minos errros analysis on the parameters </div><div class="ttdef"><b>Definition:</b> <a href="FitConfig_8h_source.html#l00205">FitConfig.h:205</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_af186297121ec413262a8c18fbc34bc4d"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#af186297121ec413262a8c18fbc34bc4d">ROOT::Fit::FitResult::fParNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; fParNames</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00369">FitResult.h:369</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a879917fed14db36f8d63fb0170d68d1d"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a879917fed14db36f8d63fb0170d68d1d">ROOT::Fit::FitResult::Print</a></div><div class="ttdeci">void Print(std::ostream &amp;os, bool covmat=false) const</div><div class="ttdoc">print the result and optionaly covariance matrix and correlations </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00446">FitResult.cxx:446</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a1d7d2b0c8017fc8d30c2958a46409693"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a1d7d2b0c8017fc8d30c2958a46409693">ROOT::Fit::FitResult::FittedBinData</a></div><div class="ttdeci">const BinData * FittedBinData() const</div><div class="ttdoc">return BinData used in the fit (return a nullptr in case a different fit is done or the data are not ...</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00685">FitResult.cxx:685</a></div></div>
<div class="ttc" id="namespaceROOT_1_1Math_1_1Util_html_ae2cc169bb3bf8b060d62776073e21731"><div class="ttname"><a href="namespaceROOT_1_1Math_1_1Util.html#ae2cc169bb3bf8b060d62776073e21731">ROOT::Math::Util::ToString</a></div><div class="ttdeci">std::string ToString(const T &amp;val)</div><div class="ttdoc">Utility function for conversion to strings. </div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00049">Util.h:49</a></div></div>
<div class="ttc" id="group__ProbFunc_html_gae07ba00b57c524cfbbc9923cdff3f9b0"><div class="ttname"><a href="group__ProbFunc.html#gae07ba00b57c524cfbbc9923cdff3f9b0">ROOT::Math::chisquared_cdf_c</a></div><div class="ttdeci">double chisquared_cdf_c(double x, double r, double x0=0)</div><div class="ttdoc">Complement of the cumulative distribution function of the  distribution with  degrees of freedom (upp...</div><div class="ttdef"><b>Definition:</b> <a href="ProbFuncMathCore_8cxx_source.html#l00057">ProbFuncMathCore.cxx:57</a></div></div>
<div class="ttc" id="textangle_8C_html_a3359d7f1aa9fe2f8bc884b02020e8d20"><div class="ttname"><a href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a></div><div class="ttdeci">auto * l</div><div class="ttdef"><b>Definition:</b> <a href="textangle_8C_source.html#l00004">textangle.C:4</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a00ad94da224db02fbdc200e2eaa4317e"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a00ad94da224db02fbdc200e2eaa4317e">ROOT::Fit::FitResult::fGlobalCC</a></div><div class="ttdeci">std::vector&lt; double &gt; fGlobalCC</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00366">FitResult.h:366</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a766724aba85ff02787b5237795c3c0d2"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a766724aba85ff02787b5237795c3c0d2">ROOT::Fit::FitResult::FitResult</a></div><div class="ttdeci">FitResult()</div><div class="ttdoc">Default constructor for an empty (non valid) fit result. </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00045">FitResult.cxx:45</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a7f7828f859db9a040c49c087c13efcee"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a7f7828f859db9a040c49c087c13efcee">ROOT::Fit::FitResult::fCovMatrix</a></div><div class="ttdeci">std::vector&lt; double &gt; fCovMatrix</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00365">FitResult.h:365</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a483f1d561ada44f18a63522c31cdc81f"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a483f1d561ada44f18a63522c31cdc81f">ROOT::Fit::FitResult::fValid</a></div><div class="ttdeci">bool fValid</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00346">FitResult.h:346</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1ParameterSettings_html_a3d77a1ec2162f7236bc9c3ba89087d46"><div class="ttname"><a href="classROOT_1_1Fit_1_1ParameterSettings.html#a3d77a1ec2162f7236bc9c3ba89087d46">ROOT::Fit::ParameterSettings::LowerLimit</a></div><div class="ttdeci">double LowerLimit() const</div><div class="ttdoc">return lower limit value </div><div class="ttdef"><b>Definition:</b> <a href="ParameterSettings_8h_source.html#l00114">ParameterSettings.h:114</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a1d7a8c0991454bb9073e9420c87926e3"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a1d7a8c0991454bb9073e9420c87926e3">ROOT::Fit::FitResult::fBoundParams</a></div><div class="ttdeci">std::map&lt; unsigned int, unsigned int &gt; fBoundParams</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00361">FitResult.h:361</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a7b11acee355a264b6b8a158533f280d0"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a7b11acee355a264b6b8a158533f280d0">ROOT::Fit::FitResult::ParameterBounds</a></div><div class="ttdeci">bool ParameterBounds(unsigned int ipar, double &amp;lower, double &amp;upper) const</div><div class="ttdoc">retrieve parameter bounds - return false if parameter is not bound </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00426">FitResult.cxx:426</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a7d7e5af8d287cca10cea052fa368336d"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a7d7e5af8d287cca10cea052fa368336d">ROOT::Fit::FitResult::fParams</a></div><div class="ttdeci">std::vector&lt; double &gt; fParams</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8h_source.html#l00363">FitResult.h:363</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitData_html_a915e1c3df239935ba03c716d68579832"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitData.html#a915e1c3df239935ba03c716d68579832">ROOT::Fit::FitData::NPoints</a></div><div class="ttdeci">unsigned int NPoints() const</div><div class="ttdoc">return number of fit points </div><div class="ttdef"><b>Definition:</b> <a href="FitData_8h_source.html#l00295">FitData.h:295</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitData_html_abe97d7c530fce05d05c42b88423e1154"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitData.html#abe97d7c530fce05d05c42b88423e1154">ROOT::Fit::FitData::NDim</a></div><div class="ttdeci">unsigned int NDim() const</div><div class="ttdoc">return coordinate data dimension </div><div class="ttdef"><b>Definition:</b> <a href="FitData_8h_source.html#l00311">FitData.h:311</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1ParameterSettings_html_af3c9d582eb5d9a221b2251b3f5639dbf"><div class="ttname"><a href="classROOT_1_1Fit_1_1ParameterSettings.html#af3c9d582eb5d9a221b2251b3f5639dbf">ROOT::Fit::ParameterSettings::IsBound</a></div><div class="ttdeci">bool IsBound() const</div><div class="ttdoc">check if is bound </div><div class="ttdef"><b>Definition:</b> <a href="ParameterSettings_8h_source.html#l00124">ParameterSettings.h:124</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_a9a35ef696052c16e7eed4b201a579e92"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#a9a35ef696052c16e7eed4b201a579e92">ROOT::Fit::FitResult::Contour</a></div><div class="ttdeci">bool Contour(unsigned int ipar, unsigned int jpar, unsigned int &amp;npoints, double *pntsx, double *pntsy, double confLevel=0.683)</div><div class="ttdoc">create contour of two parameters around the minimum pass as option confidence level: default is a val...</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00714">FitResult.cxx:714</a></div></div>
<div class="ttc" id="TMath_8h_html"><div class="ttname"><a href="TMath_8h.html">TMath.h</a></div></div>
<div class="ttc" id="Minimizer_8h_html"><div class="ttname"><a href="Minimizer_8h.html">Minimizer.h</a></div></div>
<div class="ttc" id="legend1_8C_html_a16daaa7b596941b23915a1ac1be5b42c"><div class="ttname"><a href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a></div><div class="ttdeci">const Int_t n</div><div class="ttdef"><b>Definition:</b> <a href="legend1_8C_source.html#l00016">legend1.C:16</a></div></div>
<div class="ttc" id="classROOT_1_1Math_1_1RichardsonDerivator_html"><div class="ttname"><a href="classROOT_1_1Math_1_1RichardsonDerivator.html">ROOT::Math::RichardsonDerivator</a></div><div class="ttdoc">User class for calculating the derivatives of a function. </div><div class="ttdef"><b>Definition:</b> <a href="RichardsonDerivator_8h_source.html#l00055">RichardsonDerivator.h:55</a></div></div>
<div class="ttc" id="group__QuantFunc_html_gac799813b6815345f48ab4a707e56b553"><div class="ttname"><a href="group__QuantFunc.html#gac799813b6815345f48ab4a707e56b553">ROOT::Math::chisquared_quantile</a></div><div class="ttdeci">double chisquared_quantile(double z, double r)</div><div class="ttdoc">Inverse ( ) of the cumulative distribution function of the lower tail of the  distribution with  degr...</div><div class="ttdef"><b>Definition:</b> <a href="QuantFuncMathCore_8cxx_source.html#l00067">QuantFuncMathCore.cxx:67</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_ae2d5929a694261d1912794b97e233c4e"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#ae2d5929a694261d1912794b97e233c4e">ROOT::Fit::FitResult::IsParameterBound</a></div><div class="ttdeci">bool IsParameterBound(unsigned int ipar) const</div><div class="ttdoc">query if a parameter is bound </div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00418">FitResult.cxx:418</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1ParameterSettings_html_a736b14510b928a28302017a89f87d595"><div class="ttname"><a href="classROOT_1_1Fit_1_1ParameterSettings.html#a736b14510b928a28302017a89f87d595">ROOT::Fit::ParameterSettings::HasLowerLimit</a></div><div class="ttdeci">bool HasLowerLimit() const</div><div class="ttdoc">check if parameter has lower limit </div><div class="ttdef"><b>Definition:</b> <a href="ParameterSettings_8h_source.html#l00120">ParameterSettings.h:120</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitResult_html_ac16420674a7e4afa75a79ce7b6b4d62e"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitResult.html#ac16420674a7e4afa75a79ce7b6b4d62e">ROOT::Fit::FitResult::Update</a></div><div class="ttdeci">bool Update(const std::shared_ptr&lt; ROOT::Math::Minimizer &gt; &amp;min, bool isValid, unsigned int ncalls=0)</div><div class="ttdoc">Update the fit result with a new minimization status To be run only if same fit is performed with sam...</div><div class="ttdef"><b>Definition:</b> <a href="FitResult_8cxx_source.html#l00291">FitResult.cxx:291</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitConfig_html"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitConfig.html">ROOT::Fit::FitConfig</a></div><div class="ttdoc">Class describing the configuration of the fit, options and parameter settings using the ROOT::Fit::Pa...</div><div class="ttdef"><b>Definition:</b> <a href="FitConfig_8h_source.html#l00046">FitConfig.h:46</a></div></div>
<div class="ttc" id="FitConfig_8h_html"><div class="ttname"><a href="FitConfig_8h.html">FitConfig.h</a></div></div>
<div class="ttc" id="classROOT_1_1Fit_1_1FitConfig_html_ad487eb70ed9166842c01d5a02006f023"><div class="ttname"><a href="classROOT_1_1Fit_1_1FitConfig.html#ad487eb70ed9166842c01d5a02006f023">ROOT::Fit::FitConfig::MinimizerAlgoType</a></div><div class="ttdeci">const std::string &amp; MinimizerAlgoType() const</div><div class="ttdoc">return type of minimizer algorithms </div><div class="ttdef"><b>Definition:</b> <a href="FitConfig_8h_source.html#l00193">FitConfig.h:193</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:09:27 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

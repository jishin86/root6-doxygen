<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/roostats/rs301_splot.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_87facaa6959ceb8d3dacccaf663f7b84.html">roostats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">rs301_splot.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__roostats.html">RooStats Tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/rs301_splot.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/rs301_splot.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  SPlot tutorial </p>
<p>This tutorial shows an example of using SPlot to unfold two distributions. The physics context for the example is that we want to know the isolation distribution for real electrons from Z events and fake electrons from QCD. Isolation is our 'control' variable To unfold them, we need a model for an uncorrelated variable that discriminates between Z and QCD. To do this, we use the invariant mass of two electrons. We model the Z with a Gaussian and the QCD with a falling exponential.</p>
<p>Note, since we don't have real data in this tutorial, we need to generate toy data. To do that we need a model for the isolation variable for both Z and QCD. This is only used to generate the toy data, and would not be needed if we had real data.</p>
<div class="image">
<img src="pict1_rs301_splot.C.png" alt="pict1_rs301_splot.C.png" width="400"/>
</div>
 <div class="fragment"><div class="line"></div><div class="line"></div><div class="line">[1mRooFit v3.60 -- Developed by Wouter Verkerke and David Kirkby[0m </div><div class="line">                Copyright (C) 2000-2013 NIKHEF, University of California &amp; Stanford University</div><div class="line">                All rights reserved, please read http://roofit.sourceforge.net/license.txt</div><div class="line"></div><div class="line">make z model</div><div class="line">make qcd model</div><div class="line">make full model</div><div class="line">import model</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooAddPdf::model</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooProdPdf::zModel</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooGaussian::mZModel</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::invMass</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::mZ</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::sigmaZ</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooExponential::zIsolationModel</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::isolation</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooConstVar::zIsolDecayConst</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::zYield</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooProdPdf::qcdModel</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooExponential::qcdMassModel</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::qcdMassDecayConst</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooExponential::qcdIsolationModel</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooConstVar::qcdIsolDecayConst</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::qcdYield</div><div class="line">make data set and import to workspace</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing dataset modelData</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkSpace::import(myWS) changing name of dataset from  modelData to data</div><div class="line">Calculate sWeights</div><div class="line">[#1] INFO:Minization -- createNLL: caching constraint set under name CONSTR_OF_PDF_model_FOR_OBS_invMass:isolation with 0 entries</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (zIsolationModel,qcdIsolationModel)</div><div class="line">[#1] INFO:Minization --  The following expressions will be evaluated in cache-and-track mode: (mZModel,qcdMassModel)</div><div class="line"> **********</div><div class="line"> **    1 **SET PRINT           1</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    2 **SET NOGRAD</div><div class="line"> **********</div><div class="line"> PARAMETER DEFINITIONS:</div><div class="line">    NO.   NAME         VALUE      STEP SIZE      LIMITS</div><div class="line">     1 qcdMassDecayConst  -1.00000e-02  2.00000e+01   -1.00000e+02  1.00000e+02</div><div class="line">     2 qcdYield     1.00000e+02  5.00000e+01    0.00000e+00  1.00000e+03</div><div class="line">     3 sigmaZ       2.00000e+00  1.00000e+00    0.00000e+00  1.00000e+01</div><div class="line">     4 zYield       5.00000e+01  2.50000e+01    0.00000e+00  1.00000e+03</div><div class="line"> **********</div><div class="line"> **    3 **SET ERR         0.5</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    4 **SET PRINT           1</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    5 **SET STR           1</div><div class="line"> **********</div><div class="line"> NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY</div><div class="line"> **********</div><div class="line"> **    6 **MIGRAD        2000           1</div><div class="line"> **********</div><div class="line"> FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.</div><div class="line"> START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03</div><div class="line"> FCN=1901.86 FROM MIGRAD    STATUS=INITIATE       18 CALLS          19 TOTAL</div><div class="line">                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       </div><div class="line">  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  qcdMassDecayConst  -1.00000e-02   2.00000e+01   2.01358e-01  -1.06814e+05</div><div class="line">   2  qcdYield     1.00000e+02   5.00000e+01   1.72186e-01  -1.57317e+03</div><div class="line">   3  sigmaZ       2.00000e+00   1.00000e+00   2.57889e-01   3.62916e+01</div><div class="line">   4  zYield       5.00000e+01   2.50000e+01   1.18625e-01  -1.41930e+03</div><div class="line">                               ERR DEF= 0.5</div><div class="line"> MIGRAD MINIMIZATION HAS CONVERGED.</div><div class="line"> MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.</div><div class="line"> COVARIANCE MATRIX CALCULATED SUCCESSFULLY</div><div class="line"> FCN=849.923 FROM MIGRAD    STATUS=CONVERGED     110 CALLS         111 TOTAL</div><div class="line">                     EDM=3.1409e-06    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                   STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  qcdMassDecayConst  -9.30176e-03   7.55562e-04   1.52115e-07   2.51004e+01</div><div class="line">   2  qcdYield     6.22140e+02   2.52789e+01   1.04861e-03  -1.45735e-02</div><div class="line">   3  sigmaZ       1.95257e+00   8.09927e-02   4.09416e-04  -7.77193e-02</div><div class="line">   4  zYield       3.77836e+02   1.98770e+01   8.24140e-04  -6.51095e-03</div><div class="line">                               ERR DEF= 0.5</div><div class="line"> EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  4    ERR DEF=0.5</div><div class="line">  5.709e-07  1.999e-04 -1.007e-06 -1.999e-04 </div><div class="line">  1.999e-04  6.396e+02 -9.256e-02 -1.747e+01 </div><div class="line"> -1.007e-06 -9.256e-02  6.561e-03  9.257e-02 </div><div class="line"> -1.999e-04 -1.747e+01  9.257e-02  3.953e+02 </div><div class="line"> PARAMETER  CORRELATION COEFFICIENTS  </div><div class="line">       NO.  GLOBAL      1      2      3      4</div><div class="line">        1  0.02260   1.000  0.010 -0.016 -0.013</div><div class="line">        2  0.05626   0.010  1.000 -0.045 -0.035</div><div class="line">        3  0.07351  -0.016 -0.045  1.000  0.057</div><div class="line">        4  0.06697  -0.013 -0.035  0.057  1.000</div><div class="line"> **********</div><div class="line"> **    7 **SET ERR         0.5</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    8 **SET PRINT           1</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    9 **HESSE        2000</div><div class="line"> **********</div><div class="line"> COVARIANCE MATRIX CALCULATED SUCCESSFULLY</div><div class="line"> FCN=849.923 FROM HESSE     STATUS=OK             23 CALLS         134 TOTAL</div><div class="line">                     EDM=3.13931e-06    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                INTERNAL      INTERNAL  </div><div class="line">  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   </div><div class="line">   1  qcdMassDecayConst  -9.30176e-03   7.55563e-04   3.04229e-08  -9.30176e-05</div><div class="line">   2  qcdYield     6.22140e+02   2.52790e+01   2.09721e-04   2.46778e-01</div><div class="line">   3  sigmaZ       1.95257e+00   8.09935e-02   8.18832e-05  -6.55413e-01</div><div class="line">   4  zYield       3.77836e+02   1.98772e+01   1.64828e-04  -2.46827e-01</div><div class="line">                               ERR DEF= 0.5</div><div class="line"> EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  4    ERR DEF=0.5</div><div class="line">  5.709e-07  2.002e-04 -1.009e-06 -2.002e-04 </div><div class="line">  2.002e-04  6.396e+02 -9.273e-02 -1.749e+01 </div><div class="line"> -1.009e-06 -9.273e-02  6.561e-03  9.273e-02 </div><div class="line"> -2.002e-04 -1.749e+01  9.273e-02  3.953e+02 </div><div class="line"> PARAMETER  CORRELATION COEFFICIENTS  </div><div class="line">       NO.  GLOBAL      1      2      3      4</div><div class="line">        1  0.02264   1.000  0.010 -0.016 -0.013</div><div class="line">        2  0.05634   0.010  1.000 -0.045 -0.035</div><div class="line">        3  0.07364  -0.016 -0.045  1.000  0.058</div><div class="line">        4  0.06707  -0.013 -0.035  0.058  1.000</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization</div><div class="line">[#1] INFO:Minization -- createNLL picked up cached consraints from workspace with 0 entries</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (zModel,qcdModel)</div><div class="line">[#1] INFO:Fitting -- RooAbsPdf::fitTo(model) Calculating sum-of-weights-squared correction matrix for covariance matrix</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization</div><div class="line">[#1] INFO:InputArguments -- Printing Yields</div><div class="line">RooArgList:: = (zYield,qcdYield)</div><div class="line">[#1] INFO:InputArguments -- yield in pdf: zYield 377.841</div><div class="line">[#1] INFO:InputArguments -- yield in pdf: qcdYield 622.16</div><div class="line">[#1] INFO:Eval -- Checking Likelihood normalization:  </div><div class="line">[#1] INFO:Eval -- Yield of specie  Sum of Row in Matrix   Norm</div><div class="line">[#1] INFO:Eval -- 377.841 377.842 0.999999</div><div class="line">[#1] INFO:Eval -- 622.16 622.16 0.999999</div><div class="line">[#1] INFO:Eval -- Calculating sWeight</div><div class="line">Check SWeights:</div><div class="line"></div><div class="line">Yield of Z is 377.841.  From sWeights it is 377.841</div><div class="line">Yield of QCD is 622.16.  From sWeights it is 622.16</div><div class="line"></div><div class="line">z Weight   -0.0259121   qcd Weight   1.02591  Total Weight   1</div><div class="line">z Weight   -0.0259121   qcd Weight   1.02591  Total Weight   1</div><div class="line">z Weight   1.02602   qcd Weight   -0.0260232  Total Weight   1</div><div class="line">z Weight   1.01358   qcd Weight   -0.0135828  Total Weight   1</div><div class="line">z Weight   -0.0259121   qcd Weight   1.02591  Total Weight   1</div><div class="line">z Weight   1.02684   qcd Weight   -0.0268354  Total Weight   1</div><div class="line">z Weight   -0.0259121   qcd Weight   1.02591  Total Weight   1</div><div class="line">z Weight   -0.0259121   qcd Weight   1.02591  Total Weight   1</div><div class="line">z Weight   1.03438   qcd Weight   -0.0343802  Total Weight   1</div><div class="line">z Weight   0.910182   qcd Weight   0.0898196  Total Weight   1</div><div class="line"></div><div class="line">import new dataset with sWeights</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing dataset data</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkSpace::import(myWS) changing name of dataset from  data to dataWithSWeights</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::zYield_sw</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::L_zYield</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::qcdYield_sw</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::L_qcdYield</div><div class="line">make plots</div><div class="line">[#1] INFO:Minization -- createNLL: caching constraint set under name CONSTR_OF_PDF_model_FOR_OBS_L_qcdYield:L_zYield:invMass:isolation:qcdYield_sw:zYield_sw with 0 entries</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (zIsolationModel,qcdIsolationModel)</div><div class="line">[#1] INFO:Minization --  The following expressions will be evaluated in cache-and-track mode: (mZModel,qcdMassModel)</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization</div><div class="line">[#1] INFO:Plotting -- RooAbsReal::plotOn(model) plot on invMass integrates over variables (isolation)</div><div class="line">[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (zModel)</div><div class="line">[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: (mZModel,zIsolationModel)</div><div class="line">[#1] INFO:Plotting -- RooAbsReal::plotOn(model) plot on invMass integrates over variables (isolation)</div><div class="line">[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (qcdModel)</div><div class="line">[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: (qcdMassModel,qcdIsolationModel)</div><div class="line">[#1] INFO:Plotting -- RooAbsReal::plotOn(model) plot on invMass integrates over variables (isolation)</div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooRealVar_8h.html">RooRealVar.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SPlot_8h.html">RooStats/SPlot.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooDataSet_8h.html">RooDataSet.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooRealVar_8h.html">RooRealVar.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooGaussian_8h.html">RooGaussian.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooExponential_8h.html">RooExponential.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooChebychev_8h.html">RooChebychev.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooAddPdf_8h.html">RooAddPdf.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooProdPdf_8h.html">RooProdPdf.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooAddition_8h.html">RooAddition.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooProduct_8h.html">RooProduct.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooAbsPdf_8h.html">RooAbsPdf.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooFit_8h.html">RooFit.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooFitResult_8h.html">RooFitResult.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooWorkspace_8h.html">RooWorkspace.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooConstVar_8h.html">RooConstVar.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="comment">// use this order for safety on library loading</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooFit.html">RooFit</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooStats.html">RooStats</a>;</div><div class="line"></div><div class="line"><span class="comment">// see below for implementation</span></div><div class="line"><span class="keywordtype">void</span> AddModel(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *);</div><div class="line"><span class="keywordtype">void</span> AddData(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *);</div><div class="line"><span class="keywordtype">void</span> DoSPlot(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *);</div><div class="line"><span class="keywordtype">void</span> MakePlots(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *);</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> rs301_splot()</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// Create a new workspace to manage the project.</span></div><div class="line">   <a class="code" href="classRooWorkspace.html">RooWorkspace</a> *wspace = <span class="keyword">new</span> <a class="code" href="classRooWorkspace.html">RooWorkspace</a>(<span class="stringliteral">&quot;myWS&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// add the signal and background models to the workspace.</span></div><div class="line">   <span class="comment">// Inside this function you will find a description our model.</span></div><div class="line">   AddModel(wspace);</div><div class="line"></div><div class="line">   <span class="comment">// add some toy data to the workspace</span></div><div class="line">   AddData(wspace);</div><div class="line"></div><div class="line">   <span class="comment">// inspect the workspace if you wish</span></div><div class="line">   <span class="comment">//  wspace-&gt;Print();</span></div><div class="line"></div><div class="line">   <span class="comment">// do sPlot.</span></div><div class="line">   <span class="comment">// This wil make a new dataset with sWeights added for every event.</span></div><div class="line">   DoSPlot(wspace);</div><div class="line"></div><div class="line">   <span class="comment">// Make some plots showing the discriminating variable and</span></div><div class="line">   <span class="comment">// the control variable after unfolding.</span></div><div class="line">   MakePlots(wspace);</div><div class="line"></div><div class="line">   <span class="comment">// cleanup</span></div><div class="line">   <span class="keyword">delete</span> wspace;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//____________________________________</span></div><div class="line"><span class="keywordtype">void</span> AddModel(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *<a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>)</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// Make models for signal (Higgs) and background (Z+jets and QCD)</span></div><div class="line">   <span class="comment">// In real life, this part requires an intelligent modeling</span></div><div class="line">   <span class="comment">// of signal and background -- this is only an example.</span></div><div class="line"></div><div class="line">   <span class="comment">// set range of observable</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> lowRange = 00, highRange = 200;</div><div class="line"></div><div class="line">   <span class="comment">// make a RooRealVar for the observables</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> invMass(<span class="stringliteral">&quot;invMass&quot;</span>, <span class="stringliteral">&quot;M_{inv}&quot;</span>, lowRange, highRange, <span class="stringliteral">&quot;GeV&quot;</span>);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> isolation(<span class="stringliteral">&quot;isolation&quot;</span>, <span class="stringliteral">&quot;isolation&quot;</span>, 0., 20., <span class="stringliteral">&quot;GeV&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// --------------------------------------</span></div><div class="line">   <span class="comment">// make 2-d model for Z including the invariant mass</span></div><div class="line">   <span class="comment">// distribution  and an isolation distribution which we want to</span></div><div class="line">   <span class="comment">// unfold from QCD.</span></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;make z model&quot;</span> &lt;&lt; std::endl;</div><div class="line">   <span class="comment">// mass model for Z</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> mZ(<span class="stringliteral">&quot;mZ&quot;</span>, <span class="stringliteral">&quot;Z Mass&quot;</span>, 91.2, lowRange, highRange);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> sigmaZ(<span class="stringliteral">&quot;sigmaZ&quot;</span>, <span class="stringliteral">&quot;Width of Gaussian&quot;</span>, 2, 0, 10, <span class="stringliteral">&quot;GeV&quot;</span>);</div><div class="line">   <a class="code" href="classRooGaussian.html">RooGaussian</a> mZModel(<span class="stringliteral">&quot;mZModel&quot;</span>, <span class="stringliteral">&quot;Z+jets Model&quot;</span>, invMass, mZ, sigmaZ);</div><div class="line">   <span class="comment">// we know Z mass</span></div><div class="line">   mZ.setConstant();</div><div class="line">   <span class="comment">// we leave the width of the Z free during the fit in this example.</span></div><div class="line"></div><div class="line">   <span class="comment">// isolation model for Z.  Only used to generate toy MC.</span></div><div class="line">   <span class="comment">// the exponential is of the form exp(c*x).  If we want</span></div><div class="line">   <span class="comment">// the isolation to decay an e-fold every R GeV, we use</span></div><div class="line">   <span class="comment">// c = -1/R.</span></div><div class="line">   <a class="code" href="classRooConstVar.html">RooConstVar</a> zIsolDecayConst(<span class="stringliteral">&quot;zIsolDecayConst&quot;</span>, <span class="stringliteral">&quot;z isolation decay  constant&quot;</span>, -1);</div><div class="line">   <a class="code" href="classRooExponential.html">RooExponential</a> zIsolationModel(<span class="stringliteral">&quot;zIsolationModel&quot;</span>, <span class="stringliteral">&quot;z isolation model&quot;</span>, isolation, zIsolDecayConst);</div><div class="line"></div><div class="line">   <span class="comment">// make the combined Z model</span></div><div class="line">   <a class="code" href="classRooProdPdf.html">RooProdPdf</a> zModel(<span class="stringliteral">&quot;zModel&quot;</span>, <span class="stringliteral">&quot;4-d model for Z&quot;</span>, <a class="code" href="classRooArgSet.html">RooArgSet</a>(mZModel, zIsolationModel));</div><div class="line"></div><div class="line">   <span class="comment">// --------------------------------------</span></div><div class="line">   <span class="comment">// make QCD model</span></div><div class="line"></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;make qcd model&quot;</span> &lt;&lt; std::endl;</div><div class="line">   <span class="comment">// mass model for QCD.</span></div><div class="line">   <span class="comment">// the exponential is of the form exp(c*x).  If we want</span></div><div class="line">   <span class="comment">// the mass to decay an e-fold every R GeV, we use</span></div><div class="line">   <span class="comment">// c = -1/R.</span></div><div class="line">   <span class="comment">// We can leave this parameter free during the fit.</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> qcdMassDecayConst(<span class="stringliteral">&quot;qcdMassDecayConst&quot;</span>, <span class="stringliteral">&quot;Decay const for QCD mass spectrum&quot;</span>, -0.01, -100, 100, <span class="stringliteral">&quot;1/GeV&quot;</span>);</div><div class="line">   <a class="code" href="classRooExponential.html">RooExponential</a> qcdMassModel(<span class="stringliteral">&quot;qcdMassModel&quot;</span>, <span class="stringliteral">&quot;qcd Mass Model&quot;</span>, invMass, qcdMassDecayConst);</div><div class="line"></div><div class="line">   <span class="comment">// isolation model for QCD.  Only used to generate toy MC</span></div><div class="line">   <span class="comment">// the exponential is of the form exp(c*x).  If we want</span></div><div class="line">   <span class="comment">// the isolation to decay an e-fold every R GeV, we use</span></div><div class="line">   <span class="comment">// c = -1/R.</span></div><div class="line">   <a class="code" href="classRooConstVar.html">RooConstVar</a> qcdIsolDecayConst(<span class="stringliteral">&quot;qcdIsolDecayConst&quot;</span>, <span class="stringliteral">&quot;Et resolution constant&quot;</span>, -.1);</div><div class="line">   <a class="code" href="classRooExponential.html">RooExponential</a> qcdIsolationModel(<span class="stringliteral">&quot;qcdIsolationModel&quot;</span>, <span class="stringliteral">&quot;QCD isolation model&quot;</span>, isolation, qcdIsolDecayConst);</div><div class="line"></div><div class="line">   <span class="comment">// make the 2-d model</span></div><div class="line">   <a class="code" href="classRooProdPdf.html">RooProdPdf</a> qcdModel(<span class="stringliteral">&quot;qcdModel&quot;</span>, <span class="stringliteral">&quot;2-d model for QCD&quot;</span>, <a class="code" href="classRooArgSet.html">RooArgSet</a>(qcdMassModel, qcdIsolationModel));</div><div class="line"></div><div class="line">   <span class="comment">// --------------------------------------</span></div><div class="line">   <span class="comment">// combined model</span></div><div class="line"></div><div class="line">   <span class="comment">// These variables represent the number of Z or QCD events</span></div><div class="line">   <span class="comment">// They will be fitted.</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> zYield(<span class="stringliteral">&quot;zYield&quot;</span>, <span class="stringliteral">&quot;fitted yield for Z&quot;</span>, 50, 0., 1000);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> qcdYield(<span class="stringliteral">&quot;qcdYield&quot;</span>, <span class="stringliteral">&quot;fitted yield for QCD&quot;</span>, 100, 0., 1000);</div><div class="line"></div><div class="line">   <span class="comment">// now make the combined model</span></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;make full model&quot;</span> &lt;&lt; std::endl;</div><div class="line">   <a class="code" href="classRooAddPdf.html">RooAddPdf</a> model(<span class="stringliteral">&quot;model&quot;</span>, <span class="stringliteral">&quot;z+qcd background models&quot;</span>, <a class="code" href="classRooArgList.html">RooArgList</a>(zModel, qcdModel), <a class="code" href="classRooArgList.html">RooArgList</a>(zYield, qcdYield));</div><div class="line"></div><div class="line">   <span class="comment">// interesting for debugging and visualizing the model</span></div><div class="line">   model.<a class="code" href="classRooAbsArg.html#a77b2077d0a0fa6a260f272ccf4a19a8f">graphVizTree</a>(<span class="stringliteral">&quot;fullModel.dot&quot;</span>);</div><div class="line"></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;import model&quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">   <a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;import(model);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//____________________________________</span></div><div class="line"><span class="keywordtype">void</span> AddData(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *<a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>)</div><div class="line">{</div><div class="line">   <span class="comment">// Add a toy dataset</span></div><div class="line"></div><div class="line">   <span class="comment">// how many events do we want?</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nEvents = 1000;</div><div class="line"></div><div class="line">   <span class="comment">// get what we need out of the workspace to make toy data</span></div><div class="line">   <a class="code" href="classRooAbsPdf.html">RooAbsPdf</a> *model = <a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;pdf(<span class="stringliteral">&quot;model&quot;</span>);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *invMass = <a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;var(<span class="stringliteral">&quot;invMass&quot;</span>);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *isolation = <a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;var(<span class="stringliteral">&quot;isolation&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// make the toy data</span></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;make data set and import to workspace&quot;</span> &lt;&lt; std::endl;</div><div class="line">   <a class="code" href="classRooDataSet.html">RooDataSet</a> *data = model-&gt;<a class="code" href="classRooAbsPdf.html#aff9a0b0fd2e1cab5124bd0d209ecbb18">generate</a>(<a class="code" href="classRooArgSet.html">RooArgSet</a>(*invMass, *isolation), nEvents);</div><div class="line"></div><div class="line">   <span class="comment">// import data into workspace</span></div><div class="line">   <a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;import(*data, <a class="code" href="namespaceRooFit.html#a93649fc02f13b843c7fb5a5e81e097ff">Rename</a>(<span class="stringliteral">&quot;data&quot;</span>));</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//____________________________________</span></div><div class="line"><span class="keywordtype">void</span> DoSPlot(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *<a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>)</div><div class="line">{</div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;Calculate sWeights&quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">   <span class="comment">// get what we need out of the workspace to do the fit</span></div><div class="line">   <a class="code" href="classRooAbsPdf.html">RooAbsPdf</a> *model = <a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;pdf(<span class="stringliteral">&quot;model&quot;</span>);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *zYield = <a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;var(<span class="stringliteral">&quot;zYield&quot;</span>);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *qcdYield = <a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;var(<span class="stringliteral">&quot;qcdYield&quot;</span>);</div><div class="line">   <a class="code" href="classRooDataSet.html">RooDataSet</a> *data = (<a class="code" href="classRooDataSet.html">RooDataSet</a> *)<a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;data(<span class="stringliteral">&quot;data&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// fit the model to the data.</span></div><div class="line">   model-&gt;<a class="code" href="classRooAbsPdf.html#a8f802a3a93467d5b7b089e3ccaec0fa8">fitTo</a>(*data, <a class="code" href="namespaceRooFit.html#a5b78dee63fd4e5fcdb5e8992f726cfc8">Extended</a>());</div><div class="line"></div><div class="line">   <span class="comment">// The sPlot technique requires that we fix the parameters</span></div><div class="line">   <span class="comment">// of the model that are not yields after doing the fit.</span></div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// This *could* be done with the lines below, however this is taken care of</span></div><div class="line">   <span class="comment">// by the RooStats::SPlot constructor (or more precisely the AddSWeight</span></div><div class="line">   <span class="comment">// method).</span></div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// RooRealVar* sigmaZ = ws-&gt;var(&quot;sigmaZ&quot;);</span></div><div class="line">   <span class="comment">// RooRealVar* qcdMassDecayConst = ws-&gt;var(&quot;qcdMassDecayConst&quot;);</span></div><div class="line">   <span class="comment">// sigmaZ-&gt;setConstant();</span></div><div class="line">   <span class="comment">// qcdMassDecayConst-&gt;setConstant();</span></div><div class="line"></div><div class="line">   <a class="code" href="classRooMsgService.html#a1aa4beeeda7e2aab5de645f2b8774c9c">RooMsgService::instance</a>().<a class="code" href="classRooMsgService.html#af0b3215d59b5d4b4f1739129d11f8c97">setSilentMode</a>(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Now we use the SPlot class to add SWeights to our data set</span></div><div class="line">   <span class="comment">// based on our model and our yield variables</span></div><div class="line">   <a class="code" href="classRooStats_1_1SPlot.html">RooStats::SPlot</a> *sData = <span class="keyword">new</span> <a class="code" href="classRooStats_1_1SPlot.html">RooStats::SPlot</a>(<span class="stringliteral">&quot;sData&quot;</span>, <span class="stringliteral">&quot;An SPlot&quot;</span>, *data, model, <a class="code" href="classRooArgList.html">RooArgList</a>(*zYield, *qcdYield));</div><div class="line"></div><div class="line">   <span class="comment">// Check that our weights have the desired properties</span></div><div class="line"></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;Check SWeights:&quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">   std::cout &lt;&lt; std::endl</div><div class="line">             &lt;&lt; <span class="stringliteral">&quot;Yield of Z is &quot;</span> &lt;&lt; zYield-&gt;<a class="code" href="classRooAbsReal.html#a8881da431598c6d15e06cc80518d323d">getVal</a>() &lt;&lt; <span class="stringliteral">&quot;.  From sWeights it is &quot;</span></div><div class="line">             &lt;&lt; sData-&gt;<a class="code" href="classRooStats_1_1SPlot.html#a1fb94594bb3844e2e1783c5ca42c8c50">GetYieldFromSWeight</a>(<span class="stringliteral">&quot;zYield&quot;</span>) &lt;&lt; std::endl;</div><div class="line"></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;Yield of QCD is &quot;</span> &lt;&lt; qcdYield-&gt;<a class="code" href="classRooAbsReal.html#a8881da431598c6d15e06cc80518d323d">getVal</a>() &lt;&lt; <span class="stringliteral">&quot;.  From sWeights it is &quot;</span></div><div class="line">             &lt;&lt; sData-&gt;<a class="code" href="classRooStats_1_1SPlot.html#a1fb94594bb3844e2e1783c5ca42c8c50">GetYieldFromSWeight</a>(<span class="stringliteral">&quot;qcdYield&quot;</span>) &lt;&lt; std::endl</div><div class="line">             &lt;&lt; std::endl;</div><div class="line"></div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0; i &lt; 10; i++) {</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;z Weight   &quot;</span> &lt;&lt; sData-&gt;<a class="code" href="classRooStats_1_1SPlot.html#a2641f9ae50feda8c8505c95b2b00e161">GetSWeight</a>(i, <span class="stringliteral">&quot;zYield&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;   qcd Weight   &quot;</span></div><div class="line">                &lt;&lt; sData-&gt;<a class="code" href="classRooStats_1_1SPlot.html#a2641f9ae50feda8c8505c95b2b00e161">GetSWeight</a>(i, <span class="stringliteral">&quot;qcdYield&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;  Total Weight   &quot;</span> &lt;&lt; sData-&gt;<a class="code" href="classRooStats_1_1SPlot.html#aee83021ddfd44723adde54f525c1de1b">GetSumOfEventSWeight</a>(i)</div><div class="line">                &lt;&lt; std::endl;</div><div class="line">   }</div><div class="line"></div><div class="line">   std::cout &lt;&lt; std::endl;</div><div class="line"></div><div class="line">   <span class="comment">// import this new dataset with sWeights</span></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;import new dataset with sWeights&quot;</span> &lt;&lt; std::endl;</div><div class="line">   <a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;import(*data, <a class="code" href="namespaceRooFit.html#a93649fc02f13b843c7fb5a5e81e097ff">Rename</a>(<span class="stringliteral">&quot;dataWithSWeights&quot;</span>));</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> MakePlots(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *<a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>)</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// Here we make plots of the discriminating variable (invMass) after the fit</span></div><div class="line">   <span class="comment">// and of the control variable (isolation) after unfolding with sPlot.</span></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;make plots&quot;</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">   <span class="comment">// make our canvas</span></div><div class="line">   <a class="code" href="classTCanvas.html">TCanvas</a> *cdata = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>(<span class="stringliteral">&quot;sPlot&quot;</span>, <span class="stringliteral">&quot;sPlot demo&quot;</span>, 400, 600);</div><div class="line">   cdata-&gt;<a class="code" href="classTPad.html#a064b8ae1d12a9be393c0e22c5958cc7c">Divide</a>(1, 3);</div><div class="line"></div><div class="line">   <span class="comment">// get what we need out of the workspace</span></div><div class="line">   <a class="code" href="classRooAbsPdf.html">RooAbsPdf</a> *model = <a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;pdf(<span class="stringliteral">&quot;model&quot;</span>);</div><div class="line">   <a class="code" href="classRooAbsPdf.html">RooAbsPdf</a> *zModel = <a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;pdf(<span class="stringliteral">&quot;zModel&quot;</span>);</div><div class="line">   <a class="code" href="classRooAbsPdf.html">RooAbsPdf</a> *qcdModel = <a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;pdf(<span class="stringliteral">&quot;qcdModel&quot;</span>);</div><div class="line"></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *isolation = <a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;var(<span class="stringliteral">&quot;isolation&quot;</span>);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *invMass = <a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;var(<span class="stringliteral">&quot;invMass&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// note, we get the dataset with sWeights</span></div><div class="line">   <a class="code" href="classRooDataSet.html">RooDataSet</a> *data = (<a class="code" href="classRooDataSet.html">RooDataSet</a> *)<a class="code" href="ws_8C.html#a2503a8f71dd548f769f457a7bdf3a64b">ws</a>-&gt;data(<span class="stringliteral">&quot;dataWithSWeights&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// this shouldn&#39;t be necessary, need to fix something with workspace</span></div><div class="line">   <span class="comment">// do this to set parameters back to their fitted values.</span></div><div class="line">   model-&gt;<a class="code" href="classRooAbsPdf.html#a8f802a3a93467d5b7b089e3ccaec0fa8">fitTo</a>(*data, <a class="code" href="namespaceRooFit.html#a5b78dee63fd4e5fcdb5e8992f726cfc8">Extended</a>());</div><div class="line"></div><div class="line">   <span class="comment">// plot invMass for data with full model and individual components overlaid</span></div><div class="line">   <span class="comment">//  TCanvas* cdata = new TCanvas();</span></div><div class="line">   cdata-&gt;<a class="code" href="classTCanvas.html#ad996aa7bc34186944363b48963de4de5">cd</a>(1);</div><div class="line">   <a class="code" href="classRooPlot.html">RooPlot</a> *frame = invMass-&gt;<a class="code" href="classRooAbsRealLValue.html#a745190bca471b18f1b2d46a86961f0c6">frame</a>();</div><div class="line">   data-&gt;<a class="code" href="classRooAbsData.html#ac27709a0077810f29787f046e8d03898">plotOn</a>(frame);</div><div class="line">   model-&gt;<a class="code" href="classRooAbsPdf.html#a16d579415ec8eb8160ae212d683324f2">plotOn</a>(frame);</div><div class="line">   model-&gt;<a class="code" href="classRooAbsPdf.html#a16d579415ec8eb8160ae212d683324f2">plotOn</a>(frame, <a class="code" href="namespaceRooFit.html#a9a389f7a6ebfc4bf6b82df5de6f14e7c">Components</a>(*zModel), <a class="code" href="namespaceRooFit.html#af1f7922ba5965c1a5a9791a00ef354cb">LineStyle</a>(<a class="code" href="TAttLine_8h.html#a7092c0c4616367016b70d54e5c680a69a079153995f89acb1ea87c52e9b45949a">kDashed</a>), <a class="code" href="namespaceRooFit.html#ad309cf5f63ec87ae5a7025d530f0398f">LineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a5a655b1a02e5b0311571ca57ce4f3900">kRed</a>));</div><div class="line">   model-&gt;<a class="code" href="classRooAbsPdf.html#a16d579415ec8eb8160ae212d683324f2">plotOn</a>(frame, <a class="code" href="namespaceRooFit.html#a9a389f7a6ebfc4bf6b82df5de6f14e7c">Components</a>(*qcdModel), <a class="code" href="namespaceRooFit.html#af1f7922ba5965c1a5a9791a00ef354cb">LineStyle</a>(<a class="code" href="TAttLine_8h.html#a7092c0c4616367016b70d54e5c680a69a079153995f89acb1ea87c52e9b45949a">kDashed</a>), <a class="code" href="namespaceRooFit.html#ad309cf5f63ec87ae5a7025d530f0398f">LineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a8ea4b941d1d41f4bd88387c38e13e9d3">kGreen</a>));</div><div class="line"></div><div class="line">   frame-&gt;<a class="code" href="classRooPlot.html#a5e0cfc6c61278a25cdc5a63dfe4cc0b3">SetTitle</a>(<span class="stringliteral">&quot;Fit of model to discriminating variable&quot;</span>);</div><div class="line">   frame-&gt;<a class="code" href="classRooPlot.html#ad7cdede86cb3721e079ec55fcb3b4edc">Draw</a>();</div><div class="line"></div><div class="line">   <span class="comment">// Now use the sWeights to show isolation distribution for Z and QCD.</span></div><div class="line">   <span class="comment">// The SPlot class can make this easier, but here we demonstrate in more</span></div><div class="line">   <span class="comment">// detail how the sWeights are used.  The SPlot class should make this</span></div><div class="line">   <span class="comment">// very easy and needs some more development.</span></div><div class="line"></div><div class="line">   <span class="comment">// Plot isolation for Z component.</span></div><div class="line">   <span class="comment">// Do this by plotting all events weighted by the sWeight for the Z component.</span></div><div class="line">   <span class="comment">// The SPlot class adds a new variable that has the name of the corresponding</span></div><div class="line">   <span class="comment">// yield + &quot;_sw&quot;.</span></div><div class="line">   cdata-&gt;<a class="code" href="classTCanvas.html#ad996aa7bc34186944363b48963de4de5">cd</a>(2);</div><div class="line"></div><div class="line">   <span class="comment">// create weighted data set</span></div><div class="line">   <a class="code" href="classRooDataSet.html">RooDataSet</a> *dataw_z = <span class="keyword">new</span> <a class="code" href="classRooDataSet.html">RooDataSet</a>(data-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>(), data-&gt;<a class="code" href="classTNamed.html#a8114b395bf7e0d1af609ab6a700b52ee">GetTitle</a>(), data, *data-&gt;<a class="code" href="classRooDataSet.html#a2d2355b7a32be47b906312f113ee75c0">get</a>(), 0, <span class="stringliteral">&quot;zYield_sw&quot;</span>);</div><div class="line"></div><div class="line">   <a class="code" href="classRooPlot.html">RooPlot</a> *frame2 = isolation-&gt;<a class="code" href="classRooAbsRealLValue.html#a745190bca471b18f1b2d46a86961f0c6">frame</a>();</div><div class="line">   dataw_z-&gt;<a class="code" href="classRooAbsData.html#ac27709a0077810f29787f046e8d03898">plotOn</a>(frame2, <a class="code" href="namespaceRooFit.html#acdff7ce05ee41600dffa2211de146e7f">DataError</a>(<a class="code" href="classRooAbsData.html#a3f1b47ae0cc4e217f514a8e4331f7e88a6e2e8176c8957a92f68ad94e8f8e0b7f">RooAbsData::SumW2</a>));</div><div class="line"></div><div class="line">   frame2-&gt;<a class="code" href="classRooPlot.html#a5e0cfc6c61278a25cdc5a63dfe4cc0b3">SetTitle</a>(<span class="stringliteral">&quot;isolation distribution for Z&quot;</span>);</div><div class="line">   frame2-&gt;Draw();</div><div class="line"></div><div class="line">   <span class="comment">// Plot isolation for QCD component.</span></div><div class="line">   <span class="comment">// Eg. plot all events weighted by the sWeight for the QCD component.</span></div><div class="line">   <span class="comment">// The SPlot class adds a new variable that has the name of the corresponding</span></div><div class="line">   <span class="comment">// yield + &quot;_sw&quot;.</span></div><div class="line">   cdata-&gt;<a class="code" href="classTCanvas.html#ad996aa7bc34186944363b48963de4de5">cd</a>(3);</div><div class="line">   <a class="code" href="classRooDataSet.html">RooDataSet</a> *dataw_qcd = <span class="keyword">new</span> <a class="code" href="classRooDataSet.html">RooDataSet</a>(data-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>(), data-&gt;<a class="code" href="classTNamed.html#a8114b395bf7e0d1af609ab6a700b52ee">GetTitle</a>(), data, *data-&gt;<a class="code" href="classRooDataSet.html#a2d2355b7a32be47b906312f113ee75c0">get</a>(), 0, <span class="stringliteral">&quot;qcdYield_sw&quot;</span>);</div><div class="line">   <a class="code" href="classRooPlot.html">RooPlot</a> *frame3 = isolation-&gt;<a class="code" href="classRooAbsRealLValue.html#a745190bca471b18f1b2d46a86961f0c6">frame</a>();</div><div class="line">   dataw_qcd-&gt;<a class="code" href="classRooAbsData.html#ac27709a0077810f29787f046e8d03898">plotOn</a>(frame3, <a class="code" href="namespaceRooFit.html#acdff7ce05ee41600dffa2211de146e7f">DataError</a>(<a class="code" href="classRooAbsData.html#a3f1b47ae0cc4e217f514a8e4331f7e88a6e2e8176c8957a92f68ad94e8f8e0b7f">RooAbsData::SumW2</a>));</div><div class="line"></div><div class="line">   frame3-&gt;<a class="code" href="classRooPlot.html#a5e0cfc6c61278a25cdc5a63dfe4cc0b3">SetTitle</a>(<span class="stringliteral">&quot;isolation distribution for QCD&quot;</span>);</div><div class="line">   frame3-&gt;Draw();</div><div class="line"></div><div class="line">   <span class="comment">//  cdata-&gt;SaveAs(&quot;SPlot.gif&quot;);</span></div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>Kyle Cranmer </dd></dl>

<p class="definition">Definition in file <a class="el" href="rs301__splot_8C_source.html">rs301_splot.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:26 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

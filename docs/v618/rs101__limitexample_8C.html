<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/roostats/rs101_limitexample.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_87facaa6959ceb8d3dacccaf663f7b84.html">roostats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">rs101_limitexample.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__roostats.html">RooStats Tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/rs101_limitexample.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/rs101_limitexample.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  Limits: number counting experiment with uncertainty on both the background rate and signal efficiency. </p>
<p>The usage of a Confidence Interval Calculator to set a limit on the signal is illustrated</p>
<div class="image">
<img src="pict1_rs101_limitexample.C.png" alt="pict1_rs101_limitexample.C.png" width="700"/>
</div>
 <div class="fragment"><div class="line"></div><div class="line"></div><div class="line">[1mRooFit v3.60 -- Developed by Wouter Verkerke and David Kirkby[0m </div><div class="line">                Copyright (C) 2000-2013 NIKHEF, University of California &amp; Stanford University</div><div class="line">                All rights reserved, please read http://roofit.sourceforge.net/license.txt</div><div class="line"></div><div class="line"></div><div class="line">RooWorkspace()  contents</div><div class="line"></div><div class="line">variables</div><div class="line">---------</div><div class="line">(b,gSigBkg,gSigEff,obs,ratioBkgEff,ratioSigEff,s)</div><div class="line"></div><div class="line">p.d.f.s</div><div class="line">-------</div><div class="line">RooGaussian::bkgConstraint[ x=gSigBkg mean=ratioBkgEff sigma=0.2 ] = 1</div><div class="line">RooPoisson::countingModel[ x=obs mean=countingModel_2 ] = 0.0325554</div><div class="line">RooProdPdf::modelWithConstraints[ countingModel * sigConstraint * bkgConstraint ] = 0.0325554</div><div class="line">RooGaussian::sigConstraint[ x=gSigEff mean=ratioSigEff sigma=0.05 ] = 1</div><div class="line"></div><div class="line">functions</div><div class="line">--------</div><div class="line">RooAddition::countingModel_2[ countingModel_2_[s_x_ratioSigEff] + countingModel_2_[b_x_ratioBkgEff] ] = 150</div><div class="line">RooProduct::countingModel_2_[b_x_ratioBkgEff][ b * ratioBkgEff ] = 100</div><div class="line">RooProduct::countingModel_2_[s_x_ratioSigEff][ s * ratioSigEff ] = 50</div><div class="line"></div><div class="line">[#1] INFO:Minization -- createNLL: caching constraint set under name CONSTR_OF_PDF_modelWithConstraints_FOR_OBS_obs with 2 entries</div><div class="line">[#1] INFO:Minization --  Including the following contraint terms in minimization: (sigConstraint,bkgConstraint)</div><div class="line">[#1] INFO:Fitting -- RooAddition::defaultErrorLevel(nll_modelWithConstraints_exampleData_with_constr) Summation contains a RooNLLVar, using its error level</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization --  The following expressions will be evaluated in cache-and-track mode: (countingModel)</div><div class="line"> **********</div><div class="line"> **    1 **SET PRINT           1</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    2 **SET NOGRAD</div><div class="line"> **********</div><div class="line"> PARAMETER DEFINITIONS:</div><div class="line">    NO.   NAME         VALUE      STEP SIZE      LIMITS</div><div class="line">     1 ratioBkgEff   1.00000e+00  3.00000e-01    0.00000e+00  3.00000e+00</div><div class="line">     2 ratioSigEff   1.00000e+00  3.00000e-01    0.00000e+00  3.00000e+00</div><div class="line">     3 s            5.00000e+01  1.20000e+01    0.00000e+00  1.20000e+02</div><div class="line"> **********</div><div class="line"> **    3 **SET ERR         0.5</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    4 **SET PRINT           1</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    5 **SET STR           1</div><div class="line"> **********</div><div class="line"> NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY</div><div class="line"> **********</div><div class="line"> **    6 **MIGRAD        1500           1</div><div class="line"> **********</div><div class="line"> FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.</div><div class="line"> START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03</div><div class="line"> FCN=1.01592 FROM MIGRAD    STATUS=INITIATE       12 CALLS          13 TOTAL</div><div class="line">                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       </div><div class="line">  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  ratioBkgEff   1.00000e+00   3.00000e-01   2.14402e-01  -9.42809e+00</div><div class="line">   2  ratioSigEff   1.00000e+00   3.00000e-01   2.14402e-01  -4.71404e+00</div><div class="line">   3  s            5.00000e+01   1.20000e+01   2.04382e-01  -3.94405e+00</div><div class="line">                               ERR DEF= 0.5</div><div class="line"> MIGRAD MINIMIZATION HAS CONVERGED.</div><div class="line"> MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.</div><div class="line"> COVARIANCE MATRIX CALCULATED SUCCESSFULLY</div><div class="line"> FCN=0.689753 FROM MIGRAD    STATUS=CONVERGED      60 CALLS          61 TOTAL</div><div class="line">                     EDM=4.05791e-08    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                   STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  ratioBkgEff   1.00002e+00   1.99284e-01   5.69545e-05   2.44292e-04</div><div class="line">   2  ratioSigEff   9.99992e-01   4.99900e-02   2.59106e-05  -5.01928e-03</div><div class="line">   3  s            5.99979e+01   2.32251e+01   1.58945e-04  -2.07489e-04</div><div class="line">                               ERR DEF= 0.5</div><div class="line"> EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  3    ERR DEF=0.5</div><div class="line">  3.998e-02  2.485e-07 -3.998e+00 </div><div class="line">  2.485e-07  2.500e-03 -1.500e-01 </div><div class="line"> -3.998e+00 -1.500e-01  5.687e+02 </div><div class="line"> PARAMETER  CORRELATION COEFFICIENTS  </div><div class="line">       NO.  GLOBAL      1      2      3</div><div class="line">        1  0.84507   1.000  0.000 -0.838</div><div class="line">        2  0.23079   0.000  1.000 -0.126</div><div class="line">        3  0.84774  -0.838 -0.126  1.000</div><div class="line"> **********</div><div class="line"> **    7 **SET ERR         0.5</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    8 **SET PRINT           1</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    9 **HESSE        1500</div><div class="line"> **********</div><div class="line"> COVARIANCE MATRIX CALCULATED SUCCESSFULLY</div><div class="line"> FCN=0.689753 FROM HESSE     STATUS=OK             16 CALLS          77 TOTAL</div><div class="line">                     EDM=4.05843e-08    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                INTERNAL      INTERNAL  </div><div class="line">  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   </div><div class="line">   1  ratioBkgEff   1.00002e+00   1.99326e-01   1.13909e-05  -3.39822e-01</div><div class="line">   2  ratioSigEff   9.99992e-01   4.99895e-02   5.18211e-06  -3.39843e-01</div><div class="line">   3  s            5.99979e+01   2.32296e+01   3.17891e-05  -3.54380e-05</div><div class="line">                               ERR DEF= 0.5</div><div class="line"> EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  3    ERR DEF=0.5</div><div class="line">  4.000e-02  5.038e-08 -4.000e+00 </div><div class="line">  5.038e-08  2.500e-03 -1.500e-01 </div><div class="line"> -4.000e+00 -1.500e-01  5.690e+02 </div><div class="line"> PARAMETER  CORRELATION COEFFICIENTS  </div><div class="line">       NO.  GLOBAL      1      2      3</div><div class="line">        1  0.84514   1.000  0.000 -0.838</div><div class="line">        2  0.23076   0.000  1.000 -0.126</div><div class="line">        3  0.84781  -0.838 -0.126  1.000</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import() importing dataset exampleData</div><div class="line">[#1] INFO:Minization -- createNLL picked up cached consraints from workspace with 2 entries</div><div class="line">[#1] INFO:Minization --  Including the following contraint terms in minimization: (sigConstraint,bkgConstraint)</div><div class="line">[#1] INFO:Minization -- The following global observables have been defined: (gSigEff,gSigBkg)</div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::DoGLobalFit - find MLE </div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::DoMinimizeNLL - using Minuit / Migrad with strategy 1</div><div class="line">[#1] INFO:Fitting -- RooAddition::defaultErrorLevel(nll_modelWithConstraints_exampleData_with_constr) Summation contains a RooNLLVar, using its error level</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization --  The following expressions will be evaluated in cache-and-track mode: (countingModel)</div><div class="line">[#1] INFO:Minization -- </div><div class="line">  RooFitResult: minimized FCN value: 0.689753, estimated distance to minimum: 9.56454e-09</div><div class="line">                covariance matrix quality: Full, accurate covariance matrix</div><div class="line">                Status : MINIMIZE=0 </div><div class="line"></div><div class="line">    Floating Parameter    FinalValue +/-  Error   </div><div class="line">  --------------------  --------------------------</div><div class="line">           ratioBkgEff    1.0000e+00 +/-  1.99e-01</div><div class="line">           ratioSigEff    1.0000e+00 +/-  5.00e-02</div><div class="line">                     s    5.9998e+01 +/-  2.32e+01</div><div class="line"></div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_modelWithConstraints_exampleData_with_constr_Profile[s]) Creating instance of MINUIT</div><div class="line">[#1] INFO:Fitting -- RooAddition::defaultErrorLevel(nll_modelWithConstraints_exampleData_with_constr) Summation contains a RooNLLVar, using its error level</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_modelWithConstraints_exampleData_with_constr_Profile[s]) determining minimum likelihood for current configurations w.r.t all observable</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_modelWithConstraints_exampleData_with_constr_Profile[s]) minimum found at (s=59.9982)</div><div class="line">.</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_modelWithConstraints_exampleData_with_constr_Profile[s]) Creating instance of MINUIT</div><div class="line">[#1] INFO:Fitting -- RooAddition::defaultErrorLevel(nll_modelWithConstraints_exampleData_with_constr) Summation contains a RooNLLVar, using its error level</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_modelWithConstraints_exampleData_with_constr_Profile[s]) determining minimum likelihood for current configurations w.r.t all observable</div><div class="line">[#0] ERROR:InputArguments -- RooArgSet::checkForDup: ERROR argument with name s is already in this set</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_modelWithConstraints_exampleData_with_constr_Profile[s]) minimum found at (s=59.9989)</div><div class="line">..........................................................................................................................................................................................................</div><div class="line">=== Using the following for ModelConfig ===</div><div class="line">Observables:             RooArgSet:: = (obs)</div><div class="line">Parameters of Interest:  RooArgSet:: = (s)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (ratioSigEff,ratioBkgEff)</div><div class="line">Global Observables:      RooArgSet:: = (gSigEff,gSigBkg)</div><div class="line">PDF:                     RooProdPdf::modelWithConstraints[ countingModel * sigConstraint * bkgConstraint ] = 0.00460195</div><div class="line"></div><div class="line">FeldmanCousins: ntoys per point: adaptive</div><div class="line">FeldmanCousins: nEvents per toy will not fluctuate, will always be 1</div><div class="line">FeldmanCousins: Model has nuisance parameters, will do profile construction</div><div class="line">FeldmanCousins: # points to test = 100</div><div class="line">NeymanConstruction: Prog: 1/100 total MC = 80 this test stat = 3.21178</div><div class="line"> s=0.6 ratioSigEff=0.999981 ratioBkgEff=1.43644 [-1e+30, 4.68588]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 2/100 total MC = 80 this test stat = 3.08218</div><div class="line"> s=1.8 ratioSigEff=1.00019 ratioBkgEff=1.42695 [-1e+30, 3.71884]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 3/100 total MC = 80 this test stat = 2.95515</div><div class="line"> s=3 ratioSigEff=1.00055 ratioBkgEff=1.4177 [-1e+30, 3.91238]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 4/100 total MC = 80 this test stat = 2.83091</div><div class="line"> s=4.2 ratioSigEff=1.00106 ratioBkgEff=1.4085 [-1e+30, 3.65945]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 5/100 total MC = 80 this test stat = 2.7093</div><div class="line"> s=5.4 ratioSigEff=1.00133 ratioBkgEff=1.39956 [-1e+30, 3.10318]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 6/100 total MC = 80 this test stat = 2.59036</div><div class="line"> s=6.6 ratioSigEff=1.00159 ratioBkgEff=1.39061 [-1e+30, 2.97611]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 7/100 total MC = 240 this test stat = 2.47407</div><div class="line"> s=7.8 ratioSigEff=1.00186 ratioBkgEff=1.38228 [-1e+30, 3.15094]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 8/100 total MC = 80 this test stat = 2.36054</div><div class="line"> s=9 ratioSigEff=1.0021 ratioBkgEff=1.37325 [-1e+30, 3.1239]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 9/100 total MC = 80 this test stat = 2.24968</div><div class="line"> s=10.2 ratioSigEff=1.00232 ratioBkgEff=1.36423 [-1e+30, 3.40684]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 10/100 total MC = 80 this test stat = 2.14147</div><div class="line"> s=11.4 ratioSigEff=1.00253 ratioBkgEff=1.35522 [-1e+30, 3.1714]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 11/100 total MC = 80 this test stat = 2.03601</div><div class="line"> s=12.6 ratioSigEff=1.00268 ratioBkgEff=1.3462 [-1e+30, 3.24645]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 12/100 total MC = 80 this test stat = 1.93321</div><div class="line"> s=13.8 ratioSigEff=1.00287 ratioBkgEff=1.3372 [-1e+30, 2.53824]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 13/100 total MC = 80 this test stat = 1.83309</div><div class="line"> s=15 ratioSigEff=1.00308 ratioBkgEff=1.32821 [-1e+30, 2.70016]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 14/100 total MC = 80 this test stat = 1.73564</div><div class="line"> s=16.2 ratioSigEff=1.00323 ratioBkgEff=1.31922 [-1e+30, 2.77008]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 15/100 total MC = 80 this test stat = 1.64094</div><div class="line"> s=17.4 ratioSigEff=1.00337 ratioBkgEff=1.31025 [-1e+30, 2.84065]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 16/100 total MC = 80 this test stat = 1.5489</div><div class="line"> s=18.6 ratioSigEff=1.00347 ratioBkgEff=1.30119 [-1e+30, 2.44334]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 17/100 total MC = 80 this test stat = 1.4595</div><div class="line"> s=19.8 ratioSigEff=1.00359 ratioBkgEff=1.29224 [-1e+30, 2.51006]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 18/100 total MC = 80 this test stat = 1.37287</div><div class="line"> s=21 ratioSigEff=1.0037 ratioBkgEff=1.28331 [-1e+30, 2.30853]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 19/100 total MC = 80 this test stat = 1.28887</div><div class="line"> s=22.2 ratioSigEff=1.00379 ratioBkgEff=1.27438 [-1e+30, 2.11523]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 20/100 total MC = 80 this test stat = 1.20756</div><div class="line"> s=23.4 ratioSigEff=1.00387 ratioBkgEff=1.26546 [-1e+30, 2.09374]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 21/100 total MC = 80 this test stat = 1.12892</div><div class="line"> s=24.6 ratioSigEff=1.00394 ratioBkgEff=1.25655 [-1e+30, 2.1559]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 22/100 total MC = 80 this test stat = 1.05299</div><div class="line"> s=25.8 ratioSigEff=1.00399 ratioBkgEff=1.24765 [-1e+30, 2.48172]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 23/100 total MC = 80 this test stat = 0.979748</div><div class="line"> s=27 ratioSigEff=1.00403 ratioBkgEff=1.23877 [-1e+30, 1.9489]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 24/100 total MC = 80 this test stat = 0.909174</div><div class="line"> s=28.2 ratioSigEff=1.00405 ratioBkgEff=1.22989 [-1e+30, 1.92837]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 25/100 total MC = 80 this test stat = 0.841264</div><div class="line"> s=29.4 ratioSigEff=1.00408 ratioBkgEff=1.22097 [-1e+30, 1.90797]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 26/100 total MC = 80 this test stat = 0.776027</div><div class="line"> s=30.6 ratioSigEff=1.00408 ratioBkgEff=1.21214 [-1e+30, 2.04836]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 27/100 total MC = 80 this test stat = 0.713453</div><div class="line"> s=31.8 ratioSigEff=1.00406 ratioBkgEff=1.2033 [-1e+30, 1.42563]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 28/100 total MC = 80 this test stat = 0.653543</div><div class="line"> s=33 ratioSigEff=1.00403 ratioBkgEff=1.19446 [-1e+30, 1.92614]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 29/100 total MC = 80 this test stat = 0.596293</div><div class="line"> s=34.2 ratioSigEff=1.00399 ratioBkgEff=1.18563 [-1e+30, 1.53064]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 30/100 total MC = 80 this test stat = 0.541678</div><div class="line"> s=35.4 ratioSigEff=1.00393 ratioBkgEff=1.17679 [-1e+30, 1.65725]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 31/100 total MC = 80 this test stat = 0.489749</div><div class="line"> s=36.6 ratioSigEff=1.00386 ratioBkgEff=1.16796 [-1e+30, 1.42567]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 32/100 total MC = 80 this test stat = 0.440465</div><div class="line"> s=37.8 ratioSigEff=1.00378 ratioBkgEff=1.15914 [-1e+30, 1.40855]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 33/100 total MC = 80 this test stat = 0.393811</div><div class="line"> s=39 ratioSigEff=1.00369 ratioBkgEff=1.15032 [-1e+30, 1.2593]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 34/100 total MC = 80 this test stat = 0.349798</div><div class="line"> s=40.2 ratioSigEff=1.00358 ratioBkgEff=1.14153 [-1e+30, 1.30825]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 35/100 total MC = 80 this test stat = 0.30842</div><div class="line"> s=41.4 ratioSigEff=1.00347 ratioBkgEff=1.13275 [-1e+30, 0.874179]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 36/100 total MC = 80 this test stat = 0.269673</div><div class="line"> s=42.6 ratioSigEff=1.00334 ratioBkgEff=1.12398 [-1e+30, 1.14949]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 37/100 total MC = 80 this test stat = 0.233551</div><div class="line"> s=43.8 ratioSigEff=1.00319 ratioBkgEff=1.11573 [-1e+30, 1.07403]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 38/100 total MC = 80 this test stat = 0.200042</div><div class="line"> s=45 ratioSigEff=1.00303 ratioBkgEff=1.10705 [-1e+30, 1.30848]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 39/100 total MC = 80 this test stat = 0.169154</div><div class="line"> s=46.2 ratioSigEff=1.00285 ratioBkgEff=1.09838 [-1e+30, 0.987229]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 40/100 total MC = 80 this test stat = 0.140928</div><div class="line"> s=47.4 ratioSigEff=1.00267 ratioBkgEff=1.08972 [-1e+30, 0.917557]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 41/100 total MC = 80 this test stat = 0.115258</div><div class="line"> s=48.6 ratioSigEff=1.00247 ratioBkgEff=1.08109 [-1e+30, 0.850481]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 42/100 total MC = 80 this test stat = 0.0921856</div><div class="line"> s=49.8 ratioSigEff=1.00226 ratioBkgEff=1.07247 [-1e+30, 0.891152]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 43/100 total MC = 80 this test stat = 0.071704</div><div class="line"> s=51 ratioSigEff=1.00204 ratioBkgEff=1.06387 [-1e+30, 1.04631]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 44/100 total MC = 80 this test stat = 0.0538069</div><div class="line"> s=52.2 ratioSigEff=1.00181 ratioBkgEff=1.05529 [-1e+30, 0.574131]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 45/100 total MC = 80 this test stat = 0.0384876</div><div class="line"> s=53.4 ratioSigEff=1.00156 ratioBkgEff=1.04672 [-1e+30, 0.749926]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 46/100 total MC = 80 this test stat = 0.0257395</div><div class="line"> s=54.6 ratioSigEff=1.00131 ratioBkgEff=1.03818 [-1e+30, 0.839739]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 47/100 total MC = 80 this test stat = 0.0155555</div><div class="line"> s=55.8 ratioSigEff=1.00104 ratioBkgEff=1.02966 [-1e+30, 0.715161]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 48/100 total MC = 80 this test stat = 0.00792855</div><div class="line"> s=57 ratioSigEff=1.00075 ratioBkgEff=1.02116 [-1e+30, 0.574145]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 49/100 total MC = 80 this test stat = 0.00285134</div><div class="line"> s=58.2 ratioSigEff=1.00046 ratioBkgEff=1.01268 [-1e+30, 0.732099]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 50/100 total MC = 80 this test stat = 0.000340162</div><div class="line"> s=59.4 ratioSigEff=1.00048 ratioBkgEff=1.00391 [-1e+30, 0.692058]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 51/100 total MC = 80 this test stat = 0.000338383</div><div class="line"> s=60.6 ratioSigEff=0.999508 ratioBkgEff=0.996114 [-1e+30, 0.645986]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 52/100 total MC = 80 this test stat = 0.00280022</div><div class="line"> s=61.8 ratioSigEff=0.999513 ratioBkgEff=0.987372 [-1e+30, 0.513396]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 53/100 total MC = 80 this test stat = 0.00784733</div><div class="line"> s=63 ratioSigEff=0.999173 ratioBkgEff=0.978982 [-1e+30, 0.477501]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 54/100 total MC = 80 this test stat = 0.0154172</div><div class="line"> s=64.2 ratioSigEff=0.998823 ratioBkgEff=0.970615 [-1e+30, 0.721505]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 55/100 total MC = 80 this test stat = 0.0254769</div><div class="line"> s=65.4 ratioSigEff=0.998461 ratioBkgEff=0.962272 [-1e+30, 0.628705]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 56/100 total MC = 80 this test stat = 0.0380399</div><div class="line"> s=66.6 ratioSigEff=0.998088 ratioBkgEff=0.953953 [-1e+30, 0.636603]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 57/100 total MC = 80 this test stat = 0.0530874</div><div class="line"> s=67.8 ratioSigEff=0.997704 ratioBkgEff=0.945659 [-1e+30, 0.596425]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 58/100 total MC = 80 this test stat = 0.0706058</div><div class="line"> s=69 ratioSigEff=0.997308 ratioBkgEff=0.93739 [-1e+30, 0.865376]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 59/100 total MC = 80 this test stat = 0.0905894</div><div class="line"> s=70.2 ratioSigEff=0.996902 ratioBkgEff=0.929147 [-1e+30, 0.817861]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 60/100 total MC = 80 this test stat = 0.11303</div><div class="line"> s=71.4 ratioSigEff=0.996485 ratioBkgEff=0.920929 [-1e+30, 1.06483]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 61/100 total MC = 80 this test stat = 0.137918</div><div class="line"> s=72.6 ratioSigEff=0.996058 ratioBkgEff=0.912737 [-1e+30, 0.780337]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 62/100 total MC = 80 this test stat = 0.165246</div><div class="line"> s=73.8 ratioSigEff=0.995619 ratioBkgEff=0.904572 [-1e+30, 0.684448]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 63/100 total MC = 80 this test stat = 0.195001</div><div class="line"> s=75 ratioSigEff=0.99517 ratioBkgEff=0.896434 [-1e+30, 1.03028]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 64/100 total MC = 80 this test stat = 0.227176</div><div class="line"> s=76.2 ratioSigEff=0.994711 ratioBkgEff=0.888323 [-1e+30, 0.978198]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 65/100 total MC = 80 this test stat = 0.261776</div><div class="line"> s=77.4 ratioSigEff=0.994241 ratioBkgEff=0.880239 [-1e+30, 1.11253]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 66/100 total MC = 80 this test stat = 0.298772</div><div class="line"> s=78.6 ratioSigEff=0.99376 ratioBkgEff=0.872184 [-1e+30, 1.1878]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 67/100 total MC = 80 this test stat = 0.338144</div><div class="line"> s=79.8 ratioSigEff=0.99327 ratioBkgEff=0.864156 [-1e+30, 1.48097]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 68/100 total MC = 80 this test stat = 0.379914</div><div class="line"> s=81 ratioSigEff=0.992769 ratioBkgEff=0.856158 [-1e+30, 1.56743]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 69/100 total MC = 80 this test stat = 0.424071</div><div class="line"> s=82.2 ratioSigEff=0.992258 ratioBkgEff=0.848188 [-1e+30, 1.28528]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 70/100 total MC = 80 this test stat = 0.470561</div><div class="line"> s=83.4 ratioSigEff=0.991737 ratioBkgEff=0.840248 [-1e+30, 1.43791]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 71/100 total MC = 80 this test stat = 0.519388</div><div class="line"> s=84.6 ratioSigEff=0.991206 ratioBkgEff=0.832337 [-1e+30, 1.84071]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 72/100 total MC = 80 this test stat = 0.570629</div><div class="line"> s=85.8 ratioSigEff=0.990665 ratioBkgEff=0.824456 [-1e+30, 1.31507]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 73/100 total MC = 80 this test stat = 0.624119</div><div class="line"> s=87 ratioSigEff=0.990114 ratioBkgEff=0.816606 [-1e+30, 1.18907]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 74/100 total MC = 80 this test stat = 0.679954</div><div class="line"> s=88.2 ratioSigEff=0.989554 ratioBkgEff=0.808786 [-1e+30, 1.33487]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 75/100 total MC = 80 this test stat = 0.738064</div><div class="line"> s=89.4 ratioSigEff=0.988831 ratioBkgEff=0.800144 [-1e+30, 1.56433]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 76/100 total MC = 80 this test stat = 0.798499</div><div class="line"> s=90.6 ratioSigEff=0.988237 ratioBkgEff=0.792303 [-1e+30, 1.49944]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 77/100 total MC = 80 this test stat = 0.861245</div><div class="line"> s=91.8 ratioSigEff=0.987632 ratioBkgEff=0.784488 [-1e+30, 1.7418]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 78/100 total MC = 80 this test stat = 0.926247</div><div class="line"> s=93 ratioSigEff=0.987017 ratioBkgEff=0.7767 [-1e+30, 1.37459]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 79/100 total MC = 80 this test stat = 0.993496</div><div class="line"> s=94.2 ratioSigEff=0.986393 ratioBkgEff=0.76894 [-1e+30, 2.1909]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 80/100 total MC = 80 this test stat = 1.06297</div><div class="line"> s=95.4 ratioSigEff=0.985758 ratioBkgEff=0.761207 [-1e+30, 1.85545]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 81/100 total MC = 80 this test stat = 1.13473</div><div class="line"> s=96.6 ratioSigEff=0.985113 ratioBkgEff=0.753502 [-1e+30, 1.86619]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 82/100 total MC = 80 this test stat = 1.20872</div><div class="line"> s=97.8 ratioSigEff=0.984458 ratioBkgEff=0.745825 [-1e+30, 2.41018]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 83/100 total MC = 80 this test stat = 1.28491</div><div class="line"> s=99 ratioSigEff=0.983794 ratioBkgEff=0.738176 [-1e+30, 2.4215]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 84/100 total MC = 80 this test stat = 1.36329</div><div class="line"> s=100.2 ratioSigEff=0.983119 ratioBkgEff=0.730555 [-1e+30, 2.43281]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 85/100 total MC = 80 this test stat = 1.44387</div><div class="line"> s=101.4 ratioSigEff=0.982436 ratioBkgEff=0.722963 [-1e+30, 2.44404]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 86/100 total MC = 80 this test stat = 1.52662</div><div class="line"> s=102.6 ratioSigEff=0.981742 ratioBkgEff=0.7154 [-1e+30, 2.09032]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 87/100 total MC = 80 this test stat = 1.61153</div><div class="line"> s=103.8 ratioSigEff=0.981039 ratioBkgEff=0.707866 [-1e+30, 2.76135]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 88/100 total MC = 80 this test stat = 1.69863</div><div class="line"> s=105 ratioSigEff=0.980326 ratioBkgEff=0.700362 [-1e+30, 2.20046]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 89/100 total MC = 80 this test stat = 1.78786</div><div class="line"> s=106.2 ratioSigEff=0.979605 ratioBkgEff=0.692886 [-1e+30, 2.58534]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 90/100 total MC = 80 this test stat = 1.87921</div><div class="line"> s=107.4 ratioSigEff=0.978873 ratioBkgEff=0.685441 [-1e+30, 2.89797]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 91/100 total MC = 80 this test stat = 1.97265</div><div class="line"> s=108.6 ratioSigEff=0.978133 ratioBkgEff=0.678026 [-1e+30, 3.1204]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 92/100 total MC = 80 this test stat = 2.06825</div><div class="line"> s=109.8 ratioSigEff=0.977383 ratioBkgEff=0.670641 [-1e+30, 3.0252]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 93/100 total MC = 80 this test stat = 2.16592</div><div class="line"> s=111 ratioSigEff=0.976625 ratioBkgEff=0.663286 [-1e+30, 2.93195]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 94/100 total MC = 80 this test stat = 2.26567</div><div class="line"> s=112.2 ratioSigEff=0.975857 ratioBkgEff=0.655962 [-1e+30, 3.15451]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 95/100 total MC = 80 this test stat = 2.36747</div><div class="line"> s=113.4 ratioSigEff=0.975049 ratioBkgEff=0.648489 [-1e+30, 3.05911]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 96/100 total MC = 80 this test stat = 2.47134</div><div class="line"> s=114.6 ratioSigEff=0.97426 ratioBkgEff=0.641206 [-1e+30, 2.96561]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 97/100 total MC = 80 this test stat = 2.57725</div><div class="line"> s=115.8 ratioSigEff=0.973462 ratioBkgEff=0.633952 [-1e+30, 3.5205]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 98/100 total MC = 720 this test stat = 2.68519</div><div class="line"> s=117 ratioSigEff=0.972655 ratioBkgEff=0.626728 [-1e+30, 3.19948]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 99/100 total MC = 80 this test stat = 2.79514</div><div class="line"> s=118.2 ratioSigEff=0.971839 ratioBkgEff=0.619535 [-1e+30, 3.43015]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 100/100 total MC = 80 this test stat = 2.90706</div><div class="line"> s=119.4 ratioSigEff=0.971013 ratioBkgEff=0.612371 [-1e+30, 3.55406]  in interval = 1</div><div class="line"></div><div class="line">[#1] INFO:Eval -- 100 points in interval</div><div class="line"></div><div class="line">[#1] INFO:Minization -- createNLL picked up cached consraints from workspace with 2 entries</div><div class="line">[#1] INFO:Minization --  Including the following contraint terms in minimization: (sigConstraint,bkgConstraint)</div><div class="line">[#1] INFO:Fitting -- RooAddition::defaultErrorLevel(nll_modelWithConstraints_exampleData_with_constr) Summation contains a RooNLLVar, using its error level</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization --  The following expressions will be evaluated in cache-and-track mode: (countingModel)</div><div class="line"> **********</div><div class="line"> **    1 **SET PRINT           1</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    2 **SET NOGRAD</div><div class="line"> **********</div><div class="line"> PARAMETER DEFINITIONS:</div><div class="line">    NO.   NAME         VALUE      STEP SIZE      LIMITS</div><div class="line">     1 ratioBkgEff   6.12371e-01  1.20943e-01    0.00000e+00  3.00000e+00</div><div class="line">     2 ratioSigEff   9.71013e-01  4.85593e-02    0.00000e+00  3.00000e+00</div><div class="line">     3 s            1.19400e+02  3.00000e-01    0.00000e+00  1.20000e+02</div><div class="line"> **********</div><div class="line"> **    3 **SET ERR         0.5</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    4 **SET PRINT           1</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    5 **SET STR           1</div><div class="line"> **********</div><div class="line"> NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY</div><div class="line"> **********</div><div class="line"> **    6 **MIGRAD        1500           1</div><div class="line"> **********</div><div class="line"> FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.</div><div class="line"> START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03</div><div class="line"> FCN=4.91605 FROM MIGRAD    STATUS=INITIATE       27 CALLS          28 TOTAL</div><div class="line">                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       </div><div class="line">  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  ratioBkgEff   6.12371e-01   1.20943e-01   0.00000e+00  -1.48191e+01</div><div class="line">   2  ratioSigEff   9.71013e-01   4.85593e-02   0.00000e+00  -1.97878e+01</div><div class="line">   3  s            9.75908e+01   3.00000e-01  -7.52185e-01  -1.16463e+00</div><div class="line">                               ERR DEF= 0.5</div><div class="line"> MIGRAD MINIMIZATION HAS CONVERGED.</div><div class="line"> MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.</div><div class="line"> COVARIANCE MATRIX CALCULATED SUCCESSFULLY</div><div class="line"> FCN=2.81893 FROM MIGRAD    STATUS=CONVERGED      79 CALLS          80 TOTAL</div><div class="line">                     EDM=1.35233e-06    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                   STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  ratioBkgEff   1.00007e+00   1.99245e-01   9.52486e-05   8.82152e-03</div><div class="line">   2  ratioSigEff   1.00005e+00   4.99902e-02   4.32605e-05   3.08391e-02</div><div class="line">   3  s            5.99980e+01   2.32204e+01   2.65567e-04   2.76682e-03</div><div class="line">                               ERR DEF= 0.5</div><div class="line"> EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  3    ERR DEF=0.5</div><div class="line">  3.996e-02  9.390e-07 -3.996e+00 </div><div class="line">  9.390e-07  2.500e-03 -1.501e-01 </div><div class="line"> -3.996e+00 -1.501e-01  5.685e+02 </div><div class="line"> PARAMETER  CORRELATION COEFFICIENTS  </div><div class="line">       NO.  GLOBAL      1      2      3</div><div class="line">        1  0.84499   1.000  0.000 -0.838</div><div class="line">        2  0.23083   0.000  1.000 -0.126</div><div class="line">        3  0.84767  -0.838 -0.126  1.000</div><div class="line"> **********</div><div class="line"> **    7 **SET ERR         0.5</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    8 **SET PRINT           1</div><div class="line"> **********</div><div class="line"> **********</div><div class="line"> **    9 **HESSE        1500</div><div class="line"> **********</div><div class="line"> COVARIANCE MATRIX CALCULATED SUCCESSFULLY</div><div class="line"> FCN=2.81893 FROM HESSE     STATUS=OK             16 CALLS          96 TOTAL</div><div class="line">                     EDM=1.35232e-06    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                INTERNAL      INTERNAL  </div><div class="line">  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   </div><div class="line">   1  ratioBkgEff   1.00007e+00   1.99312e-01   1.90497e-05  -3.39791e-01</div><div class="line">   2  ratioSigEff   1.00005e+00   4.99897e-02   8.65209e-06  -3.39803e-01</div><div class="line">   3  s            5.99980e+01   2.32275e+01   5.31134e-05  -3.30615e-05</div><div class="line">                               ERR DEF= 0.5</div><div class="line"> EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  3    ERR DEF=0.5</div><div class="line">  3.999e-02  5.161e-07 -3.999e+00 </div><div class="line">  5.161e-07  2.500e-03 -1.501e-01 </div><div class="line"> -3.999e+00 -1.501e-01  5.689e+02 </div><div class="line"> PARAMETER  CORRELATION COEFFICIENTS  </div><div class="line">       NO.  GLOBAL      1      2      3</div><div class="line">        1  0.84511   1.000  0.000 -0.838</div><div class="line">        2  0.23079   0.000  1.000 -0.126</div><div class="line">        3  0.84778  -0.838 -0.126  1.000</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization</div><div class="line">[#1] INFO:Minization -- createNLL picked up cached consraints from workspace with 2 entries</div><div class="line">[#1] INFO:Minization --  Including the following contraint terms in minimization: (sigConstraint,bkgConstraint)</div><div class="line">[#1] INFO:Minization -- The following global observables have been defined: (gSigEff,gSigBkg)</div><div class="line">Metropolis-Hastings progress: ....................................................................................................</div><div class="line">[#1] INFO:Eval -- Proposal acceptance rate: 48.275%</div><div class="line">[#1] INFO:Eval -- Number of steps in chain: 9655</div><div class="line">Profile lower limit on s = 13.9497</div><div class="line">Profile upper limit on s = 107.95</div><div class="line">FC lower limit on s = 0.6</div><div class="line">FC upper limit on s = 119.4</div><div class="line">MCMC lower limit on s = 18.5269</div><div class="line">MCMC upper limit on s = 103.567</div><div class="line">MCMC Actual confidence level: 0.949952</div><div class="line">[#0] ERROR:InputArguments -- RooArgSet::checkForDup: ERROR argument with name weight_MarkovChain_local_ is already in this set</div><div class="line">plotting the chain data - nentries = 9655</div><div class="line">plotting the scanned points used in the frequentist construction - npoints = 100</div><div class="line">Real time 0:00:10, CP time 10.350</div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooProfileLL_8h.html">RooProfileLL.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooAbsPdf_8h.html">RooAbsPdf.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="HypoTestResult_8h.html">RooStats/HypoTestResult.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooRealVar_8h.html">RooRealVar.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooPlot_8h.html">RooPlot.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooDataSet_8h.html">RooDataSet.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooTreeDataStore_8h.html">RooTreeDataStore.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TTree_8h.html">TTree.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TLine_8h.html">TLine.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TStopwatch_8h.html">TStopwatch.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ProfileLikelihoodCalculator_8h.html">RooStats/ProfileLikelihoodCalculator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="MCMCCalculator_8h.html">RooStats/MCMCCalculator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="UniformProposal_8h.html">RooStats/UniformProposal.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="FeldmanCousins_8h.html">RooStats/FeldmanCousins.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="NumberCountingPdfFactory_8h.html">RooStats/NumberCountingPdfFactory.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ConfInterval_8h.html">RooStats/ConfInterval.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="PointSetInterval_8h.html">RooStats/PointSetInterval.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="LikelihoodInterval_8h.html">RooStats/LikelihoodInterval.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="LikelihoodIntervalPlot_8h.html">RooStats/LikelihoodIntervalPlot.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooStatsUtils_8h.html">RooStats/RooStatsUtils.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ModelConfig_8h.html">RooStats/ModelConfig.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="MCMCInterval_8h.html">RooStats/MCMCInterval.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="MCMCIntervalPlot_8h.html">RooStats/MCMCIntervalPlot.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ProposalFunction_8h.html">RooStats/ProposalFunction.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ProposalHelper_8h.html">RooStats/ProposalHelper.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooFitResult_8h.html">RooFitResult.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TGraph2D_8h.html">TGraph2D.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// use this order for safety on library loading</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooFit.html">RooFit</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooStats.html">RooStats</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> rs101_limitexample()</div><div class="line">{</div><div class="line">   <span class="comment">// --------------------------------------</span></div><div class="line">   <span class="comment">// An example of setting a limit in a number counting experiment with uncertainty on background and signal</span></div><div class="line"></div><div class="line">   <span class="comment">// to time the macro</span></div><div class="line">   <a class="code" href="classTStopwatch.html">TStopwatch</a> t;</div><div class="line">   t.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line"></div><div class="line">   <span class="comment">// --------------------------------------</span></div><div class="line">   <span class="comment">// The Model building stage</span></div><div class="line">   <span class="comment">// --------------------------------------</span></div><div class="line">   <a class="code" href="classRooWorkspace.html">RooWorkspace</a> *wspace = <span class="keyword">new</span> <a class="code" href="classRooWorkspace.html">RooWorkspace</a>();</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Poisson::countingModel(obs[150,0,300], &quot;</span></div><div class="line">                   <span class="stringliteral">&quot;sum(s[50,0,120]*ratioSigEff[1.,0,3.],b[100]*ratioBkgEff[1.,0.,3.]))&quot;</span>); <span class="comment">// counting model</span></div><div class="line">   <span class="comment">//  wspace-&gt;factory(&quot;Gaussian::sigConstraint(ratioSigEff,1,0.05)&quot;); // 5% signal efficiency uncertainty</span></div><div class="line">   <span class="comment">//  wspace-&gt;factory(&quot;Gaussian::bkgConstraint(ratioBkgEff,1,0.1)&quot;); // 10% background efficiency uncertainty</span></div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Gaussian::sigConstraint(gSigEff[1,0,3],ratioSigEff,0.05)&quot;</span>); <span class="comment">// 5% signal efficiency uncertainty</span></div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Gaussian::bkgConstraint(gSigBkg[1,0,3],ratioBkgEff,0.2)&quot;</span>);  <span class="comment">// 10% background efficiency uncertainty</span></div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;PROD::modelWithConstraints(countingModel,sigConstraint,bkgConstraint)&quot;</span>); <span class="comment">// product of terms</span></div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#a9131cf30e7ea371b14a619ebf0d7e18f">Print</a>();</div><div class="line"></div><div class="line">   <a class="code" href="classRooAbsPdf.html">RooAbsPdf</a> *modelWithConstraints = wspace-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;modelWithConstraints&quot;</span>); <span class="comment">// get the model</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *obs = wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;obs&quot;</span>);                                  <span class="comment">// get the observable</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> = wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;s&quot;</span>);                                      <span class="comment">// get the signal we care about</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> =</div><div class="line">      wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;b&quot;</span>); <span class="comment">// get the background and set it to a constant.  Uncertainty included in ratioBkgEff</span></div><div class="line">   <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;setConstant();</div><div class="line"></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *ratioSigEff = wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;ratioSigEff&quot;</span>); <span class="comment">// get uncertain parameter to constrain</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *ratioBkgEff = wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;ratioBkgEff&quot;</span>); <span class="comment">// get uncertain parameter to constrain</span></div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> constrainedParams(*ratioSigEff,</div><div class="line">                               *ratioBkgEff); <span class="comment">// need to constrain these in the fit (should change default behavior)</span></div><div class="line"></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *gSigEff = wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;gSigEff&quot;</span>); <span class="comment">// global observables for signal efficiency</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *gSigBkg = wspace-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;gSigBkg&quot;</span>); <span class="comment">// global obs for background efficiency</span></div><div class="line">   gSigEff-&gt;<a class="code" href="classRooAbsRealLValue.html#ada206bf5e97d88491e89032c1bd7789c">setConstant</a>();</div><div class="line">   gSigBkg-&gt;<a class="code" href="classRooAbsRealLValue.html#ada206bf5e97d88491e89032c1bd7789c">setConstant</a>();</div><div class="line"></div><div class="line">   <span class="comment">// Create an example dataset with 160 observed events</span></div><div class="line">   obs-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(160.);</div><div class="line">   <a class="code" href="classRooDataSet.html">RooDataSet</a> *data = <span class="keyword">new</span> <a class="code" href="classRooDataSet.html">RooDataSet</a>(<span class="stringliteral">&quot;exampleData&quot;</span>, <span class="stringliteral">&quot;exampleData&quot;</span>, <a class="code" href="classRooArgSet.html">RooArgSet</a>(*obs));</div><div class="line">   data-&gt;<a class="code" href="classRooDataSet.html#a5f9df28f72d49715073669890da8bf1f">add</a>(*obs);</div><div class="line"></div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> all(*<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>, *ratioBkgEff, *ratioSigEff);</div><div class="line"></div><div class="line">   <span class="comment">// not necessary</span></div><div class="line">   modelWithConstraints-&gt;<a class="code" href="classRooAbsPdf.html#a8f802a3a93467d5b7b089e3ccaec0fa8">fitTo</a>(*data, <a class="code" href="namespaceRooFit.html#a30b2f29c6489a3b32c17b8587d568530">RooFit::Constrain</a>(<a class="code" href="classRooArgSet.html">RooArgSet</a>(*ratioSigEff, *ratioBkgEff)));</div><div class="line"></div><div class="line">   <span class="comment">// Now let&#39;s make some confidence intervals for s, our parameter of interest</span></div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> paramOfInterest(*<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>);</div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> modelConfig(wspace);</div><div class="line">   modelConfig.<a class="code" href="classRooStats_1_1ModelConfig.html#afdd514ddbe92c70b56d0a3cc87f0a745">SetPdf</a>(*modelWithConstraints);</div><div class="line">   modelConfig.<a class="code" href="classRooStats_1_1ModelConfig.html#a6c7174b07a0cf56574f04d7e319cd15c">SetParametersOfInterest</a>(paramOfInterest);</div><div class="line">   modelConfig.<a class="code" href="classRooStats_1_1ModelConfig.html#ae1f9b32270671d2bf7b9f0fcac4f957e">SetNuisanceParameters</a>(constrainedParams);</div><div class="line">   modelConfig.<a class="code" href="classRooStats_1_1ModelConfig.html#a0e4f2861bf29e08e6c518b2d09f9376f">SetObservables</a>(*obs);</div><div class="line">   modelConfig.<a class="code" href="classRooStats_1_1ModelConfig.html#a98323297e0b37d6a99db4b4eda0ea1c5">SetGlobalObservables</a>(<a class="code" href="classRooArgSet.html">RooArgSet</a>(*gSigEff, *gSigBkg));</div><div class="line">   modelConfig.<a class="code" href="classTNamed.html#ac9ab37338859e070a2695e3b2db8d217">SetName</a>(<span class="stringliteral">&quot;ModelConfig&quot;</span>);</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#acff0ca83ad63c5b7a4cb8ea39d0e1669">import</a>(modelConfig);</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#acff0ca83ad63c5b7a4cb8ea39d0e1669">import</a>(*data);</div><div class="line">   wspace-&gt;<a class="code" href="classTNamed.html#ac9ab37338859e070a2695e3b2db8d217">SetName</a>(<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line">   wspace-&gt;<a class="code" href="classRooWorkspace.html#a99bc69a858f1dd54a3f69fcb11b0081f">writeToFile</a>(<span class="stringliteral">&quot;rs101_ws.root&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// First, let&#39;s use a Calculator based on the Profile Likelihood Ratio</span></div><div class="line">   <span class="comment">// ProfileLikelihoodCalculator plc(*data, *modelWithConstraints, paramOfInterest);</span></div><div class="line">   <a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html">ProfileLikelihoodCalculator</a> plc(*data, modelConfig);</div><div class="line">   plc.SetTestSize(.05);</div><div class="line">   <a class="code" href="classRooStats_1_1ConfInterval.html">ConfInterval</a> *lrinterval = plc.GetInterval(); <span class="comment">// that was easy.</span></div><div class="line"></div><div class="line">   <span class="comment">// Let&#39;s make a plot</span></div><div class="line">   <a class="code" href="classTCanvas.html">TCanvas</a> *dataCanvas = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>(<span class="stringliteral">&quot;dataCanvas&quot;</span>);</div><div class="line">   dataCanvas-&gt;<a class="code" href="classTPad.html#a064b8ae1d12a9be393c0e22c5958cc7c">Divide</a>(2, 1);</div><div class="line"></div><div class="line">   dataCanvas-&gt;<a class="code" href="classTCanvas.html#ad996aa7bc34186944363b48963de4de5">cd</a>(1);</div><div class="line">   <a class="code" href="classRooStats_1_1LikelihoodIntervalPlot.html">LikelihoodIntervalPlot</a> plotInt((<a class="code" href="classRooStats_1_1LikelihoodInterval.html">LikelihoodInterval</a> *)lrinterval);</div><div class="line">   plotInt.SetTitle(<span class="stringliteral">&quot;Profile Likelihood Ratio and Posterior for S&quot;</span>);</div><div class="line">   plotInt.Draw();</div><div class="line"></div><div class="line">   <span class="comment">// Second, use a Calculator based on the Feldman Cousins technique</span></div><div class="line">   <a class="code" href="classRooStats_1_1FeldmanCousins.html">FeldmanCousins</a> <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>(*data, modelConfig);</div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.UseAdaptiveSampling(<span class="keyword">true</span>);</div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.FluctuateNumDataEntries(<span class="keyword">false</span>); <span class="comment">// number counting analysis: dataset always has 1 entry with N events observed</span></div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.SetNBins(100);                  <span class="comment">// number of points to test per parameter</span></div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.SetTestSize(.05);</div><div class="line">   <span class="comment">//  fc.SaveBeltToFile(true); // optional</span></div><div class="line">   <a class="code" href="classRooStats_1_1ConfInterval.html">ConfInterval</a> *fcint = NULL;</div><div class="line">   fcint = <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetInterval(); <span class="comment">// that was easy.</span></div><div class="line"></div><div class="line">   <a class="code" href="classRooFitResult.html">RooFitResult</a> *fit = modelWithConstraints-&gt;<a class="code" href="classRooAbsPdf.html#a8f802a3a93467d5b7b089e3ccaec0fa8">fitTo</a>(*data, <a class="code" href="namespaceRooFit.html#aaccf9043976e51d28313a373a022f003">Save</a>(<span class="keyword">true</span>));</div><div class="line"></div><div class="line">   <span class="comment">// Third, use a Calculator based on Markov Chain monte carlo</span></div><div class="line">   <span class="comment">// Before configuring the calculator, let&#39;s make a ProposalFunction</span></div><div class="line">   <span class="comment">// that will achieve a high acceptance rate</span></div><div class="line">   <a class="code" href="classRooStats_1_1ProposalHelper.html">ProposalHelper</a> ph;</div><div class="line">   ph.<a class="code" href="classRooStats_1_1ProposalHelper.html#a69f305778842862cf5f793facdaa4c61">SetVariables</a>((<a class="code" href="classRooArgSet.html">RooArgSet</a> &amp;)fit-&gt;<a class="code" href="classRooFitResult.html#a90de237846f00972f77ecd6fb346b471">floatParsFinal</a>());</div><div class="line">   ph.<a class="code" href="classRooStats_1_1ProposalHelper.html#a1ad42c99d84a9b94023e07757d71dd40">SetCovMatrix</a>(fit-&gt;<a class="code" href="classRooFitResult.html#a16fffe1a2eafa3733bc2501a7bf23b62">covarianceMatrix</a>());</div><div class="line">   ph.<a class="code" href="classRooStats_1_1ProposalHelper.html#a32046486740cee28adeaaeade6e33783">SetUpdateProposalParameters</a>(<span class="keyword">true</span>);</div><div class="line">   ph.<a class="code" href="classRooStats_1_1ProposalHelper.html#a9acb9ac26ffa8b6b7b994a594cf10e37">SetCacheSize</a>(100);</div><div class="line">   <a class="code" href="classRooStats_1_1ProposalFunction.html">ProposalFunction</a> *pdfProp = ph.<a class="code" href="classRooStats_1_1ProposalHelper.html#a5fc754f0a8f348cbfa17a83de916889b">GetProposalFunction</a>(); <span class="comment">// that was easy</span></div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1MCMCCalculator.html">MCMCCalculator</a> mc(*data, modelConfig);</div><div class="line">   mc.SetNumIters(20000);    <span class="comment">// steps to propose in the chain</span></div><div class="line">   mc.SetTestSize(.05);      <span class="comment">// 95% CL</span></div><div class="line">   mc.SetNumBurnInSteps(40); <span class="comment">// ignore first N steps in chain as &quot;burn in&quot;</span></div><div class="line">   mc.SetProposalFunction(*pdfProp);</div><div class="line">   mc.SetLeftSideTailFraction(0.5);                        <span class="comment">// find a &quot;central&quot; interval</span></div><div class="line">   <a class="code" href="classRooStats_1_1MCMCInterval.html">MCMCInterval</a> *mcInt = (<a class="code" href="classRooStats_1_1MCMCInterval.html">MCMCInterval</a> *)mc.GetInterval(); <span class="comment">// that was easy</span></div><div class="line"></div><div class="line">   <span class="comment">// Get Lower and Upper limits from Profile Calculator</span></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Profile lower limit on s = &quot;</span> &lt;&lt; ((<a class="code" href="classRooStats_1_1LikelihoodInterval.html">LikelihoodInterval</a> *)lrinterval)-&gt;LowerLimit(*<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>) &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Profile upper limit on s = &quot;</span> &lt;&lt; ((<a class="code" href="classRooStats_1_1LikelihoodInterval.html">LikelihoodInterval</a> *)lrinterval)-&gt;UpperLimit(*<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>) &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">// Get Lower and Upper limits from FeldmanCousins with profile construction</span></div><div class="line">   <span class="keywordflow">if</span> (fcint != NULL) {</div><div class="line">      <span class="keywordtype">double</span> fcul = ((<a class="code" href="classRooStats_1_1PointSetInterval.html">PointSetInterval</a> *)fcint)-&gt;UpperLimit(*<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>);</div><div class="line">      <span class="keywordtype">double</span> fcll = ((<a class="code" href="classRooStats_1_1PointSetInterval.html">PointSetInterval</a> *)fcint)-&gt;LowerLimit(*<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>);</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;FC lower limit on s = &quot;</span> &lt;&lt; fcll &lt;&lt; endl;</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;FC upper limit on s = &quot;</span> &lt;&lt; fcul &lt;&lt; endl;</div><div class="line">      <a class="code" href="classTLine.html">TLine</a> *fcllLine = <span class="keyword">new</span> <a class="code" href="classTLine.html">TLine</a>(fcll, 0, fcll, 1);</div><div class="line">      <a class="code" href="classTLine.html">TLine</a> *fculLine = <span class="keyword">new</span> <a class="code" href="classTLine.html">TLine</a>(fcul, 0, fcul, 1);</div><div class="line">      fcllLine-&gt;<a class="code" href="classTAttLine.html#a718156d3be0e4b3e0c52b2257a9d4e7a">SetLineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a5a655b1a02e5b0311571ca57ce4f3900">kRed</a>);</div><div class="line">      fculLine-&gt;<a class="code" href="classTAttLine.html#a718156d3be0e4b3e0c52b2257a9d4e7a">SetLineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a5a655b1a02e5b0311571ca57ce4f3900">kRed</a>);</div><div class="line">      fcllLine-&gt;<a class="code" href="classTObject.html#adaa7be22dce34ebb73fbf22e4bdf33a2">Draw</a>(<span class="stringliteral">&quot;same&quot;</span>);</div><div class="line">      fculLine-&gt;<a class="code" href="classTObject.html#adaa7be22dce34ebb73fbf22e4bdf33a2">Draw</a>(<span class="stringliteral">&quot;same&quot;</span>);</div><div class="line">      dataCanvas-&gt;<a class="code" href="classTCanvas.html#a83bb3270c4e4cd4250730d5586ceebd6">Update</a>();</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// Plot MCMC interval and print some statistics</span></div><div class="line">   <a class="code" href="classRooStats_1_1MCMCIntervalPlot.html">MCMCIntervalPlot</a> mcPlot(*mcInt);</div><div class="line">   mcPlot.<a class="code" href="classRooStats_1_1MCMCIntervalPlot.html#a0883d7f458bb9adf2f9fe76026d042e4">SetLineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a951e8c9c29427097fd137e19a3300e03">kMagenta</a>);</div><div class="line">   mcPlot.<a class="code" href="classRooStats_1_1MCMCIntervalPlot.html#aaaa60324f3822cf98448f466f5ed5a60">SetLineWidth</a>(2);</div><div class="line">   mcPlot.<a class="code" href="classRooStats_1_1MCMCIntervalPlot.html#af16d300c0e4fe8b4af84ec56b7d48cdb">Draw</a>(<span class="stringliteral">&quot;same&quot;</span>);</div><div class="line"></div><div class="line">   <span class="keywordtype">double</span> mcul = mcInt-&gt;<a class="code" href="classRooStats_1_1MCMCInterval.html#a14314c91266d7ff84d7fcdf14b8f655e">UpperLimit</a>(*<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>);</div><div class="line">   <span class="keywordtype">double</span> mcll = mcInt-&gt;<a class="code" href="classRooStats_1_1MCMCInterval.html#a8431ef4e859c68a2d08f0a2562e2e8e6">LowerLimit</a>(*<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>);</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;MCMC lower limit on s = &quot;</span> &lt;&lt; mcll &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;MCMC upper limit on s = &quot;</span> &lt;&lt; mcul &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;MCMC Actual confidence level: &quot;</span> &lt;&lt; mcInt-&gt;<a class="code" href="classRooStats_1_1MCMCInterval.html#a78147394c36c929049cb1042a3f5e91b">GetActualConfidenceLevel</a>() &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">// 3-d plot of the parameter points</span></div><div class="line">   dataCanvas-&gt;<a class="code" href="classTCanvas.html#ad996aa7bc34186944363b48963de4de5">cd</a>(2);</div><div class="line">   <span class="comment">// also plot the points in the markov chain</span></div><div class="line">   <a class="code" href="classRooDataSet.html">RooDataSet</a> *chainData = mcInt-&gt;<a class="code" href="classRooStats_1_1MCMCInterval.html#a9e561ef4164080cc259fc124831d3f77">GetChainAsDataSet</a>();</div><div class="line"></div><div class="line">   assert(chainData);</div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;plotting the chain data - nentries = &quot;</span> &lt;&lt; chainData-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>() &lt;&lt; std::endl;</div><div class="line">   <a class="code" href="classTTree.html">TTree</a> *chain = <a class="code" href="namespaceRooStats.html#a182cb34e51a998218bc623211cf09d3b">RooStats::GetAsTTree</a>(<span class="stringliteral">&quot;chainTreeData&quot;</span>, <span class="stringliteral">&quot;chainTreeData&quot;</span>, *chainData);</div><div class="line">   assert(chain);</div><div class="line">   chain-&gt;<a class="code" href="classTAttMarker.html#a697e1a65975ff344c9dca7618fd44de4">SetMarkerStyle</a>(6);</div><div class="line">   chain-&gt;<a class="code" href="classTAttMarker.html#a27f1eae16a3f990024e8a401ed034fa3">SetMarkerColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a5a655b1a02e5b0311571ca57ce4f3900">kRed</a>);</div><div class="line"></div><div class="line">   chain-&gt;<a class="code" href="classTTree.html#ac4016b174665a086fe16695aad3356e2">Draw</a>(<span class="stringliteral">&quot;s:ratioSigEff:ratioBkgEff&quot;</span>, <span class="stringliteral">&quot;nll_MarkovChain_local_&quot;</span>, <span class="stringliteral">&quot;box&quot;</span>); <span class="comment">// 3-d box proportional to posterior</span></div><div class="line"></div><div class="line">   <span class="comment">// the points used in the profile construction</span></div><div class="line">   <a class="code" href="classRooDataSet.html">RooDataSet</a> *parScanData = (<a class="code" href="classRooDataSet.html">RooDataSet</a> *)<a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetPointsToScan();</div><div class="line">   assert(parScanData);</div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;plotting the scanned points used in the frequentist construction - npoints = &quot;</span></div><div class="line">             &lt;&lt; parScanData-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>() &lt;&lt; std::endl;</div><div class="line">   <span class="comment">// getting the tree and drawing it -crashes (very strange....);</span></div><div class="line">   <span class="comment">// TTree* parameterScan =  RooStats::GetAsTTree(&quot;parScanTreeData&quot;,&quot;parScanTreeData&quot;,*parScanData);</span></div><div class="line">   <span class="comment">// assert(parameterScan);</span></div><div class="line">   <span class="comment">// parameterScan-&gt;Draw(&quot;s:ratioSigEff:ratioBkgEff&quot;,&quot;&quot;,&quot;goff&quot;);</span></div><div class="line">   <a class="code" href="classTGraph2D.html">TGraph2D</a> *<a class="code" href="legend1_8C.html#a81e8067fc8f8d5a6217c06912ca906a0">gr</a> = <span class="keyword">new</span> <a class="code" href="classTGraph2D.html">TGraph2D</a>(parScanData-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>());</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ievt = 0; ievt &lt; parScanData-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>(); ++ievt) {</div><div class="line">      <span class="keyword">const</span> <a class="code" href="classRooArgSet.html">RooArgSet</a> *evt = parScanData-&gt;<a class="code" href="classRooDataSet.html#a2d2355b7a32be47b906312f113ee75c0">get</a>(ievt);</div><div class="line">      <span class="keywordtype">double</span> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = evt-&gt;<a class="code" href="classRooArgSet.html#a72568bf2b2726891810ba3b3e8251f0b">getRealValue</a>(<span class="stringliteral">&quot;ratioBkgEff&quot;</span>);</div><div class="line">      <span class="keywordtype">double</span> <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> = evt-&gt;<a class="code" href="classRooArgSet.html#a72568bf2b2726891810ba3b3e8251f0b">getRealValue</a>(<span class="stringliteral">&quot;ratioSigEff&quot;</span>);</div><div class="line">      <span class="keywordtype">double</span> <a class="code" href="TRolke_8cxx.html#a89a026883dd7df087bf16c8c176caeed">z</a> = evt-&gt;<a class="code" href="classRooArgSet.html#a72568bf2b2726891810ba3b3e8251f0b">getRealValue</a>(<span class="stringliteral">&quot;s&quot;</span>);</div><div class="line">      <a class="code" href="legend1_8C.html#a81e8067fc8f8d5a6217c06912ca906a0">gr</a>-&gt;<a class="code" href="classTGraph.html#a0cd3af5cb1b7cdc249002e45a0b32318">SetPoint</a>(ievt, <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>, <a class="code" href="TRolke_8cxx.html#a89a026883dd7df087bf16c8c176caeed">z</a>);</div><div class="line">      <span class="comment">// std::cout &lt;&lt; ievt &lt;&lt; &quot;  &quot; &lt;&lt; x &lt;&lt; &quot;  &quot; &lt;&lt; y &lt;&lt; &quot;  &quot; &lt;&lt; z &lt;&lt; std::endl;</span></div><div class="line">   }</div><div class="line">   <a class="code" href="legend1_8C.html#a81e8067fc8f8d5a6217c06912ca906a0">gr</a>-&gt;<a class="code" href="classTAttMarker.html#a697e1a65975ff344c9dca7618fd44de4">SetMarkerStyle</a>(24);</div><div class="line">   <a class="code" href="legend1_8C.html#a81e8067fc8f8d5a6217c06912ca906a0">gr</a>-&gt;<a class="code" href="classTGraph.html#a7ee6d3572ef075dd4fa1a6deb939a986">Draw</a>(<span class="stringliteral">&quot;P SAME&quot;</span>);</div><div class="line"></div><div class="line">   <span class="keyword">delete</span> wspace;</div><div class="line">   <span class="keyword">delete</span> lrinterval;</div><div class="line">   <span class="keyword">delete</span> mcInt;</div><div class="line">   <span class="keyword">delete</span> fcint;</div><div class="line">   <span class="keyword">delete</span> data;</div><div class="line"></div><div class="line">   <span class="comment">// print timing info</span></div><div class="line">   t.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   t.<a class="code" href="classTStopwatch.html#aa393762ec66c9732940dccf05e8be7ec">Print</a>();</div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>Kyle Cranmer </dd></dl>

<p class="definition">Definition in file <a class="el" href="rs101__limitexample_8C_source.html">rs101_limitexample.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:26 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

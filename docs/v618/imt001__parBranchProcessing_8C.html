<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/multicore/imt001_parBranchProcessing.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_b2d2b4e27d077f7d4f8f12bfa35378a6.html">multicore</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">imt001_parBranchProcessing.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__multicore.html">Multicore tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/imt001_parBranchProcessing.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/imt001_parBranchProcessing.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  Demonstrate how to activate and use the implicit parallelisation of <a class="el" href="classTTree.html#a9fc48df5560fce1a2d63ecd1ac5b40cb" title="Read all branches of entry and return total number of bytes read. ">TTree::GetEntry</a>. </p>
<p>Such parallelisation creates one task per top-level branch of the tree being read. In this example, most of the branches are floating point numbers, which are very fast to read. This parallelisation can be used, though, on bigger trees with many (complex) branches, which are more likely to benefit from speedup gains.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="keywordtype">int</span> imt001_parBranchProcessing()</div><div class="line">{</div><div class="line">   <span class="comment">// First enable implicit multi-threading globally, so that the implicit parallelisation is on.</span></div><div class="line">   <span class="comment">// The parameter of the call specifies the number of threads to use.</span></div><div class="line">   <span class="keywordtype">int</span> nthreads = 4;</div><div class="line">   <a class="code" href="namespaceROOT.html#a06f2b8b216b615e5abbc872c9feff40f">ROOT::EnableImplicitMT</a>(nthreads);</div><div class="line"></div><div class="line">   <span class="comment">// Open the file containing the tree</span></div><div class="line">   <span class="keyword">auto</span> <a class="code" href="namespacefile.html">file</a> = <a class="code" href="classTFile.html#aec5f3fae0774aabfc615ebb4b00fe5e0">TFile::Open</a>(<span class="stringliteral">&quot;http://root.cern.ch/files/h1/dstarmb.root&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Get the tree</span></div><div class="line">   <span class="keyword">auto</span> <a class="code" href="namespacetree.html">tree</a> = <a class="code" href="namespacefile.html">file</a>-&gt;Get&lt;<a class="code" href="classTTree.html">TTree</a>&gt;(<span class="stringliteral">&quot;h42&quot;</span>);</div><div class="line"></div><div class="line">   <span class="keyword">const</span> <span class="keyword">auto</span> nEntries = <a class="code" href="namespacetree.html">tree</a>-&gt;GetEntries();</div><div class="line"></div><div class="line">   <span class="comment">// Read the branches in parallel.</span></div><div class="line">   <span class="comment">// Note that the interface does not change, the parallelisation is internal</span></div><div class="line">   <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="classROOT_1_1TSeq.html">ROOT::TSeqUL</a>(nEntries)) {</div><div class="line">      <a class="code" href="namespacetree.html">tree</a>-&gt;GetEntry(i); <span class="comment">// parallel read</span></div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// IMT parallelisation can be disabled for a specific tree</span></div><div class="line">   <a class="code" href="namespacetree.html">tree</a>-&gt;SetImplicitMT(<span class="keyword">false</span>);</div><div class="line"></div><div class="line">   <span class="comment">// If now GetEntry is invoked on the tree, the reading is sequential</span></div><div class="line">   <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="classROOT_1_1TSeq.html">ROOT::TSeqUL</a>(nEntries)) {</div><div class="line">      <a class="code" href="namespacetree.html">tree</a>-&gt;GetEntry(i); <span class="comment">// sequential read</span></div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// Parallel reading can be re-enabled</span></div><div class="line">   <a class="code" href="namespacetree.html">tree</a>-&gt;SetImplicitMT(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">   <span class="comment">// IMT can be also disabled globally.</span></div><div class="line">   <span class="comment">// As a result, no tree will run GetEntry in parallel</span></div><div class="line">   <a class="code" href="namespaceROOT.html#af6b6120e5533533bfe589e5ed91845f0">ROOT::DisableImplicitMT</a>();</div><div class="line"></div><div class="line">   <span class="comment">// This is still sequential: the global flag is disabled, even if the</span></div><div class="line">   <span class="comment">// flag for this particular tree is enabled</span></div><div class="line">   <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="classROOT_1_1TSeq.html">ROOT::TSeqUL</a>(nEntries)) {</div><div class="line">      <a class="code" href="namespacetree.html">tree</a>-&gt;GetEntry(i); <span class="comment">// sequential read</span></div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><dl class="section date"><dt>Date</dt><dd>26/09/2016 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Enric Tejedor </dd></dl>

<p class="definition">Definition in file <a class="el" href="imt001__parBranchProcessing_8C_source.html">imt001_parBranchProcessing.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:19 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: hist/spectrum/src/TSpectrum2.cxx Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8b9334156f3646fccf89e63b9869c7f9.html">hist</a></li><li class="navelem"><a class="el" href="dir_4ba217a18a1577d50b5101554d250fb7.html">spectrum</a></li><li class="navelem"><a class="el" href="dir_951b72617a0dcb03fe7fe95e0ea59f90.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TSpectrum2.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="TSpectrum2_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// @(#)root/spectrum:$Id$</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Author: Miroslav Morhac   17/01/2006</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/** \class TSpectrum2</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">    \ingroup Spectrum</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">    \brief Advanced 2-dimensional spectra processing</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">    \author Miroslav Morhac</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> This class contains advanced spectra processing functions.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">  - One-dimensional background estimation functions</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">  - Two-dimensional background estimation functions</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">  - One-dimensional smoothing functions</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">  - Two-dimensional smoothing functions</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">  - One-dimensional deconvolution functions</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">  - Two-dimensional deconvolution functions</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">  - One-dimensional peak search functions</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">  - Two-dimensional peak search functions</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> The algorithms in this class have been published in the following references:</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> 1.  M.Morhac et al.: Background elimination methods for multidimensional coincidence gamma-ray spectra. Nuclear Instruments and Methods in Physics Research A 401 (1997) 113-132.</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> 2.  M.Morhac et al.: Efficient one- and two-dimensional Gold deconvolution and its application to gamma-ray spectra decomposition. Nuclear Instruments and Methods in Physics Research A 401 (1997) 385-408.</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> 3.  M.Morhac et al.: Identification of peaks in multidimensional coincidence gamma-ray spectra. Nuclear Instruments and Methods in Research Physics A 443(2000), 108-125.</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> These NIM papers are also available as doc or ps files from:</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> - [SpectrumDec.ps.gz](ftp://root.cern.ch/root/SpectrumDec.ps.gz)</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> - [SpectrumSrc.ps.gz](ftp://root.cern.ch/root/SpectrumSrc.ps.gz)</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> - [SpectrumBck.ps.gz](ftp://root.cern.ch/root/SpectrumBck.ps.gz)</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> See also the</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> [online documentation](https://root.cern.ch/guides/tspectrum-manual) and</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> [tutorials](https://root.cern.ch/doc/master/group__tutorial__spectrum.html).</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> All the figures in this page were prepared using the DaqProVis</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> system, Data Acquisition, Processing and Visualization system,</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> developed at the Institute of Physics, Slovak Academy of Sciences, Bratislava,</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> Slovakia.</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TSpectrum2_8h.html">TSpectrum2.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TPolyMarker_8h.html">TPolyMarker.h</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TList_8h.html">TList.h</a>&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TH1_8h.html">TH1.h</a>&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TMath_8h.html">TMath.h</a>&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="TSpectrum2_8cxx.html#ade09a69507390390f0d1bd5b7d91826c">   47</a></span>&#160;<span class="preprocessor">#define PEAK_WINDOW 1024</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="classTSpectrum2.html#a2514608f7dbb02b499d0d815ddcd0583">TSpectrum2::fgIterations</a>    = 3;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="classTSpectrum2.html#a5b5107643564867a924e5388f4cd8130">TSpectrum2::fgAverageWindow</a> = 3;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<a class="code" href="Rtypes_8h.html#a3f9bf160bbbb44209e95556960836b96">ClassImp</a>(<a class="code" href="classTSpectrum2.html">TSpectrum2</a>);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">/// Constructor.</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#a664df05d3a534db570945a456cec7631">   57</a></span>&#160;<a class="code" href="classTSpectrum2.html#a664df05d3a534db570945a456cec7631">TSpectrum2::TSpectrum2</a>() :<a class="code" href="classTNamed.html">TNamed</a>(<span class="stringliteral">&quot;Spectrum&quot;</span>, <span class="stringliteral">&quot;Miroslav Morhac peak finder&quot;</span>)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;{</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a> = 100;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <a class="code" href="classTSpectrum2.html#a5c77428b1f25e112fd92e45acce75a50">fMaxPeaks</a>   = <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   <a class="code" href="classTSpectrum2.html#ad6f0d7a16e7e438a95c71cad90a687a0">fPosition</a>   = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>];</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <a class="code" href="classTSpectrum2.html#af6e702f37eeaf5dc28635f14e116c7fc">fPositionX</a>  = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>];</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <a class="code" href="classTSpectrum2.html#ab8d21e037700a3f5fe361afd2ab6e017">fPositionY</a>  = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>];</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <a class="code" href="classTSpectrum2.html#a1fb2ff06a926a65493ab5d25a221d76e">fResolution</a> = 1;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   <a class="code" href="classTSpectrum2.html#a2417ca04282b789c493e70411599f1b2">fHistogram</a>  = 0;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   <a class="code" href="classTSpectrum2.html#a7ef661c22ea3da07a243bac6589dc3b6">fNPeaks</a>     = 0;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">///  - maxpositions:  maximum number of peaks</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">///  - resolution:    *NOT USED* determines resolution of the neighbouring peaks</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">///                   default value is 1 correspond to 3 sigma distance</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">///                   between peaks. Higher values allow higher resolution</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">///                   (smaller distance between peaks.</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">///                   May be set later through SetResolution.</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#af37ce8e845422095d21114268dbca61b">   77</a></span>&#160;<a class="code" href="classTSpectrum2.html#a664df05d3a534db570945a456cec7631">TSpectrum2::TSpectrum2</a>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> maxpositions, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> resolution) :<a class="code" href="classTNamed.html">TNamed</a>(<span class="stringliteral">&quot;Spectrum&quot;</span>, <span class="stringliteral">&quot;Miroslav Morhac peak finder&quot;</span>)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;{</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a> = maxpositions;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   <a class="code" href="classTSpectrum2.html#a5c77428b1f25e112fd92e45acce75a50">fMaxPeaks</a>  = <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <a class="code" href="classTSpectrum2.html#ad6f0d7a16e7e438a95c71cad90a687a0">fPosition</a>  = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>];</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <a class="code" href="classTSpectrum2.html#af6e702f37eeaf5dc28635f14e116c7fc">fPositionX</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>];</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   <a class="code" href="classTSpectrum2.html#ab8d21e037700a3f5fe361afd2ab6e017">fPositionY</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>];</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   <a class="code" href="classTSpectrum2.html#a2417ca04282b789c493e70411599f1b2">fHistogram</a> = 0;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   <a class="code" href="classTSpectrum2.html#a7ef661c22ea3da07a243bac6589dc3b6">fNPeaks</a>    = 0;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   <a class="code" href="classTSpectrum2.html#a494fd9dcea391dc346e9f2282305f655">SetResolution</a>(resolution);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">/// Destructor.</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#a4b0fb4011855309063563e5137b47b56">   92</a></span>&#160;<a class="code" href="classTSpectrum2.html#a4b0fb4011855309063563e5137b47b56">TSpectrum2::~TSpectrum2</a>()</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;{</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   <span class="keyword">delete</span> [] <a class="code" href="classTSpectrum2.html#ad6f0d7a16e7e438a95c71cad90a687a0">fPosition</a>;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="keyword">delete</span> [] <a class="code" href="classTSpectrum2.html#af6e702f37eeaf5dc28635f14e116c7fc">fPositionX</a>;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="keyword">delete</span> [] <a class="code" href="classTSpectrum2.html#ab8d21e037700a3f5fe361afd2ab6e017">fPositionY</a>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   <span class="keyword">delete</span>    <a class="code" href="classTSpectrum2.html#a2417ca04282b789c493e70411599f1b2">fHistogram</a>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">/// static function: Set average window of searched peaks</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">/// see TSpectrum2::SearchHighRes</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#a8aeffb2b740edafcf007c34c0d80af5a">  104</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTSpectrum2.html#a8aeffb2b740edafcf007c34c0d80af5a">TSpectrum2::SetAverageWindow</a>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> w)</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <a class="code" href="classTSpectrum2.html#a5b5107643564867a924e5388f4cd8130">fgAverageWindow</a> = w;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">/// static function: Set max number of decon iterations in deconvolution operation</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">/// see TSpectrum2::SearchHighRes</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#a286e8ed4a45ec7f986a8ad69348a3663">  113</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTSpectrum2.html#a286e8ed4a45ec7f986a8ad69348a3663">TSpectrum2::SetDeconIterations</a>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;{</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <a class="code" href="classTSpectrum2.html#a2514608f7dbb02b499d0d815ddcd0583">fgIterations</a> = <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">///   This function calculates the background spectrum in the input histogram h.</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">///   The background is returned as a histogram.</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">///   Function parameters:</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">///   - h: input 2-d histogram</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">///   - numberIterations, (default value = 20)</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">///     Increasing numberIterations make the result smoother and lower.</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">///   - option: may contain one of the following options</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">///      - to set the direction parameter</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">///        &quot;BackIncreasingWindow&quot;. By default the direction is BackDecreasingWindow</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">///      - filterOrder-order of clipping filter. Possible values:</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">///            - &quot;BackOrder2&quot; (default)</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">///            - &quot;BackOrder4&quot;</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">///            - &quot;BackOrder6&quot;</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">///            - &quot;BackOrder8&quot;</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">///      - &quot;nosmoothing&quot;- if selected, the background is not smoothed</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">///         By default the background is smoothed.</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">///      - smoothWindow-width of smoothing window. Possible values:</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">///            - &quot;BackSmoothing3&quot; (default)</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">///            - &quot;BackSmoothing5&quot;</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">///            - &quot;BackSmoothing7&quot;</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">///            - &quot;BackSmoothing9&quot;</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">///            - &quot;BackSmoothing11&quot;</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">///            - &quot;BackSmoothing13&quot;</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">///            - &quot;BackSmoothing15&quot;</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">///      - &quot;Compton&quot; if selected the estimation of Compton edge</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">///                  will be included.</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">///      - &quot;same&quot; : if this option is specified, the resulting background</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">///                 histogram is superimposed on the picture in the current pad.</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">///  NOTE that the background is only evaluated in the current range of h.</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">///  ie, if h has a bin range (set via h-&gt;GetXaxis()-&gt;SetRange(binmin,binmax),</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">///  the returned histogram will be created with the same number of bins</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">///  as the input histogram h, but only bins from binmin to binmax will be filled</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">///  with the estimated background.</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#a82cf6ee8aa5a709643564b4b4fa74044">  155</a></span>&#160;<a class="code" href="classTH1.html">TH1</a> *<a class="code" href="classTSpectrum2.html#a82cf6ee8aa5a709643564b4b4fa74044">TSpectrum2::Background</a>(<span class="keyword">const</span> <a class="code" href="classTH1.html">TH1</a> * <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> number_of_iterations,</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                   <a class="code" href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a> * option)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;{</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Background&quot;</span>,<span class="stringliteral">&quot;function not yet implemented: h=%s, iter=%d, option=%sn&quot;</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        , <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>-&gt;GetName(), number_of_iterations, option);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">/// Print the array of positions.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#a897608c225c0d54b8302e6a413f22710">  166</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTSpectrum2.html#a897608c225c0d54b8302e6a413f22710">TSpectrum2::Print</a>(<a class="code" href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a> *)<span class="keyword"> const</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   printf(<span class="stringliteral">&quot;\nNumber of positions = %d\n&quot;</span>,<a class="code" href="classTSpectrum2.html#a7ef661c22ea3da07a243bac6589dc3b6">fNPeaks</a>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i=0;i&lt;<a class="code" href="classTSpectrum2.html#a7ef661c22ea3da07a243bac6589dc3b6">fNPeaks</a>;i++) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      printf(<span class="stringliteral">&quot; x[%d] = %g, y[%d] = %g\n&quot;</span>,i,<a class="code" href="classTSpectrum2.html#af6e702f37eeaf5dc28635f14e116c7fc">fPositionX</a>[i],i,<a class="code" href="classTSpectrum2.html#ab8d21e037700a3f5fe361afd2ab6e017">fPositionY</a>[i]);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">///   This function searches for peaks in source spectrum in hin</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">///   The number of found peaks and their positions are written into</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">///   the members fNpeaks and fPositionX.</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">///   The search is performed in the current histogram range.</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">///   Function parameters:</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">///  - hin:       pointer to the histogram of source spectrum</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">///  - sigma:   sigma of searched peaks, for details we refer to manual</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">///  - threshold: (default=0.05)  peaks with amplitude less than</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">///    threshold*highest_peak are discarded.  0&lt;threshold&lt;1</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">///   By default, the background is removed before deconvolution.</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">///   Specify the option &quot;nobackground&quot; to not remove the background.</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">///   By default the &quot;Markov&quot; chain algorithm is used.</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">///   Specify the option &quot;noMarkov&quot; to disable this algorithm</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">///   Note that by default the source spectrum is replaced by a new spectrum</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">///   By default a polymarker object is created and added to the list of</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">///   functions of the histogram. The histogram is drawn with the specified</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">///   option and the polymarker object drawn on top of the histogram.</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">///   The polymarker coordinates correspond to the npeaks peaks found in</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">///   the histogram.</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">///   A pointer to the polymarker object can be retrieved later via:</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">/// ~~~ {.cpp}</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">///    TList *functions = hin-&gt;GetListOfFunctions();</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">///    TPolyMarker *pm = (TPolyMarker*)functions-&gt;FindObject(&quot;TPolyMarker&quot;)</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">/// ~~~</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">///   Specify the option &quot;goff&quot; to disable the storage and drawing of the</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">///   polymarker.</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#a9f0138439417cb5b478dd3b85c7266a3">  206</a></span>&#160;<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="classTSpectrum2.html#a9f0138439417cb5b478dd3b85c7266a3">TSpectrum2::Search</a>(<span class="keyword">const</span> <a class="code" href="classTH1.html">TH1</a> * hin, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a>,</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                             <a class="code" href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a> * option, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> threshold)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;{</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   <span class="keywordflow">if</span> (hin == 0)</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> dimension = hin-&gt;<a class="code" href="classTH1.html#a48abf2a23357ba4c1c4e152686a711d4">GetDimension</a>();</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   <span class="keywordflow">if</span> (dimension != 2) {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Search&quot;</span>, <span class="stringliteral">&quot;Must be a 2-d histogram&quot;</span>);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <a class="code" href="classTString.html">TString</a> opt = option;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   opt.<a class="code" href="classTString.html#a1be9e2a41facebeac4feddd9801a0034">ToLower</a>();</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> background = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;nobackground&quot;</span>)) {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      background = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      opt.<a class="code" href="classTString.html#a5072f18275913ec22cfa6f7c0c70c557">ReplaceAll</a>(<span class="stringliteral">&quot;nobackground&quot;</span>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> markov = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;nomarkov&quot;</span>)) {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      markov = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      opt.<a class="code" href="classTString.html#a5072f18275913ec22cfa6f7c0c70c557">ReplaceAll</a>(<span class="stringliteral">&quot;nomarkov&quot;</span>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> sizex = hin-&gt;<a class="code" href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">GetXaxis</a>()-&gt;<a class="code" href="classTAxis.html#ac6efeb83d609a187a332a6217442665c">GetNbins</a>();</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> sizey = hin-&gt;<a class="code" href="classTH1.html#a5cadfed83a4db70b4eae6b0a1cea3532">GetYaxis</a>()-&gt;<a class="code" href="classTAxis.html#ac6efeb83d609a187a332a6217442665c">GetNbins</a>();</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i, j, binx,biny, npeaks;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> ** source = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>*[sizex];</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> ** <a class="code" href="triangle_8c.html#aa22f343c7ac709eab3fdd162721759a1">dest</a>   = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>*[sizex];</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; sizex; i++) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      source[i] = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[sizey];</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <a class="code" href="triangle_8c.html#aa22f343c7ac709eab3fdd162721759a1">dest</a>[i]   = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[sizey];</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; sizey; j++) {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;         source[i][j] = hin-&gt;<a class="code" href="classTH1.html#ac70dcb4082bd510f5aa3e6efeb043f39">GetBinContent</a>(i + 1, j + 1);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   <span class="comment">//npeaks = SearchHighRes(source, dest, sizex, sizey, sigma, 100*threshold, kTRUE, 3, kTRUE, 10);</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   <span class="comment">//the smoothing option is used for 1-d but not for 2-d histograms</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   npeaks = <a class="code" href="classTSpectrum2.html#a6a346c29d38ca4afc72fa9c551d3cef3">SearchHighRes</a>(source, <a class="code" href="triangle_8c.html#aa22f343c7ac709eab3fdd162721759a1">dest</a>, sizex, sizey, <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a>, 100*threshold,  background, <a class="code" href="classTSpectrum2.html#a2514608f7dbb02b499d0d815ddcd0583">fgIterations</a>, markov, <a class="code" href="classTSpectrum2.html#a5b5107643564867a924e5388f4cd8130">fgAverageWindow</a>);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <span class="comment">//The logic in the loop should be improved to use the fact</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   <span class="comment">//that fPositionX,Y give a precise position inside a bin.</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   <span class="comment">//The current algorithm takes the center of the bin only.</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; npeaks; i++) {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      binx = 1 + <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>(<a class="code" href="classTSpectrum2.html#af6e702f37eeaf5dc28635f14e116c7fc">fPositionX</a>[i] + 0.5);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      biny = 1 + <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>(<a class="code" href="classTSpectrum2.html#ab8d21e037700a3f5fe361afd2ab6e017">fPositionY</a>[i] + 0.5);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <a class="code" href="classTSpectrum2.html#af6e702f37eeaf5dc28635f14e116c7fc">fPositionX</a>[i] = hin-&gt;<a class="code" href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">GetXaxis</a>()-&gt;<a class="code" href="classTAxis.html#a299bed7dfb2452a7cc026e16f249f25c">GetBinCenter</a>(binx);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <a class="code" href="classTSpectrum2.html#ab8d21e037700a3f5fe361afd2ab6e017">fPositionY</a>[i] = hin-&gt;<a class="code" href="classTH1.html#a5cadfed83a4db70b4eae6b0a1cea3532">GetYaxis</a>()-&gt;<a class="code" href="classTAxis.html#a299bed7dfb2452a7cc026e16f249f25c">GetBinCenter</a>(biny);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; sizex; i++) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keyword">delete</span> [] source[i];</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keyword">delete</span> [] <a class="code" href="triangle_8c.html#aa22f343c7ac709eab3fdd162721759a1">dest</a>[i];</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   <span class="keyword">delete</span> [] source;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   <span class="keyword">delete</span> [] <a class="code" href="triangle_8c.html#aa22f343c7ac709eab3fdd162721759a1">dest</a>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;goff&quot;</span>))</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordflow">return</span> npeaks;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   <span class="keywordflow">if</span> (!npeaks) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   <a class="code" href="classTPolyMarker.html">TPolyMarker</a> * pm = (<a class="code" href="classTPolyMarker.html">TPolyMarker</a>*)hin-&gt;<a class="code" href="classTH1.html#a4f38ff3c9c675313fc647d32c87ea07a">GetListOfFunctions</a>()-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<span class="stringliteral">&quot;TPolyMarker&quot;</span>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <span class="keywordflow">if</span> (pm) {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      hin-&gt;<a class="code" href="classTH1.html#a4f38ff3c9c675313fc647d32c87ea07a">GetListOfFunctions</a>()-&gt;<a class="code" href="classTList.html#a3026e979d86376d2f362044d5a94c71b">Remove</a>(pm);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keyword">delete</span> pm;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   }</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   pm = <span class="keyword">new</span> <a class="code" href="classTPolyMarker.html">TPolyMarker</a>(npeaks, <a class="code" href="classTSpectrum2.html#af6e702f37eeaf5dc28635f14e116c7fc">fPositionX</a>, <a class="code" href="classTSpectrum2.html#ab8d21e037700a3f5fe361afd2ab6e017">fPositionY</a>);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   hin-&gt;<a class="code" href="classTH1.html#a4f38ff3c9c675313fc647d32c87ea07a">GetListOfFunctions</a>()-&gt;<a class="code" href="classTList.html#a1b90ccfbde1729266b585194fa45df14">Add</a>(pm);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   pm-&gt;<a class="code" href="classTAttMarker.html#a697e1a65975ff344c9dca7618fd44de4">SetMarkerStyle</a>(23);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   pm-&gt;<a class="code" href="classTAttMarker.html#a27f1eae16a3f990024e8a401ed034fa3">SetMarkerColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a5a655b1a02e5b0311571ca57ce4f3900">kRed</a>);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   pm-&gt;<a class="code" href="classTAttMarker.html#a95522acfc3fa6157f317f9993edfa047">SetMarkerSize</a>(1.3);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   ((<a class="code" href="classTH1.html">TH1</a>*)hin)-&gt;Draw(option);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   <span class="keywordflow">return</span> npeaks;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">/// *NOT USED*</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">///  resolution: determines resolution of the neighboring peaks</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">///              default value is 1 correspond to 3 sigma distance</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">///              between peaks. Higher values allow higher resolution</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">///              (smaller distance between peaks.</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">///              May be set later through SetResolution.</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#a494fd9dcea391dc346e9f2282305f655">  287</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTSpectrum2.html#a494fd9dcea391dc346e9f2282305f655">TSpectrum2::SetResolution</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> resolution)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;{</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   <span class="keywordflow">if</span> (resolution &gt; 1)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <a class="code" href="classTSpectrum2.html#a1fb2ff06a926a65493ab5d25a221d76e">fResolution</a> = resolution;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <a class="code" href="classTSpectrum2.html#a1fb2ff06a926a65493ab5d25a221d76e">fResolution</a> = 1;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">///   This function calculates background spectrum from source spectrum.</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">///   The result is placed to the array pointed by spectrum pointer.</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">///   Function parameters:</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">///  - spectrum-pointer to the array of source spectrum</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">///  - ssizex-x length of spectrum</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">///  - ssizey-y length of spectrum</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">///  - numberIterationsX-maximal x width of clipping window</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">///  - numberIterationsY-maximal y width of clipping window</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">///                           for details we refer to manual</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">///  - direction- direction of change of clipping window</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">///               - possible values=kBackIncreasingWindow</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">///                                 kBackDecreasingWindow</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">///  - filterType-determines the algorithm of the filtering</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">///               - possible values=kBackSuccessiveFiltering</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">///                                 kBackOneStepFiltering</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">/// ### Background estimation</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">/// Goal: Separation of useful information (peaks) from useless information (background)</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">///  - method is based on Sensitive Nonlinear Iterative Peak (SNIP) clipping algorithm [1]</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">///  - there exist two algorithms for the estimation of new value in the channel \f$ i_1,i_2\f$</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">/// Algorithm based on Successive Comparisons:</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">/// It is an extension of one-dimensional SNIP algorithm to another dimension. For</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">/// details we refer to [2].</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">/// Algorithm based on One Step Filtering:</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">/// New value in the estimated channel is calculated as:</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">/// \f[ a = \nu_{p-1}(i_1,i_2)\f]</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">/// \f[</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">/// b = \frac{\nu_{p-1}(i_1-p,i_2-p) - 2\nu_{p-1}(i_1-p,i_2) + \nu_{p-1}(i_1-p,i_2+p) - 2\nu_{p-1}(i_1,i_2-p)}{4} +</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">/// \f]</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">/// \f[</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">/// \frac{-2\nu_{p-1}(i_1,i_2+p) + \nu_{p-1}(i_1+p,i_2-p) - 2\nu_{p-1}(i_1+p,i_2) + \nu_{p-1}(i_1+p,i_2+p)}{4}</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">/// \f]</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">/// \f[ \nu_{p-1}(i_1,i_2) = min(a,b)\f]</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">/// where p = 1, 2, ..., number_of_iterations.</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">/// #### References:</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">/// [1] C. G Ryan et al.: SNIP, a statistics-sensitive background treatment for the</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">/// quantitative analysis of PIXE spectra in geoscience applications. NIM, B34 (1988), 396-402.</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">/// [2] M. Morhac;, J. Kliman, V.</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">/// Matouoek, M. Veselsky, I. Turzo.:</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">/// Background elimination methods for multidimensional gamma-ray spectra. NIM,</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">/// A401 (1997) 113-132.</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">/// ### Example 1 - script Back_gamma64.c</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">/// \image html TSpectrum2_Background1.jpg Fig. 1 Original two-dimensional gamma-gamma-ray spectrum</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">/// \image html TSpectrum2_Background2.jpg Fig. 2 Background estimated from data from Fig. 1 using decreasing clipping window with widths 4, 4 and algorithm based on successive comparisons. The estimate includes not only continuously changing background but also one-dimensional ridges.</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">/// \image html TSpectrum2_Background3.jpg Fig. 3 Resulting peaks after subtraction of the estimated background (Fig. 2) from original two-dimensional gamma-gamma-ray spectrum (Fig. 1).</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">/// #### Script:</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">/// Example to illustrate the background estimator (class TSpectrum). To execute this example, do:</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">/// `root &gt; .x Back_gamma64.C`</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">/// ~~~ {.cpp}</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">///   #include &lt;TSpectrum&gt;</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">///   void Back_gamma64() {</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">///      Int_t i, j;</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">///      Double_t nbinsx = 64;</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">///      Double_t nbinsy = 64;</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">///      Double_t xmin = 0;</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">///      Double_t xmax = (Double_t)nbinsx;</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">///      Double_t ymin = 0;</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">///      Double_t ymax = (Double_t)nbinsy;</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">///      Double_t ** source = new Double_t*[nbinsx];</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">///         source[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">///      TH2F *back = new TH2F(&quot;back&quot;,&quot;Background estimation&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">///      TFile *f = new TFile(&quot;spectra2/TSpectrum2.root&quot;);</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">///      back=(TH2F*) f-&gt;Get(&quot;back1;1&quot;);</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">///      TCanvas *Background = new TCanvas(&quot;Background&quot;,&quot;Estimation of background with increasing window&quot;,10,10,1000,700);</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">///      TSpectrum *s = new TSpectrum();</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">///            source[i][j] = back-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">///      s-&gt;Background(source,nbinsx,nbinsy,4,4,kBackDecreasingWindow,kBackSuccessiveFiltering);</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++)</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">///            back-&gt;SetBinContent(i + 1,j + 1, source[i][j]);</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">///      back-&gt;Draw(&quot;SURF&quot;);</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">///   }</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">/// ~~~</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">/// ### Example 2- script Back_gamma256.c</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">/// \image html TSpectrum2_Background4.jpg Fig. 4 Original two-dimensional gamma-gamma-ray spectrum 256x256 channels</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">/// \image html TSpectrum2_Background5.jpg Fig. 5 Peaks after subtraction of the estimated background (increasing clipping window with widths 8, 8 and algorithm based on successive comparisons) from original two-dimensional gamma-gamma-ray spectrum (Fig. 4).</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">/// #### Script:</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"></span><span class="comment">// Example to illustrate the background estimator (class TSpectrum).</span><span class="comment"></span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">/// To execute this example, do</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">/// `root &gt; .x Back_gamma256.C`</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">/// ~~~ {.cpp}</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">///   #include &lt;TSpectrum&gt;</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">///   void Back_gamma256() {</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">///      Int_t i, j;</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">///      Double_t nbinsx = 64;</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">///      Double_t nbinsy = 64;</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">///      Double_t xmin = 0;</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">///      Double_t xmax = (Double_t)nbinsx;</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">///      Double_t ymin = 0;</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">///      Double_t ymax = (Double_t)nbinsy;</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">///      Double_t** source = new Double_t*[nbinsx];</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">///         source[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">///      TH2F *back = new TH2F(&quot;back&quot;,&quot;Background estimation&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">///      TFile *f = new TFile(&quot;spectra2/TSpectrum2.root&quot;);</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">///      back=(TH2F*) f-&gt;Get(&quot;back2;1&quot;);</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">///      TCanvas *Background = new TCanvas(&quot;Background&quot;,&quot;Estimation of background with increasing window&quot;,10,10,1000,700);</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">///      TSpectrum *s = new TSpectrum();</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">///            source[i][j] = back-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">///      s-&gt;Background(source,nbinsx,nbinsy,8,8,kBackIncreasingWindow,kBackSuccessiveFiltering);</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++)</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">///            back-&gt;SetBinContent(i + 1,j + 1, source[i][j]);</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">///      back-&gt;Draw(&quot;SURF&quot;);</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">///   }</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">/// ~~~</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">/// Example 3- script Back_synt256.c</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">/// \image html TSpectrum2_Background6.jpg Fig. 6 Original two-dimensional synthetic spectrum 256x256 channels</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">/// \image html TSpectrum2_Background7.jpg Fig. 7 Peaks after subtraction of the estimated background (increasing clipping window with widths 8, 8 and algorithm based on successive comparisons) from original two-dimensional gamma-gamma-ray spectrum (Fig. 6). One can observe artefacts (ridges) around the peaks due to the employed algorithm.</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">/// \image html TSpectrum2_Background8.jpg Fig. 8 Peaks after subtraction of the estimated background (increasing clipping window with widths 8, 8 and algorithm based on one step filtering) from original two-dimensional gamma-gamma-ray spectrum (Fig. 6). The artefacts from the above given Fig. 7 disappeared.</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">/// #### Script:</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">/// Example to illustrate the background estimator (class TSpectrum).</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">/// To execute this example, do</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">/// `root &gt; .x Back_synt256.C`</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">/// ~~~ {.cpp}</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">///   #include &lt;TSpectrum&gt;</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">///   void Back_synt256() {</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">///      Int_t i, j;</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">///      Double_t nbinsx = 64;</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">///      Double_t nbinsy = 64;</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">///      Double_t xmin = 0;</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">///      Double_t xmax = (Double_t)nbinsx;</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">///      Double_t ymin = 0;</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">///      Double_t ymax = (Double_t)nbinsy;</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">///      Double_t** source = new Double_t*[nbinsx];</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">///         source[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">///      TH2F *back = new TH2F(&quot;back&quot;,&quot;Background estimation&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">///      TFile *f = new TFile(&quot;spectra2/TSpectrum2.root&quot;);</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">///      back=(TH2F*) f-&gt;Get(&quot;back3;1&quot;);</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">///      TCanvas *Background = new TCanvas(&quot;Background&quot;,&quot;Estimation of background with increasing window&quot;,10,10,1000,700);</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">///      TSpectrum *s = new TSpectrum();</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">///            source[i][j] = back-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">///      s-&gt;Background(source,nbinsx,nbinsy,8,8,</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">///                    kBackIncreasingWindow,kBackSuccessiveFiltering);//kBackOneStepFiltering</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++)</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">///            back-&gt;SetBinContent(i + 1,j + 1, source[i][j]);</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">///      back-&gt;Draw(&quot;SURF&quot;);</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">///   }</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">/// ~~~</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#a816a5c39b058426a064cc118aa78eaee">  483</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classTSpectrum2.html#a82cf6ee8aa5a709643564b4b4fa74044">TSpectrum2::Background</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> **spectrum,</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                       <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> ssizex, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> ssizey,</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                       <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> numberIterationsX,</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                       <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> numberIterationsY,</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                       <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> direction,</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                       <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> filterType)</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;{</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i, <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>, sampling, r1, r2;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>, <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, p1, p2, p3, p4, <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a>, s2, s3, s4;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   <span class="keywordflow">if</span> (ssizex &lt;= 0 || ssizey &lt;= 0)</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Wrong parameters&quot;</span>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   <span class="keywordflow">if</span> (numberIterationsX &lt; 1 || numberIterationsY &lt; 1)</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Width of Clipping Window Must Be Positive&quot;</span>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <span class="keywordflow">if</span> (ssizex &lt; 2 * numberIterationsX + 1</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        || ssizey &lt; 2 * numberIterationsY + 1)</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordflow">return</span> (<span class="stringliteral">&quot;Too Large Clipping Window&quot;</span>);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> **working_space = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>*[ssizex];</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; ssizex; i++)</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      working_space[i] = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[ssizey];</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   sampling =</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;       (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) <a class="code" href="namespaceTMath.html#a38e1c23e08564d17051526d7e0a5364d">TMath::Max</a>(numberIterationsX, numberIterationsY);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   <span class="keywordflow">if</span> (direction == <a class="code" href="classTSpectrum2.html#afe35204b93276053410315d3c68bc2e5ad124dffd2aadc9ddbcf3b085dddd2e9c">kBackIncreasingWindow</a>) {</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keywordflow">if</span> (filterType == <a class="code" href="classTSpectrum2.html#afe35204b93276053410315d3c68bc2e5a7a9d8b0e7a3b58026f2067ca7545fb3a">kBackSuccessiveFiltering</a>) {</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;         <span class="keywordflow">for</span> (i = 1; i &lt;= sampling; i++) {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            r1 = (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) <a class="code" href="namespaceTMath.html#aaae88f888b116f98b932ba4543fa00b5">TMath::Min</a>(i, numberIterationsX), r2 =</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) <a class="code" href="namespaceTMath.html#aaae88f888b116f98b932ba4543fa00b5">TMath::Min</a>(i, numberIterationsY);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> = r2; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> &lt; ssizey - r2; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>++) {</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;               <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = r1; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> &lt; ssizex - r1; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>++) {</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>];</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                  p1 = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> - r2];</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                  p2 = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + r2];</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                  p3 = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> - r2];</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                  p4 = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + r2];</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                  <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> - r2];</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                  s2 = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>];</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                  s3 = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>];</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                  s4 = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + r2];</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                  <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (p1 + p2) / 2.0;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; s2)</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                     s2 = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                  <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (p1 + p3) / 2.0;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a>)</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                     <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                  <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (p2 + p4) / 2.0;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; s4)</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                     s4 = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                  <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (p3 + p4) / 2.0;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; s3)</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                     s3 = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                  <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> = <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> - (p1 + p3) / 2.0;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                  s2 = s2 - (p1 + p2) / 2.0;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                  s3 = s3 - (p3 + p4) / 2.0;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                  s4 = s4 - (p2 + p4) / 2.0;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                  <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (<a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> + s4) / 2.0 + (s2 + s3) / 2.0 + (p1 + p2 +</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                                            p3 +</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                                            p4) / 4.0;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                  <span class="keywordflow">if</span> (b &lt; a &amp;&amp; b &gt; 0)</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                     <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                  working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>] = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;               }</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> = r2; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> &lt; ssizey - r2; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>++) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;               <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = r1; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> &lt; ssizex - r1; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>++) {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                  spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>] = working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>];</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;               }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            }</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;         }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (filterType == <a class="code" href="classTSpectrum2.html#afe35204b93276053410315d3c68bc2e5a8e8791437ea655d06862c4392dfb7f79">kBackOneStepFiltering</a>) {</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;         <span class="keywordflow">for</span> (i = 1; i &lt;= sampling; i++) {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            r1 = (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) <a class="code" href="namespaceTMath.html#aaae88f888b116f98b932ba4543fa00b5">TMath::Min</a>(i, numberIterationsX), r2 =</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) <a class="code" href="namespaceTMath.html#aaae88f888b116f98b932ba4543fa00b5">TMath::Min</a>(i, numberIterationsY);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> = r2; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> &lt; ssizey - r2; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>++) {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;               <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = r1; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> &lt; ssizex - r1; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>++) {</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>];</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                  <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = -(spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> - r2] +</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                         spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + r2] + spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> -</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                                                                     r2]</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                         + spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + r2]) / 4 +</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                      (spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> - r2] + spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>] +</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                       spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>] + spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + r2]) / 2;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                  <span class="keywordflow">if</span> (b &lt; a &amp;&amp; b &gt; 0)</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                     <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                  working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>] = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;               }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> = i; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> &lt; ssizey - i; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>++) {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;               <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = i; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> &lt; ssizex - i; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>++) {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                  spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>] = working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>];</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;               }</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;         }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      }</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (direction == <a class="code" href="classTSpectrum2.html#afe35204b93276053410315d3c68bc2e5acf4f81f5ef18487c5873ef4384dcfdaa">kBackDecreasingWindow</a>) {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="keywordflow">if</span> (filterType == <a class="code" href="classTSpectrum2.html#afe35204b93276053410315d3c68bc2e5a7a9d8b0e7a3b58026f2067ca7545fb3a">kBackSuccessiveFiltering</a>) {</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;         <span class="keywordflow">for</span> (i = sampling; i &gt;= 1; i--) {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            r1 = (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) <a class="code" href="namespaceTMath.html#aaae88f888b116f98b932ba4543fa00b5">TMath::Min</a>(i, numberIterationsX), r2 =</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) <a class="code" href="namespaceTMath.html#aaae88f888b116f98b932ba4543fa00b5">TMath::Min</a>(i, numberIterationsY);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> = r2; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> &lt; ssizey - r2; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>++) {</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;               <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = r1; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> &lt; ssizex - r1; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>++) {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>];</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                  p1 = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> - r2];</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                  p2 = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + r2];</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                  p3 = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> - r2];</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                  p4 = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + r2];</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                  <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> - r2];</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                  s2 = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>];</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                  s3 = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>];</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                  s4 = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + r2];</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                  <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (p1 + p2) / 2.0;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; s2)</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                     s2 = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                  <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (p1 + p3) / 2.0;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a>)</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                     <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                  <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (p2 + p4) / 2.0;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; s4)</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                     s4 = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                  <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (p3 + p4) / 2.0;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; s3)</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                     s3 = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                  <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> = <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> - (p1 + p3) / 2.0;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                  s2 = s2 - (p1 + p2) / 2.0;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                  s3 = s3 - (p3 + p4) / 2.0;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                  s4 = s4 - (p2 + p4) / 2.0;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                  <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (<a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> + s4) / 2.0 + (s2 + s3) / 2.0 + (p1 + p2 +</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                                            p3 +</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                                            p4) / 4.0;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                  <span class="keywordflow">if</span> (b &lt; a &amp;&amp; b &gt; 0)</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                     <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                  working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>] = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;               }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> = r2; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> &lt; ssizey - r2; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>++) {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;               <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = r1; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> &lt; ssizex - r1; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>++) {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                  spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>] = working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>];</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;               }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;         }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (filterType == <a class="code" href="classTSpectrum2.html#afe35204b93276053410315d3c68bc2e5a8e8791437ea655d06862c4392dfb7f79">kBackOneStepFiltering</a>) {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;         <span class="keywordflow">for</span> (i = sampling; i &gt;= 1; i--) {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            r1 = (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) <a class="code" href="namespaceTMath.html#aaae88f888b116f98b932ba4543fa00b5">TMath::Min</a>(i, numberIterationsX), r2 =</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) <a class="code" href="namespaceTMath.html#aaae88f888b116f98b932ba4543fa00b5">TMath::Min</a>(i, numberIterationsY);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> = r2; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> &lt; ssizey - r2; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>++) {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;               <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = r1; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> &lt; ssizex - r1; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>++) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>];</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                  <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = -(spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> - r2] +</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                         spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + r2] + spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> -</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                                                     r2]</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                         + spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + r2]) / 4 +</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                      (spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> - r2] + spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>] +</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                       spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + r1][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>] + spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + r2]) / 2;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                  <span class="keywordflow">if</span> (b &lt; a &amp;&amp; b &gt; 0)</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                     <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                  working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>] = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;               }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> = i; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> &lt; ssizey - i; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>++) {</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;               <span class="keywordflow">for</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = i; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> &lt; ssizex - i; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>++) {</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                  spectrum[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>] = working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>];</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;               }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;         }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;   }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; ssizex; i++)</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="keyword">delete</span>[]working_space[i];</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   <span class="keyword">delete</span>[]working_space;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;}</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">/// This function calculates smoothed spectrum from source spectrum</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">/// based on Markov chain method.</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">/// The result is placed in the array pointed by source pointer.</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">/// Function parameters:</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">///  - source-pointer to the array of source spectrum</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">///  - ssizex-x length of source</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">///  - ssizey-y length of source</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">///  - averWindow-width of averaging smoothing window</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">/// ### Smoothing</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">/// Goal: Suppression of statistical fluctuations the algorithm is based on discrete</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">/// Markov chain, which has very simple invariant distribution</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">/// \f[</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">/// U_2 = \frac{p_{1.2}}{p_{2,1}}U_1, U_3 = \frac{p_{2,3}}{p_{3,2}}U_2 U_1, ... , U_n = \frac{p_{n-1,n}}{p_{n,n-1}}U_{n-1} ... U_2 U_1</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">/// \f]</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">/// \f$U_1\f$ being defined from the normalization condition \f$ \sum_{i=1}^{n} U_i = 1\f$</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">/// n is the length of the smoothed spectrum and</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">/// \f[</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">/// p_{i,i\pm1} = A_i \sum_{k=1}^{m} exp\left[\frac{y(i\pm k)-y(i)}{y(i\pm k)+y(i)}\right]</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">/// \f]</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">/// is the probability of the change of the peak position from channel i to the channel i+1.</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">/// \f$A_i\f$ is the normalization constant so that\f$ p_{i,i-1}+p_{i,i+1}=1\f$ and m is a width</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">/// of smoothing window. We have extended this algorithm to two dimensions.</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">/// #### Reference:</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">/// [1] Z.K. Silagadze, A new algorithm for automatic photopeak searches. NIM A 376 (1996), 451.</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">/// ### Example 4 - script Smooth.c</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">/// \image html TSpectrum2_Smoothing1.jpg Fig. 9 Original noisy spectrum.</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">/// \image html TSpectrum2_Smoothing2.jpg Fig. 10 Smoothed spectrum m=3 Peaks can hardly be observed. Peaks become apparent.</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">/// \image html TSpectrum2_Smoothing3.jpg Fig. 11 Smoothed spectrum m=5</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">/// \image html TSpectrum2_Smoothing4.jpg Fig.12 Smoothed spectrum m=7</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">/// #### Script:</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">/// Example to illustrate the Markov smoothing (class TSpectrum).</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">/// To execute this example, do</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">/// `root &gt; .x Smooth.C`</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">/// ~~~ {.cpp}</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">///   #include &lt;TSpectrum&gt;</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">///   void Smooth() {</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">///      Int_t i, j;</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">///      Double_t nbinsx = 256;</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">///      Double_t nbinsy = 256;</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">///      Double_t xmin = 0;</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">///      Double_t xmax = (Double_t)nbinsx;</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">///      Double_t ymin = 0;</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">///      Double_t ymax = (Double_t)nbinsy;</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">///      Double_t** source = new Double_t*[nbinsx];</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">///         source[i] = new Double_t[nbinsy];</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">///      TH2F *smooth = new TH2F(&quot;smooth&quot;,&quot;Background estimation&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">///      TFile *f = new TFile(&quot;spectra2/TSpectrum2.root&quot;);</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">///      smooth=(TH2F*) f-&gt;Get(&quot;smooth1;1&quot;);</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">///      TCanvas *Smoothing = new TCanvas(&quot;Smoothing&quot;,&quot;Markov smoothing&quot;,10,10,1000,700);</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">///      TSpectrum *s = new TSpectrum();</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">///            source[i][j] = smooth-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">///      s-&gt;SmoothMarkov(source,nbinsx,nbinsx,3); //5,7</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++)</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">///            smooth-&gt;SetBinContent(i + 1,j + 1, source[i][j]);</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">///      smooth-&gt;Draw(&quot;SURF&quot;);</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">///   }</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">/// ~~~</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00736"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#a482a7f144b9cc1b0405d0ac0d8cc9bbb">  736</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classTSpectrum2.html#a482a7f144b9cc1b0405d0ac0d8cc9bbb">TSpectrum2::SmoothMarkov</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> **source, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> ssizex, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> ssizey, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> averWindow)</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;{</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>, <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>, <a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>, <a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a>, i, j, <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>, <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, maxch;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> nom, nip, nim, sp, sm, spx, spy, smx, smy, plocha = 0;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;   <span class="keywordflow">if</span>(averWindow &lt;= 0)</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Averaging Window must be positive&quot;</span>;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> **working_space = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>*[ssizex];</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   <span class="keywordflow">for</span>(i = 0; i &lt; ssizex; i++)</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      working_space[i] = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[ssizey];</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;   <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a> = 0;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;   <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a> = ssizex - 1;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;   <a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a> = 0;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;   <a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a> = ssizey - 1;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;   <span class="keywordflow">for</span>(i = 0, maxch = 0; i &lt; ssizex; i++){</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <span class="keywordflow">for</span>(j = 0; j &lt; ssizey; j++){</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;         working_space[i][j] = 0;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;         <span class="keywordflow">if</span>(maxch &lt; source[i][j])</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            maxch = source[i][j];</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;         plocha += source[i][j];</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      }</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;   }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   <span class="keywordflow">if</span>(maxch == 0) {</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <span class="keyword">delete</span> [] working_space;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;   }</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;   nom = 0;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   working_space[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>] = 1;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;   <span class="keywordflow">for</span>(i = <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>; i &lt; <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>; i++){</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      nip = source[i][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>] / maxch;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      nim = source[i + 1][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>] / maxch;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      sp = 0,sm = 0;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = 1; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &lt;= averWindow; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>++){</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;         <span class="keywordflow">if</span>((i + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>) &gt; <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>)</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[<a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>] / maxch;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[i + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>] / maxch;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;         <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nip;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;         <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip &lt;= 0)</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 1;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip);</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;         <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;         <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;         sp = sp + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;         <span class="keywordflow">if</span>(i - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1 &lt; <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>)</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>] / maxch;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[i - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>] / maxch;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;         <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nim;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;         <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim &lt;= 0)</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 1;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;         <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;         <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;         sm = sm + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      }</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = sp / sm;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[i + 1][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>] = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> * working_space[i][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>];</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      nom = nom + <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;   }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   <span class="keywordflow">for</span>(i = <a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>; i &lt; <a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a>; i++){</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      nip = source[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][i] / maxch;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      nim = source[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][i + 1] / maxch;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      sp = 0,sm = 0;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = 1; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &lt;= averWindow; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>++){</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;         <span class="keywordflow">if</span>((i + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>) &gt; <a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a>)</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][<a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a>] / maxch;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][i + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>] / maxch;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;         <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nip;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;         <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip &lt;= 0)</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 1;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;         <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;         <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;         sp = sp + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;         <span class="keywordflow">if</span>(i - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1 &lt; <a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>)</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>] / maxch;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][i - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1] / maxch;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;         <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nim;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;         <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim &lt;= 0)</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 1;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;         <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;         <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;         sm = sm + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      }</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = sp / sm;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][i + 1] = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> * working_space[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][i];</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      nom = nom + <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   }</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;   <span class="keywordflow">for</span>(i = <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>; i &lt; <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>; i++){</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="keywordflow">for</span>(j = <a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>; j &lt; <a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a>; j++){</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;         nip = source[i][j + 1] / maxch;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;         nim = source[i + 1][j + 1] / maxch;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;         spx = 0,smx = 0;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;         <span class="keywordflow">for</span>(<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = 1; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &lt;= averWindow; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>++){</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <span class="keywordflow">if</span>(i + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &gt; <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>)</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[<a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>][j] / maxch;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[i + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>][j] / maxch;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nip;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip &lt;= 0)</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 1;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            spx = spx + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            <span class="keywordflow">if</span>(i - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1 &lt; <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>)</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][j] / maxch;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[i - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1][j] / maxch;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nim;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim &lt;= 0)</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 1;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            smx = smx + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;         }</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;         spy = 0,smy = 0;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;         nip = source[i + 1][j] / maxch;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;         nim = source[i + 1][j + 1] / maxch;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;         <span class="keywordflow">for</span> (<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = 1; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &lt;= averWindow; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>++) {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            <span class="keywordflow">if</span> (j + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &gt; <a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a>) <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[i][<a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a>]/maxch;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            <span class="keywordflow">else</span>              <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[i][j + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>] / maxch;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nip;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip &lt;= 0) <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 1;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            <span class="keywordflow">else</span>              <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            spy = spy + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            <span class="keywordflow">if</span> (j - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1 &lt; <a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>) <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[i][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>] / maxch;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            <span class="keywordflow">else</span>                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = source[i][j - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1] / maxch;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nim;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim &lt;= 0) <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 1;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="keywordflow">else</span>              <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            smy = smy + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;         }</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;         <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = (spx * working_space[i][j + 1] + spy * working_space[i + 1][j]) / (smx +smy);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;         working_space[i + 1][j + 1] = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;         nom = nom + <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      }</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;   }</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;   <span class="keywordflow">for</span>(i = <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>; i &lt;= <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>; i++){</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="keywordflow">for</span>(j = <a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>; j &lt;= <a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a>; j++){</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;         working_space[i][j] = working_space[i][j] / nom;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      }</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;   }</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;   <span class="keywordflow">for</span>(i = 0;i &lt; ssizex; i++){</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordflow">for</span>(j = 0; j &lt; ssizey; j++){</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;         source[i][j] = plocha * working_space[i][j];</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      }</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;   }</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; ssizex; i++)</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keyword">delete</span>[]working_space[i];</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;   <span class="keyword">delete</span>[]working_space;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;}</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">/// This function calculates deconvolution from source spectrum</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">/// according to response spectrum</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">/// The result is placed in the matrix pointed by source pointer.</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">/// Function parameters:</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">///  - source-pointer to the matrix of source spectrum</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">///  - resp-pointer to the matrix of response spectrum</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">///  - ssizex-x length of source and response spectra</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">///  - ssizey-y length of source and response spectra</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">///  - numberIterations, for details we refer to manual</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">///  - numberRepetitions, for details we refer to manual</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">///  - boost, boosting factor, for details we refer to manual</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">/// ### Deconvolution</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">/// Goal: Improvement of the resolution in spectra, decomposition of multiplets</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">/// Mathematical formulation of the 2-dimensional convolution system is</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">///\f[</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">/// y(i_1,i_2) = \sum_{k_1=0}^{N_1-1} \sum_{k_2=0}^{N_2-1} h(i_1-k_1,i_2-k_2)x(k_1,k_2)</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">///\f]</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">///\f[</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">/// i_1 = 0,1,2, ... ,N_1-1, i_2 = 0,1,2, ... ,N_2-1</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">///\f]</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">/// where h(i,j) is the impulse response function, x, y are input and output</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">/// matrices, respectively, \f$ N_1, N_2\f$ are the lengths of x and h matrices</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">///  - let us assume that we know the response and the output matrices (spectra) of the above given system.</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">///  - the deconvolution represents solution of the overdetermined system of linear equations, i.e., the</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">///    calculation of the matrix x.</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">///  - from numerical stability point of view the operation of deconvolution is</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">///    extremely critical (ill-posed problem) as well as time consuming operation.</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">///  - the Gold deconvolution algorithm proves to work very well even for 2-dimensional</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">///    systems. Generalisation of the algorithm for 2-dimensional systems was presented in [1], [2].</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">///  - for Gold deconvolution algorithm as well as for boosted deconvolution algorithm we refer also to TSpectrum</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">/// #### References:</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">/// [1] M. Morhac;, J. Kliman, V. Matouoek, M. Veselsky, I. Turzo.:</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">/// Efficient one- and two-dimensional Gold deconvolution and its application to</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">/// gamma-ray spectra decomposition. NIM, A401 (1997) 385-408.</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">/// [2] Morhac; M., Matouoek V., Kliman J., Efficient algorithm of multidimensional</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">/// deconvolution and its application to nuclear data processing, Digital Signal</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">/// Processing 13 (2003) 144.</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">/// ### Example 5 - script Decon.c</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">/// response function (usually peak) should be shifted to the beginning of the coordinate system (see Fig. 13)</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">/// \image html TSpectrum2_Deconvolution1.jpg Fig. 13 2-dimensional response spectrum</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">/// \image html TSpectrum2_Deconvolution2.jpg Fig. 14 2-dimensional gamma-gamma-ray input spectrum (before deconvolution)</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">/// \image html TSpectrum2_Deconvolution3.jpg Fig. 15 Spectrum from Fig. 14 after deconvolution (1000 iterations)</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">/// #### Script:</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">/// Example to illustrate the Gold deconvolution (class TSpectrum2).</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">/// To execute this example, do</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">/// `root &gt; .x Decon.C`</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">/// ~~~ {.cpp}</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">///   #include &lt;TSpectrum2&gt;</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">///   void Decon() {</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">///      Int_t i, j;</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">///      Double_t nbinsx = 256;</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">///      Double_t nbinsy = 256;</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">///      Double_t xmin = 0;</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">///      Double_t xmax = (Double_t)nbinsx;</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">///      Double_t ymin = 0;</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">///      Double_t ymax = (Double_t)nbinsy;</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">///      Double_t** source = new Double_t*[nbinsx];</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">///         source[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">///      TH2F *decon = new TH2F(&quot;decon&quot;,&quot;Gold deconvolution&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">///      TFile *f = new TFile(&quot;spectra2/TSpectrum2.root&quot;);</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">///      decon=(TH2F*) f-&gt;Get(&quot;decon1;1&quot;);</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">///      Double_t** response = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">///         response[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">///      TH2F *resp = new TH2F(&quot;resp&quot;,&quot;Response matrix&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">///      resp=(TH2F*) f-&gt;Get(&quot;resp1;1&quot;);</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">///      TCanvas *Deconvol = new TCanvas(&quot;Deconvolution&quot;,&quot;Gold deconvolution&quot;,10,10,1000,700);</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">///      TSpectrum *s = new TSpectrum();</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">///            source[i][j] = decon-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">///            response[i][j] = resp-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">///      s-&gt;Deconvolution(source,response,nbinsx,nbinsy,1000,1,1);</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++)</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">///            decon-&gt;SetBinContent(i + 1,j + 1, source[i][j]);</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">///      decon-&gt;Draw(&quot;SURF&quot;);</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">///   }</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">/// ~~~</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">/// ### Example 6 - script Decon2.c</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">/// \image html TSpectrum2_Deconvolution4.jpg Fig. 16 Response spectrum</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">/// \image html TSpectrum2_Deconvolution5.jpg Fig. 17 Original synthetic input spectrum (before deconvolution). It is composed of 17 peaks. 5 peaks are overlapping in the outlined multiplet and two peaks in doublet.</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">/// \image html TSpectrum2_Deconvolution6.jpg Fig. 18 Spectrum from Fig. 17 after deconvolution (1000 iterations). Resolution is improved but the peaks in multiplet remained unresolved.</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">/// #### Script:</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">/// Example to illustrate the Gold deconvolution (class TSpectrum2).</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">/// To execute this example, do</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">/// `root &gt; .x Decon2.C`</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">/// ~~~ {.cpp}</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">///   #include &lt;TSpectrum2&gt;</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">///   void Decon2() {</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">///      Int_t i, j;</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">///      Double_t nbinsx = 64;</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">///      Double_t nbinsy = 64;</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">///      Double_t xmin = 0;</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">///      Double_t xmax = (Double_t)nbinsx;</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">///      Double_t ymin = 0;</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">///      Double_t ymax = (Double_t)nbinsy;</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">///      Double_t** source = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">///         source[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">///      TH2F *decon = new TH2F(&quot;decon&quot;,&quot;Gold deconvolution&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">///      TFile *f = new TFile(&quot;spectra2/TSpectrum2.root&quot;);</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">///      decon=(TH2F*) f-&gt;Get(&quot;decon2;1&quot;);</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">///      Double_t** response = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">///         response[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">///      TH2F *resp = new TH2F(&quot;resp&quot;,&quot;Response matrix&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">///      resp=(TH2F*) f-&gt;Get(&quot;resp2;1&quot;);</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">///      TCanvas *Deconvol = new TCanvas(&quot;Deconvolution&quot;,&quot;Gold deconvolution&quot;,10,10,1000,700);</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">///      TSpectrum *s = new TSpectrum();</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">///            source[i][j] = decon-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">///            response[i][j] = resp-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">///      s-&gt;Deconvolution(source,response,nbinsx,nbinsy,1000,1,1);</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++)</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">///            decon-&gt;SetBinContent(i + 1,j + 1, source[i][j]);</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">///      decon-&gt;Draw(&quot;SURF&quot;);</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">///   }</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">/// ~~~</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">/// ### Example 7 - script Decon2HR.c</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">/// \image html TSpectrum2_Deconvolution7.jpg Fig. 19 Spectrum from Fig. 17 after boosted deconvolution (50 iterations repeated 20 times, boosting coefficient was 1.2). All the peaks in multiplet as well as in doublet are completely decomposed.</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">/// #### Script:</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">/// Example to illustrate boosted Gold deconvolution (class TSpectrum2).</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">/// To execute this example, do</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">/// `root &gt; .x Decon2HR.C`</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">/// ~~~ {.cpp}</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">///   #include &lt;TSpectrum2&gt;</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">///   void Decon2HR() {</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">///      Int_t i, j;</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">///      Double_t nbinsx = 64;</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">///      Double_t nbinsy = 64;</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">///      Double_t xmin = 0;</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">///      Double_t xmax = (Double_t)nbinsx;</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">///      Double_t ymin = 0;</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">///      Double_t ymax = (Double_t)nbinsy;</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">///      Double_t** source = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">///         source[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">///      TH2F *decon = new TH2F(&quot;decon&quot;,&quot;Boosted Gold deconvolution&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">///      TFile *f = new TFile(&quot;spectra2/TSpectrum2.root&quot;);</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">///      decon=(TH2F*) f-&gt;Get(&quot;decon2;1&quot;);</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">///      Double_t** response = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">///         response[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">///      TH2F *resp = new TH2F(&quot;resp&quot;,&quot;Response matrix&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">///      resp=(TH2F*) f-&gt;Get(&quot;resp2;1&quot;);</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">///      TCanvas *Deconvol = new TCanvas(&quot;Deconvolution&quot;,&quot;Gold deconvolution&quot;,10,10,1000,700);</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">///      TSpectrum *s = new TSpectrum();</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">///            source[i][j] = decon-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">///            response[i][j] = resp-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">///      s-&gt;Deconvolution(source,response,nbinsx,nbinsy,1000,1,1);</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++)</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">///            dec   on-&gt;SetBinContent(i + 1,j + 1, source[i][j]);</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">///      decon-&gt;Draw(&quot;SURF&quot;);</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">///   }</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">/// ~~~</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01134"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#af5814154084ed05e20e1d93293ae0fd0"> 1134</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classTSpectrum2.html#af5814154084ed05e20e1d93293ae0fd0">TSpectrum2::Deconvolution</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> **source, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> **resp,</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                                       <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> ssizex, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> ssizey,</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                       <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> numberIterations,</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                                       <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> numberRepetitions,</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                                       <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="namespaceROOT_1_1Math_1_1VectorUtil.html#a421c8e59ccf765d83def701c1ff8fa76">boost</a>)</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;{</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i, j, lhx, lhy, i1, i2, j1, j2, k1, k2, lindex, i1min, i1max,</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;       i2min, i2max, j1min, j1max, j2min, j2max, positx = 0, posity = 0, repet;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> lda, ldb, ldc, area, maximum = 0;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;   <span class="keywordflow">if</span> (ssizex &lt;= 0 || ssizey &lt;= 0)</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Wrong parameters&quot;</span>;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;   <span class="keywordflow">if</span> (numberIterations &lt;= 0)</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Number of iterations must be positive&quot;</span>;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;   <span class="keywordflow">if</span> (numberRepetitions &lt;= 0)</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Number of repetitions must be positive&quot;</span>;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> **working_space = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *[ssizex];</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; ssizex; i++)</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      working_space[i] = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[5 * ssizey];</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;   area = 0;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;   lhx = -1, lhy = -1;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; ssizex; i++) {</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; ssizey; j++) {</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;         lda = resp[i][j];</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;         <span class="keywordflow">if</span> (lda != 0) {</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            <span class="keywordflow">if</span> ((i + 1) &gt; lhx)</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;               lhx = i + 1;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            <span class="keywordflow">if</span> ((j + 1) &gt; lhy)</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;               lhy = j + 1;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;         }</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;         working_space[i][j] = lda;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;         area = area + lda;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;         <span class="keywordflow">if</span> (lda &gt; maximum) {</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            maximum = lda;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            positx = i, posity = j;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;         }</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      }</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;   }</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;   <span class="keywordflow">if</span> (lhx == -1 || lhy == -1) {</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keyword">delete</span> [] working_space;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="keywordflow">return</span> (<span class="stringliteral">&quot;Zero response data&quot;</span>);</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;   }</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">//calculate ht*y and write into p</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;   <span class="keywordflow">for</span> (i2 = 0; i2 &lt; ssizey; i2++) {</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keywordflow">for</span> (i1 = 0; i1 &lt; ssizex; i1++) {</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;         ldc = 0;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;         <span class="keywordflow">for</span> (j2 = 0; j2 &lt;= (lhy - 1); j2++) {</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            <span class="keywordflow">for</span> (j1 = 0; j1 &lt;= (lhx - 1); j1++) {</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;               k2 = i2 + j2, k1 = i1 + j1;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;               <span class="keywordflow">if</span> (k2 &gt;= 0 &amp;&amp; k2 &lt; ssizey &amp;&amp; k1 &gt;= 0 &amp;&amp; k1 &lt; ssizex) {</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                  lda = working_space[j1][j2];</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                  ldb = source[k1][k2];</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                  ldc = ldc + lda * ldb;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;               }</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            }</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;         }</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;         working_space[i1][i2 + ssizey] = ldc;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;   }</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">//calculate matrix b=ht*h</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;   i1min = -(lhx - 1), i1max = lhx - 1;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;   i2min = -(lhy - 1), i2max = lhy - 1;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;   <span class="keywordflow">for</span> (i2 = i2min; i2 &lt;= i2max; i2++) {</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      <span class="keywordflow">for</span> (i1 = i1min; i1 &lt;= i1max; i1++) {</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;         ldc = 0;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;         j2min = -i2;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;         <span class="keywordflow">if</span> (j2min &lt; 0)</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            j2min = 0;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;         j2max = lhy - 1 - i2;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;         <span class="keywordflow">if</span> (j2max &gt; lhy - 1)</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            j2max = lhy - 1;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;         <span class="keywordflow">for</span> (j2 = j2min; j2 &lt;= j2max; j2++) {</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;            j1min = -i1;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;            <span class="keywordflow">if</span> (j1min &lt; 0)</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;               j1min = 0;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            j1max = lhx - 1 - i1;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;            <span class="keywordflow">if</span> (j1max &gt; lhx - 1)</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;               j1max = lhx - 1;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;            <span class="keywordflow">for</span> (j1 = j1min; j1 &lt;= j1max; j1++) {</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;               lda = working_space[j1][j2];</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;               <span class="keywordflow">if</span> (i1 + j1 &lt; ssizex &amp;&amp; i2 + j2 &lt; ssizey)</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                  ldb = working_space[i1 + j1][i2 + j2];</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                  ldb = 0;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;               ldc = ldc + lda * ldb;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;            }</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;         }</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;         working_space[i1 - i1min][i2 - i2min + 2 * ssizey ] = ldc;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      }</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;   }</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">//initialization in x1 matrix</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;   <span class="keywordflow">for</span> (i2 = 0; i2 &lt; ssizey; i2++) {</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="keywordflow">for</span> (i1 = 0; i1 &lt; ssizex; i1++) {</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;         working_space[i1][i2 + 3 * ssizey] = 1;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;         working_space[i1][i2 + 4 * ssizey] = 0;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      }</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;   }</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;   <span class="comment">//START OF ITERATIONS</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;   <span class="keywordflow">for</span> (repet = 0; repet &lt; numberRepetitions; repet++) {</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      <span class="keywordflow">if</span> (repet != 0) {</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; ssizex; i++) {</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; ssizey; j++) {</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;               working_space[i][j + 3 * ssizey] =</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                   <a class="code" href="namespaceTMath.html#a9f3bcefa095d69086d20e7b76bc9bfc6">TMath::Power</a>(working_space[i][j + 3 * ssizey], <a class="code" href="namespaceROOT_1_1Math_1_1VectorUtil.html#a421c8e59ccf765d83def701c1ff8fa76">boost</a>);</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            }</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;         }</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      }</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <span class="keywordflow">for</span> (lindex = 0; lindex &lt; numberIterations; lindex++) {</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;         <span class="keywordflow">for</span> (i2 = 0; i2 &lt; ssizey; i2++) {</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            <span class="keywordflow">for</span> (i1 = 0; i1 &lt; ssizex; i1++) {</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;               ldb = 0;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;               j2min = i2;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;               <span class="keywordflow">if</span> (j2min &gt; lhy - 1)</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                  j2min = lhy - 1;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;               j2min = -j2min;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;               j2max = ssizey - i2 - 1;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;               <span class="keywordflow">if</span> (j2max &gt; lhy - 1)</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                  j2max = lhy - 1;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;               j1min = i1;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;               <span class="keywordflow">if</span> (j1min &gt; lhx - 1)</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                  j1min = lhx - 1;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;               j1min = -j1min;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;               j1max = ssizex - i1 - 1;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;               <span class="keywordflow">if</span> (j1max &gt; lhx - 1)</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                  j1max = lhx - 1;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;               <span class="keywordflow">for</span> (j2 = j2min; j2 &lt;= j2max; j2++) {</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                  <span class="keywordflow">for</span> (j1 = j1min; j1 &lt;= j1max; j1++) {</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                     ldc =  working_space[j1 - i1min][j2 - i2min + 2 * ssizey];</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                     lda = working_space[i1 + j1][i2 + j2 + 3 * ssizey];</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                     ldb = ldb + lda * ldc;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                  }</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;               }</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;               lda = working_space[i1][i2 + 3 * ssizey];</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;               ldc = working_space[i1][i2 + 1 * ssizey];</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;               <span class="keywordflow">if</span> (ldc * lda != 0 &amp;&amp; ldb != 0) {</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                  lda = lda * ldc / ldb;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;               }</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                  lda = 0;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;               working_space[i1][i2 + 4 * ssizey] = lda;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            }</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;         }</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;         <span class="keywordflow">for</span> (i2 = 0; i2 &lt; ssizey; i2++) {</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            <span class="keywordflow">for</span> (i1 = 0; i1 &lt; ssizex; i1++)</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;               working_space[i1][i2 + 3 * ssizey] =</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                   working_space[i1][i2 + 4 * ssizey];</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;         }</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      }</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;   }</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; ssizex; i++) {</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; ssizey; j++)</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;         source[(i + positx) % ssizex][(j + posity) % ssizey] =</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;             area * working_space[i][j + 3 * ssizey];</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;   }</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; ssizex; i++)</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="keyword">delete</span>[]working_space[i];</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;   <span class="keyword">delete</span>[]working_space;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;}</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="comment">/// This function searches for peaks in source spectrum</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="comment">/// It is based on deconvolution method. First the background is</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="comment">/// removed (if desired), then Markov spectrum is calculated</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment">/// (if desired), then the response function is generated</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">/// according to given sigma and deconvolution is carried out.</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">/// Function parameters:</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">///  - source-pointer to the matrix of source spectrum</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment">///  - dest-pointer to the matrix of resulting deconvolved spectrum</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">///  - ssizex-x length of source spectrum</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="comment">///  - ssizey-y length of source spectrum</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment">///  - sigma-sigma of searched peaks, for details we refer to manual</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment">///  - threshold-threshold value in % for selected peaks, peaks with</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment">///    amplitude less than threshold*highest_peak/100</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">///    are ignored, see manual</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">///  - backgroundRemove-logical variable, set if the removal of</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">///    background before deconvolution is desired</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment">///  - deconIterations-number of iterations in deconvolution operation</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="comment">///  - markov-logical variable, if it is true, first the source spectrum</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="comment">///    is replaced by new spectrum calculated using Markov</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment">///    chains method.</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">///  - averWindow-averaging window of searched peaks, for details</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment">///    we refer to manual (applies only for Markov method)</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment">/// ### Peaks searching</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment">/// Goal: to identify automatically the peaks in spectrum with the presence of the</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="comment">/// continuous background, one-fold coincidences (ridges) and statistical</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="comment">/// fluctuations - noise.</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment">/// The common problems connected with correct peak identification in two-dimensional coincidence spectra are</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="comment">///  - non-sensitivity to noise, i.e., only statistically relevant peaks should be identified</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">///  - non-sensitivity of the algorithm to continuous background</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">///  - non-sensitivity to one-fold coincidences (coincidences peak - background in both dimensions) and their crossings</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment">///  - ability to identify peaks close to the edges of the spectrum region. Usually peak finders fail to detect them</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment">///  - resolution, decomposition of doublets and multiplets. The algorithm should be able to recognise close positioned peaks.</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment">///  - ability to identify peaks with different sigma</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment">/// #### References:</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="comment">/// [1] M.A. Mariscotti: A method for identification of peaks in the presence of</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="comment">/// background and its application to spectrum analysis. NIM 50 (1967), 309-320.</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="comment">/// [2] M. Morhac;, J. Kliman, V. Matouoek, M. Veselsky, I. Turzo.:Identification</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment">/// of peaks in multidimensional coincidence gamma-ray spectra. NIM, A443 (2000)</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">/// 108-125.</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="comment">/// [3] Z.K. Silagadze, A new algorithm for automatic photopeak searches. NIM A 376</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">/// (1996), 451.</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="comment">/// ### Examples of peak searching method</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment">/// SearchHighRes function provides users with the possibility</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment">/// to vary the input parameters and with the access to the output deconvolved data</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment">/// in the destination spectrum. Based on the output data one can tune the</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment">/// parameters.</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment">/// ### Example 8 - script Src.c</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment">/// \image html TSpectrum2_Searching1.jpg Fig. 20 Two-dimensional spectrum with found peaks denoted by markers (sigma=2, threshold=5%, 3 iterations steps in the deconvolution)</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment">/// \image html TSpectrum2_Searching3.jpg Fig. 21 Spectrum from Fig. 20 after background elimination and deconvolution</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment">/// #### Script:</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="comment">/// Example to illustrate high resolution peak searching function (class TSpectrum).</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="comment">/// To execute this example, do</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="comment">/// `root &gt; .x Src.C</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="comment">/// ~~~ {.cpp}</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="comment">///   #include &lt;TSpectrum2&gt;</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment">///   void Src() {</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="comment">///      Int_t i, j, nfound;</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment">///      Double_t nbinsx = 64;</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">///      Double_t nbinsy = 64;</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">///      Double_t xmin = 0;</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">///      Double_t xmax = (Double_t)nbinsx;</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">///      Double_t ymin = 0;</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment">///      Double_t ymax = (Double_t)nbinsy;</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment">///      Double_t** source = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="comment">///         source[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">///      Double_t** dest = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">///         dest[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment">///      TH2F *search = new TH2F(&quot;search&quot;,&quot;High resolution peak searching&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);/</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="comment">///      TFile *f = new TFile(&quot;spectra2/TSpectrum2.root&quot;);</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment">///      search=(TH2F*) f-&gt;Get(&quot;search4;1&quot;);</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">///      TCanvas *Searching = new TCanvas(&quot;Searching&quot;,&quot;High resolution peak searching&quot;,10,10,1000,700);</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment">///      TSpectrum2 *s = new TSpectrum2();</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="comment">///            source[i][j] = search-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment">///      nfound = s-&gt;SearchHighRes(source, dest, nbinsx, nbinsy, 2, 5, kTRUE, 3, kFALSE, 3);</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">///      printf(&quot;Found %d candidate peaks\n&quot;,nfound);</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">///      for(i=0;i&lt;nfound;i++)</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment">///         printf(&quot;posx= %d, posy= %d, value=%d\n&quot;,(Int_t)(fPositionX[i]+0.5), (Int_t)(fPositionY[i]+0.5),</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment">///         (Int_t)source[(Int_t)(fPositionX[i]+0.5)][(Int_t)(fPositionY[i]+0.5)]);</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment">///  }</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment">/// ~~~</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment">/// ### Example 9 - script Src2.c</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment">/// \image html TSpectrum2_Searching4.jpg Fig. 22 Two-dimensional noisy spectrum with found peaks denoted by markers (sigma=2, threshold=10%, 10 iterations steps in the deconvolution). One can observe that the algorithm is insensitive to the crossings of one-dimensional ridges. It identifies only two-coincidence peaks.</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment">/// \image html TSpectrum2_Searching5.jpg Fig. 23 Spectrum from Fig. 22 after background elimination and deconvolution</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment">/// #### Script:</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment">/// Example to illustrate high resolution peak searching function (class TSpectrum).</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment">/// To execute this example, do</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment">/// `root &gt; .x Src2.C`</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment">/// ~~~ {.cpp}</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment">///   #include &lt;TSpectrum2&gt;</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment">///   void Src2() {</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">///      Int_t i, j, nfound;</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment">///      Double_t nbinsx = 256;</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">///      Double_t nbinsy = 256;</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment">///      Double_t xmin = 0;</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">///      Double_t xmax = (Double_t)nbinsx;</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="comment">///      Double_t ymin = 0;</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="comment">///      Double_t ymax = (Double_t)nbinsy;</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="comment">///      Double_t** source = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment">///         source[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">///      Double_t** dest = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment">///         dest[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment">///      TH2F *search = new TH2F(&quot;search&quot;,&quot;High resolution peak searching&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">///      TFile *f = new TFile(&quot;spectra2/TSpectrum2.root&quot;);</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">///      search=(TH2F*) f-&gt;Get(&quot;back3;1&quot;);</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="comment">///      TCanvas *Searching = new TCanvas(&quot;Searching&quot;,&quot;High resolution peak searching&quot;,10,10,1000,700);</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">///      TSpectrum2 *s = new TSpectrum2();</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment">///            source[i][j] = search-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">///      nfound = s-&gt;SearchHighRes(source, dest, nbinsx, nbinsy, 2, 10, kTRUE, 10, kFALSE, 3);</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">///      printf(&quot;Found %d candidate peaks\n&quot;,nfound);</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">///      for(i=0;i&lt;nfound;i++)</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment">///         printf(&quot;posx= %d, posy= %d, value=%d\n&quot;,(Int_t)(fPositionX[i]+0.5), (Int_t)(fPositionY[i]+0.5),</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="comment">///         (Int_t)source[(Int_t)(fPositionX[i]+0.5)][(Int_t)(fPositionY[i]+0.5)]);</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment">///   }</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="comment">/// ~~~</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment">/// ### Example 10 - script Src3.c</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment">/// \image html TSpectrum2_Searching6.jpg Fig. 24 Two-dimensional spectrum with 15 found peaks denoted by markers. Some peaks are positioned close to each other. It is necessary to increase number of iterations in the deconvolution. In next 3 Figs. we shall study the influence of this parameter.</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment">/// \image html TSpectrum2_Searching7.jpg Fig. 25 Spectrum from Fig. 24 after deconvolution (# of iterations = 3). Number of identified peaks = 13.</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment">/// \image html TSpectrum2_Searching8.jpg Fig. 26 Spectrum from Fig. 24 after deconvolution (# of iterations = 10). Number of identified peaks = 13.</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">/// \image html TSpectrum2_Searching9.jpg Fig. 27 Spectrum from Fig. 24 after deconvolution (# of iterations = 100). Number of identified peaks = 15. Now the algorithm is able to decompose two doublets in the spectrum.</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment">/// #### Script:</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment">/// Example to illustrate high resolution peak searching function (class TSpectrum).</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="comment">/// To execute this example, do</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="comment">/// `root &gt; .x Src3.C`</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="comment">/// ~~~ {.cpp}</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="comment">///   #include &lt;TSpectrum2&gt;</span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment">///   void Src3() {</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="comment">///      Int_t i, j, nfound;</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment">///      Double_t nbinsx = 64;</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="comment">///      Double_t nbinsy = 64;</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="comment">///      Double_t xmin = 0;</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment">///      Double_t xmax = (Double_t)nbinsx;</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="comment">///      Double_t ymin = 0;</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="comment">///      Double_t ymax = (Double_t)nbinsy;</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="comment">///      Double_t** source = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="comment">///         source[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="comment">///      Double_t** dest = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="comment">///         dest[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment">///      TH2F *search = new TH2F(&quot;search&quot;,&quot;High resolution peak searching&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">///      TFile *f = new TFile(&quot;spectra2/TSpectrum2.root&quot;);</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="comment">///      search=(TH2F*) f-&gt;Get(&quot;search1;1&quot;);</span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="comment">///      TCanvas *Searching = new TCanvas(&quot;Searching&quot;,&quot;High resolution peak searching&quot;,10,10,1000,700);</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="comment">///      TSpectrum2 *s = new TSpectrum2();</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment">///            source[i][j] = search-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">///      nfound = s-&gt;SearchHighRes(source, dest, nbinsx, nbinsy, 2, 2, kFALSE, 3, kFALSE, 1);//3, 10, 100</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment">///      printf(&quot;Found %d candidate peaks\n&quot;,nfound);</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment">///      for(i=0;i&lt;nfound;i++)</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">///         printf(&quot;posx= %d, posy= %d, value=%d\n&quot;,(Int_t)(fPositionX[i]+0.5), (Int_t)(fPositionY[i]+0.5),</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">///         (Int_t)source[(Int_t)(fPositionX[i]+0.5)][(Int_t)(fPositionY[i]+0.5)]);</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment">///  }</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">/// ~~~</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">/// ### Example 11 - script Src4.c</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="comment">/// \image html TSpectrum2_Searching10.jpg Fig. 28 Two-dimensional spectrum with peaks with different sigma denoted by markers (sigma=3, threshold=5%, 10 iterations steps in the deconvolution, Markov smoothing with window=3)</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment">/// \image html TSpectrum2_Searching12.jpg Fig. 29 Spectrum from Fig. 28 after smoothing and deconvolution.</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment">/// #### Script:</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment">/// Example to illustrate high resolution peak searching function (class TSpectrum).</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">/// To execute this example, do</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">/// `root &gt; .x Src4.C`</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">/// ~~~ {.cpp}</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">///   #include &lt;TSpectrum2&gt;</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">///   void Src4() {</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">///   Int_t i, j, nfound;</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">///      Double_t nbinsx = 64;</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment">///      Double_t nbinsy = 64;</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">///      Double_t xmin = 0;</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">///      Double_t xmax = (Double_t)nbinsx;</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">///      Double_t ymin = 0;</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">///      Double_t ymax = (Double_t)nbinsy;</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">///      Double_t** source = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">///         source[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">///      Double_t** dest = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">///         dest[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment">///      TH2F *search = new TH2F(&quot;search&quot;,&quot;High resolution peak searching&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment">///      TFile *f = new TFile(&quot;spectra2/TSpectrum2.root&quot;);</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment">///      search=(TH2F*) f-&gt;Get(&quot;search2;1&quot;);</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment">///      TCanvas *Searching = new TCanvas(&quot;Searching&quot;,&quot;High resolution peak searching&quot;,10,10,1000,700);</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment">///      TSpectrum2 *s = new TSpectrum2();</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="comment">///            source[i][j] = search-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment">///       }</span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment">///      nfound = s-&gt;SearchHighRes(source, dest, nbinsx, nbinsy, 3, 5, kFALSE, 10, kTRUE, 3);</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment">///      printf(&quot;Found %d candidate peaks\n&quot;,nfound);</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">///      for(i=0;i&lt;nfound;i++)</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment">///         printf(&quot;posx= %d, posy= %d, value=%d\n&quot;,(Int_t)(fPositionX[i]+0.5), (Int_t)(fPositionY[i]+0.5),</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="comment">///         (Int_t)source[(Int_t)(fPositionX[i]+0.5)][(Int_t)(fPositionY[i]+0.5)]);</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="comment">///  }</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="comment">/// ~~~</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment">/// ### Example 12 - script Src5.c`</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment">/// \image html TSpectrum2_Searching13.jpg Fig. 30 Two-dimensional spectrum with peaks positioned close to the edges denoted by markers (sigma=2, threshold=5%, 10 iterations steps in the deconvolution)</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">/// \image html TSpectrum2_Searching14.jpg Fig. 31 Spectrum from Fig. 30 after deconvolution.</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">/// #### Script:</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">/// Example to illustrate high resolution peak searching function (class TSpectrum).</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment">/// To execute this example, do</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment">/// `root &gt; .x Src5.C`</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">/// ~~~ {.cpp}</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="comment">///   #include &lt;TSpectrum2&gt;</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment">///   void Src5() {</span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment">///      Int_t i, j, nfound;</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">///      Double_t nbinsx = 64;</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">///      Double_t nbinsy = 64;</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">///      Double_t xmin = 0;</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment">///      Double_t xmax = (Double_t)nbinsx;</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment">///      Double_t ymin = 0;</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment">///      Double_t ymax = (Double_t)nbinsy;</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment">///      Double_t** source = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment">///         source[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">///      Double_t** dest = new Double_t*[nbinsx];</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment">///      for (i=0;i&lt;nbinsx;i++)</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">///         dest[i]=new Double_t[nbinsy];</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment">///      TH2F *search = new TH2F(&quot;search&quot;,&quot;High resolution peak searching&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment">///      TFile *f = new TFile(&quot;spectra2/TSpectrum2.root&quot;);</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="comment">///      search=(TH2F*) f-&gt;Get(&quot;search3;1&quot;);</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">///      TCanvas *Searching = new TCanvas(&quot;Searching&quot;,&quot;High resolution peak searching&quot;,10,10,1000,700);</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">///      TSpectrum2 *s = new TSpectrum2();</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment">///      for (i = 0; i &lt; nbinsx; i++){</span></div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">///         for (j = 0; j &lt; nbinsy; j++){</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="comment">///            source[i][j] = search-&gt;GetBinContent(i + 1,j + 1);</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="comment">///         }</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="comment">///      }</span></div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="comment">///      nfound = s-&gt;SearchHighRes(source, dest, nbinsx, nbinsy, 2, 5, kFALSE, 10, kFALSE, 1);</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment">///      printf(&quot;Found %d candidate peaks\n&quot;,nfound);</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment">///      for(i=0;i&lt;nfound;i++)</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment">///         printf(&quot;posx= %d, posy= %d, value=%d\n&quot;,(Int_t)(fPositionX[i]+0.5), (Int_t)(fPositionY[i]+0.5),</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment">///         (Int_t)source[(Int_t)(fPositionX[i]+0.5)][(Int_t)(fPositionY[i]+0.5)]);</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment">///  }</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment">/// ~~~</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01589"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#a6a346c29d38ca4afc72fa9c551d3cef3"> 1589</a></span>&#160;<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="classTSpectrum2.html#a6a346c29d38ca4afc72fa9c551d3cef3">TSpectrum2::SearchHighRes</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> **source, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> **<a class="code" href="triangle_8c.html#aa22f343c7ac709eab3fdd162721759a1">dest</a>, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> ssizex, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> ssizey,</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                                 <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a>, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> threshold,</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                                 <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> backgroundRemove,<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> deconIterations,</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                                 <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> markov, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> averWindow)</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;{</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> number_of_iterations = (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>)(4 * <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a> + 0.5);</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> k, lindex, priz;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> lda, ldb, ldc, area, maximum;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>, <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>, <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>, peak_index = 0, ssizex_ext = ssizex + 4 * number_of_iterations, ssizey_ext = ssizey + 4 * number_of_iterations, shift = 2 * number_of_iterations;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>, <a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a>, i, j;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>, <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>, ax, ay, maxch, plocha = 0;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> nom, nip, nim, sp, sm, spx, spy, smx, smy;</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> p1, p2, p3, p4, <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a>, s2, s3, s4;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> lhx, lhy, i1, i2, j1, j2, k1, k2, i1min, i1max, i2min, i2max, j1min, j1max, j2min, j2max, positx, posity;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a> &lt; 1) {</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;SearchHighRes&quot;</span>, <span class="stringliteral">&quot;Invalid sigma, must be greater than or equal to 1&quot;</span>);</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;   }</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;   <span class="keywordflow">if</span>(threshold&lt;=0||threshold&gt;=100){</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;SearchHighRes&quot;</span>, <span class="stringliteral">&quot;Invalid threshold, must be positive and less than 100&quot;</span>);</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;   }</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;   j = (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) (5.0 * <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a> + 0.5);</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;   <span class="keywordflow">if</span> (j &gt;= <a class="code" href="TSpectrum2_8cxx.html#ade09a69507390390f0d1bd5b7d91826c">PEAK_WINDOW</a> / 2) {</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;SearchHighRes&quot;</span>, <span class="stringliteral">&quot;Too large sigma&quot;</span>);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;   }</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;   <span class="keywordflow">if</span> (markov == <span class="keyword">true</span>) {</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;      <span class="keywordflow">if</span> (averWindow &lt;= 0) {</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;         <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;SearchHighRes&quot;</span>, <span class="stringliteral">&quot;Averaging window must be positive&quot;</span>);</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      }</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;   }</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;   <span class="keywordflow">if</span>(backgroundRemove == <span class="keyword">true</span>){</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      <span class="keywordflow">if</span>(ssizex_ext &lt; 2 * number_of_iterations + 1 || ssizey_ext &lt; 2 * number_of_iterations + 1){</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;         <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;SearchHighRes&quot;</span>, <span class="stringliteral">&quot;Too large clipping window&quot;</span>);</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      }</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;   }</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;   i = (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>)(4 * <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a> + 0.5);</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;   i = 4 * i;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> **working_space = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *[ssizex + i];</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;   <span class="keywordflow">for</span> (j = 0; j &lt; ssizex + i; j++) {</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *wsk = working_space[j] = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[16 * (ssizey + i)];</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      <span class="keywordflow">for</span> (k=0;k&lt;16 * (ssizey + i);k++) wsk[k] = 0;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;   }</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;   <span class="keywordflow">for</span>(j = 0; j &lt; ssizey_ext; j++){</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; ssizex_ext; i++){</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;         <span class="keywordflow">if</span>(i &lt; shift){</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            <span class="keywordflow">if</span>(j &lt; shift)</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                  working_space[i][j + ssizey_ext] = source[0][0];</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(j &gt;= ssizey + shift)</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                  working_space[i][j + ssizey_ext] = source[0][ssizey - 1];</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                  working_space[i][j + ssizey_ext] = source[0][j - shift];</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;         }</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(i &gt;= ssizex + shift){</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            <span class="keywordflow">if</span>(j &lt; shift)</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;               working_space[i][j + ssizey_ext] = source[ssizex - 1][0];</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(j &gt;= ssizey + shift)</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;               working_space[i][j + ssizey_ext] = source[ssizex - 1][ssizey - 1];</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;               working_space[i][j + ssizey_ext] = source[ssizex - 1][j - shift];</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;         }</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;         <span class="keywordflow">else</span>{</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;            <span class="keywordflow">if</span>(j &lt; shift)</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;               working_space[i][j + ssizey_ext] = source[i - shift][0];</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(j &gt;= ssizey + shift)</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;               working_space[i][j + ssizey_ext] = source[i - shift][ssizey - 1];</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;               working_space[i][j + ssizey_ext] = source[i - shift][j - shift];</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;         }</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      }</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;   }</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;   <span class="keywordflow">if</span>(backgroundRemove == <span class="keyword">true</span>){</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      <span class="keywordflow">for</span>(i = 1; i &lt;= number_of_iterations; i++){</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;         <span class="keywordflow">for</span>(<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> = i; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> &lt; ssizey_ext - i; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>++){</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = i; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> &lt; ssizex_ext - i; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>++){</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + ssizey_ext];</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;               p1 = working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - i][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + ssizey_ext - i];</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;               p2 = working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - i][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + ssizey_ext + i];</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;               p3 = working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + i][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + ssizey_ext - i];</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;               p4 = working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + i][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + ssizey_ext + i];</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;               <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> = working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + ssizey_ext - i];</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;               s2 = working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - i][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + ssizey_ext];</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;               s3 = working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> + i][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + ssizey_ext];</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;               s4 = working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + ssizey_ext + i];</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (p1 + p2) / 2.0;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;               <span class="keywordflow">if</span>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; s2)</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                  s2 = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (p1 + p3) / 2.0;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;               <span class="keywordflow">if</span>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a>)</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                  <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (p2 + p4) / 2.0;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;               <span class="keywordflow">if</span>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; s4)</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                  s4 = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (p3 + p4) / 2.0;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;               <span class="keywordflow">if</span>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &gt; s3)</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                  s3 = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;               <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> = <a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> - (p1 + p3) / 2.0;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;               s2 = s2 - (p1 + p2) / 2.0;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;               s3 = s3 - (p3 + p4) / 2.0;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;               s4 = s4 - (p2 + p4) / 2.0;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = (<a class="code" href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a> + s4) / 2.0 + (s2 + s3) / 2.0 + (p1 + p2 + p3 + p4) / 4.0;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;               <span class="keywordflow">if</span>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> &lt; <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>)</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;               working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>] = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            }</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;         }</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;         <span class="keywordflow">for</span>(<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> = i;<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> &lt; ssizey_ext - i; <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>++){</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = i; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> &lt; ssizex_ext - i; <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>++){</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;               working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> + ssizey_ext] = working_space[<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>][<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>];</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;            }</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;         }</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;      }</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      <span class="keywordflow">for</span>(j = 0;j &lt; ssizey_ext; j++){</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;         <span class="keywordflow">for</span>(i = 0; i &lt; ssizex_ext; i++){</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            <span class="keywordflow">if</span>(i &lt; shift){</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;               <span class="keywordflow">if</span>(j &lt; shift)</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                  working_space[i][j + ssizey_ext] = source[0][0] - working_space[i][j + ssizey_ext];</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;               <span class="keywordflow">else</span> <span class="keywordflow">if</span>(j &gt;= ssizey + shift)</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                  working_space[i][j + ssizey_ext] = source[0][ssizey - 1] - working_space[i][j + ssizey_ext];</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                  working_space[i][j + ssizey_ext] = source[0][j - shift] - working_space[i][j + ssizey_ext];</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;            }</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(i &gt;= ssizex + shift){</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;               <span class="keywordflow">if</span>(j &lt; shift)</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                  working_space[i][j + ssizey_ext] = source[ssizex - 1][0] - working_space[i][j + ssizey_ext];</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;               <span class="keywordflow">else</span> <span class="keywordflow">if</span>(j &gt;= ssizey + shift)</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                  working_space[i][j + ssizey_ext] = source[ssizex - 1][ssizey - 1] - working_space[i][j + ssizey_ext];</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                  working_space[i][j + ssizey_ext] = source[ssizex - 1][j - shift] - working_space[i][j + ssizey_ext];</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            }</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            <span class="keywordflow">else</span>{</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;               <span class="keywordflow">if</span>(j &lt; shift)</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                  working_space[i][j + ssizey_ext] = source[i - shift][0] - working_space[i][j + ssizey_ext];</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;               <span class="keywordflow">else</span> <span class="keywordflow">if</span>(j &gt;= ssizey + shift)</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                  working_space[i][j + ssizey_ext] = source[i - shift][ssizey - 1] - working_space[i][j + ssizey_ext];</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                  working_space[i][j + ssizey_ext] = source[i - shift][j - shift] - working_space[i][j + ssizey_ext];</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            }</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;         }</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      }</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;   }</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;   <span class="keywordflow">for</span>(j = 0; j &lt; ssizey_ext; j++){</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; ssizex_ext; i++){</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;         working_space[i][j + 15*ssizey_ext] = working_space[i][j + ssizey_ext];</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      }</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;   }</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;   <span class="keywordflow">if</span>(markov == <span class="keyword">true</span>){</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      <span class="keywordflow">for</span>(i = 0;i &lt; ssizex_ext; i++){</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;         <span class="keywordflow">for</span>(j = 0; j &lt; ssizey_ext; j++)</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;         working_space[i][j + 2 * ssizex_ext] = working_space[i][ssizey_ext + j];</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      }</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a> = 0;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a> = ssizex_ext - 1;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      <a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a> = 0;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      <a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a> = ssizey_ext - 1;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;      <span class="keywordflow">for</span>(i = 0, maxch = 0; i &lt; ssizex_ext; i++){</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;         <span class="keywordflow">for</span>(j = 0; j &lt; ssizey_ext; j++){</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;            working_space[i][j] = 0;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;            <span class="keywordflow">if</span>(maxch &lt; working_space[i][j + 2 * ssizey_ext])</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;               maxch = working_space[i][j + 2 * ssizey_ext];</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;            plocha += working_space[i][j + 2 * ssizey_ext];</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;         }</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      }</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      <span class="keywordflow">if</span>(maxch == 0) {</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;         <span class="keyword">delete</span> [] working_space;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      }</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;      nom=0;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;      working_space[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>] = 1;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      <span class="keywordflow">for</span>(i = <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>; i &lt; <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>; i++){</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;         nip = working_space[i][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a> + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;         nim = working_space[i + 1][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a> + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;         sp = 0,sm = 0;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;         <span class="keywordflow">for</span>(<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = 1;<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &lt;= averWindow; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>++){</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;            <span class="keywordflow">if</span>((i + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>) &gt; <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>)</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[<a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a> + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[i + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a> + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nip;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip &lt;= 0)</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 1;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>=<a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip);</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;            sp = sp + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;            <span class="keywordflow">if</span>(i - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1 &lt; <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>)</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a> + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[i - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a> + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nim;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim &lt;= 0)</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 1;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>=<a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim);</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            sm = sm + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;         }</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;         <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = sp / sm;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;         <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[i + 1][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>] = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> * working_space[i][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>];</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;         nom = nom + <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      }</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      <span class="keywordflow">for</span>(i = <a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>; i &lt; <a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a>; i++){</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;         nip = working_space[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][i + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;         nim = working_space[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][i + 1 + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;         sp = 0,sm = 0;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;         <span class="keywordflow">for</span>(<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = 1; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &lt;= averWindow; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>++){</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;            <span class="keywordflow">if</span>((i + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>) &gt; <a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a>)</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][<a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a> + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][i + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nip;</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip &lt;= 0)</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>=1;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>=<a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip);</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            sp = sp + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;            <span class="keywordflow">if</span>(i - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1 &lt; <a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>)</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a> + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][i - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1 + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nim;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim &lt;= 0)</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 1;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;               <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>=<a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim);</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;            <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            sm = sm + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;         }</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;         <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = sp / sm;</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;         <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][i + 1] = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> * working_space[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][i];</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;         nom = nom + <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      }</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      <span class="keywordflow">for</span>(i = <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>; i &lt; <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>; i++){</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;         <span class="keywordflow">for</span>(j = <a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>; j &lt; <a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a>; j++){</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            nip = working_space[i][j + 1 + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            nim = working_space[i + 1][j + 1 + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;            spx = 0,smx = 0;</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = 1; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &lt;= averWindow; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>++){</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;               <span class="keywordflow">if</span>(i + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &gt; <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>)</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[<a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>][j + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[i + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>][j + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nip;</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;               <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip &lt;= 0)</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 1;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>=<a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip);</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;               spx = spx + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;               <span class="keywordflow">if</span>(i - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1 &lt; <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>)</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>][j + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[i - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1][j + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nim;</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;               <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim &lt;= 0)</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>=1;</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>=<a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim);</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;               smx = smx + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;            }</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;            spy = 0,smy = 0;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;            nip = working_space[i + 1][j + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;            nim = working_space[i + 1][j + 1 + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = 1; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &lt;= averWindow; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>++){</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;               <span class="keywordflow">if</span>(j + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &gt; <a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a>)</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[i][<a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a> + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[i][j + <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> - nip;</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;               <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip &lt;= 0)</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 1;</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>=<a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nip);</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;               spy = spy + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;               <span class="keywordflow">if</span>(j - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1 &lt; <a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>)</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[i][<a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a> + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = working_space[i][j - <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> + 1 + 2 * ssizey_ext] / maxch;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>=<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>-nim;</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;               <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim &lt;= 0)</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 1;</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                  <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>=<a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> + nim);</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> / <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;               <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>);</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;               smy = smy + <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;            }</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;            <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = (spx * working_space[i][j + 1] + spy * working_space[i + 1][j]) / (smx + smy);</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;            working_space[i + 1][j + 1] = <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;            nom = nom + <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;         }</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      }</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="keywordflow">for</span>(i = <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>; i &lt;= <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>; i++){</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;         <span class="keywordflow">for</span>(j = <a class="code" href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a>; j &lt;= <a class="code" href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a>; j++){</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            working_space[i][j] = working_space[i][j] / nom;</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;         }</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      }</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; ssizex_ext; i++){</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;         <span class="keywordflow">for</span>(j = 0; j &lt; ssizey_ext; j++){</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            working_space[i][j + ssizey_ext] = working_space[i][j] * plocha;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;            working_space[i][2 * ssizey_ext + j] = working_space[i][ssizey_ext + j];</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;         }</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      }</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;   }</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;   <span class="comment">//deconvolution starts</span></div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;   area = 0;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;   lhx = -1,lhy = -1;</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;   positx = 0,posity = 0;</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;   maximum = 0;</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;   <span class="comment">//generate response matrix</span></div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;   <span class="keywordflow">for</span>(i = 0; i &lt; ssizex_ext; i++){</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      <span class="keywordflow">for</span>(j = 0; j &lt; ssizey_ext; j++){</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;         lda = (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>)i - 3 * <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a>;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;         ldb = (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>)j - 3 * <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a>;</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;         lda = (lda * lda + ldb * ldb) / (2 * <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a> * <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a>);</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;         k=(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>)(1000 * <a class="code" href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a>(-lda));</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;         lda = k;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;         <span class="keywordflow">if</span>(lda != 0){</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;            <span class="keywordflow">if</span>((i + 1) &gt; lhx)</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;               lhx = i + 1;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            <span class="keywordflow">if</span>((j + 1) &gt; lhy)</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;               lhy = j + 1;</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;         }</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;         working_space[i][j] = lda;</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;         area = area + lda;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;         <span class="keywordflow">if</span>(lda &gt; maximum){</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;            maximum = lda;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;            positx = i,posity = j;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;         }</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      }</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;   }</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;   <span class="comment">//read source matrix</span></div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;   <span class="keywordflow">for</span>(i = 0;i &lt; ssizex_ext; i++){</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      <span class="keywordflow">for</span>(j = 0;j &lt; ssizey_ext; j++){</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;         working_space[i][j + 14 * ssizey_ext] = <a class="code" href="namespaceTMath.html#af682354cea223351f1306bf98a858dfd">TMath::Abs</a>(working_space[i][j + ssizey_ext]);</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      }</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;   }</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;   <span class="comment">//calculate matrix b=ht*h</span></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;   i = lhx - 1;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;   <span class="keywordflow">if</span>(i &gt; ssizex_ext)</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;      i = ssizex_ext;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;   j = lhy - 1;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;   <span class="keywordflow">if</span>(j&gt;ssizey_ext)</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;      j = ssizey_ext;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;   i1min = -i,i1max = i;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;   i2min = -j,i2max = j;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;   <span class="keywordflow">for</span>(i2 = i2min; i2 &lt;= i2max; i2++){</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;      <span class="keywordflow">for</span>(i1 = i1min; i1 &lt;= i1max; i1++){</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;         ldc = 0;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;         j2min = -i2;</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;         <span class="keywordflow">if</span>(j2min &lt; 0)</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            j2min = 0;</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;         j2max = lhy - 1 - i2;</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;         <span class="keywordflow">if</span>(j2max &gt; lhy - 1)</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            j2max = lhy - 1;</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;         <span class="keywordflow">for</span>(j2 = j2min; j2 &lt;= j2max; j2++){</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;            j1min = -i1;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;            <span class="keywordflow">if</span>(j1min &lt; 0)</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;               j1min = 0;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            j1max = lhx - 1 - i1;</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;            <span class="keywordflow">if</span>(j1max &gt; lhx - 1)</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;               j1max = lhx - 1;</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;            <span class="keywordflow">for</span>(j1 = j1min; j1 &lt;= j1max; j1++){</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;               lda = working_space[j1][j2];</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;               ldb = working_space[i1 + j1][i2 + j2];</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;               ldc = ldc + lda * ldb;</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;            }</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;         }</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;         k = (i1 + ssizex_ext) / ssizex_ext;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;         working_space[(i1 + ssizex_ext) % ssizex_ext][i2 + ssizey_ext + 10 * ssizey_ext + k * 2 * ssizey_ext] = ldc;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      }</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;   }</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;   <span class="comment">//calculate at*y and write into p</span></div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;   i = lhx - 1;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;   <span class="keywordflow">if</span>(i &gt; ssizex_ext)</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      i = ssizex_ext;</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;   j = lhy - 1;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;   <span class="keywordflow">if</span>(j &gt; ssizey_ext)</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;      j = ssizey_ext;</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;   i2min = -j,i2max = ssizey_ext + j - 1;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;   i1min = -i,i1max = ssizex_ext + i - 1;</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;   <span class="keywordflow">for</span>(i2 = i2min; i2 &lt;= i2max; i2++){</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;      <span class="keywordflow">for</span>(i1=i1min;i1&lt;=i1max;i1++){</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;         ldc=0;</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;         <span class="keywordflow">for</span>(j2 = 0; j2 &lt;= (lhy - 1); j2++){</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;            <span class="keywordflow">for</span>(j1 = 0; j1 &lt;= (lhx - 1); j1++){</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;               k2 = i2 + j2,k1 = i1 + j1;</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;               <span class="keywordflow">if</span>(k2 &gt;= 0 &amp;&amp; k2 &lt; ssizey_ext &amp;&amp; k1 &gt;= 0 &amp;&amp; k1 &lt; ssizex_ext){</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                  lda = working_space[j1][j2];</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                  ldb = working_space[k1][k2 + 14 * ssizey_ext];</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                  ldc = ldc + lda * ldb;</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;               }</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;            }</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;         }</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;         k = (i1 + ssizex_ext) / ssizex_ext;</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;         working_space[(i1 + ssizex_ext) % ssizex_ext][i2 + ssizey_ext + ssizey_ext + k * 3 * ssizey_ext] = ldc;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      }</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;   }</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;   <span class="comment">//move matrix p</span></div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;   <span class="keywordflow">for</span>(i2 = 0; i2 &lt; ssizey_ext; i2++){</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      <span class="keywordflow">for</span>(i1 = 0; i1 &lt; ssizex_ext; i1++){</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;         k = (i1 + ssizex_ext) / ssizex_ext;</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;         ldb = working_space[(i1 + ssizex_ext) % ssizex_ext][i2 + ssizey_ext + ssizey_ext + k * 3 * ssizey_ext];</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;         working_space[i1][i2 + 14 * ssizey_ext] = ldb;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      }</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;   }</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;   <span class="comment">//initialization in x1 matrix</span></div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;   <span class="keywordflow">for</span>(i2 = 0; i2 &lt; ssizey_ext; i2++){</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;      <span class="keywordflow">for</span>(i1 = 0; i1 &lt; ssizex_ext; i1++){</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;         working_space[i1][i2 + ssizey_ext] = 1;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;         working_space[i1][i2 + 2 * ssizey_ext] = 0;</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      }</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;   }</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;   <span class="comment">//START OF ITERATIONS</span></div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;   <span class="keywordflow">for</span>(lindex = 0; lindex &lt; deconIterations; lindex++){</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      <span class="keywordflow">for</span>(i2 = 0; i2 &lt; ssizey_ext; i2++){</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;         <span class="keywordflow">for</span>(i1 = 0; i1 &lt; ssizex_ext; i1++){</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;            lda = working_space[i1][i2 + ssizey_ext];</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;            ldc = working_space[i1][i2 + 14 * ssizey_ext];</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;            <span class="keywordflow">if</span>(lda &gt; 0.000001 &amp;&amp; ldc &gt; 0.000001){</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;               ldb=0;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;               j2min=i2;</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;               <span class="keywordflow">if</span>(j2min &gt; lhy - 1)</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                  j2min = lhy - 1;</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;               j2min = -j2min;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;               j2max = ssizey_ext - i2 - 1;</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;               <span class="keywordflow">if</span>(j2max &gt; lhy - 1)</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                  j2max = lhy - 1;</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;               j1min = i1;</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;               <span class="keywordflow">if</span>(j1min &gt; lhx - 1)</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                  j1min = lhx - 1;</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;               j1min = -j1min;</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;               j1max = ssizex_ext - i1 - 1;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;               <span class="keywordflow">if</span>(j1max &gt; lhx - 1)</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                  j1max = lhx - 1;</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;               <span class="keywordflow">for</span>(j2 = j2min; j2 &lt;= j2max; j2++){</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                  <span class="keywordflow">for</span>(j1 = j1min; j1 &lt;= j1max; j1++){</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                     k = (j1 + ssizex_ext) / ssizex_ext;</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                     ldc = working_space[(j1 + ssizex_ext) % ssizex_ext][j2 + ssizey_ext + 10 * ssizey_ext + k * 2 * ssizey_ext];</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                     lda = working_space[i1 + j1][i2 + j2 + ssizey_ext];</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                     ldb = ldb + lda * ldc;</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                  }</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;               }</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;               lda = working_space[i1][i2 + ssizey_ext];</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;               ldc = working_space[i1][i2 + 14 * ssizey_ext];</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;               <span class="keywordflow">if</span>(ldc * lda != 0 &amp;&amp; ldb != 0){</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                  lda =lda * ldc / ldb;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;               }</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                  lda=0;</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;               working_space[i1][i2 + 2 * ssizey_ext] = lda;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;            }</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;         }</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;      }</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;      <span class="keywordflow">for</span>(i2 = 0; i2 &lt; ssizey_ext; i2++){</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;         <span class="keywordflow">for</span>(i1 = 0; i1 &lt; ssizex_ext; i1++)</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;            working_space[i1][i2 + ssizey_ext] = working_space[i1][i2 + 2 * ssizey_ext];</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;      }</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;   }</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;   <span class="comment">//looking for maximum</span></div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;   maximum=0;</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;   <span class="keywordflow">for</span>(i = 0; i &lt; ssizex_ext; i++){</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;      <span class="keywordflow">for</span>(j = 0; j &lt; ssizey_ext; j++){</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;         working_space[(i + positx) % ssizex_ext][(j + posity) % ssizey_ext] = area * working_space[i][j + ssizey_ext];</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;         <span class="keywordflow">if</span>(maximum &lt; working_space[(i + positx) % ssizex_ext][(j + posity) % ssizey_ext])</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            maximum = working_space[(i + positx) % ssizex_ext][(j + posity) % ssizey_ext];</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;      }</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;   }</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;   <span class="comment">//searching for peaks in deconvolved spectrum</span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;   <span class="keywordflow">for</span>(i = 1; i &lt; ssizex_ext - 1; i++){</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;      <span class="keywordflow">for</span>(j = 1; j &lt; ssizey_ext - 1; j++){</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;         <span class="keywordflow">if</span>(working_space[i][j] &gt; working_space[i - 1][j] &amp;&amp; working_space[i][j] &gt; working_space[i - 1][j - 1] &amp;&amp; working_space[i][j] &gt; working_space[i][j - 1] &amp;&amp; working_space[i][j] &gt; working_space[i + 1][j - 1] &amp;&amp; working_space[i][j] &gt; working_space[i + 1][j] &amp;&amp; working_space[i][j] &gt; working_space[i + 1][j + 1] &amp;&amp; working_space[i][j] &gt; working_space[i][j + 1] &amp;&amp; working_space[i][j] &gt; working_space[i - 1][j + 1]){</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;            <span class="keywordflow">if</span>(i &gt;= shift &amp;&amp; i &lt; ssizex + shift &amp;&amp; j &gt;= shift &amp;&amp; j &lt; ssizey + shift){</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;               <span class="keywordflow">if</span>(working_space[i][j] &gt; threshold * maximum / 100.0){</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                  <span class="keywordflow">if</span>(peak_index &lt; <a class="code" href="classTSpectrum2.html#a5c77428b1f25e112fd92e45acce75a50">fMaxPeaks</a>){</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                     <span class="keywordflow">for</span>(k = i - 1,<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 0,<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = 0; k &lt;= i + 1; k++){</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                        <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> += (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>)(k - shift) * working_space[k][j];</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                        <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> += working_space[k][j];</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                     }</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                     ax=<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>/<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                     <span class="keywordflow">if</span>(ax &lt; 0)</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;                        ax = 0;</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                     <span class="keywordflow">if</span>(ax &gt;= ssizex)</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                        ax = ssizex - 1;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                     <span class="keywordflow">for</span>(k = j - 1,<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> = 0,<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = 0; k &lt;= j + 1; k++){</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                        <a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a> += (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>)(k - shift) * working_space[i][k];</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                        <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> += working_space[i][k];</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                     }</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                     ay=<a class="code" href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a>/<a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                     <span class="keywordflow">if</span>(ay &lt; 0)</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                        ay = 0;</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                     <span class="keywordflow">if</span>(ay &gt;= ssizey)</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                        ay = ssizey - 1;</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                     <span class="keywordflow">if</span>(peak_index == 0){</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                        <a class="code" href="classTSpectrum2.html#af6e702f37eeaf5dc28635f14e116c7fc">fPositionX</a>[0] = ax;</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                        <a class="code" href="classTSpectrum2.html#ab8d21e037700a3f5fe361afd2ab6e017">fPositionY</a>[0] = ay;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                        peak_index = 1;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                     }</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                     <span class="keywordflow">else</span>{</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                        <span class="keywordflow">for</span>(k = 0, priz = 0; k &lt; peak_index &amp;&amp; priz == 0; k++){</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                           <span class="keywordflow">if</span>(working_space[shift+(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>)(ax+0.5)][15 * ssizey_ext + shift + (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>)(ay+0.5)] &gt; working_space[shift+(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>)(<a class="code" href="classTSpectrum2.html#af6e702f37eeaf5dc28635f14e116c7fc">fPositionX</a>[k]+0.5)][15 * ssizey_ext + shift + (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>)(<a class="code" href="classTSpectrum2.html#ab8d21e037700a3f5fe361afd2ab6e017">fPositionY</a>[k]+0.5)])</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                              priz = 1;</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                        }</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                        <span class="keywordflow">if</span>(priz == 0){</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                           <span class="keywordflow">if</span>(k &lt; <a class="code" href="classTSpectrum2.html#a5c77428b1f25e112fd92e45acce75a50">fMaxPeaks</a>){</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                              <a class="code" href="classTSpectrum2.html#af6e702f37eeaf5dc28635f14e116c7fc">fPositionX</a>[k] = ax;</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                              <a class="code" href="classTSpectrum2.html#ab8d21e037700a3f5fe361afd2ab6e017">fPositionY</a>[k] = ay;</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                           }</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                        }</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                        <span class="keywordflow">else</span>{</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                           <span class="keywordflow">for</span>(<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = peak_index; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &gt;= k; <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>--){</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                              <span class="keywordflow">if</span>(<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> &lt; <a class="code" href="classTSpectrum2.html#a5c77428b1f25e112fd92e45acce75a50">fMaxPeaks</a>){</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                                 <a class="code" href="classTSpectrum2.html#af6e702f37eeaf5dc28635f14e116c7fc">fPositionX</a>[<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>] = <a class="code" href="classTSpectrum2.html#af6e702f37eeaf5dc28635f14e116c7fc">fPositionX</a>[<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> - 1];</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                                 <a class="code" href="classTSpectrum2.html#ab8d21e037700a3f5fe361afd2ab6e017">fPositionY</a>[<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>] = <a class="code" href="classTSpectrum2.html#ab8d21e037700a3f5fe361afd2ab6e017">fPositionY</a>[<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> - 1];</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                              }</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                           }</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                           <a class="code" href="classTSpectrum2.html#af6e702f37eeaf5dc28635f14e116c7fc">fPositionX</a>[k - 1] = ax;</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                           <a class="code" href="classTSpectrum2.html#ab8d21e037700a3f5fe361afd2ab6e017">fPositionY</a>[k - 1] = ay;</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                        }</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                        <span class="keywordflow">if</span>(peak_index &lt; <a class="code" href="classTSpectrum2.html#a5c77428b1f25e112fd92e45acce75a50">fMaxPeaks</a>)</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                           peak_index += 1;</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                     }</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                  }</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;               }</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;            }</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;         }</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;      }</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;   }</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;   <span class="comment">//writing back deconvolved spectrum</span></div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;   <span class="keywordflow">for</span>(i = 0; i &lt; ssizex; i++){</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      <span class="keywordflow">for</span>(j = 0; j &lt; ssizey; j++){</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;         <a class="code" href="triangle_8c.html#aa22f343c7ac709eab3fdd162721759a1">dest</a>[i][j] = working_space[i + shift][j + shift];</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;      }</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;   }</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;   i = (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>)(4 * <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a> + 0.5);</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;   i = 4 * i;</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;   <span class="keywordflow">for</span> (j = 0; j &lt; ssizex + i; j++)</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;      <span class="keyword">delete</span>[]working_space[j];</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;   <span class="keyword">delete</span>[]working_space;</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;   <a class="code" href="classTSpectrum2.html#a7ef661c22ea3da07a243bac6589dc3b6">fNPeaks</a> = peak_index;</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classTSpectrum2.html#a7ef661c22ea3da07a243bac6589dc3b6">fNPeaks</a>;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;}</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="comment">/// static function (called by TH1), interface to TSpectrum2::Search</span></div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02207"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#acd302568b36c24131cb764735a6074f4"> 2207</a></span>&#160;<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="classTSpectrum2.html#acd302568b36c24131cb764735a6074f4">TSpectrum2::StaticSearch</a>(<span class="keyword">const</span> <a class="code" href="classTH1.html">TH1</a> *hist, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a>, <a class="code" href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a> *option, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> threshold)</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;{</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;   <a class="code" href="classTSpectrum2.html">TSpectrum2</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>;</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>.Search(hist,<a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a>,option,threshold);</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;}</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="comment">/// static function (called by TH1), interface to TSpectrum2::Background</span></div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02216"></a><span class="lineno"><a class="line" href="classTSpectrum2.html#a404c160b1c1ab38a778a37f5af9ad4e3"> 2216</a></span>&#160;<a class="code" href="classTH1.html">TH1</a> *<a class="code" href="classTSpectrum2.html#a404c160b1c1ab38a778a37f5af9ad4e3">TSpectrum2::StaticBackground</a>(<span class="keyword">const</span> <a class="code" href="classTH1.html">TH1</a> *hist,<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> niter, <a class="code" href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a> *option)</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;{</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;   <a class="code" href="classTSpectrum2.html">TSpectrum2</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>.Background(hist,niter,option);</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;}</div><div class="ttc" id="classTSpectrum2_html_af5814154084ed05e20e1d93293ae0fd0"><div class="ttname"><a href="classTSpectrum2.html#af5814154084ed05e20e1d93293ae0fd0">TSpectrum2::Deconvolution</a></div><div class="ttdeci">const char * Deconvolution(Double_t **source, Double_t **resp, Int_t ssizex, Int_t ssizey, Int_t numberIterations, Int_t numberRepetitions, Double_t boost)</div><div class="ttdoc">This function calculates deconvolution from source spectrum according to response spectrum The result...</div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8cxx_source.html#l01134">TSpectrum2.cxx:1134</a></div></div>
<div class="ttc" id="THbookFile_8cxx_html_a058f249a5e6d20724cb0784b40a183e8"><div class="ttname"><a href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a></div><div class="ttdeci">float xmin</div><div class="ttdef"><b>Definition:</b> <a href="THbookFile_8cxx_source.html#l00093">THbookFile.cxx:93</a></div></div>
<div class="ttc" id="classTSpectrum2_html_ab8d21e037700a3f5fe361afd2ab6e017"><div class="ttname"><a href="classTSpectrum2.html#ab8d21e037700a3f5fe361afd2ab6e017">TSpectrum2::fPositionY</a></div><div class="ttdeci">Double_t * fPositionY</div><div class="ttdoc">[fNPeaks] Y position of peaks </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8h_source.html#l00024">TSpectrum2.h:24</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_afc405399e08793afdff5b4692827b2a1"><div class="ttname"><a href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a></div><div class="ttdeci">const char Option_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00062">RtypesCore.h:62</a></div></div>
<div class="ttc" id="Rtypes_8h_html_ac31db05c6cb5891c704eae374f6926a8a5a655b1a02e5b0311571ca57ce4f3900"><div class="ttname"><a href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a5a655b1a02e5b0311571ca57ce4f3900">kRed</a></div><div class="ttdef"><b>Definition:</b> <a href="Rtypes_8h_source.html#l00064">Rtypes.h:64</a></div></div>
<div class="ttc" id="THbookFile_8cxx_html_a5c6190dc7aa1bd7aafb9592a64f7046d"><div class="ttname"><a href="THbookFile_8cxx.html#a5c6190dc7aa1bd7aafb9592a64f7046d">ymin</a></div><div class="ttdeci">float ymin</div><div class="ttdef"><b>Definition:</b> <a href="THbookFile_8cxx_source.html#l00093">THbookFile.cxx:93</a></div></div>
<div class="ttc" id="classTSpectrum2_html"><div class="ttname"><a href="classTSpectrum2.html">TSpectrum2</a></div><div class="ttdoc">Advanced 2-dimensional spectra processing. </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8h_source.html#l00018">TSpectrum2.h:18</a></div></div>
<div class="ttc" id="classTString_html_a5072f18275913ec22cfa6f7c0c70c557"><div class="ttname"><a href="classTString.html#a5072f18275913ec22cfa6f7c0c70c557">TString::ReplaceAll</a></div><div class="ttdeci">TString &amp; ReplaceAll(const TString &amp;s1, const TString &amp;s2)</div><div class="ttdef"><b>Definition:</b> <a href="TString_8h_source.html#l00687">TString.h:687</a></div></div>
<div class="ttc" id="classTSpectrum2_html_afe35204b93276053410315d3c68bc2e5a7a9d8b0e7a3b58026f2067ca7545fb3a"><div class="ttname"><a href="classTSpectrum2.html#afe35204b93276053410315d3c68bc2e5a7a9d8b0e7a3b58026f2067ca7545fb3a">TSpectrum2::kBackSuccessiveFiltering</a></div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8h_source.html#l00034">TSpectrum2.h:34</a></div></div>
<div class="ttc" id="classTH1_html_ac70dcb4082bd510f5aa3e6efeb043f39"><div class="ttname"><a href="classTH1.html#ac70dcb4082bd510f5aa3e6efeb043f39">TH1::GetBinContent</a></div><div class="ttdeci">virtual Double_t GetBinContent(Int_t bin) const</div><div class="ttdoc">Return content of bin number bin. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l04882">TH1.cxx:4882</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a5b5107643564867a924e5388f4cd8130"><div class="ttname"><a href="classTSpectrum2.html#a5b5107643564867a924e5388f4cd8130">TSpectrum2::fgAverageWindow</a></div><div class="ttdeci">static Int_t fgAverageWindow</div><div class="ttdoc">Average window of searched peaks. </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8h_source.html#l00027">TSpectrum2.h:27</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a2417ca04282b789c493e70411599f1b2"><div class="ttname"><a href="classTSpectrum2.html#a2417ca04282b789c493e70411599f1b2">TSpectrum2::fHistogram</a></div><div class="ttdeci">TH1 * fHistogram</div><div class="ttdoc">resulting histogram </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8h_source.html#l00026">TSpectrum2.h:26</a></div></div>
<div class="ttc" id="classTString_html"><div class="ttname"><a href="classTString.html">TString</a></div><div class="ttdoc">Basic string class. </div><div class="ttdef"><b>Definition:</b> <a href="TString_8h_source.html#l00131">TString.h:131</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a286e8ed4a45ec7f986a8ad69348a3663"><div class="ttname"><a href="classTSpectrum2.html#a286e8ed4a45ec7f986a8ad69348a3663">TSpectrum2::SetDeconIterations</a></div><div class="ttdeci">static void SetDeconIterations(Int_t n=3)</div><div class="ttdoc">static function: Set max number of decon iterations in deconvolution operation see TSpectrum2::Search...</div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8cxx_source.html#l00113">TSpectrum2.cxx:113</a></div></div>
<div class="ttc" id="namespaceTMath_html_aaae88f888b116f98b932ba4543fa00b5"><div class="ttname"><a href="namespaceTMath.html#aaae88f888b116f98b932ba4543fa00b5">TMath::Min</a></div><div class="ttdeci">Short_t Min(Short_t a, Short_t b)</div><div class="ttdef"><b>Definition:</b> <a href="TMathBase_8h_source.html#l00180">TMathBase.h:180</a></div></div>
<div class="ttc" id="classTString_html_a1be9e2a41facebeac4feddd9801a0034"><div class="ttname"><a href="classTString.html#a1be9e2a41facebeac4feddd9801a0034">TString::ToLower</a></div><div class="ttdeci">void ToLower()</div><div class="ttdoc">Change string to lower-case. </div><div class="ttdef"><b>Definition:</b> <a href="TString_8cxx_source.html#l01125">TString.cxx:1125</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_a3885b911a54b47a4e61671f45dd45d0b"><div class="ttname"><a href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a></div><div class="ttdeci">int Int_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00041">RtypesCore.h:41</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_aa101f564ac7b845ca31aec2fbc00ce97"><div class="ttname"><a href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a></div><div class="ttdeci">bool Bool_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00059">RtypesCore.h:59</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a1fb2ff06a926a65493ab5d25a221d76e"><div class="ttname"><a href="classTSpectrum2.html#a1fb2ff06a926a65493ab5d25a221d76e">TSpectrum2::fResolution</a></div><div class="ttdeci">Double_t fResolution</div><div class="ttdoc">NOT USED resolution of the neighboring peaks </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8h_source.html#l00025">TSpectrum2.h:25</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a494fd9dcea391dc346e9f2282305f655"><div class="ttname"><a href="classTSpectrum2.html#a494fd9dcea391dc346e9f2282305f655">TSpectrum2::SetResolution</a></div><div class="ttdeci">void SetResolution(Double_t resolution=1)</div><div class="ttdoc">NOT USED resolution: determines resolution of the neighboring peaks default value is 1 correspond to ...</div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8cxx_source.html#l00287">TSpectrum2.cxx:287</a></div></div>
<div class="ttc" id="namespaceTMath_html_af682354cea223351f1306bf98a858dfd"><div class="ttname"><a href="namespaceTMath.html#af682354cea223351f1306bf98a858dfd">TMath::Abs</a></div><div class="ttdeci">Short_t Abs(Short_t d)</div><div class="ttdef"><b>Definition:</b> <a href="TMathBase_8h_source.html#l00120">TMathBase.h:120</a></div></div>
<div class="ttc" id="classTSpectrum2_html_afe35204b93276053410315d3c68bc2e5a8e8791437ea655d06862c4392dfb7f79"><div class="ttname"><a href="classTSpectrum2.html#afe35204b93276053410315d3c68bc2e5a8e8791437ea655d06862c4392dfb7f79">TSpectrum2::kBackOneStepFiltering</a></div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8h_source.html#l00035">TSpectrum2.h:35</a></div></div>
<div class="ttc" id="namespaceTMath_html_a9f3bcefa095d69086d20e7b76bc9bfc6"><div class="ttname"><a href="namespaceTMath.html#a9f3bcefa095d69086d20e7b76bc9bfc6">TMath::Power</a></div><div class="ttdeci">LongDouble_t Power(LongDouble_t x, LongDouble_t y)</div><div class="ttdef"><b>Definition:</b> <a href="TMath_8h_source.html#l00723">TMath.h:723</a></div></div>
<div class="ttc" id="classTList_html_a85c8734ab131c0db5f68c724e47496a7"><div class="ttname"><a href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">TList::FindObject</a></div><div class="ttdeci">virtual TObject * FindObject(const char *name) const</div><div class="ttdoc">Find an object in this list using its name. </div><div class="ttdef"><b>Definition:</b> <a href="TList_8cxx_source.html#l00575">TList.cxx:575</a></div></div>
<div class="ttc" id="classTH1_html_a48abf2a23357ba4c1c4e152686a711d4"><div class="ttname"><a href="classTH1.html#a48abf2a23357ba4c1c4e152686a711d4">TH1::GetDimension</a></div><div class="ttdeci">virtual Int_t GetDimension() const</div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00278">TH1.h:278</a></div></div>
<div class="ttc" id="legend1_8C_html_a13c6713ae496caa8195647f76887f926"><div class="ttname"><a href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a></div><div class="ttdeci">Double_t x[n]</div><div class="ttdef"><b>Definition:</b> <a href="legend1_8C_source.html#l00017">legend1.C:17</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a7ef661c22ea3da07a243bac6589dc3b6"><div class="ttname"><a href="classTSpectrum2.html#a7ef661c22ea3da07a243bac6589dc3b6">TSpectrum2::fNPeaks</a></div><div class="ttdeci">Int_t fNPeaks</div><div class="ttdoc">number of peaks found </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8h_source.html#l00021">TSpectrum2.h:21</a></div></div>
<div class="ttc" id="classTNamed_html"><div class="ttname"><a href="classTNamed.html">TNamed</a></div><div class="ttdoc">The TNamed class is the base class for all named ROOT classes. </div><div class="ttdef"><b>Definition:</b> <a href="TNamed_8h_source.html#l00029">TNamed.h:29</a></div></div>
<div class="ttc" id="classTAxis_html_a299bed7dfb2452a7cc026e16f249f25c"><div class="ttname"><a href="classTAxis.html#a299bed7dfb2452a7cc026e16f249f25c">TAxis::GetBinCenter</a></div><div class="ttdeci">virtual Double_t GetBinCenter(Int_t bin) const</div><div class="ttdoc">Return center of bin. </div><div class="ttdef"><b>Definition:</b> <a href="TAxis_8cxx_source.html#l00464">TAxis.cxx:464</a></div></div>
<div class="ttc" id="classTAttMarker_html_a27f1eae16a3f990024e8a401ed034fa3"><div class="ttname"><a href="classTAttMarker.html#a27f1eae16a3f990024e8a401ed034fa3">TAttMarker::SetMarkerColor</a></div><div class="ttdeci">virtual void SetMarkerColor(Color_t mcolor=1)</div><div class="ttdoc">Set the marker color. </div><div class="ttdef"><b>Definition:</b> <a href="TAttMarker_8h_source.html#l00038">TAttMarker.h:38</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a897608c225c0d54b8302e6a413f22710"><div class="ttname"><a href="classTSpectrum2.html#a897608c225c0d54b8302e6a413f22710">TSpectrum2::Print</a></div><div class="ttdeci">virtual void Print(Option_t *option=&quot;&quot;) const</div><div class="ttdoc">Print the array of positions. </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8cxx_source.html#l00166">TSpectrum2.cxx:166</a></div></div>
<div class="ttc" id="h1analysisProxy_8h_html_a351c2b9335dfcbe83de6eb9629c2a0e3"><div class="ttname"><a href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a></div><div class="ttdeci">const Double_t sigma</div><div class="ttdef"><b>Definition:</b> <a href="h1analysisProxy_8h_source.html#l00011">h1analysisProxy.h:11</a></div></div>
<div class="ttc" id="TList_8h_html"><div class="ttname"><a href="TList_8h.html">TList.h</a></div></div>
<div class="ttc" id="namespaceTGeant4Unit_html_a5d450e80998065902b102dca2a69066a"><div class="ttname"><a href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">TGeant4Unit::s</a></div><div class="ttdeci">static constexpr double s</div><div class="ttdef"><b>Definition:</b> <a href="TGeant4SystemOfUnits_8h_source.html#l00162">TGeant4SystemOfUnits.h:162</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a5c77428b1f25e112fd92e45acce75a50"><div class="ttname"><a href="classTSpectrum2.html#a5c77428b1f25e112fd92e45acce75a50">TSpectrum2::fMaxPeaks</a></div><div class="ttdeci">Int_t fMaxPeaks</div><div class="ttdoc">Maximum number of peaks to be found. </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8h_source.html#l00020">TSpectrum2.h:20</a></div></div>
<div class="ttc" id="classTSpectrum2_html_af6e702f37eeaf5dc28635f14e116c7fc"><div class="ttname"><a href="classTSpectrum2.html#af6e702f37eeaf5dc28635f14e116c7fc">TSpectrum2::fPositionX</a></div><div class="ttdeci">Double_t * fPositionX</div><div class="ttdoc">[fNPeaks] X position of peaks </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8h_source.html#l00023">TSpectrum2.h:23</a></div></div>
<div class="ttc" id="THbookFile_8cxx_html_acee1a082369857c7ee64924a0d9bc706"><div class="ttname"><a href="THbookFile_8cxx.html#acee1a082369857c7ee64924a0d9bc706">ymax</a></div><div class="ttdeci">float ymax</div><div class="ttdef"><b>Definition:</b> <a href="THbookFile_8cxx_source.html#l00093">THbookFile.cxx:93</a></div></div>
<div class="ttc" id="textangle_8C_html_a655a1c2a1ec25e8fcfb713772281e8f5"><div class="ttname"><a href="textangle_8C.html#a655a1c2a1ec25e8fcfb713772281e8f5">a</a></div><div class="ttdeci">auto * a</div><div class="ttdef"><b>Definition:</b> <a href="textangle_8C_source.html#l00012">textangle.C:12</a></div></div>
<div class="ttc" id="classTList_html_a3026e979d86376d2f362044d5a94c71b"><div class="ttname"><a href="classTList.html#a3026e979d86376d2f362044d5a94c71b">TList::Remove</a></div><div class="ttdeci">virtual TObject * Remove(TObject *obj)</div><div class="ttdoc">Remove object from the list. </div><div class="ttdef"><b>Definition:</b> <a href="TList_8cxx_source.html#l00819">TList.cxx:819</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a8aeffb2b740edafcf007c34c0d80af5a"><div class="ttname"><a href="classTSpectrum2.html#a8aeffb2b740edafcf007c34c0d80af5a">TSpectrum2::SetAverageWindow</a></div><div class="ttdeci">static void SetAverageWindow(Int_t w=3)</div><div class="ttdoc">static function: Set average window of searched peaks see TSpectrum2::SearchHighRes ...</div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8cxx_source.html#l00104">TSpectrum2.cxx:104</a></div></div>
<div class="ttc" id="namespaceROOT_1_1Math_1_1VectorUtil_html_a421c8e59ccf765d83def701c1ff8fa76"><div class="ttname"><a href="namespaceROOT_1_1Math_1_1VectorUtil.html#a421c8e59ccf765d83def701c1ff8fa76">ROOT::Math::VectorUtil::boost</a></div><div class="ttdeci">LVector boost(const LVector &amp;v, const BoostVector &amp;b)</div><div class="ttdoc"> Boost a generic Lorentz Vector class using a generic 3D Vector class describing the boost The only r...</div><div class="ttdef"><b>Definition:</b> <a href="GenVector_2VectorUtil_8h_source.html#l00327">VectorUtil.h:327</a></div></div>
<div class="ttc" id="classTObject_html_abe1fb206304cfa1b8d1e77a4a4fd0120"><div class="ttname"><a href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">TObject::Error</a></div><div class="ttdeci">virtual void Error(const char *method, const char *msgfmt,...) const</div><div class="ttdoc">Issue error message. </div><div class="ttdef"><b>Definition:</b> <a href="TObject_8cxx_source.html#l00880">TObject.cxx:880</a></div></div>
<div class="ttc" id="RSha256_8hxx_html_ac1e4ed4e56436a432900cad5a1225731"><div class="ttname"><a href="RSha256_8hxx.html#ac1e4ed4e56436a432900cad5a1225731">s1</a></div><div class="ttdeci">#define s1(x)</div><div class="ttdef"><b>Definition:</b> <a href="RSha256_8hxx_source.html#l00091">RSha256.hxx:91</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a664df05d3a534db570945a456cec7631"><div class="ttname"><a href="classTSpectrum2.html#a664df05d3a534db570945a456cec7631">TSpectrum2::TSpectrum2</a></div><div class="ttdeci">TSpectrum2()</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8cxx_source.html#l00057">TSpectrum2.cxx:57</a></div></div>
<div class="ttc" id="classTAttMarker_html_a697e1a65975ff344c9dca7618fd44de4"><div class="ttname"><a href="classTAttMarker.html#a697e1a65975ff344c9dca7618fd44de4">TAttMarker::SetMarkerStyle</a></div><div class="ttdeci">virtual void SetMarkerStyle(Style_t mstyle=1)</div><div class="ttdoc">Set the marker style. </div><div class="ttdef"><b>Definition:</b> <a href="TAttMarker_8h_source.html#l00040">TAttMarker.h:40</a></div></div>
<div class="ttc" id="classTH1_html_a5cadfed83a4db70b4eae6b0a1cea3532"><div class="ttname"><a href="classTH1.html#a5cadfed83a4db70b4eae6b0a1cea3532">TH1::GetYaxis</a></div><div class="ttdeci">TAxis * GetYaxis()</div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00317">TH1.h:317</a></div></div>
<div class="ttc" id="THbookFile_8cxx_html_a9c42f51718ed192ed1841a53d2b0e507"><div class="ttname"><a href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a></div><div class="ttdeci">float xmax</div><div class="ttdef"><b>Definition:</b> <a href="THbookFile_8cxx_source.html#l00093">THbookFile.cxx:93</a></div></div>
<div class="ttc" id="classTAttMarker_html_a95522acfc3fa6157f317f9993edfa047"><div class="ttname"><a href="classTAttMarker.html#a95522acfc3fa6157f317f9993edfa047">TAttMarker::SetMarkerSize</a></div><div class="ttdeci">virtual void SetMarkerSize(Size_t msize=1)</div><div class="ttdoc">Set the marker size. </div><div class="ttdef"><b>Definition:</b> <a href="TAttMarker_8h_source.html#l00041">TAttMarker.h:41</a></div></div>
<div class="ttc" id="RSha256_8hxx_html_acf9942d15f0dd0ac4fc5ca66096a3f6d"><div class="ttname"><a href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a></div><div class="ttdeci">#define h(i)</div><div class="ttdef"><b>Definition:</b> <a href="RSha256_8hxx_source.html#l00106">RSha256.hxx:106</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_a7e568baf910535e8ffd438acb843434d"><div class="ttname"><a href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a></div><div class="ttdeci">const Bool_t kFALSE</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00088">RtypesCore.h:88</a></div></div>
<div class="ttc" id="classTSpectrum2_html_afe35204b93276053410315d3c68bc2e5ad124dffd2aadc9ddbcf3b085dddd2e9c"><div class="ttname"><a href="classTSpectrum2.html#afe35204b93276053410315d3c68bc2e5ad124dffd2aadc9ddbcf3b085dddd2e9c">TSpectrum2::kBackIncreasingWindow</a></div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8h_source.html#l00032">TSpectrum2.h:32</a></div></div>
<div class="ttc" id="TPolyMarker_8h_html"><div class="ttname"><a href="TPolyMarker_8h.html">TPolyMarker.h</a></div></div>
<div class="ttc" id="namespaceTMath_html_a428950de9bddacfb35915a9603880005"><div class="ttname"><a href="namespaceTMath.html#a428950de9bddacfb35915a9603880005">TMath::Exp</a></div><div class="ttdeci">Double_t Exp(Double_t x)</div><div class="ttdef"><b>Definition:</b> <a href="TMath_8h_source.html#l00715">TMath.h:715</a></div></div>
<div class="ttc" id="classTSpectrum2_html_acd302568b36c24131cb764735a6074f4"><div class="ttname"><a href="classTSpectrum2.html#acd302568b36c24131cb764735a6074f4">TSpectrum2::StaticSearch</a></div><div class="ttdeci">static Int_t StaticSearch(const TH1 *hist, Double_t sigma=2, Option_t *option=&quot;goff&quot;, Double_t threshold=0.05)</div><div class="ttdoc">static function (called by TH1), interface to TSpectrum2::Search </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8cxx_source.html#l02207">TSpectrum2.cxx:2207</a></div></div>
<div class="ttc" id="classTPolyMarker_html"><div class="ttname"><a href="classTPolyMarker.html">TPolyMarker</a></div><div class="ttdoc">A PolyMarker is defined by an array on N points in a 2-D space. </div><div class="ttdef"><b>Definition:</b> <a href="TPolyMarker_8h_source.html#l00031">TPolyMarker.h:31</a></div></div>
<div class="ttc" id="classTSpectrum2_html_ad6f0d7a16e7e438a95c71cad90a687a0"><div class="ttname"><a href="classTSpectrum2.html#ad6f0d7a16e7e438a95c71cad90a687a0">TSpectrum2::fPosition</a></div><div class="ttdeci">Double_t * fPosition</div><div class="ttdoc">[fNPeaks] array of current peak positions </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8h_source.html#l00022">TSpectrum2.h:22</a></div></div>
<div class="ttc" id="Rtypes_8h_html_a3f9bf160bbbb44209e95556960836b96"><div class="ttname"><a href="Rtypes_8h.html#a3f9bf160bbbb44209e95556960836b96">ClassImp</a></div><div class="ttdeci">#define ClassImp(name)</div><div class="ttdef"><b>Definition:</b> <a href="Rtypes_8h_source.html#l00365">Rtypes.h:365</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_ab9b5334647b78ec4256db251e3ae1fc6"><div class="ttname"><a href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a></div><div class="ttdeci">double Double_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00055">RtypesCore.h:55</a></div></div>
<div class="ttc" id="classTSpectrum2_html_afe35204b93276053410315d3c68bc2e5acf4f81f5ef18487c5873ef4384dcfdaa"><div class="ttname"><a href="classTSpectrum2.html#afe35204b93276053410315d3c68bc2e5acf4f81f5ef18487c5873ef4384dcfdaa">TSpectrum2::kBackDecreasingWindow</a></div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8h_source.html#l00033">TSpectrum2.h:33</a></div></div>
<div class="ttc" id="TSpectrum2_8h_html"><div class="ttname"><a href="TSpectrum2_8h.html">TSpectrum2.h</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a4b0fb4011855309063563e5137b47b56"><div class="ttname"><a href="classTSpectrum2.html#a4b0fb4011855309063563e5137b47b56">TSpectrum2::~TSpectrum2</a></div><div class="ttdeci">virtual ~TSpectrum2()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8cxx_source.html#l00092">TSpectrum2.cxx:92</a></div></div>
<div class="ttc" id="legend1_8C_html_a1380cd153a0fc78015dd604dbcb6c841"><div class="ttname"><a href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a></div><div class="ttdeci">Double_t y[n]</div><div class="ttdef"><b>Definition:</b> <a href="legend1_8C_source.html#l00017">legend1.C:17</a></div></div>
<div class="ttc" id="classTString_html_aefd4aa6797ae0fd7e63345def5c0be92"><div class="ttname"><a href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">TString::Contains</a></div><div class="ttdeci">Bool_t Contains(const char *pat, ECaseCompare cmp=kExact) const</div><div class="ttdef"><b>Definition:</b> <a href="TString_8h_source.html#l00619">TString.h:619</a></div></div>
<div class="ttc" id="classTH1_html"><div class="ttname"><a href="classTH1.html">TH1</a></div><div class="ttdoc">The TH1 histogram class. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00056">TH1.h:56</a></div></div>
<div class="ttc" id="classTList_html_a1b90ccfbde1729266b585194fa45df14"><div class="ttname"><a href="classTList.html#a1b90ccfbde1729266b585194fa45df14">TList::Add</a></div><div class="ttdeci">virtual void Add(TObject *obj)</div><div class="ttdef"><b>Definition:</b> <a href="TList_8h_source.html#l00087">TList.h:87</a></div></div>
<div class="ttc" id="textangle_8C_html_a3359d7f1aa9fe2f8bc884b02020e8d20"><div class="ttname"><a href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a></div><div class="ttdeci">auto * l</div><div class="ttdef"><b>Definition:</b> <a href="textangle_8C_source.html#l00004">textangle.C:4</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a482a7f144b9cc1b0405d0ac0d8cc9bbb"><div class="ttname"><a href="classTSpectrum2.html#a482a7f144b9cc1b0405d0ac0d8cc9bbb">TSpectrum2::SmoothMarkov</a></div><div class="ttdeci">const char * SmoothMarkov(Double_t **source, Int_t ssizex, Int_t ssizey, Int_t averWindow)</div><div class="ttdoc">This function calculates smoothed spectrum from source spectrum based on Markov chain method...</div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8cxx_source.html#l00736">TSpectrum2.cxx:736</a></div></div>
<div class="ttc" id="triangle_8c_html_aa22f343c7ac709eab3fdd162721759a1"><div class="ttname"><a href="triangle_8c.html#aa22f343c7ac709eab3fdd162721759a1">dest</a></div><div class="ttdeci">#define dest(otri, vertexptr)</div><div class="ttdef"><b>Definition:</b> <a href="triangle_8c_source.html#l01040">triangle.c:1040</a></div></div>
<div class="ttc" id="namespaceTMath_html_a38e1c23e08564d17051526d7e0a5364d"><div class="ttname"><a href="namespaceTMath.html#a38e1c23e08564d17051526d7e0a5364d">TMath::Max</a></div><div class="ttdeci">Short_t Max(Short_t a, Short_t b)</div><div class="ttdef"><b>Definition:</b> <a href="TMathBase_8h_source.html#l00212">TMathBase.h:212</a></div></div>
<div class="ttc" id="TRolke_8cxx_html_a1a2354f40e332ad13673b70afc2c0dbf"><div class="ttname"><a href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a></div><div class="ttdeci">you should not use this method at all Int_t Int_t Double_t Double_t Double_t Int_t Double_t Double_t Double_t Double_t b</div><div class="ttdef"><b>Definition:</b> <a href="TRolke_8cxx_source.html#l00630">TRolke.cxx:630</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a404c160b1c1ab38a778a37f5af9ad4e3"><div class="ttname"><a href="classTSpectrum2.html#a404c160b1c1ab38a778a37f5af9ad4e3">TSpectrum2::StaticBackground</a></div><div class="ttdeci">static TH1 * StaticBackground(const TH1 *hist, Int_t niter=20, Option_t *option=&quot;&quot;)</div><div class="ttdoc">static function (called by TH1), interface to TSpectrum2::Background </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8cxx_source.html#l02216">TSpectrum2.cxx:2216</a></div></div>
<div class="ttc" id="TH1_8h_html"><div class="ttname"><a href="TH1_8h.html">TH1.h</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a82cf6ee8aa5a709643564b4b4fa74044"><div class="ttname"><a href="classTSpectrum2.html#a82cf6ee8aa5a709643564b4b4fa74044">TSpectrum2::Background</a></div><div class="ttdeci">virtual TH1 * Background(const TH1 *hist, Int_t niter=20, Option_t *option=&quot;&quot;)</div><div class="ttdoc">This function calculates the background spectrum in the input histogram h. </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8cxx_source.html#l00155">TSpectrum2.cxx:155</a></div></div>
<div class="ttc" id="namespaceTMath_html_a9ea900c956031cb12057acf7c322b0fa"><div class="ttname"><a href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a></div><div class="ttdeci">Double_t Sqrt(Double_t x)</div><div class="ttdef"><b>Definition:</b> <a href="TMath_8h_source.html#l00679">TMath.h:679</a></div></div>
<div class="ttc" id="classTAxis_html_ac6efeb83d609a187a332a6217442665c"><div class="ttname"><a href="classTAxis.html#ac6efeb83d609a187a332a6217442665c">TAxis::GetNbins</a></div><div class="ttdeci">Int_t GetNbins() const</div><div class="ttdef"><b>Definition:</b> <a href="TAxis_8h_source.html#l00121">TAxis.h:121</a></div></div>
<div class="ttc" id="TMath_8h_html"><div class="ttname"><a href="TMath_8h.html">TMath.h</a></div></div>
<div class="ttc" id="classTH1_html_a4f38ff3c9c675313fc647d32c87ea07a"><div class="ttname"><a href="classTH1.html#a4f38ff3c9c675313fc647d32c87ea07a">TH1::GetListOfFunctions</a></div><div class="ttdeci">TList * GetListOfFunctions() const</div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00239">TH1.h:239</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_af2f51d30ccd86e85be3e3e69793a86ef"><div class="ttname"><a href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a></div><div class="ttdeci">const Bool_t kTRUE</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00087">RtypesCore.h:87</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a6a346c29d38ca4afc72fa9c551d3cef3"><div class="ttname"><a href="classTSpectrum2.html#a6a346c29d38ca4afc72fa9c551d3cef3">TSpectrum2::SearchHighRes</a></div><div class="ttdeci">Int_t SearchHighRes(Double_t **source, Double_t **dest, Int_t ssizex, Int_t ssizey, Double_t sigma, Double_t threshold, Bool_t backgroundRemove, Int_t deconIterations, Bool_t markov, Int_t averWindow)</div><div class="ttdoc">This function searches for peaks in source spectrum It is based on deconvolution method. </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8cxx_source.html#l01589">TSpectrum2.cxx:1589</a></div></div>
<div class="ttc" id="legend1_8C_html_a16daaa7b596941b23915a1ac1be5b42c"><div class="ttname"><a href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a></div><div class="ttdeci">const Int_t n</div><div class="ttdef"><b>Definition:</b> <a href="legend1_8C_source.html#l00016">legend1.C:16</a></div></div>
<div class="ttc" id="TSpectrum2_8cxx_html_ade09a69507390390f0d1bd5b7d91826c"><div class="ttname"><a href="TSpectrum2_8cxx.html#ade09a69507390390f0d1bd5b7d91826c">PEAK_WINDOW</a></div><div class="ttdeci">#define PEAK_WINDOW</div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8cxx_source.html#l00047">TSpectrum2.cxx:47</a></div></div>
<div class="ttc" id="classTH1_html_a3d91d3762b9789bd6e54e67d8ccce2e6"><div class="ttname"><a href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">TH1::GetXaxis</a></div><div class="ttdeci">TAxis * GetXaxis()</div><div class="ttdoc">Get the behaviour adopted by the object about the statoverflows. See EStatOverflows for more informat...</div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00316">TH1.h:316</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a2514608f7dbb02b499d0d815ddcd0583"><div class="ttname"><a href="classTSpectrum2.html#a2514608f7dbb02b499d0d815ddcd0583">TSpectrum2::fgIterations</a></div><div class="ttdeci">static Int_t fgIterations</div><div class="ttdoc">Maximum number of decon iterations (default=3) </div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8h_source.html#l00028">TSpectrum2.h:28</a></div></div>
<div class="ttc" id="classTSpectrum2_html_a9f0138439417cb5b478dd3b85c7266a3"><div class="ttname"><a href="classTSpectrum2.html#a9f0138439417cb5b478dd3b85c7266a3">TSpectrum2::Search</a></div><div class="ttdeci">virtual Int_t Search(const TH1 *hist, Double_t sigma=2, Option_t *option=&quot;&quot;, Double_t threshold=0.05)</div><div class="ttdoc">This function searches for peaks in source spectrum in hin The number of found peaks and their positi...</div><div class="ttdef"><b>Definition:</b> <a href="TSpectrum2_8cxx_source.html#l00206">TSpectrum2.cxx:206</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:09:22 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

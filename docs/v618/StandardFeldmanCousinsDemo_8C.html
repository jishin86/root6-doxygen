<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/roostats/StandardFeldmanCousinsDemo.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_87facaa6959ceb8d3dacccaf663f7b84.html">roostats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">StandardFeldmanCousinsDemo.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__roostats.html">RooStats Tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/StandardFeldmanCousinsDemo.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/StandardFeldmanCousinsDemo.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  Standard demo of the Feldman-Cousins calculator StandardFeldmanCousinsDemo </p>
<p>This is a standard demo that can be used with any <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a> file prepared in the standard way. You specify:</p><ul>
<li>name for input <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a> file</li>
<li>name of workspace inside <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a> file that holds model and data</li>
<li>name of ModelConfig that specifies details for calculator tools</li>
<li>name of dataset</li>
</ul>
<p>With default parameters the macro will attempt to run the standard hist2workspace example and read the <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a> file that it produces.</p>
<p>The actual heart of the demo is only about 10 lines long.</p>
<p>The FeldmanCousins tools is a classical frequentist calculation based on the Neyman Construction. The test statistic can be generalized for nuisance parameters by using the profile likelihood ratio. But unlike the ProfileLikelihoodCalculator, this tool explicitly builds the sampling distribution of the test statistic via toy Monte Carlo.</p>
<div class="image">
<img src="pict1_StandardFeldmanCousinsDemo.C.png" alt="pict1_StandardFeldmanCousinsDemo.C.png" width="700"/>
</div>
 <div class="fragment"><div class="line"></div><div class="line"></div><div class="line">[1mRooFit v3.60 -- Developed by Wouter Verkerke and David Kirkby[0m </div><div class="line">                Copyright (C) 2000-2013 NIKHEF, University of California &amp; Stanford University</div><div class="line">                All rights reserved, please read http://roofit.sourceforge.net/license.txt</div><div class="line"></div><div class="line"></div><div class="line">=== Using the following for ModelConfig ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.174888</div><div class="line"></div><div class="line">FeldmanCousins: ntoys per point: adaptive</div><div class="line">FeldmanCousins: nEvents per toy will fluctuate about  expectation</div><div class="line">FeldmanCousins: Model has nuisance parameters, will do profile construction</div><div class="line">FeldmanCousins: # points to test = 10</div><div class="line">lookup index = 0</div><div class="line">NeymanConstruction: Prog: 1/10 total MC = 78 this test stat = 1.323</div><div class="line"> SigXsecOverSM=0.15 alpha_syst2=0.602204 alpha_syst3=0.227781 gamma_stat_channel1_bin_0=1.03121 gamma_stat_channel1_bin_1=1.04626 [-1e+30, 3.00321]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 2/10 total MC = 78 this test stat = 0.62223</div><div class="line"> SigXsecOverSM=0.45 alpha_syst2=0.398364 alpha_syst3=0.161337 gamma_stat_channel1_bin_0=1.02058 gamma_stat_channel1_bin_1=1.03265 [-1e+30, 2.02972]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 3/10 total MC = 78 this test stat = 0.185526</div><div class="line"> SigXsecOverSM=0.75 alpha_syst2=0.208894 alpha_syst3=0.0960207 gamma_stat_channel1_bin_0=1.01066 gamma_stat_channel1_bin_1=1.01935 [-1e+30, 1.36211]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 4/10 total MC = 78 this test stat = 0.00588509</div><div class="line"> SigXsecOverSM=1.05 alpha_syst2=0.0280678 alpha_syst3=0.0367739 gamma_stat_channel1_bin_0=1.0014 gamma_stat_channel1_bin_1=1.00625 [-1e+30, 1.11847]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 5/10 total MC = 78 this test stat = 0.0747855</div><div class="line"> SigXsecOverSM=1.35 alpha_syst2=-0.14426 alpha_syst3=-0.0333676 gamma_stat_channel1_bin_0=0.99286 gamma_stat_channel1_bin_1=0.994142 [-1e+30, 2.18053]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 6/10 total MC = 78 this test stat = 0.38368</div><div class="line"> SigXsecOverSM=1.65 alpha_syst2=-0.306403 alpha_syst3=-0.0939379 gamma_stat_channel1_bin_0=0.985118 gamma_stat_channel1_bin_1=0.981397 [-1e+30, 1.59882]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 7/10 total MC = 78 this test stat = 0.924288</div><div class="line"> SigXsecOverSM=1.95 alpha_syst2=-0.45999 alpha_syst3=-0.155748 gamma_stat_channel1_bin_0=0.977832 gamma_stat_channel1_bin_1=0.96943 [-1e+30, 2.13401]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 8/10 total MC = 78 this test stat = 1.68871</div><div class="line"> SigXsecOverSM=2.25 alpha_syst2=-0.601904 alpha_syst3=-0.21612 gamma_stat_channel1_bin_0=0.971077 gamma_stat_channel1_bin_1=0.957715 [-1e+30, 2.12322]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 9/10 total MC = 234 this test stat = 2.66932</div><div class="line"> SigXsecOverSM=2.55 alpha_syst2=-0.732241 alpha_syst3=-0.275902 gamma_stat_channel1_bin_0=0.964738 gamma_stat_channel1_bin_1=0.946434 [-1e+30, 2.20603]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 10/10 total MC = 234 this test stat = 3.85849</div><div class="line"> SigXsecOverSM=2.85 alpha_syst2=-0.851873 alpha_syst3=-0.333983 gamma_stat_channel1_bin_0=0.958838 gamma_stat_channel1_bin_1=0.935421 [-1e+30, 2.28476]  in interval = 0</div><div class="line"></div><div class="line">[#1] INFO:Eval -- 8 points in interval</div><div class="line"></div><div class="line">95% interval on SigXsecOverSM is : [0.15, 2.25] </div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TFile_8h.html">TFile.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TROOT_8h.html">TROOT.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TH1F_8h.html">TH1F.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TSystem_8h.html">TSystem.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooWorkspace_8h.html">RooWorkspace.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooAbsData_8h.html">RooAbsData.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ModelConfig_8h.html">RooStats/ModelConfig.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="FeldmanCousins_8h.html">RooStats/FeldmanCousins.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ToyMCSampler_8h.html">RooStats/ToyMCSampler.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="PointSetInterval_8h.html">RooStats/PointSetInterval.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ConfidenceBelt_8h.html">RooStats/ConfidenceBelt.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooFit.html">RooFit</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooStats.html">RooStats</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> StandardFeldmanCousinsDemo(<span class="keyword">const</span> <span class="keywordtype">char</span> *infile = <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *workspaceName = <span class="stringliteral">&quot;combined&quot;</span>,</div><div class="line">                                <span class="keyword">const</span> <span class="keywordtype">char</span> *modelConfigName = <span class="stringliteral">&quot;ModelConfig&quot;</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *dataName = <span class="stringliteral">&quot;obsData&quot;</span>)</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------------</span></div><div class="line">   <span class="comment">// First part is just to access a user-defined file</span></div><div class="line">   <span class="comment">// or create the standard example file if it doesn&#39;t exist</span></div><div class="line">   <span class="keyword">const</span> <span class="keywordtype">char</span> *filename = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line">   <span class="keywordflow">if</span> (!strcmp(infile, <span class="stringliteral">&quot;&quot;</span>)) {</div><div class="line">      filename = <span class="stringliteral">&quot;results/example_combined_GaussExample_model.root&quot;</span>;</div><div class="line">      <span class="keywordtype">bool</span> fileExist = !<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(filename); <span class="comment">// note opposite return code</span></div><div class="line">      <span class="comment">// if file does not exists generate with histfactory</span></div><div class="line">      <span class="keywordflow">if</span> (!fileExist) {</div><div class="line"><span class="preprocessor">#ifdef _WIN32</span></div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;HistFactory file cannot be generated on Windows - exit&quot;</span> &lt;&lt; endl;</div><div class="line">         <span class="keywordflow">return</span>;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">         <span class="comment">// Normally this would be run on the command line</span></div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;will run standard hist2workspace example&quot;</span> &lt;&lt; endl;</div><div class="line">         <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLine(<span class="stringliteral">&quot;.! prepareHistFactory .&quot;</span>);</div><div class="line">         <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLine(<span class="stringliteral">&quot;.! hist2workspace config/example.xml&quot;</span>);</div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;\n\n---------------------&quot;</span> &lt;&lt; endl;</div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;Done creating example input&quot;</span> &lt;&lt; endl;</div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;---------------------\n\n&quot;</span> &lt;&lt; endl;</div><div class="line">      }</div><div class="line"></div><div class="line">   } <span class="keywordflow">else</span></div><div class="line">      filename = infile;</div><div class="line"></div><div class="line">   <span class="comment">// Try to open the file</span></div><div class="line">   <a class="code" href="classTFile.html">TFile</a> *<a class="code" href="namespacefile.html">file</a> = <a class="code" href="classTFile.html#aec5f3fae0774aabfc615ebb4b00fe5e0">TFile::Open</a>(filename);</div><div class="line"></div><div class="line">   <span class="comment">// if input file was specified byt not found, quit</span></div><div class="line">   <span class="keywordflow">if</span> (!<a class="code" href="namespacefile.html">file</a>) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;StandardRooStatsDemoMacro: Input file &quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot; is not found&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------------</span></div><div class="line">   <span class="comment">// Tutorial starts here</span></div><div class="line">   <span class="comment">// -------------------------------------------------------</span></div><div class="line"></div><div class="line">   <span class="comment">// get the workspace out of the file</span></div><div class="line">   <a class="code" href="classRooWorkspace.html">RooWorkspace</a> *w = (<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *)<a class="code" href="namespacefile.html">file</a>-&gt;Get(workspaceName);</div><div class="line">   <span class="keywordflow">if</span> (!w) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;workspace not found&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// get the modelConfig out of the file</span></div><div class="line">   <a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> *mc = (<a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> *)w-&gt;<a class="code" href="classRooWorkspace.html#af56548d1c16301ebaf951c452d52f5c3">obj</a>(modelConfigName);</div><div class="line"></div><div class="line">   <span class="comment">// get the modelConfig out of the file</span></div><div class="line">   <a class="code" href="classRooAbsData.html">RooAbsData</a> *data = w-&gt;<a class="code" href="classRooWorkspace.html#a2e0683ca1b7375eaa434a9cc1298e736">data</a>(dataName);</div><div class="line"></div><div class="line">   <span class="comment">// make sure ingredients are found</span></div><div class="line">   <span class="keywordflow">if</span> (!data || !mc) {</div><div class="line">      w-&gt;<a class="code" href="classRooWorkspace.html#a9131cf30e7ea371b14a619ebf0d7e18f">Print</a>();</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;data or ModelConfig was not found&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------------</span></div><div class="line">   <span class="comment">// create and use the FeldmanCousins tool</span></div><div class="line">   <span class="comment">// to find and plot the 95% confidence interval</span></div><div class="line">   <span class="comment">// on the parameter of interest as specified</span></div><div class="line">   <span class="comment">// in the model config</span></div><div class="line">   <a class="code" href="classRooStats_1_1FeldmanCousins.html">FeldmanCousins</a> <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>(*data, *mc);</div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.SetConfidenceLevel(0.95); <span class="comment">// 95% interval</span></div><div class="line">   <span class="comment">// fc.AdditionalNToysFactor(0.1); // to speed up the result</span></div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.UseAdaptiveSampling(<span class="keyword">true</span>); <span class="comment">// speed it up a bit</span></div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.SetNBins(10);              <span class="comment">// set how many points per parameter of interest to scan</span></div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.CreateConfBelt(<span class="keyword">true</span>);      <span class="comment">// save the information in the belt for plotting</span></div><div class="line"></div><div class="line">   <span class="comment">// Since this tool needs to throw toy MC the PDF needs to be</span></div><div class="line">   <span class="comment">// extended or the tool needs to know how many entries in a dataset</span></div><div class="line">   <span class="comment">// per pseudo experiment.</span></div><div class="line">   <span class="comment">// In the &#39;number counting form&#39; where the entries in the dataset</span></div><div class="line">   <span class="comment">// are counts, and not values of discriminating variables, the</span></div><div class="line">   <span class="comment">// datasets typically only have one entry and the PDF is not</span></div><div class="line">   <span class="comment">// extended.</span></div><div class="line">   <span class="keywordflow">if</span> (!mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#a69d77200d6313129397ac2aa8deef408">canBeExtended</a>()) {</div><div class="line">      <span class="keywordflow">if</span> (data-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>() == 1)</div><div class="line">         <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.FluctuateNumDataEntries(<span class="keyword">false</span>);</div><div class="line">      <span class="keywordflow">else</span></div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;Not sure what to do about this model&quot;</span> &lt;&lt; endl;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// We can use PROOF to speed things along in parallel</span></div><div class="line">   <span class="comment">//  ProofConfig pc(*w, 1, &quot;workers=4&quot;, kFALSE);</span></div><div class="line">   <span class="comment">//  ToyMCSampler*  toymcsampler = (ToyMCSampler*) fc.GetTestStatSampler();</span></div><div class="line">   <span class="comment">//  toymcsampler-&gt;SetProofConfig(&amp;pc); // enable proof</span></div><div class="line"></div><div class="line">   <span class="comment">// Now get the interval</span></div><div class="line">   <a class="code" href="classRooStats_1_1PointSetInterval.html">PointSetInterval</a> *interval = <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetInterval();</div><div class="line">   <a class="code" href="classRooStats_1_1ConfidenceBelt.html">ConfidenceBelt</a> *belt = <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetConfidenceBelt();</div><div class="line"></div><div class="line">   <span class="comment">// print out the interval on the first Parameter of Interest</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *firstPOI = (<a class="code" href="classRooRealVar.html">RooRealVar</a> *)mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>()-&gt;<a class="code" href="classRooAbsCollection.html#a225c780c4c32077d6923e956225e437a">first</a>();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;\n95% interval on &quot;</span> &lt;&lt; firstPOI-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>() &lt;&lt; <span class="stringliteral">&quot; is : [&quot;</span> &lt;&lt; interval-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#aa221cea064f8013ff5f7fde218a226e3">LowerLimit</a>(*firstPOI) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line">        &lt;&lt; interval-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#a8c43f888bbc5ba55ec8553a0506dcfc6">UpperLimit</a>(*firstPOI) &lt;&lt; <span class="stringliteral">&quot;] &quot;</span> &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">// ---------------------------------------------</span></div><div class="line">   <span class="comment">// No nice plots yet, so plot the belt by hand</span></div><div class="line"></div><div class="line">   <span class="comment">// Ask the calculator which points were scanned</span></div><div class="line">   <a class="code" href="classRooDataSet.html">RooDataSet</a> *parameterScan = (<a class="code" href="classRooDataSet.html">RooDataSet</a> *)<a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetPointsToScan();</div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *tmpPoint;</div><div class="line"></div><div class="line">   <span class="comment">// make a histogram of parameter vs. threshold</span></div><div class="line">   <a class="code" href="classTH1F.html">TH1F</a> *histOfThresholds =</div><div class="line">      <span class="keyword">new</span> <a class="code" href="classTH1F.html">TH1F</a>(<span class="stringliteral">&quot;histOfThresholds&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, parameterScan-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>(), firstPOI-&gt;<a class="code" href="classRooAbsRealLValue.html#af16e9d798cdd32874357e57430803a82">getMin</a>(), firstPOI-&gt;<a class="code" href="classRooAbsRealLValue.html#a07d826bfa29ecd48e8e31ed28bd0bc48">getMax</a>());</div><div class="line"></div><div class="line">   <span class="comment">// loop through the points that were tested and ask confidence belt</span></div><div class="line">   <span class="comment">// what the upper/lower thresholds were.</span></div><div class="line">   <span class="comment">// For FeldmanCousins, the lower cut off is always 0</span></div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0; i &lt; parameterScan-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>(); ++i) {</div><div class="line">      tmpPoint = (<a class="code" href="classRooArgSet.html">RooArgSet</a> *)parameterScan-&gt;<a class="code" href="classRooDataSet.html#a2d2355b7a32be47b906312f113ee75c0">get</a>(i)-&gt;<a class="code" href="classRooArgSet.html#a693748866f98afb0b4e9efd40de6b405">clone</a>(<span class="stringliteral">&quot;temp&quot;</span>);</div><div class="line">      <span class="keywordtype">double</span> arMax = belt-&gt;<a class="code" href="classRooStats_1_1ConfidenceBelt.html#ad465a9878549db5398cabbffb57ff7fb">GetAcceptanceRegionMax</a>(*tmpPoint);</div><div class="line">      <span class="keywordtype">double</span> arMin = belt-&gt;<a class="code" href="classRooStats_1_1ConfidenceBelt.html#ad465a9878549db5398cabbffb57ff7fb">GetAcceptanceRegionMax</a>(*tmpPoint);</div><div class="line">      <span class="keywordtype">double</span> poiVal = tmpPoint-&gt;<a class="code" href="classRooArgSet.html#a72568bf2b2726891810ba3b3e8251f0b">getRealValue</a>(firstPOI-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>());</div><div class="line">      histOfThresholds-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(poiVal, arMax);</div><div class="line">   }</div><div class="line">   histOfThresholds-&gt;<a class="code" href="classTH1.html#a89a5d8fc84154b504566f367ba8d0238">SetMinimum</a>(0);</div><div class="line">   histOfThresholds-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>Kyle Cranmer </dd></dl>

<p class="definition">Definition in file <a class="el" href="StandardFeldmanCousinsDemo_8C_source.html">StandardFeldmanCousinsDemo.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:27 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/unfold/testUnfold4.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_284875b6767095332f555c963e26f94e.html">unfold</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">testUnfold4.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__unfold.html">TUnfold tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/testUnfold4.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/testUnfold4.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  Test program for the class <a class="el" href="classTUnfoldSys.html" title="An algorithm to unfold distributions from detector to truth level, with background subtraction and pr...">TUnfoldSys</a>. </p>
<p>Simple toy tests of the <a class="el" href="classTUnfold.html" title="An algorithm to unfold distributions from detector to truth level. ">TUnfold</a> package</p>
<p>Pseudo data (5000 events) are unfolded into three components The unfolding is performed once without and once with area constraint</p>
<p>Ideally, the pulls may show that the result is biased if no constraint is applied. This is expected because the true data errors are not known, and instead the sqrt(data) errors are used.</p>
<div class="fragment"><div class="line"></div><div class="line">TUnfold version is V17.6</div><div class="line">toy iteration: 0</div><div class="line">toy iteration: 10</div><div class="line">toy iteration: 20</div><div class="line">toy iteration: 30</div><div class="line">toy iteration: 40</div><div class="line">toy iteration: 50</div><div class="line">toy iteration: 60</div><div class="line">toy iteration: 70</div><div class="line">toy iteration: 80</div><div class="line">toy iteration: 90</div><div class="line">toy iteration: 100</div><div class="line">toy iteration: 110</div><div class="line">toy iteration: 120</div><div class="line">toy iteration: 130</div><div class="line">toy iteration: 140</div><div class="line">toy iteration: 150</div><div class="line">toy iteration: 160</div><div class="line">toy iteration: 170</div><div class="line">toy iteration: 180</div><div class="line">toy iteration: 190</div><div class="line">toy iteration: 200</div><div class="line">toy iteration: 210</div><div class="line">toy iteration: 220</div><div class="line">toy iteration: 230</div><div class="line">toy iteration: 240</div><div class="line">toy iteration: 250</div><div class="line">toy iteration: 260</div><div class="line">toy iteration: 270</div><div class="line">toy iteration: 280</div><div class="line">toy iteration: 290</div><div class="line">toy iteration: 300</div><div class="line">toy iteration: 310</div><div class="line">toy iteration: 320</div><div class="line">toy iteration: 330</div><div class="line">toy iteration: 340</div><div class="line">toy iteration: 350</div><div class="line">toy iteration: 360</div><div class="line">toy iteration: 370</div><div class="line">toy iteration: 380</div><div class="line">toy iteration: 390</div><div class="line">toy iteration: 400</div><div class="line">toy iteration: 410</div><div class="line">toy iteration: 420</div><div class="line">toy iteration: 430</div><div class="line">toy iteration: 440</div><div class="line">toy iteration: 450</div><div class="line">toy iteration: 460</div><div class="line">toy iteration: 470</div><div class="line">toy iteration: 480</div><div class="line">toy iteration: 490</div><div class="line">toy iteration: 500</div><div class="line">toy iteration: 510</div><div class="line">toy iteration: 520</div><div class="line">toy iteration: 530</div><div class="line">toy iteration: 540</div><div class="line">toy iteration: 550</div><div class="line">toy iteration: 560</div><div class="line">toy iteration: 570</div><div class="line">toy iteration: 580</div><div class="line">toy iteration: 590</div><div class="line">toy iteration: 600</div><div class="line">toy iteration: 610</div><div class="line">toy iteration: 620</div><div class="line">toy iteration: 630</div><div class="line">toy iteration: 640</div><div class="line">toy iteration: 650</div><div class="line">toy iteration: 660</div><div class="line">toy iteration: 670</div><div class="line">toy iteration: 680</div><div class="line">toy iteration: 690</div><div class="line">toy iteration: 700</div><div class="line">toy iteration: 710</div><div class="line">toy iteration: 720</div><div class="line">toy iteration: 730</div><div class="line">toy iteration: 740</div><div class="line">toy iteration: 750</div><div class="line">toy iteration: 760</div><div class="line">toy iteration: 770</div><div class="line">toy iteration: 780</div><div class="line">toy iteration: 790</div><div class="line">toy iteration: 800</div><div class="line">toy iteration: 810</div><div class="line">toy iteration: 820</div><div class="line">toy iteration: 830</div><div class="line">toy iteration: 840</div><div class="line">toy iteration: 850</div><div class="line">toy iteration: 860</div><div class="line">toy iteration: 870</div><div class="line">toy iteration: 880</div><div class="line">toy iteration: 890</div><div class="line">toy iteration: 900</div><div class="line">toy iteration: 910</div><div class="line">toy iteration: 920</div><div class="line">toy iteration: 930</div><div class="line">toy iteration: 940</div><div class="line">toy iteration: 950</div><div class="line">toy iteration: 960</div><div class="line">toy iteration: 970</div><div class="line">toy iteration: 980</div><div class="line">toy iteration: 990</div><div class="line"> FCN=17.3145 FROM MIGRAD    STATUS=CONVERGED      59 CALLS          60 TOTAL</div><div class="line">                     EDM=1.33067e-10    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                   STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  Constant     1.53639e+02   6.05704e+00   1.02575e-02   3.01728e-06</div><div class="line">   2  Mean        -1.21390e-01   3.38684e-02   6.92568e-05  -1.72950e-05</div><div class="line">   3  Sigma        1.02094e+00   2.43696e-02   1.33049e-05   2.18204e-03</div><div class="line"> FCN=8.19808 FROM MIGRAD    STATUS=CONVERGED      59 CALLS          60 TOTAL</div><div class="line">                     EDM=6.85034e-10    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                   STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  Constant     1.49698e+02   5.79213e+00   7.06055e-03   3.51186e-06</div><div class="line">   2  Mean        -2.59551e-01   3.46939e-02   5.10123e-05   1.03984e-04</div><div class="line">   3  Sigma        1.05666e+00   2.43573e-02   9.38061e-06   5.79231e-03</div><div class="line"> FCN=59.2962 FROM MIGRAD    STATUS=CONVERGED      60 CALLS          61 TOTAL</div><div class="line">                     EDM=7.24941e-07    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                   STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  Constant     1.27750e+02   5.41128e+00   1.64364e-02  -2.21211e-04</div><div class="line">   2  Mean        -4.82115e-01   4.90259e-02   1.46715e-04  -1.83701e-02</div><div class="line">   3  Sigma        1.09744e+00   3.08576e-02   2.35052e-05  -1.11293e-01</div><div class="line"> FCN=24.0114 FROM MIGRAD    STATUS=CONVERGED      59 CALLS          60 TOTAL</div><div class="line">                     EDM=2.61634e-10    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                   STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  Constant     1.47374e+02   5.80099e+00   1.15432e-02  -2.73138e-06</div><div class="line">   2  Mean         1.89896e-01   3.51550e-02   8.46764e-05   2.01950e-04</div><div class="line">   3  Sigma        1.05773e+00   2.51629e-02   1.57038e-05  -3.21528e-03</div><div class="line"> FCN=17.3474 FROM MIGRAD    STATUS=CONVERGED      59 CALLS          60 TOTAL</div><div class="line">                     EDM=3.1205e-08    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                   STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  Constant     1.49983e+02   5.77488e+00   1.00379e-02  -3.84601e-05</div><div class="line">   2  Mean         2.01446e-01   3.42777e-02   7.12868e-05   3.82112e-03</div><div class="line">   3  Sigma        1.04383e+00   2.32937e-02   1.28346e-05  -3.31497e-02</div><div class="line"> FCN=66.0535 FROM MIGRAD    STATUS=CONVERGED      69 CALLS          70 TOTAL</div><div class="line">                     EDM=1.81969e-10    STRATEGY= 1      ERROR MATRIX ACCURATE </div><div class="line">  EXT PARAMETER                                   STEP         FIRST   </div><div class="line">  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE </div><div class="line">   1  Constant     1.24001e+02   5.38113e+00   1.68582e-02   3.09845e-06</div><div class="line">   2  Mean        -4.12797e-01   4.98370e-02   1.59404e-04  -2.92079e-04</div><div class="line">   3  Sigma        1.12618e+00   3.36751e-02   2.62795e-05  -5.54263e-04</div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="TMath_8h.html">TMath.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="TRandom3_8h.html">TRandom3.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="TFitter_8h.html">TFitter.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="TF1_8h.html">TF1.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="TStyle_8h.html">TStyle.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="TVector_8h.html">TVector.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="TGraph_8h.html">TGraph.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="TError_8h.html">TError.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TUnfoldDensity_8h.html">TUnfoldDensity.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"></div><div class="line"><a class="code" href="classTRandom.html">TRandom</a> *rnd=0;</div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> GenerateGenEvent(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nmax,<span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *probability) {</div><div class="line">   <span class="comment">// choose an integer random number in the range [0,nmax]</span></div><div class="line">   <span class="comment">//    (the generator level bin)</span></div><div class="line">   <span class="comment">// depending on the probabilities</span></div><div class="line">   <span class="comment">//   probability[0],probability[1],...probability[nmax-1]</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>=rnd-&gt;<a class="code" href="classTRandom.html#af504d4f838ab09eb48b7c252615563aa">Rndm</a>();</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=0;</div><div class="line">   <span class="keywordflow">while</span>((<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>&lt;nmax)&amp;&amp;(<a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>&gt;=probability[<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>])) {</div><div class="line">      <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a> -= probability[<a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>];</div><div class="line">      <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>++;</div><div class="line">   }</div><div class="line">   <span class="keywordflow">return</span> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>;</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> GenerateRecEvent(<span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *shapeParm) {</div><div class="line">   <span class="comment">// return a coordinate (the reconstructed variable)</span></div><div class="line">   <span class="comment">// depending on shapeParm[]</span></div><div class="line">   <span class="comment">//  shapeParm[0]: fraction of events with Gaussian distribution</span></div><div class="line">   <span class="comment">//  shapeParm[1]: mean of Gaussian</span></div><div class="line">   <span class="comment">//  shapeParm[2]: width of Gaussian</span></div><div class="line">   <span class="comment">//  (1-shapeParm[0]): fraction of events with flat distribution</span></div><div class="line">   <span class="comment">//  shapeParm[3]: minimum of flat component</span></div><div class="line">   <span class="comment">//  shapeParm[4]: maximum of flat component</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>=rnd-&gt;<a class="code" href="classTRandom.html#af504d4f838ab09eb48b7c252615563aa">Rndm</a>();</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>;</div><div class="line">   <span class="keywordflow">if</span>(<a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>&lt;shapeParm[0]) {</div><div class="line">      <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=rnd-&gt;<a class="code" href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">Gaus</a>(shapeParm[1],shapeParm[2]);</div><div class="line">   } <span class="keywordflow">else</span> {</div><div class="line">      <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>=rnd-&gt;<a class="code" href="classTRandom.html#af504d4f838ab09eb48b7c252615563aa">Rndm</a>()*(shapeParm[4]-shapeParm[3])+shapeParm[3];</div><div class="line">   }</div><div class="line">   <span class="keywordflow">return</span> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> testUnfold4(<span class="keywordtype">bool</span> printInfo = <span class="keyword">false</span>)</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// switch off printing Info messages</span></div><div class="line">   <span class="keywordflow">if</span> (!printInfo) <a class="code" href="TError_8h.html#ad79dd6699eb25a20c4f95d4f7a0b6407">gErrorIgnoreLevel</a> = <a class="code" href="TError_8h.html#a93dce12f8f28c55827b45f530a507281">kWarning</a>; </div><div class="line">   </div><div class="line">  <span class="comment">// switch on histogram errors</span></div><div class="line">  <a class="code" href="classTH1.html#a8cd3b44217c8fec1d74046ed2ac153c2">TH1::SetDefaultSumw2</a>();</div><div class="line"></div><div class="line">  <span class="comment">// random generator</span></div><div class="line">  rnd=<span class="keyword">new</span> <a class="code" href="classTRandom3.html">TRandom3</a>();</div><div class="line"></div><div class="line">  <span class="comment">// data and MC number of events</span></div><div class="line">  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <span class="keyword">const</span> nData0=    500.0;</div><div class="line">  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <span class="keyword">const</span> nMC0  =  50000.0;</div><div class="line"></div><div class="line">  <span class="comment">// Binning</span></div><div class="line">  <span class="comment">// reconstructed variable (0-10)</span></div><div class="line">  <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <span class="keyword">const</span> nDet=15;</div><div class="line">  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <span class="keyword">const</span> xminDet=0.0;</div><div class="line">  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <span class="keyword">const</span> xmaxDet=15.0;</div><div class="line"></div><div class="line">  <span class="comment">// signal binning (three shapes: 0,1,2)</span></div><div class="line">  <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <span class="keyword">const</span> nGen=3;</div><div class="line">  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <span class="keyword">const</span> xminGen=-0.5;</div><div class="line">  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <span class="keyword">const</span> xmaxGen= 2.5;</div><div class="line"></div><div class="line">  <span class="comment">// parameters</span></div><div class="line">  <span class="comment">// fraction of events per signal shape</span></div><div class="line">  <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> genFrac[]={0.3,0.6,0.1};</div><div class="line"></div><div class="line">  <span class="comment">// signal shapes</span></div><div class="line">  <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> genShape[][5]=</div><div class="line">     {{1.0,2.0,1.5,0.,15.},</div><div class="line">      {1.0,7.0,2.5,0.,15.},</div><div class="line">      {0.0,0.0,0.0,0.,15.}};</div><div class="line"></div><div class="line">  <span class="comment">// define DATA histograms</span></div><div class="line">  <span class="comment">// observed data distribution</span></div><div class="line">  <a class="code" href="classTH1D.html">TH1D</a> *histDetDATA=<span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;Yrec&quot;</span>,<span class="stringliteral">&quot;;DATA(Yrec)&quot;</span>,nDet,xminDet,xmaxDet);</div><div class="line"></div><div class="line">  <span class="comment">// define MC histograms</span></div><div class="line">  <span class="comment">// matrix of migrations</span></div><div class="line">  <a class="code" href="classTH2D.html">TH2D</a> *histGenDetMC=<span class="keyword">new</span> <a class="code" href="classTH2D.html">TH2D</a>(<span class="stringliteral">&quot;Yrec%Xgen&quot;</span>,<span class="stringliteral">&quot;MC(Xgen,Yrec)&quot;</span>,</div><div class="line">                              nGen,xminGen,xmaxGen,nDet,xminDet,xmaxDet);</div><div class="line"></div><div class="line">  <a class="code" href="classTH1D.html">TH1D</a> *histUnfold=<span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;Xgen&quot;</span>,<span class="stringliteral">&quot;;DATA(Xgen)&quot;</span>,nGen,xminGen,xmaxGen);</div><div class="line"></div><div class="line">  <a class="code" href="classTH1D.html">TH1D</a> **histPullNC=<span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>* [nGen];</div><div class="line">  <a class="code" href="classTH1D.html">TH1D</a> **histPullArea=<span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>* [nGen];</div><div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nGen;i++) {</div><div class="line">     histPullNC[i]=<span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<a class="code" href="classTString.html#ac34bbb89627e20624a416dfbb7a3db70">TString::Format</a>(<span class="stringliteral">&quot;PullNC%d&quot;</span>,i),<span class="stringliteral">&quot;pull&quot;</span>,15,-3.,3.);</div><div class="line">     histPullArea[i]=<span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<a class="code" href="classTString.html#ac34bbb89627e20624a416dfbb7a3db70">TString::Format</a>(<span class="stringliteral">&quot;PullArea%d&quot;</span>,i),<span class="stringliteral">&quot;pull&quot;</span>,15,-3.,3.);</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// this method is new in version 16 of TUnfold</span></div><div class="line">  cout&lt;&lt;<span class="stringliteral">&quot;TUnfold version is &quot;</span>&lt;&lt;<a class="code" href="classTUnfold.html#a4b9f6064b7d743689428861f511e6f2b">TUnfold::GetTUnfoldVersion</a>()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"></div><div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> itoy=0;itoy&lt;1000;itoy++) {</div><div class="line">     <span class="keywordflow">if</span>(!(itoy %10)) cout&lt;&lt;<span class="stringliteral">&quot;toy iteration: &quot;</span>&lt;&lt;itoy&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">     histDetDATA-&gt;<a class="code" href="classTH1D.html#a0e2aa2350d4c0cd7bbcaccb29bff8760">Reset</a>();</div><div class="line">     histGenDetMC-&gt;<a class="code" href="classTH2D.html#adc4578cc1b3344a3bfe9945a4212b348">Reset</a>();</div><div class="line"></div><div class="line">     <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nData=rnd-&gt;<a class="code" href="classTRandom.html#a1529ed28e6ce1230d135548460b12c19">Poisson</a>(nData0);</div><div class="line">     <span class="keywordflow">for</span>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i=0;i&lt;nData;i++) {</div><div class="line">        <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> iGen=GenerateGenEvent(nGen,genFrac);</div><div class="line">        <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> yObs=GenerateRecEvent(genShape[iGen]);</div><div class="line">        histDetDATA-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(yObs);</div><div class="line">     }</div><div class="line"></div><div class="line">     <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nMC=rnd-&gt;<a class="code" href="classTRandom.html#a1529ed28e6ce1230d135548460b12c19">Poisson</a>(nMC0);</div><div class="line">     <span class="keywordflow">for</span>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i=0;i&lt;nMC;i++) {</div><div class="line">        <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> iGen=GenerateGenEvent(nGen,genFrac);</div><div class="line">        <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> yObs=GenerateRecEvent(genShape[iGen]);</div><div class="line">        histGenDetMC-&gt;<a class="code" href="classTH2.html#a4cf5530929bd446be82148884d0d1fa3">Fill</a>(iGen,yObs);</div><div class="line">     }</div><div class="line">     <span class="comment">/* for(Int_t ix=0;ix&lt;=histGenDetMC-&gt;GetNbinsX()+1;ix++) {</span></div><div class="line"><span class="comment">        for(Int_t iy=0;iy&lt;=histGenDetMC-&gt;GetNbinsY()+1;iy++) {</span></div><div class="line"><span class="comment">           cout&lt;&lt;ix&lt;&lt;iy&lt;&lt;&quot; : &quot;&lt;&lt;histGenDetMC-&gt;GetBinContent(ix,iy)&lt;&lt;&quot;\n&quot;;</span></div><div class="line"><span class="comment">        }</span></div><div class="line"><span class="comment">        } */</span></div><div class="line">     <span class="comment">//========================</span></div><div class="line">     <span class="comment">// unfolding</span></div><div class="line"></div><div class="line">     <a class="code" href="classTUnfoldSys.html">TUnfoldSys</a> unfold(histGenDetMC,<a class="code" href="classTUnfold.html#adb3ade9e94eedc71e5258e1af589de62a87355f8fd856583a77487ed5cca69ce2">TUnfold::kHistMapOutputHoriz</a>,</div><div class="line">                       <a class="code" href="classTUnfold.html#a8dbac6b2a783e95f4dc008b7e0352ab9a6ba26a47d61030e58099147b79b99210">TUnfold::kRegModeSize</a>,<a class="code" href="classTUnfold.html#a728827089c781ef7ff3e03c25eed784aaef42221561cc7d677ae21219156730b3">TUnfold::kEConstraintNone</a>);</div><div class="line">     <span class="comment">// define the input vector (the measured data distribution)</span></div><div class="line">     unfold.SetInput(histDetDATA,0.0,1.0);</div><div class="line"></div><div class="line">     <span class="comment">// run the unfolding</span></div><div class="line">     unfold.ScanLcurve(50,0.,0.,0,0,0);</div><div class="line"></div><div class="line">     <span class="comment">// fill pull distributions without constraint</span></div><div class="line">     unfold.GetOutput(histUnfold);</div><div class="line"></div><div class="line">     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nGen;i++) {</div><div class="line">        histPullNC[i]-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>((histUnfold-&gt;<a class="code" href="classTH1.html#ac70dcb4082bd510f5aa3e6efeb043f39">GetBinContent</a>(i+1)-genFrac[i]*nData0)/</div><div class="line">                            histUnfold-&gt;<a class="code" href="classTH1.html#a3af6cc15ab6c2490428c9b691885d919">GetBinError</a>(i+1));</div><div class="line">     }</div><div class="line"></div><div class="line">     <span class="comment">// repeat unfolding on the same data, now with Area constraint</span></div><div class="line">     unfold.SetConstraint(<a class="code" href="classTUnfold.html#a728827089c781ef7ff3e03c25eed784aa0c6db965feefac22363aa92d8517f990">TUnfold::kEConstraintArea</a>);</div><div class="line"></div><div class="line">     <span class="comment">// run the unfolding</span></div><div class="line">     unfold.ScanLcurve(50,0.,0.,0,0,0);</div><div class="line"></div><div class="line">     <span class="comment">// fill pull distributions with constraint</span></div><div class="line">     unfold.GetOutput(histUnfold);</div><div class="line"></div><div class="line">     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nGen;i++) {</div><div class="line">        histPullArea[i]-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>((histUnfold-&gt;<a class="code" href="classTH1.html#ac70dcb4082bd510f5aa3e6efeb043f39">GetBinContent</a>(i+1)-genFrac[i]*nData0)/</div><div class="line">                            histUnfold-&gt;<a class="code" href="classTH1.html#a3af6cc15ab6c2490428c9b691885d919">GetBinError</a>(i+1));</div><div class="line">     }</div><div class="line"></div><div class="line">  }</div><div class="line">  <a class="code" href="classTCanvas.html">TCanvas</a> <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>;</div><div class="line">  <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>.Divide(3,2);</div><div class="line"></div><div class="line">  <a class="code" href="TStyle_8h.html#ace94cabdcf18c1e8a7856d8c3f388cfe">gStyle</a>-&gt;<a class="code" href="classTStyle.html#aedeb1d117d9f16af9f8ad430bf956d64">SetOptFit</a>(1111);</div><div class="line"></div><div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nGen;i++) {</div><div class="line">     <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>.cd(i+1);</div><div class="line">     histPullNC[i]-&gt;<a class="code" href="classTH1.html#a63eb028df86bc86c8e20c989eb23fb2a">Fit</a>(<span class="stringliteral">&quot;gaus&quot;</span>);</div><div class="line">     histPullNC[i]-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line">  }</div><div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nGen;i++) {</div><div class="line">     <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>.cd(i+4);</div><div class="line">     histPullArea[i]-&gt;<a class="code" href="classTH1.html#a63eb028df86bc86c8e20c989eb23fb2a">Fit</a>(<span class="stringliteral">&quot;gaus&quot;</span>);</div><div class="line">     histPullArea[i]-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line">  }</div><div class="line">  <a class="code" href="win32gdk_2src_2gifencode_8c.html#a606a386e5db616c66c8c8d932d23dc39">output</a>.SaveAs(<span class="stringliteral">&quot;testUnfold4.ps&quot;</span>);</div><div class="line">}</div></div><!-- fragment --><p><b>Version 17.6, in parallel to changes in <a class="el" href="classTUnfold.html" title="An algorithm to unfold distributions from detector to truth level. ">TUnfold</a></b></p>
<h4>History:</h4>
<ul>
<li>Version 17.5, in parallel to changes in <a class="el" href="classTUnfold.html" title="An algorithm to unfold distributions from detector to truth level. ">TUnfold</a></li>
<li>Version 17.4, in parallel to changes in <a class="el" href="classTUnfold.html" title="An algorithm to unfold distributions from detector to truth level. ">TUnfold</a></li>
<li>Version 17.3, in parallel to changes in <a class="el" href="classTUnfold.html" title="An algorithm to unfold distributions from detector to truth level. ">TUnfold</a></li>
<li>Version 17.2, in parallel to changes in <a class="el" href="classTUnfold.html" title="An algorithm to unfold distributions from detector to truth level. ">TUnfold</a></li>
<li>Version 17.1, in parallel to changes in <a class="el" href="classTUnfold.html" title="An algorithm to unfold distributions from detector to truth level. ">TUnfold</a></li>
<li>Version 16.1, parallel to changes in <a class="el" href="classTUnfold.html" title="An algorithm to unfold distributions from detector to truth level. ">TUnfold</a></li>
<li>Version 16.0, parallel to changes in <a class="el" href="classTUnfold.html" title="An algorithm to unfold distributions from detector to truth level. ">TUnfold</a></li>
<li>Version 15, use L-curve scan to scan the average correlation</li>
</ul>
<p>This file is part of <a class="el" href="classTUnfold.html" title="An algorithm to unfold distributions from detector to truth level. ">TUnfold</a>.</p>
<p><a class="el" href="classTUnfold.html" title="An algorithm to unfold distributions from detector to truth level. ">TUnfold</a> is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
<p><a class="el" href="classTUnfold.html" title="An algorithm to unfold distributions from detector to truth level. ">TUnfold</a> is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with <a class="el" href="classTUnfold.html" title="An algorithm to unfold distributions from detector to truth level. ">TUnfold</a>. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.</p>
<dl class="section author"><dt>Author</dt><dd>Stefan Schmitt DESY, 14.10.2008 </dd></dl>

<p class="definition">Definition in file <a class="el" href="testUnfold4_8C_source.html">testUnfold4.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:34 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

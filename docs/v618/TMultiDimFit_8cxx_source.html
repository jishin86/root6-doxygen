<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: hist/hist/src/TMultiDimFit.cxx Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8b9334156f3646fccf89e63b9869c7f9.html">hist</a></li><li class="navelem"><a class="el" href="dir_a75669761cd420cdb0e6cb084a91e897.html">hist</a></li><li class="navelem"><a class="el" href="dir_094a69ecc49b1dea368942997aba1fad.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TMultiDimFit.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="TMultiDimFit_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// @(#)root/hist:$Id$</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Author: Christian Holm Christensen 07/11/2000</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/** \class TMultiDimFit</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">    \ingroup Hist</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> Multidimensional Fits in ROOT.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> ## Overview</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> A common problem encountered in different fields of applied science is</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> to find an expression for one physical quantity in terms of several</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> others, which are directly measurable.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> An example in high energy physics is the evaluation of the momentum of</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> a charged particle from the observation of its trajectory in a magnetic</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> field.  The problem is to relate the momentum of the particle to the</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> observations, which may consists of positional measurements at</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> intervals along the particle trajectory.</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> The exact functional relationship between the measured quantities</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> (e.g., the space-points) and the dependent quantity (e.g., the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> momentum) is in general not known, but one possible way of solving the</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> problem, is to find an expression which reliably approximates the</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> dependence of the momentum on the observations.</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> This explicit function of the observations can be obtained by a</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> &lt;I&gt;least squares&lt;/I&gt; fitting procedure applied to a representative</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> sample of the data, for which the dependent quantity (e.g., momentum)</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> and the independent observations are known. The function can then be</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> used to compute the quantity of interest for new observations of the</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> independent variables.</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> This class &lt;TT&gt;TMultiDimFit&lt;/TT&gt; implements such a procedure in</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> ROOT. It is largely based on the CERNLIB MUDIFI package [2].</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> Though the basic concepts are still sound, and</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> therefore kept, a few implementation details have changed, and this</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> class can take advantage of MINUIT [4] to improve the errors</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> of the fitting, thanks to the class TMinuit.</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> In [5] and [6] H. Wind demonstrates the utility</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> of this procedure in the context of tracking, magnetic field</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> parameterisation, and so on. The outline of the method used in this</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> class is based on Winds discussion, and I refer these two excellents</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> text for more information.</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> And example of usage is given in multidimfit.C.</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> ## The Method</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> Let \f$ D \f$ by the dependent quantity of interest, which depends smoothly</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> on the observable quantities \f$ x_1, \ldots, x_N \f$ which we&#39;ll denote by</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> \f$\mathbf{x}\f$. Given a training sample of \f$ M\f$ tuples of the form, (TMultiDimFit::AddRow)</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">     \left(\mathbf{x}_j, D_j, E_j\right)\quad,</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> where \f$\mathbf{x}_j = (x_{1,j},\ldots,x_{N,j})\f$ are \f$ N\f$ independent</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> variables, \f$ D_j\f$ is the known, quantity dependent at \f$\mathbf{x}_j\f$ and \f$ E_j\f$ is</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> the square error in \f$ D_j\f$, the class will try to find the parameterization</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">     D_p(\mathbf{x}) = \sum_{l=1}^{L} c_l \prod_{i=1}^{N} p_{li}\left(x_i\right)</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">     = \sum_{l=1}^{L} c_l F_l(\mathbf{x})</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> such that</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">     S \equiv \sum_{j=1}^{M} \left(D_j - D_p\left(\mathbf{x}_j\right)\right)^2</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> is minimal. Here \f$p_{li}(x_i)\f$ are monomials, or Chebyshev or Legendre</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> polynomials, labelled \f$l = 1, \ldots, L\f$, in each variable \f$ x_i\f$,\f$ i=1, \ldots, N\f$.</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> So what TMultiDimFit does, is to determine the number of terms \f$ L\f$, and then \f$ L\f$ terms</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> (or functions) \f$ F_l\f$, and the \f$ L\f$ coefficients \f$ c_l\f$, so that \f$ S\f$ is minimal</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"> (TMultiDimFit::FindParameterization).</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"> Of course it&#39;s more than a little unlikely that \f$ S\f$ will ever become</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"> exact zero as a result of the procedure outlined below. Therefore, the</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"> user is asked to provide a minimum relative error \f$ \epsilon\f$ (TMultiDimFit::SetMinRelativeError),</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"> and \f$ S\f$ will be considered minimized when</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">   R = \frac{S}{\sum_{j=1}^M D_j^2} &lt; \epsilon</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"> Optionally, the user may impose a functional expression by specifying</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"> the powers of each variable in \f$ L\f$ specified functions \f$ F_1, \ldots,F_L\f$ (TMultiDimFit::SetPowers).</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"> In that case, only the coefficients \f$ c_l\f$ is calculated by the class.</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"> ## Limiting the Number of Terms</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"> As always when dealing with fits, there&#39;s a real chance of *over fitting*. As is well-known, it&#39;s</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"> always possible to fit an \f$ N-1\f$ polynomial in \f$ x\f$ to \f$ N\f$ points \f$ (x,y)\f$ with</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"> \f$\chi^2 = 0\f$, but the polynomial is not likely to fit new data at all [1].</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"> Therefore, the user is asked to provide an upper limit, \f$ L_{max}\f$ to the number of terms in</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"> \f$ D_p\f$ (TMultiDimFit::SetMaxTerms).</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"> However, since there&#39;s an infinite number of \f$ F_l\f$ to choose from, the</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"> user is asked to give the maximum power. \f$ P_{max,i}\f$, of each variable</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> \f$ x_i\f$ to be considered in the minimization of \f$ S\f$ (TMultiDimFit::SetMaxPowers).</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"> One way of obtaining values for the maximum power in variable \f$ i\f$, is</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> to perform a regular fit to the dependent quantity \f$ D\f$, using a</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> polynomial only in \f$ x_i\f$. The maximum power is \f$ P_{max,i}\f$ is then the</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> power that does not significantly improve the one-dimensional</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"> least-square fit over \f$ x_i\f$ to \f$ D\f$ [5].</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"> There are still a huge amount of possible choices for \f$ F_l\f$; in fact</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"> there are \f$\prod_{i=1}^{N} (P_{max,i} + 1)\f$ possible</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"> choices. Obviously we need to limit this. To this end, the user is</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"> asked to set a *power control limit*, \f$ Q\f$ (TMultiDimFit::SetPowerLimit), and a function</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"> \f$ F_l\f$ is only accepted if</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">   Q_l = \sum_{i=1}^{N} \frac{P_{li}}{P_{max,i}} &lt; Q</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"> where \f$ P_{li}\f$ is the leading power of variable \f$ x_i\f$ in function \f$ F_l\f$ (TMultiDimFit::MakeCandidates).</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> So the number of functions increase with \f$ Q\f$ (1, 2 is fine, 5 is way out).</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"> ## Gram-Schmidt Orthogonalisation&lt;/A&gt;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"> To further reduce the number of functions in the final expression,</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"> only those functions that significantly reduce \f$ S\f$ is chosen. What</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"> `significant&#39; means, is chosen by the user, and will be</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> discussed below (see [2.3](TMultiFimFit.html#sec:selectiondetail)).</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"> The functions \f$ F_l\f$ are generally not orthogonal, which means one will</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"> have to evaluate all possible \f$ F_l\f$&#39;s over all data-points before</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"> finding the most significant [1]. We can, however, do</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> better then that. By applying the *modified Gram-Schmidt</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> orthogonalisation* algorithm [5] [3] to the</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"> functions \f$ F_l\f$, we can evaluate the contribution to the reduction of</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"> \f$ S\f$ from each function in turn, and we may delay the actual inversion</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> of the curvature-matrix (TMultiDimFit::MakeGramSchmidt).</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"> So we are let to consider an \f$ M\times L\f$ matrix \f$\mathsf{F}\f$, an</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"> element of which is given by</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">   f_{jl} = F_j\left(x_{1j} , x_{2j}, \ldots, x_{Nj}\right)</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">   = F_l(\mathbf{x}_j)\,  \quad\mbox{with}~j=1,2,\ldots,M,</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"> where \f$ j\f$ labels the \f$ M\f$ rows in the training sample and \f$ l\f$ labels</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> \f$ L\f$ functions of \f$ N\f$ variables, and \f$ L \leq M\f$. That is, \f$ f_{jl}\f$ is</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> the term (or function) numbered \f$ l\f$ evaluated at the data point</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"> \f$ j\f$. We have to normalise \f$\mathbf{x}_j\f$ to \f$ [-1,1]\f$ for this to</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"> succeed [5] (TMultiDimFit::MakeNormalized). We then define a</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"> matrix \f$\mathsf{W}\f$ of which the columns \f$\mathbf{w}_j\f$ are given by</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"> \f{eqnarray*}{</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">   \mathbf{w}_1 &amp;=&amp; \mathbf{f}_1 = F_1\left(\mathbf x_1\right)\\</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">   \mathbf{w}_l &amp;=&amp; \mathbf{f}_l - \sum^{l-1}_{k=1} \frac{\mathbf{f}_l \bullet</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">   \mathbf{w}_k}{\mathbf{w}_k^2}\mathbf{w}_k\,.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"> \f}</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> and \f$\mathbf{w}_{l}\f$ is the component of \f$\mathbf{f}_{l} \f$ orthogonal</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"> to \f$\mathbf{w}_{1}, \ldots, \mathbf{w}_{l-1}\f$. Hence we obtain [3],</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">   \mathbf{w}_k\bullet\mathbf{w}_l = 0\quad\mbox{if}~k \neq l\quad.</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> We now take as a new model \f$\mathsf{W}\mathbf{a}\f$. We thus want to</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> minimize</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">   S\equiv \left(\mathbf{D} - \mathsf{W}\mathbf{a}\right)^2\quad,</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"> where \f$\mathbf{D} = \left(D_1,\ldots,D_M\right)\f$ is a vector of the</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"> dependent quantity in the sample. Differentiation with respect to</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"> \f$ a_j\f$ gives, using [6], &lt;a name=&quot;eq:dS2&quot;&gt;&lt;/a&gt;</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">   \mathbf{D}\bullet\mathbf{w}_l - a_l\mathbf{w}_l^2 = 0</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"> or</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">   a_l = \frac{\mathbf{D}_l\bullet\mathbf{w}_l}{\mathbf{w}_l^2}</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> Let \f$ S_j\f$ be the sum of squares of residuals when taking \f$ j\f$ functions</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> into account. Then</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">   S_l = \left[\mathbf{D} - \sum^l_{k=1} a_k\mathbf{w}_k\right]^2</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">   = \mathbf{D}^2 - 2\mathbf{D} \sum^l_{k=1} a_k\mathbf{w}_k</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">   + \sum^l_{k=1} a_k^2\mathbf{w}_k^2</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"> Using [9], we see that</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"> \f{eqnarray*}{</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">   S_l &amp;=&amp; \mathbf{D}^2 - 2 \sum^l_{k=1} a_k^2\mathbf{w}_k^2 +</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">   \sum^j_{k=1} a_k^2\mathbf{w}_k^2\nonumber\\</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">   &amp;=&amp; \mathbf{D}^2 - \sum^l_{k=1} a_k^2\mathbf{w}_k^2\nonumber\\</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">   &amp;=&amp; \mathbf{D}^2 - \sum^l_{k=1} \frac{\left(\mathbf D\bullet \mathbf</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">   w_k\right)}{\mathbf w_k^2}</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> \f}</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"> So for each new function \f$ F_l\f$ included in the model, we get a</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> reduction of the sum of squares of residuals of \f$a_l^2\mathbf{w}_l^2\f$,</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> where \f$\mathbf{w}_l\f$ is given by [4] and \f$ a_l\f$ by [9]. Thus, using</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> the Gram-Schmidt orthogonalisation, we</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"> can decide if we want to include this function in the final model,</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> *before* the matrix inversion.</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"> ## Function Selection Based on Residual</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> Supposing that \f$ L-1\f$ steps of the procedure have been performed, the</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"> problem now is to consider the \f$L^{\mbox{th}}\f$ function.</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> The sum of squares of residuals can be written as</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">   S_L = \textbf{D}^T\bullet\textbf{D} -</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">   \sum^L_{l=1}a^2_l\left(\textbf{w}_l^T\bullet\textbf{w}_l\right)</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> where the relation [9] have been taken into account. The</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"> contribution of the \f$L^{\mbox{th}}\f$ function to the reduction of S, is</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"> given by</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">   \Delta S_L = a^2_L\left(\textbf{w}_L^T\bullet\textbf{w}_L\right)</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"> Two test are now applied to decide whether this \f$L^{\mbox{th}}\f$</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"> function is to be included in the final expression, or not.</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"> ## Test 1</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"> Denoting by \f$ H_{L-1}\f$ the subspace spanned by \f$\textbf{w}_1,\ldots,\textbf{w}_{L-1}\f$</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> the function \d$\textbf{w}_L\d$ is by construction (see 4) the projection of the function</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> \f$ F_L\f$ onto the direction perpendicular to \f$ H_{L-1}\f$. Now, if the</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> length of \f$\textbf{w}_L\f$ (given by \f$\textbf{w}_L\bullet\textbf{w}_L\f$)</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> is very small compared to the length of \f$\textbf{f}_L\f$ this new</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"> function can not contribute much to the reduction of the sum of</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"> squares of residuals. The test consists then in calculating the angle</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"> \f$ \theta \f$ between the two vectors \f$\textbf{w}_L\f$ \f$ \textbf {f}_L\f$</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"> (see also figure 1) and requiring that it&#39;s</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"> *greater* then a threshold value which the user must set (TMultiDimFit::SetMinAngle).</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"> \image html multidimfit_img86.gif &quot;Figure 1: (a) angle \f$\theta\f$ between \f$\textbf{w}_l\f$ and \f$\textbf{f}_L\f$, (b) angle \f$ \phi \f$ between \f$\textbf{w}_L\f$ and \f$\textbf{D}\f$&quot;</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"> ## Test 2</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"> Let \f$\textbf{D}\f$ be the data vector to be fitted. As illustrated in</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"> figure 1, the \f$L^{\mbox{th}}\f$ function \f$\textbf{w}_L\f$</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment"> will contribute significantly to the reduction of \f$ S\f$, if the angle</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"> \f$\phi^\prime\f$ between \f$\textbf{w}_L\f$ and \f$\textbf{D}\f$ is smaller than</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"> an upper limit \f$ \phi \f$, defined by the user (MultiDimFit::SetMaxAngle)</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"> However, the method automatically readjusts the value of this angle</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"> while fitting is in progress, in order to make the selection criteria</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"> less and less difficult to be fulfilled. The result is that the</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"> functions contributing most to the reduction of \f$ S\f$ are chosen first</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"> (TMultiDimFit::TestFunction).</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"> In case \f$ \phi \f$ isn&#39;t defined, an alternative method of</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"> performing this second test is used: The \f$L^{\mbox{th}}\f$</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"> function \f$\textbf{f}_L\f$ is accepted if (refer also to equation (13))</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">   \Delta S_L &gt; \frac{S_{L-1}}{L_{max}-L}</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"> where  \f$ S_{L-1}\f$ is the sum of the \f$ L-1\f$ first residuals from the</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"> \f$ L-1\f$ functions previously accepted; and \f$ L_{max}\f$ is the total number</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"> of functions allowed in the final expression of the fit (defined by</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment"> user).</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"> From this we see, that by restricting \f$ L_{max}\f$ -- the number of</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"> terms in the final model -- the fit is more difficult to perform,</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"> since the above selection criteria is more limiting.</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"> The more coefficients we evaluate, the more the sum of squares of</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"> residuals \f$ S\f$ will be reduced. We can evaluate \f$ S\f$ before inverting</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"> \f$\mathsf{B}\f$ as shown below.</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"> ## Coefficients and Coefficient Errors</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"> Having found a parameterization, that is the \f$ F_l\f$&#39;s and \f$ L\f$, that</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"> minimizes \f$ S\f$, we still need to determine the coefficients</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"> \f$ c_l\f$. However, it&#39;s a feature of how we choose the significant</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"> functions, that the evaluation of the \f$ c_l\f$&#39;s becomes trivial [5]. To derive</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"> \f$\mathbf{c}\f$, we first note that</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"> equation (4) can be written as</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">   \mathsf{F} = \mathsf{W}\mathsf{B}</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"> where</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"> \f{eqnarray*}{</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">   b_{ij} = \frac{\mathbf{f}_j \bullet \mathbf{w}_i}{\mathbf{w}_i^2}</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">     &amp; \mbox{if} &amp; i &lt; j\\</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">   1 &amp; \mbox{if} &amp; i = j\\</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">   0 &amp; \mbox{if} &amp; i &gt; j</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"> \f}</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"> Consequently, \f$\mathsf{B}\f$ is an upper triangle matrix, which can be</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"> readily inverted. So we now evaluate</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">   \mathsf{F}\mathsf{B}^{-1} = \mathsf{W}</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"> The model \f$\mathsf{W}\mathbf{a}\f$ can therefore be written as</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"> \f$(\mathsf{F}\mathsf{B}^{-1})\mathbf{a} = \mathsf{F}(\mathsf{B}^{-1}\mathbf{a})\,.\f$</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"> The original model \f$\mathsf{F}\mathbf{c}\f$ is therefore identical with</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"> this if</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">   \mathbf{c} = \left(\mathsf{B}^{-1}\mathbf{a}\right) =</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">   \left[\mathbf{a}^T\left(\mathsf{B}^{-1}\right)^T\right]^T\,.</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"> The reason we use \f$\left(\mathsf{B}^{-1}\right)^T\f$ rather then</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"> \f$\mathsf{B}^{-1}\f$ is to save storage, since \f$\left(\mathsf{B}^{-1}\right)^T\f$</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"> can be stored in the same matrix as \f$\mathsf{B}\f$ (TMultiDimFit::MakeCoefficients).</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"> The errors in the coefficients is calculated by inverting the curvature matrix</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"> of the non-orthogonal functions \f$ f_{lj}\f$ [1] (TMultiDimFit::MakeCoefficientErrors).</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"> ## Considerations</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"> It&#39;s important to realize that the training sample should be</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"> representative of the problem at hand, in particular along the borders</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"> of the region of interest. This is because the algorithm presented</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"> here, is a *interpolation*, rather then a *extrapolation* [5].</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"> Also, the independent variables \f$ x_{i}\f$ need to be linear</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"> independent, since the procedure will perform poorly if they are not</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"> [5]. One can find an linear transformation from ones</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"> original variables \f$ \xi_{i}\f$ to a set of linear independent variables</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"> \f$ x_{i}\f$, using a *Principal Components Analysis* (see TPrincipal), and</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"> then use the transformed variable as input to this class [5] [6].</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"> H. Wind also outlines a method for parameterising a multidimensional</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"> dependence over a multidimensional set of variables. An example</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"> of the method from [5], is a follows (please refer to</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"> [5] for a full discussion):</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"> 1. Define \f$\mathbf{P} = (P_1, \ldots, P_5)\f$ are the 5 dependent</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"> quantities that define a track.</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"> 2. Compute, for \f$ M\f$ different values of \f$\mathbf{P}\f$, the tracks</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"> through the magnetic field, and determine the corresponding</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"> \f$\mathbf{x} = (x_1, \ldots, x_N)\f$.</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"> 3. Use the simulated observations to determine, with a simple</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"> approximation, the values of \f$\mathbf{P}_j\f$. We call these values</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"> \f$\mathbf{P}^\prime_j, j = 1, \ldots, M\f$.</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"> 4. Determine from \f$\mathbf{x}\f$ a set of at least five relevant</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"> coordinates \f$\mathbf{x}^\prime\f$, using contrains, *or</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"> alternative:*</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"> 5. Perform a Principal Component Analysis (using TPrincipal), and use</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"> to get a linear transformation \f$\mathbf{x} \rightarrow \mathbf{x}^\prime\f$, so that</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"> \f$\mathbf{x}^\prime\f$ are constrained and linear independent.</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"> 6. Perform a Principal Component Analysis on</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"> \f$Q_i = P_i / P^\prime_i\, i = 1, \ldots, 5\f$, to get linear</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"> indenpendent (among themselves, but not independent of \f$\mathbf{x}\f$) quantities</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"> \f$\mathbf{Q}^\prime\f$</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"> 7. For each component \f$Q^\prime_i\f$ make a multidimensional fit,</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"> using \f$\mathbf{x}^\prime\f$ as the variables, thus determining a set of</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"> coefficients \f$\mathbf{c}_i\f$.</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"> To process data, using this parameterisation, do</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"> 1. Test wether the observation \f$\mathbf{x}\f$ within the domain of</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"> the parameterization, using the result from the Principal Component</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"> Analysis.</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"> 2. Determine \f$\mathbf{P}^\prime\f$ as before.</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"> 3. Determine \f$\mathbf{x}^\prime\f$ as before.</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"> 4. Use the result of the fit to determine \f$\mathbf{Q}^\prime\f$.</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"> 5. Transform back to \f$\mathbf{P}\f$ from \f$\mathbf{Q}^\prime\f$, using</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"> the result from the Principal Component Analysis.</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"> ## Testing the parameterization</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"> The class also provides functionality for testing the, over the</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"> training sample, found parameterization (TMultiDimFit::Fit). This is done by passing</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"> the class a test sample of \f$ M_t\f$ tuples of the form</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"> \f$(\mathbf{x}_{t,j},D_{t,j}, E_{t,j})\f$, where \f$\mathbf{x}_{t,j}\f$ are the independent</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"> variables, \f$ D_{t,j}\f$ the known, dependent quantity, and \f$ E_{t,j}\f$ is</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"> the square error in \f$ D_{t,j}\f$ (TMultiDimFit::AddTestRow).</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"> The parameterization is then evaluated at every \f$\mathbf{x}_t\f$ in the</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"> test sample, and</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">   S_t \equiv \sum_{j=1}^{M_t} \left(D_{t,j} -</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">   D_p\left(\mathbf{x}_{t,j}\right)\right)^2</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"> is evaluated. The relative error over the test sample</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"> \f[</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">   R_t = \frac{S_t}{\sum_{j=1}^{M_t} D_{t,j}^2}</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"> \f]</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"> should not be to low or high compared to \f$ R\f$ from the training</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"> sample. Also, multiple correlation coefficient from both samples should</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"> be fairly close, otherwise one of the samples is not representative of</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"> the problem. A large difference in the reduced \f$ \chi^2\f$ over the two</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"> samples indicate an over fit, and the maximum number of terms in the</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"> parameterisation should be reduced.</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"> It&#39;s possible to use [4] to further improve the fit, using the test sample.</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"> Christian Holm</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment"> ## Bibliography</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment"> - &lt;a name=&quot;bevington&quot;&gt;&lt;/a&gt; Philip R. Bevington and D. Keith Robinson. *Data Reduction and Error Analysis for</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">   the Physical Sciences*. McGraw-Hill, 2 edition, 1992.</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"> - &lt;a name=&quot;mudifi&quot;&gt;&lt;/a&gt; R. Brun et al. *Long writeup DD/75-23*, CERN, 1980.</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"> - Gene H. Golub and Charles F. van Loan. *Matrix Computations*.</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">   John Hopkins University Press, Baltimore, 3 edition, 1996.</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"> - &lt;a name=&quot;minuit&quot;&gt;&lt;/a&gt;F. James. *Minuit*. Long writeup D506, CERN, 1998.</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"> - &lt;a name=&quot;wind72&quot;&gt;&lt;/a&gt;H. Wind. *Function parameterization*. Proceedings of the 1972 CERN Computing and Data Processing</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">   School, volume 72-21 of Yellow report. CERN, 1972.</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"> - &lt;a name=&quot;wind81&quot;&gt;&lt;/a&gt;H. Wind. 1. principal component analysis, 2. pattern recognition for track</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">   finding, 3. interpolation and functional representation. Yellow report EP/81-12, CERN, 1981.</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">[1]: classTMultiDimFit.html#bevington</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">[2]: classTMultiDimFit.html#mudifi</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">[4]: classTMultiDimFit.html#minuit</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">[5]: classTMultiDimFit.html#wind72</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">[6]: classTMultiDimFit.html#wind81</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">[9]: classTMultiDimFit.html#eq:dS2</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Riostream_8h.html">Riostream.h</a>&quot;</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TMultiDimFit_8h.html">TMultiDimFit.h</a>&quot;</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TMath_8h.html">TMath.h</a>&quot;</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TH1_8h.html">TH1.h</a>&quot;</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TH2_8h.html">TH2.h</a>&quot;</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TROOT_8h.html">TROOT.h</a>&quot;</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TBrowser_8h.html">TBrowser.h</a>&quot;</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TDecompChol_8h.html">TDecompChol.h</a>&quot;</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#a317ddc7f65b58a5dac1767a77d6755c5">  398</a></span>&#160;<span class="preprocessor">#define RADDEG (180. / TMath::Pi())</span></div><div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#ac377a5fa64fdef02d0048cf0e27aca2c">  399</a></span>&#160;<span class="preprocessor">#define DEGRAD (TMath::Pi() / 180.)</span></div><div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#a5ab555f0b173febdb3ee3e426ab261a0">  400</a></span>&#160;<span class="preprocessor">#define HIST_XORIG     0</span></div><div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#a197a8cb6c7980161c743d7406270956f">  401</a></span>&#160;<span class="preprocessor">#define HIST_DORIG     1</span></div><div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#a1d1ed449317205baf4318315bec57474">  402</a></span>&#160;<span class="preprocessor">#define HIST_XNORM     2</span></div><div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#a02c88c0b6d9d5d3086ceca952d079aed">  403</a></span>&#160;<span class="preprocessor">#define HIST_DSHIF     3</span></div><div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#a280cd1275ebe4292c7e05c62740e5b3f">  404</a></span>&#160;<span class="preprocessor">#define HIST_RX        4</span></div><div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#ae026def51d4bb2970016a9150e817378">  405</a></span>&#160;<span class="preprocessor">#define HIST_RD        5</span></div><div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#ad15c4be1d09512b8b100f4d97ff13e09">  406</a></span>&#160;<span class="preprocessor">#define HIST_RTRAI     6</span></div><div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#abc53d6530eb580057e12ecb5b4e88b48">  407</a></span>&#160;<span class="preprocessor">#define HIST_RTEST     7</span></div><div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#a634868703c8cc999d06cff35a8a289fc">  408</a></span>&#160;<span class="preprocessor">#define PARAM_MAXSTUDY 1</span></div><div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#a5bab3ed8bd37031d95ed6e105c4cfa8d">  409</a></span>&#160;<span class="preprocessor">#define PARAM_SEVERAL  2</span></div><div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#a1843561a29ec05879992dc840caf4221">  410</a></span>&#160;<span class="preprocessor">#define PARAM_RELERR   3</span></div><div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#af90c111e0b8dbee3646b0a50da904c7d">  411</a></span>&#160;<span class="preprocessor">#define PARAM_MAXTERMS 4</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="TMultiDimFit_8cxx.html#a8cfcdcd0945476639dfb907c6aafafa1">mdfHelper</a>(<span class="keywordtype">int</span>&amp;, <span class="keywordtype">double</span>*, <span class="keywordtype">double</span>&amp;, <span class="keywordtype">double</span>*, <span class="keywordtype">int</span>);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<a class="code" href="Rtypes_8h.html#a3f9bf160bbbb44209e95556960836b96">ClassImp</a>(<a class="code" href="classTMultiDimFit.html">TMultiDimFit</a>);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">//____________________________________________________________________</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">// Static instance. Used with mdfHelper and TMinuit</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<a class="code" href="classTMultiDimFit.html">TMultiDimFit</a>* <a class="code" href="classTMultiDimFit.html#aedb4a6da4070e3c88c84d14a096b061b">TMultiDimFit::fgInstance</a> = 0;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">/// Empty CTOR. Do not use</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a9b7e0799259eafefb688ec173c1dee78">  430</a></span>&#160;<a class="code" href="classTMultiDimFit.html#a9b7e0799259eafefb688ec173c1dee78">TMultiDimFit::TMultiDimFit</a>()</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;{</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>           = 0;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a>            = 0;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   <a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a>            = 0;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   <a class="code" href="classTMultiDimFit.html#a353ebfbe3b6be4608608a1891319f235">fSumSqQuantity</a>          = 0;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   <a class="code" href="classTMultiDimFit.html#a482dd2926682899a1c2eadc5448fa68a">fSumSqAvgQuantity</a>       = 0;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;   <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>             = 0;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;   <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>             = 0;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   <a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a>         = 0;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <a class="code" href="classTMultiDimFit.html#aa04e50147be5c9a8d9040e3b826c75f8">fMinAngle</a>               = 1;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   <a class="code" href="classTMultiDimFit.html#a9957717d755bac7da27236ca52a5af6b">fMaxAngle</a>               = 0;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   <a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a>               = 0;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   <a class="code" href="classTMultiDimFit.html#afc80a4fe1f39eb2124bffbc4029484cc">fMinRelativeError</a>       = 0;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   <a class="code" href="classTMultiDimFit.html#a54aaace3db3ff52251aa408a30f2a3e6">fMaxPowers</a>              = 0;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <a class="code" href="classTMultiDimFit.html#aea2ee066fdfc04b3bd1797aaf154d52c">fPowerLimit</a>             = 0;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>           = 0;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   <a class="code" href="classTMultiDimFit.html#afd6da56fd072b4d48a656001ae080e71">fFunctionCodes</a>          = 0;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   <a class="code" href="classTMultiDimFit.html#a56a33cdba3c529818b7f8407813bab18">fMaxStudy</a>               = 0;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <a class="code" href="classTMultiDimFit.html#af6ebf85c4647ea94d84a3fee7ba4dc51">fMaxFuncNV</a>              = 0;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <a class="code" href="classTMultiDimFit.html#a8868c2f37dc91673d7fe3be00bcb5eae">fMaxPowersFinal</a>         = 0;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>                 = 0;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;   <a class="code" href="classTMultiDimFit.html#ab1c8c0801040a8ba1d7fefdf107a289d">fPowerIndex</a>             = 0;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac95cb9370c928be136efbaec080195b9">fMaxResidual</a>            = 0;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   <a class="code" href="classTMultiDimFit.html#a6a131a8d119f37edf5ac7ac4b764b211">fMinResidual</a>            = 0;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   <a class="code" href="classTMultiDimFit.html#a2ba24cef5173b7bc5f55c25d57f95335">fMaxResidualRow</a>         = 0;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   <a class="code" href="classTMultiDimFit.html#a89082db5af59a8001f1f17da93cd1975">fMinResidualRow</a>         = 0;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   <a class="code" href="classTMultiDimFit.html#aa155aa11e0a5891ddd5678e2c0b6e0a8">fSumSqResidual</a>          = 0;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;   <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>          = 0;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   <a class="code" href="classTMultiDimFit.html#a915f6ba6a911fc155d32ff94d2c5ed90">fRMS</a>                    = 0;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac94c103fb73cd4eb775375271c74becc">fChi2</a>                   = 0;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   <a class="code" href="classTMultiDimFit.html#a969d67752c326e4456832e00ba6464f3">fParameterisationCode</a>   = 0;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac9cc5e457015ce9f569e0c2e865d8ecf">fError</a>                  = 0;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <a class="code" href="classTMultiDimFit.html#a68dd2aecfd779ec22b1dfe8a0f3923e8">fTestError</a>              = 0;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <a class="code" href="classTMultiDimFit.html#a0ccafce2b1e34938ca21f8380f44c42d">fPrecision</a>              = 0;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   <a class="code" href="classTMultiDimFit.html#aad4535d5041352b9ce1e556da6c499bf">fTestPrecision</a>          = 0;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <a class="code" href="classTMultiDimFit.html#a85678efb97e963279c31d60cd4591ce0">fCorrelationCoeff</a>       = 0;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   <a class="code" href="classTMultiDimFit.html#a9e7f168a0f08032f4f45184af3cc0019">fTestCorrelationCoeff</a>   = 0;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>             = 0;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   <a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>          = 0;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <a class="code" href="classTMultiDimFit.html#acfcf45d7b310b62d46f9908aaa7a38dc">fBinVarX</a>                = 100;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   <a class="code" href="classTMultiDimFit.html#a5b4d1c29886a160d7c10e10fedd8f23b">fBinVarY</a>                = 100;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   <a class="code" href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">fFitter</a>                 = 0;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   <a class="code" href="classTMultiDimFit.html#abdab5d9509890288a37712774a5f61ed">fPolyType</a>               = <a class="code" href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152ea01c4c4c755c598880447ca3ce72b0950">kMonomials</a>;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;   <a class="code" href="classTMultiDimFit.html#a1fa5c6ef9f25b28a1b86f1f370ba55dd">fShowCorrelation</a>        = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   <a class="code" href="classTMultiDimFit.html#a20cc6137d3c71256a9833f98f3a202c5">fIsUserFunction</a>         = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   <a class="code" href="classTMultiDimFit.html#af689396ca31f81ddcf49870cce1779c9">fIsVerbose</a>              = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;}</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">/// Constructor</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">/// Second argument is the type of polynomials to use in</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">/// parameterisation, one of:</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">///      TMultiDimFit::kMonomials</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">///      TMultiDimFit::kChebyshev</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">///      TMultiDimFit::kLegendre</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">/// Options:</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">///   K      Compute (k)correlation matrix</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">///   V      Be verbose</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">/// Default is no options.</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#ae7ff87b7c44f9938af5c082ece98a6cd">  505</a></span>&#160;<a class="code" href="classTMultiDimFit.html#a9b7e0799259eafefb688ec173c1dee78">TMultiDimFit::TMultiDimFit</a>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> dimension,</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                           <a class="code" href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152e">EMDFPolyType</a> <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>,</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                           <a class="code" href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a> *option)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;: <a class="code" href="classTNamed.html">TNamed</a>(<span class="stringliteral">&quot;multidimfit&quot;</span>,<span class="stringliteral">&quot;Multi-dimensional fit object&quot;</span>),</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;fQuantity(dimension),</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;fSqError(dimension),</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;fVariables(dimension*100),</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;fMeanVariables(dimension),</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;fMaxVariables(dimension),</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;fMinVariables(dimension)</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;{</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   <a class="code" href="classTMultiDimFit.html#aedb4a6da4070e3c88c84d14a096b061b">fgInstance</a> = <span class="keyword">this</span>;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>           = 0;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a>            = 0;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;   <a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a>            = 0;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   <a class="code" href="classTMultiDimFit.html#a353ebfbe3b6be4608608a1891319f235">fSumSqQuantity</a>          = 0;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   <a class="code" href="classTMultiDimFit.html#a482dd2926682899a1c2eadc5448fa68a">fSumSqAvgQuantity</a>       = 0;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>             = dimension;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>             = 0;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a>         = 0;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   <a class="code" href="classTMultiDimFit.html#aa04e50147be5c9a8d9040e3b826c75f8">fMinAngle</a>               = 1;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   <a class="code" href="classTMultiDimFit.html#a9957717d755bac7da27236ca52a5af6b">fMaxAngle</a>               = 0;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   <a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a>               = 0;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;   <a class="code" href="classTMultiDimFit.html#afc80a4fe1f39eb2124bffbc4029484cc">fMinRelativeError</a>       = 0.01;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   <a class="code" href="classTMultiDimFit.html#a54aaace3db3ff52251aa408a30f2a3e6">fMaxPowers</a>              = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[dimension];</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   <a class="code" href="classTMultiDimFit.html#aea2ee066fdfc04b3bd1797aaf154d52c">fPowerLimit</a>             = 1;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>           = 0;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   <a class="code" href="classTMultiDimFit.html#afd6da56fd072b4d48a656001ae080e71">fFunctionCodes</a>          = 0;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   <a class="code" href="classTMultiDimFit.html#a56a33cdba3c529818b7f8407813bab18">fMaxStudy</a>               = 0;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   <a class="code" href="classTMultiDimFit.html#af6ebf85c4647ea94d84a3fee7ba4dc51">fMaxFuncNV</a>              = 0;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   <a class="code" href="classTMultiDimFit.html#a8868c2f37dc91673d7fe3be00bcb5eae">fMaxPowersFinal</a>         = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[dimension];</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>                 = 0;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   <a class="code" href="classTMultiDimFit.html#ab1c8c0801040a8ba1d7fefdf107a289d">fPowerIndex</a>             = 0;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac95cb9370c928be136efbaec080195b9">fMaxResidual</a>            = 0;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   <a class="code" href="classTMultiDimFit.html#a6a131a8d119f37edf5ac7ac4b764b211">fMinResidual</a>            = 0;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   <a class="code" href="classTMultiDimFit.html#a2ba24cef5173b7bc5f55c25d57f95335">fMaxResidualRow</a>         = 0;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <a class="code" href="classTMultiDimFit.html#a89082db5af59a8001f1f17da93cd1975">fMinResidualRow</a>         = 0;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <a class="code" href="classTMultiDimFit.html#aa155aa11e0a5891ddd5678e2c0b6e0a8">fSumSqResidual</a>          = 0;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>          = 0;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   <a class="code" href="classTMultiDimFit.html#a915f6ba6a911fc155d32ff94d2c5ed90">fRMS</a>                    = 0;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac94c103fb73cd4eb775375271c74becc">fChi2</a>                   = 0;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   <a class="code" href="classTMultiDimFit.html#a969d67752c326e4456832e00ba6464f3">fParameterisationCode</a>   = 0;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac9cc5e457015ce9f569e0c2e865d8ecf">fError</a>                  = 0;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   <a class="code" href="classTMultiDimFit.html#a68dd2aecfd779ec22b1dfe8a0f3923e8">fTestError</a>              = 0;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   <a class="code" href="classTMultiDimFit.html#a0ccafce2b1e34938ca21f8380f44c42d">fPrecision</a>              = 0;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;   <a class="code" href="classTMultiDimFit.html#aad4535d5041352b9ce1e556da6c499bf">fTestPrecision</a>          = 0;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   <a class="code" href="classTMultiDimFit.html#a85678efb97e963279c31d60cd4591ce0">fCorrelationCoeff</a>       = 0;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   <a class="code" href="classTMultiDimFit.html#a9e7f168a0f08032f4f45184af3cc0019">fTestCorrelationCoeff</a>   = 0;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>             = 0;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   <a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>          = 0;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   <a class="code" href="classTMultiDimFit.html#acfcf45d7b310b62d46f9908aaa7a38dc">fBinVarX</a>                = 100;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   <a class="code" href="classTMultiDimFit.html#a5b4d1c29886a160d7c10e10fedd8f23b">fBinVarY</a>                = 100;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   <a class="code" href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">fFitter</a>                 = 0;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   <a class="code" href="classTMultiDimFit.html#abdab5d9509890288a37712774a5f61ed">fPolyType</a>               = <a class="code" href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a>;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   <a class="code" href="classTMultiDimFit.html#a1fa5c6ef9f25b28a1b86f1f370ba55dd">fShowCorrelation</a>        = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   <a class="code" href="classTMultiDimFit.html#a20cc6137d3c71256a9833f98f3a202c5">fIsUserFunction</a>         = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <a class="code" href="classTMultiDimFit.html#af689396ca31f81ddcf49870cce1779c9">fIsVerbose</a>              = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   <a class="code" href="classTString.html">TString</a> opt             = option;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   opt.<a class="code" href="classTString.html#a1be9e2a41facebeac4feddd9801a0034">ToLower</a>();</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;k&quot;</span>)) <a class="code" href="classTMultiDimFit.html#a1fa5c6ef9f25b28a1b86f1f370ba55dd">fShowCorrelation</a> = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;v&quot;</span>)) <a class="code" href="classTMultiDimFit.html#af689396ca31f81ddcf49870cce1779c9">fIsVerbose</a>       = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;}</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">/// Destructor</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00583"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a62878aaa9a99e39e2bdbc1aca637efc1">  583</a></span>&#160;<a class="code" href="classTMultiDimFit.html#a62878aaa9a99e39e2bdbc1aca637efc1">TMultiDimFit::~TMultiDimFit</a>()</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;{</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   <span class="keyword">delete</span> [] <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   <span class="keyword">delete</span> [] <a class="code" href="classTMultiDimFit.html#a54aaace3db3ff52251aa408a30f2a3e6">fMaxPowers</a>;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   <span class="keyword">delete</span> [] <a class="code" href="classTMultiDimFit.html#a8868c2f37dc91673d7fe3be00bcb5eae">fMaxPowersFinal</a>;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   <span class="keyword">delete</span> [] <a class="code" href="classTMultiDimFit.html#ab1c8c0801040a8ba1d7fefdf107a289d">fPowerIndex</a>;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   <span class="keyword">delete</span> [] <a class="code" href="classTMultiDimFit.html#afd6da56fd072b4d48a656001ae080e71">fFunctionCodes</a>;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>) <a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#af4d5429298af281bdc7fe62b123f5385">Clear</a>(<span class="stringliteral">&quot;nodelete&quot;</span>);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <span class="keyword">delete</span> <a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;}</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">/// Add a row consisting of fNVariables independent variables, the</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">/// known, dependent quantity, and optionally, the square error in</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">/// the dependent quantity, to the training sample to be used for the</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">/// parameterization.</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">/// The mean of the variables and quantity is calculated on the fly,</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">/// as outlined in TPrincipal::AddRow.</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">/// This sample should be representative of the problem at hand.</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">/// Please note, that if no error is given Poisson statistics is</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">/// assumed and the square error is set to the value of dependent</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">/// quantity.  See also the</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00608"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a74720b6e5b76b417cf809cf57401ef3c">  608</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#a74720b6e5b76b417cf809cf57401ef3c">TMultiDimFit::AddRow</a>(<span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> D, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="namespaceTMath.html#a8a8fbe07e94608dbed9e9260283a442f">E</a>)</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;{</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>)</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <span class="keywordflow">if</span> (++<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a> == 1) {</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>  = D;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a>   = D;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a>   = D;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <a class="code" href="classTMultiDimFit.html#a353ebfbe3b6be4608608a1891319f235">fSumSqQuantity</a> = D * D;<span class="comment">// G.Q. erratum on August 15th, 2008</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>  *= 1 - 1./<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>(<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>  += D / <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>(<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <a class="code" href="classTMultiDimFit.html#a353ebfbe3b6be4608608a1891319f235">fSumSqQuantity</a> += D * D;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordflow">if</span> (D &gt;= <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a>) <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a> = D;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="keywordflow">if</span> (D &lt;= <a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a>) <a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a> = D;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   <span class="comment">// If the vector isn&#39;t big enough to hold the new data, then</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   <span class="comment">// expand the vector by half it&#39;s size.</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> size = <a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>.<a class="code" href="classTVectorT.html#a60abeb137f2db9084b6d5de5e40699bc">GetNrows</a>();</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a> &gt; size) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>.<a class="code" href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">ResizeTo</a>(size + size/2);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <a class="code" href="classTMultiDimFit.html#a743cd1b44fc3bf532385b750de395621">fSqError</a>.<a class="code" href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">ResizeTo</a>(size + size/2);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;   }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   <span class="comment">// Store the value</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;   <a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>(<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>-1) = D;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   <a class="code" href="classTMultiDimFit.html#a743cd1b44fc3bf532385b750de395621">fSqError</a>(<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>-1) = (<a class="code" href="namespaceTMath.html#a8a8fbe07e94608dbed9e9260283a442f">E</a> == 0 ? D : <a class="code" href="namespaceTMath.html#a8a8fbe07e94608dbed9e9260283a442f">E</a>);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   <span class="comment">// Store data point in internal vector</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   <span class="comment">// If the vector isn&#39;t big enough to hold the new data, then</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   <span class="comment">// expand the vector by half it&#39;s size</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   size = <a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>.<a class="code" href="classTVectorT.html#a60abeb137f2db9084b6d5de5e40699bc">GetNrows</a>();</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a> * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> &gt; size)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>.<a class="code" href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">ResizeTo</a>(size + size/2);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;   <span class="comment">// Increment the data point counter</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i,j;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++) {</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a> == 1) {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;         <a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>(i) = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i];</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;         <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(i)  = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i];</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;         <a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>(i)  = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i];</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;         <a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>(i) *= 1 - 1./<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>(<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;         <a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>(i) += <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i] / <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>(<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;         <span class="comment">// Update the maximum value for this component</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i] &gt;= <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(i)) <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(i)  = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i];</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;         <span class="comment">// Update the minimum value for this component</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i] &lt;= <a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>(i)) <a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>(i)  = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i];</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      }</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="comment">// Store the data.</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      j = (<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>-1) * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + i;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>(j) = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i];</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;}</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">/// Add a row consisting of fNVariables independent variables, the</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">/// known, dependent quantity, and optionally, the square error in</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">/// the dependent quantity, to the test sample to be used for the</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">/// test of the parameterization.</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">/// This sample needn&#39;t be representative of the problem at hand.</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">/// Please note, that if no error is given Poisson statistics is</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">/// assumed and the square error is set to the value of dependent</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">/// quantity.  See also the</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00687"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a963c212eef6e1910fd9fd2f3f05d4bdd">  687</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#a963c212eef6e1910fd9fd2f3f05d4bdd">TMultiDimFit::AddTestRow</a>(<span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> D, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="namespaceTMath.html#a8a8fbe07e94608dbed9e9260283a442f">E</a>)</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;{</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a>++ == 0) {</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <a class="code" href="classTMultiDimFit.html#a56a46526c239b3bb8677ecc95c9f1981">fTestQuantity</a>.<a class="code" href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">ResizeTo</a>(<a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <a class="code" href="classTMultiDimFit.html#a5749229ff5da4f6c8793c1930d441ef3">fTestSqError</a>.<a class="code" href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">ResizeTo</a>(<a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      <a class="code" href="classTMultiDimFit.html#a7ba2e7356f09f5cd1a9ee77bd238ec26">fTestVariables</a>.<a class="code" href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">ResizeTo</a>(<a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> * 100);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;   }</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   <span class="comment">// If the vector isn&#39;t big enough to hold the new data, then</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;   <span class="comment">// expand the vector by half it&#39;s size.</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> size = <a class="code" href="classTMultiDimFit.html#a56a46526c239b3bb8677ecc95c9f1981">fTestQuantity</a>.<a class="code" href="classTVectorT.html#a60abeb137f2db9084b6d5de5e40699bc">GetNrows</a>();</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a> &gt; size) {</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <a class="code" href="classTMultiDimFit.html#a56a46526c239b3bb8677ecc95c9f1981">fTestQuantity</a>.<a class="code" href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">ResizeTo</a>(size + size/2);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <a class="code" href="classTMultiDimFit.html#a5749229ff5da4f6c8793c1930d441ef3">fTestSqError</a>.<a class="code" href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">ResizeTo</a>(size + size/2);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   }</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   <span class="comment">// Store the value</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   <a class="code" href="classTMultiDimFit.html#a56a46526c239b3bb8677ecc95c9f1981">fTestQuantity</a>(<a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a>-1) = D;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <a class="code" href="classTMultiDimFit.html#a5749229ff5da4f6c8793c1930d441ef3">fTestSqError</a>(<a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a>-1) = (<a class="code" href="namespaceTMath.html#a8a8fbe07e94608dbed9e9260283a442f">E</a> == 0 ? D : <a class="code" href="namespaceTMath.html#a8a8fbe07e94608dbed9e9260283a442f">E</a>);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   <span class="comment">// Store data point in internal vector</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <span class="comment">// If the vector isn&#39;t big enough to hold the new data, then</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   <span class="comment">// expand the vector by half it&#39;s size</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   size = <a class="code" href="classTMultiDimFit.html#a7ba2e7356f09f5cd1a9ee77bd238ec26">fTestVariables</a>.<a class="code" href="classTVectorT.html#a60abeb137f2db9084b6d5de5e40699bc">GetNrows</a>();</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a> * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> &gt; size)</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <a class="code" href="classTMultiDimFit.html#a7ba2e7356f09f5cd1a9ee77bd238ec26">fTestVariables</a>.<a class="code" href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">ResizeTo</a>(size + size/2);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;   <span class="comment">// Increment the data point counter</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i,j;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++) {</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      j = <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> * (<a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a> - 1) + i;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <a class="code" href="classTMultiDimFit.html#a7ba2e7356f09f5cd1a9ee77bd238ec26">fTestVariables</a>(j) = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i];</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i] &gt; <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(i))</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;         <a class="code" href="classTObject.html#a75fddd7eef38a13c1374130ec7dc5cf8">Warning</a>(<span class="stringliteral">&quot;AddTestRow&quot;</span>, <span class="stringliteral">&quot;variable %d (row: %d) too large: %f &gt; %f&quot;</span>,</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                 i, <a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a>, <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i], <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(i));</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i] &lt; <a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>(i))</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;         <a class="code" href="classTObject.html#a75fddd7eef38a13c1374130ec7dc5cf8">Warning</a>(<span class="stringliteral">&quot;AddTestRow&quot;</span>, <span class="stringliteral">&quot;variable %d (row: %d) too small: %f &lt; %f&quot;</span>,</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                 i, <a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a>, <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i], <a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>(i));</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   }</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;}</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">/// Browse the TMultiDimFit object in the TBrowser.</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00734"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#ab95ddf228f66641893679f5680217eca">  734</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#ab95ddf228f66641893679f5680217eca">TMultiDimFit::Browse</a>(<a class="code" href="classTBrowser.html">TBrowser</a>* <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>)</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;{</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>) {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <a class="code" href="classTIter.html">TIter</a> next(<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <a class="code" href="classTH1.html">TH1</a>* <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> = 0;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="keywordflow">while</span> ((<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> = (<a class="code" href="classTH1.html">TH1</a>*)next()))</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;         <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>,<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>-&gt;GetName());</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;   }</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>.<a class="code" href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">IsValid</a>())</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>, <span class="stringliteral">&quot;Variables (Training)&quot;</span>);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>.<a class="code" href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">IsValid</a>())</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>, <span class="stringliteral">&quot;Quantity (Training)&quot;</span>);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a743cd1b44fc3bf532385b750de395621">fSqError</a>.<a class="code" href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">IsValid</a>())</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#a743cd1b44fc3bf532385b750de395621">fSqError</a>, <span class="stringliteral">&quot;Error (Training)&quot;</span>);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>.<a class="code" href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">IsValid</a>())</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>, <span class="stringliteral">&quot;Mean of Variables (Training)&quot;</span>);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>.<a class="code" href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">IsValid</a>())</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>, <span class="stringliteral">&quot;Mean of Variables (Training)&quot;</span>);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>.<a class="code" href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">IsValid</a>())</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>, <span class="stringliteral">&quot;Min of Variables (Training)&quot;</span>);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a7ba2e7356f09f5cd1a9ee77bd238ec26">fTestVariables</a>.<a class="code" href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">IsValid</a>())</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#a7ba2e7356f09f5cd1a9ee77bd238ec26">fTestVariables</a>, <span class="stringliteral">&quot;Variables (Test)&quot;</span>);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a56a46526c239b3bb8677ecc95c9f1981">fTestQuantity</a>.<a class="code" href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">IsValid</a>())</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#a56a46526c239b3bb8677ecc95c9f1981">fTestQuantity</a>, <span class="stringliteral">&quot;Quantity (Test)&quot;</span>);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a5749229ff5da4f6c8793c1930d441ef3">fTestSqError</a>.<a class="code" href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">IsValid</a>())</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#a5749229ff5da4f6c8793c1930d441ef3">fTestSqError</a>, <span class="stringliteral">&quot;Error (Test)&quot;</span>);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a>.<a class="code" href="classTMatrixTBase.html#abdd847ecced6029aa8955fbdad9771e7">IsValid</a>())</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a>, <span class="stringliteral">&quot;Functions&quot;</span>);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>.<a class="code" href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">IsValid</a>())</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>,<span class="stringliteral">&quot;Coefficients&quot;</span>);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTMultiDimFit.html#ae985f0b701950ec974977159a9bf138f">fCoefficientsRMS</a>.<a class="code" href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">IsValid</a>())</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#ae985f0b701950ec974977159a9bf138f">fCoefficientsRMS</a>,<span class="stringliteral">&quot;Coefficients Errors&quot;</span>);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#ab28ec111cdb90176007d7b090e3fe7f0">fOrthFunctions</a>.<a class="code" href="classTMatrixTBase.html#abdd847ecced6029aa8955fbdad9771e7">IsValid</a>())</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#ab28ec111cdb90176007d7b090e3fe7f0">fOrthFunctions</a>, <span class="stringliteral">&quot;Orthogonal Functions&quot;</span>);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#ae8179978b62885a88d026666777f7598">fOrthFunctionNorms</a>.<a class="code" href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">IsValid</a>())</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#ae8179978b62885a88d026666777f7598">fOrthFunctionNorms</a>, <span class="stringliteral">&quot;Orthogonal Functions Norms&quot;</span>);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>.<a class="code" href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">IsValid</a>())</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>, <span class="stringliteral">&quot;Residuals&quot;</span>);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTMultiDimFit.html#a7bb76ca216ad08945970f45628bf0f21">fOrthCoefficients</a>.<a class="code" href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">IsValid</a>())</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#a7bb76ca216ad08945970f45628bf0f21">fOrthCoefficients</a>,<span class="stringliteral">&quot;Orthogonal Coefficients&quot;</span>);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a188c31631ea14c84bbf6cbd74a6fa439">fOrthCurvatureMatrix</a>.<a class="code" href="classTMatrixTBase.html#abdd847ecced6029aa8955fbdad9771e7">IsValid</a>())</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#a188c31631ea14c84bbf6cbd74a6fa439">fOrthCurvatureMatrix</a>,<span class="stringliteral">&quot;Orthogonal curvature matrix&quot;</span>);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTMultiDimFit.html#ab0e827c0499bce9f79783df14b60ec53">fCorrelationMatrix</a>.<a class="code" href="classTMatrixTBase.html#abdd847ecced6029aa8955fbdad9771e7">IsValid</a>())</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(&amp;<a class="code" href="classTMultiDimFit.html#ab0e827c0499bce9f79783df14b60ec53">fCorrelationMatrix</a>,<span class="stringliteral">&quot;Correlation Matrix&quot;</span>);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">fFitter</a>)</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>-&gt;Add(<a class="code" href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">fFitter</a>, <a class="code" href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">fFitter</a>-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>());</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;}</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">/// Clear internal structures and variables</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00786"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#ab66658d0c5dc0c20ce649482d336a047">  786</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#ab66658d0c5dc0c20ce649482d336a047">TMultiDimFit::Clear</a>(<a class="code" href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a> *option)</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;{</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i, j, <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a> = <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>, <a class="code" href="textangle_8C.html#a15eed939eb6efebfc935e895368c847a">m</a> = <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;   <span class="comment">// Training sample, dependent quantity</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;   <a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>.<a class="code" href="classTVectorT.html#a018d2fbf7d3f9de6a060b591c3f0a65d">Zero</a>();</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;   <a class="code" href="classTMultiDimFit.html#a743cd1b44fc3bf532385b750de395621">fSqError</a>.<a class="code" href="classTVectorT.html#a018d2fbf7d3f9de6a060b591c3f0a65d">Zero</a>();</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;   <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>                 = 0;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;   <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a>                  = 0;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;   <a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a>                  = 0;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;   <a class="code" href="classTMultiDimFit.html#a353ebfbe3b6be4608608a1891319f235">fSumSqQuantity</a>                = 0;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   <a class="code" href="classTMultiDimFit.html#a482dd2926682899a1c2eadc5448fa68a">fSumSqAvgQuantity</a>             = 0;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   <span class="comment">// Training sample, independent variables</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;   <a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>.<a class="code" href="classTVectorT.html#a018d2fbf7d3f9de6a060b591c3f0a65d">Zero</a>();</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>                   = 0;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;   <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>                   = 0;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;   <a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>.<a class="code" href="classTVectorT.html#a018d2fbf7d3f9de6a060b591c3f0a65d">Zero</a>();</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;   <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>.<a class="code" href="classTVectorT.html#a018d2fbf7d3f9de6a060b591c3f0a65d">Zero</a>();</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   <a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>.<a class="code" href="classTVectorT.html#a018d2fbf7d3f9de6a060b591c3f0a65d">Zero</a>();</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   <span class="comment">// Test sample</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;   <a class="code" href="classTMultiDimFit.html#a56a46526c239b3bb8677ecc95c9f1981">fTestQuantity</a>.<a class="code" href="classTVectorT.html#a018d2fbf7d3f9de6a060b591c3f0a65d">Zero</a>();</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;   <a class="code" href="classTMultiDimFit.html#a5749229ff5da4f6c8793c1930d441ef3">fTestSqError</a>.<a class="code" href="classTVectorT.html#a018d2fbf7d3f9de6a060b591c3f0a65d">Zero</a>();</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;   <a class="code" href="classTMultiDimFit.html#a7ba2e7356f09f5cd1a9ee77bd238ec26">fTestVariables</a>.<a class="code" href="classTVectorT.html#a018d2fbf7d3f9de6a060b591c3f0a65d">Zero</a>();</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;   <a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a>               = 0;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;   <span class="comment">// Functions</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;   <a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a>.<a class="code" href="classTMatrixTBase.html#a41f9191d986b6d99366b6e5aca353ae7">Zero</a>();</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;   <span class="comment">//for (i = 0; i &lt; fMaxTerms; i++)  fPowerIndex[i]    = 0;</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;   <span class="comment">//for (i = 0; i &lt; fMaxTerms; i++)  fFunctionCodes[i] = 0;</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;   <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>                 = 0;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;   <a class="code" href="classTMultiDimFit.html#a56a33cdba3c529818b7f8407813bab18">fMaxStudy</a>                     = 0;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;   <a class="code" href="classTMultiDimFit.html#ab28ec111cdb90176007d7b090e3fe7f0">fOrthFunctions</a>.<a class="code" href="classTMatrixTBase.html#a41f9191d986b6d99366b6e5aca353ae7">Zero</a>();</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;   <a class="code" href="classTMultiDimFit.html#ae8179978b62885a88d026666777f7598">fOrthFunctionNorms</a>.<a class="code" href="classTVectorT.html#a018d2fbf7d3f9de6a060b591c3f0a65d">Zero</a>();</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;   <span class="comment">// Control parameters</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;   <a class="code" href="classTMultiDimFit.html#afc80a4fe1f39eb2124bffbc4029484cc">fMinRelativeError</a>             = 0;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;   <a class="code" href="classTMultiDimFit.html#aa04e50147be5c9a8d9040e3b826c75f8">fMinAngle</a>                     = 0;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;   <a class="code" href="classTMultiDimFit.html#a9957717d755bac7da27236ca52a5af6b">fMaxAngle</a>                     = 0;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;   <a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a>                     = 0;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;   <span class="comment">// Powers</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; i++) {</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <a class="code" href="classTMultiDimFit.html#a54aaace3db3ff52251aa408a30f2a3e6">fMaxPowers</a>[i]               = 0;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      <a class="code" href="classTMultiDimFit.html#a8868c2f37dc91673d7fe3be00bcb5eae">fMaxPowersFinal</a>[i]          = 0;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="textangle_8C.html#a15eed939eb6efebfc935e895368c847a">m</a>; j++)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;         <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[i * <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a> + j]        = 0;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;   }</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;   <a class="code" href="classTMultiDimFit.html#aea2ee066fdfc04b3bd1797aaf154d52c">fPowerLimit</a>                   = 0;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;   <span class="comment">// Residuals</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac95cb9370c928be136efbaec080195b9">fMaxResidual</a>                  = 0;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;   <a class="code" href="classTMultiDimFit.html#a6a131a8d119f37edf5ac7ac4b764b211">fMinResidual</a>                  = 0;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;   <a class="code" href="classTMultiDimFit.html#a2ba24cef5173b7bc5f55c25d57f95335">fMaxResidualRow</a>               = 0;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;   <a class="code" href="classTMultiDimFit.html#a89082db5af59a8001f1f17da93cd1975">fMinResidualRow</a>               = 0;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   <a class="code" href="classTMultiDimFit.html#aa155aa11e0a5891ddd5678e2c0b6e0a8">fSumSqResidual</a>                = 0;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;   <span class="comment">// Fit</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;   <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>                = 0;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;   <a class="code" href="classTMultiDimFit.html#a7bb76ca216ad08945970f45628bf0f21">fOrthCoefficients</a>             = 0;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;   <a class="code" href="classTMultiDimFit.html#a188c31631ea14c84bbf6cbd74a6fa439">fOrthCurvatureMatrix</a>          = 0;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;   <a class="code" href="classTMultiDimFit.html#a915f6ba6a911fc155d32ff94d2c5ed90">fRMS</a>                          = 0;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;   <a class="code" href="classTMultiDimFit.html#ab0e827c0499bce9f79783df14b60ec53">fCorrelationMatrix</a>.<a class="code" href="classTMatrixTBase.html#a41f9191d986b6d99366b6e5aca353ae7">Zero</a>();</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac9cc5e457015ce9f569e0c2e865d8ecf">fError</a>                        = 0;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;   <a class="code" href="classTMultiDimFit.html#a68dd2aecfd779ec22b1dfe8a0f3923e8">fTestError</a>                    = 0;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;   <a class="code" href="classTMultiDimFit.html#a0ccafce2b1e34938ca21f8380f44c42d">fPrecision</a>                    = 0;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;   <a class="code" href="classTMultiDimFit.html#aad4535d5041352b9ce1e556da6c499bf">fTestPrecision</a>                = 0;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;   <span class="comment">// Coefficients</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;   <a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>.<a class="code" href="classTVectorT.html#a018d2fbf7d3f9de6a060b591c3f0a65d">Zero</a>();</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;   <a class="code" href="classTMultiDimFit.html#ae985f0b701950ec974977159a9bf138f">fCoefficientsRMS</a>.<a class="code" href="classTVectorT.html#a018d2fbf7d3f9de6a060b591c3f0a65d">Zero</a>();</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;   <a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>.<a class="code" href="classTVectorT.html#a018d2fbf7d3f9de6a060b591c3f0a65d">Zero</a>();</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#af4d5429298af281bdc7fe62b123f5385">Clear</a>(option);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;   <span class="comment">// Options</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;   <a class="code" href="classTMultiDimFit.html#abdab5d9509890288a37712774a5f61ed">fPolyType</a>                     = <a class="code" href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152ea01c4c4c755c598880447ca3ce72b0950">kMonomials</a>;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;   <a class="code" href="classTMultiDimFit.html#a1fa5c6ef9f25b28a1b86f1f370ba55dd">fShowCorrelation</a>              = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;   <a class="code" href="classTMultiDimFit.html#a20cc6137d3c71256a9833f98f3a202c5">fIsUserFunction</a>               = <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;}</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">/// Evaluate parameterization at point x. Optional argument coeff is</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">/// a vector of coefficients for the parameterisation, fNCoefficients</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">/// elements long.</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00873"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a3383acbb4420f6dfbef6c7899d2ce82b">  873</a></span>&#160;<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="classTMultiDimFit.html#a3383acbb4420f6dfbef6c7899d2ce82b">TMultiDimFit::Eval</a>(<span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>* coeff)<span class="keyword"> const</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> returnValue = <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> term        = 0;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>    i, j;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; i++) {</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <span class="comment">// Evaluate the ith term in the expansion</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      term = (coeff ? coeff[i] : <a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>(i));</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++) {</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;         <span class="comment">// Evaluate the factor (polynomial) in the j-th variable.</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;         <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>    p  =  <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[<a class="code" href="classTMultiDimFit.html#ab1c8c0801040a8ba1d7fefdf107a289d">fPowerIndex</a>[i] * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j];</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>  =  1 + 2. / (<a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(j) - <a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>(j))</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;         * (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[j] - <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(j));</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;         term        *= <a class="code" href="classTMultiDimFit.html#ad7419aa5ebe661a8e621059954476b66">EvalFactor</a>(p,<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      }</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="comment">// Add this term to the final result</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      returnValue += term;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;   }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;   <span class="keywordflow">return</span> returnValue;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;}</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">/// Evaluate parameterization error at point x. Optional argument coeff is</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">/// a vector of coefficients for the parameterisation, fNCoefficients</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">/// elements long.</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00901"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#ac175cdf9aeb02a708f0b96bd734fcbc0">  901</a></span>&#160;<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="classTMultiDimFit.html#ac175cdf9aeb02a708f0b96bd734fcbc0">TMultiDimFit::EvalError</a>(<span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>* coeff)<span class="keyword"> const</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> returnValue = 0;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> term        = 0;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>    i, j;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; i++) {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="comment">//     std::cout &lt;&lt; &quot;Error coef &quot; &lt;&lt; i &lt;&lt; &quot; -&gt; &quot; &lt;&lt; fCoefficientsRMS(i) &lt;&lt; std::endl;</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;   }</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; i++) {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <span class="comment">// Evaluate the ith term in the expansion</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      term = (coeff ? coeff[i] : <a class="code" href="classTMultiDimFit.html#ae985f0b701950ec974977159a9bf138f">fCoefficientsRMS</a>(i));</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++) {</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;         <span class="comment">// Evaluate the factor (polynomial) in the j-th variable.</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;         <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>    p  =  <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[<a class="code" href="classTMultiDimFit.html#ab1c8c0801040a8ba1d7fefdf107a289d">fPowerIndex</a>[i] * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j];</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>  =  1 + 2. / (<a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(j) - <a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>(j))</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;         * (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[j] - <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(j));</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;         term        *= <a class="code" href="classTMultiDimFit.html#ad7419aa5ebe661a8e621059954476b66">EvalFactor</a>(p,<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;         <span class="comment">//   std::cout &lt;&lt; &quot;i,j &quot; &lt;&lt; i &lt;&lt; &quot;, &quot; &lt;&lt; j &lt;&lt; &quot;  &quot;  &lt;&lt; p &lt;&lt; &quot;  &quot; &lt;&lt; y &lt;&lt; &quot;  &quot; &lt;&lt; EvalFactor(p,y) &lt;&lt; &quot;  &quot; &lt;&lt; term &lt;&lt; std::endl;</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      }</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <span class="comment">// Add this term to the final result</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      returnValue += term*term;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="comment">//      std::cout &lt;&lt; &quot; i = &quot; &lt;&lt; i &lt;&lt; &quot; value = &quot; &lt;&lt; returnValue &lt;&lt; std::endl;</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;   }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;   returnValue = <a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a>(returnValue);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;   <span class="keywordflow">return</span> returnValue;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;}</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">/// PRIVATE METHOD:</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">/// Calculate the control parameter from the passed powers</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00934"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#ab6c34ca711c504890abcf7e668bd1de3">  934</a></span>&#160;<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="classTMultiDimFit.html#ab6c34ca711c504890abcf7e668bd1de3">TMultiDimFit::EvalControl</a>(<span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> *iv)<span class="keyword"> const</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> = 0;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="triangle_8c.html#a92508a9fbb1db78d0bbedbf68cf93d1b">epsilon</a> = 1<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-6; <span class="comment">// a small number</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++) {</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a54aaace3db3ff52251aa408a30f2a3e6">fMaxPowers</a>[i] != 1)</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;         <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> += (<a class="code" href="triangle_8c.html#a92508a9fbb1db78d0bbedbf68cf93d1b">epsilon</a> + iv[i] - 1) / (<a class="code" href="triangle_8c.html#a92508a9fbb1db78d0bbedbf68cf93d1b">epsilon</a> + <a class="code" href="classTMultiDimFit.html#a54aaace3db3ff52251aa408a30f2a3e6">fMaxPowers</a>[i] - 1);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;   }</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;}</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">/// PRIVATE METHOD:</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">/// Evaluate function with power p at variable value x</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00949"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#ad7419aa5ebe661a8e621059954476b66">  949</a></span>&#160;<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="classTMultiDimFit.html#ad7419aa5ebe661a8e621059954476b66">TMultiDimFit::EvalFactor</a>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> p, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>)<span class="keyword"> const</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>    i   = 0;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> p1  = 1;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> p2  = 0;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> p3  = 0;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>   = 0;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;   <span class="keywordflow">switch</span>(p) {</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;         <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a> = 1;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;         <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a> =  <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;         p2 = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;         <span class="keywordflow">for</span> (i = 3; i &lt;= p; i++) {</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            p3 = p2 * <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#abdab5d9509890288a37712774a5f61ed">fPolyType</a> == <a class="code" href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152ea6c631fe681d300f83c3a5e8334cc1ab7">kLegendre</a>)</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;               p3 = ((2 * i - 3) * p2 * <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> - (i - 2) * p1) / (i - 1);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#abdab5d9509890288a37712774a5f61ed">fPolyType</a> == <a class="code" href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152eac9953ab7fc01b500168df1fa056fba5f">kChebyshev</a>)</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;               p3 = 2 * <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> * p2 - p1;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            p1 = p2;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            p2 = p3;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;         }</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;         <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a> = p3;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;   }</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a>;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;}</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">/// Find the parameterization</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">/// Options:</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">///     None so far</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">/// For detailed description of what this entails, please refer to the</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00991"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a6fcbef530e89fe295103c1f84107ef33">  991</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#a6fcbef530e89fe295103c1f84107ef33">TMultiDimFit::FindParameterization</a>(<a class="code" href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a> *)</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;{</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;   <a class="code" href="classTMultiDimFit.html#a505a681f417fc9e6f7a33bac37b597d4">MakeNormalized</a>();</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;   <a class="code" href="classTMultiDimFit.html#a63255512123a70b8fb0ec3d01f9bb576">MakeCandidates</a>();</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;   <a class="code" href="classTMultiDimFit.html#abc69e78e14f641805c364fb9f5a620fa">MakeParameterization</a>();</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   <a class="code" href="classTMultiDimFit.html#aaf529206d8c377fd6b852987e7599a5d">MakeCoefficients</a>();</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;   <a class="code" href="classTMultiDimFit.html#a11ed6eeaf562791494391e7348d080fb">MakeCoefficientErrors</a>();</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   <a class="code" href="classTMultiDimFit.html#a046de74be7fc5ba5f36df6db4e110630">MakeCorrelation</a>();</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;}</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">/// Try to fit the found parameterisation to the test sample.</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">/// Options</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">///     M     use Minuit to improve coefficients</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">/// Also, refer to</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01010"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a995a6ac6f1cf39c8b2ba59fcd26641b3"> 1010</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#a995a6ac6f1cf39c8b2ba59fcd26641b3">TMultiDimFit::Fit</a>(<a class="code" href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a> *option)</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;{</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i, j;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>*      <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>    = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>];</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>  sumSqD    = 0;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>    sumD    = 0;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>  sumSqR    = 0;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>    sumR    = 0;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;   <span class="comment">// Calculate the residuals over the test sample</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a>; i++) {</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++)</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;         <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[j] = <a class="code" href="classTMultiDimFit.html#a7ba2e7356f09f5cd1a9ee77bd238ec26">fTestVariables</a>(i * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j);</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> res =  <a class="code" href="classTMultiDimFit.html#a56a46526c239b3bb8677ecc95c9f1981">fTestQuantity</a>(i) - <a class="code" href="classTMultiDimFit.html#a3383acbb4420f6dfbef6c7899d2ce82b">Eval</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      sumD         += <a class="code" href="classTMultiDimFit.html#a56a46526c239b3bb8677ecc95c9f1981">fTestQuantity</a>(i);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      sumSqD       += <a class="code" href="classTMultiDimFit.html#a56a46526c239b3bb8677ecc95c9f1981">fTestQuantity</a>(i) * <a class="code" href="classTMultiDimFit.html#a56a46526c239b3bb8677ecc95c9f1981">fTestQuantity</a>(i);</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      sumR         += res;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      sumSqR       += res * res;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#a93170b16cd359cbf0e8643c41b987703">TESTBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#abc53d6530eb580057e12ecb5b4e88b48">HIST_RTEST</a>))</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;         ((<a class="code" href="classTH1D.html">TH1D</a>*)<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<span class="stringliteral">&quot;res_test&quot;</span>))-&gt;Fill(res);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;   }</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> dAvg         = sumSqD - (sumD * sumD) / <a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a>;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> rAvg         = sumSqR - (sumR * sumR) / <a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a>;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;   <a class="code" href="classTMultiDimFit.html#a9e7f168a0f08032f4f45184af3cc0019">fTestCorrelationCoeff</a> = (dAvg - rAvg) / dAvg;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;   <a class="code" href="classTMultiDimFit.html#a68dd2aecfd779ec22b1dfe8a0f3923e8">fTestError</a>            = sumSqR;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;   <a class="code" href="classTMultiDimFit.html#aad4535d5041352b9ce1e556da6c499bf">fTestPrecision</a>        = sumSqR / sumSqD;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;   <a class="code" href="classTString.html">TString</a> opt(option);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;   opt.<a class="code" href="classTString.html#a1be9e2a41facebeac4feddd9801a0034">ToLower</a>();</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;   <span class="keywordflow">if</span> (!opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;m&quot;</span>))</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <a class="code" href="classTMultiDimFit.html#afc84891faa78c530965d1cfc9670a079">MakeChi2</a>();</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a> * 50 &gt; <a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a>)</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      <a class="code" href="classTObject.html#a75fddd7eef38a13c1374130ec7dc5cf8">Warning</a>(<span class="stringliteral">&quot;Fit&quot;</span>, <span class="stringliteral">&quot;test sample is very small&quot;</span>);</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;   <span class="keywordflow">if</span> (!opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;m&quot;</span>)) {</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Fit&quot;</span>, <span class="stringliteral">&quot;invalid option&quot;</span>);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <span class="keyword">delete</span> [] <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;   }</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;   <a class="code" href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">fFitter</a> = <a class="code" href="classTVirtualFitter.html#aea097f4da10bb75324bd40aee976127a">TVirtualFitter::Fitter</a>(0,<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">fFitter</a>) {</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Fit&quot;</span>, <span class="stringliteral">&quot;Cannot create Fitter&quot;</span>);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="keyword">delete</span> [] <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;   }</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;   <a class="code" href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">fFitter</a>-&gt;<a class="code" href="classTVirtualFitter.html#a87b7aa8b098fdde5e0dfd44eb680ee5e">SetFCN</a>(<a class="code" href="TMultiDimFit_8cxx.html#a8cfcdcd0945476639dfb907c6aafafa1">mdfHelper</a>);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;   <span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>  maxArgs = 16;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>           args = 1;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>*   arglist  = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[maxArgs];</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;   arglist[0]           = -1;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;   <a class="code" href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">fFitter</a>-&gt;<a class="code" href="classTVirtualFitter.html#aa932bc097c3ed3d5c9e33186b47a2f82">ExecuteCommand</a>(<span class="stringliteral">&quot;SET PRINT&quot;</span>,arglist,args);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; i++) {</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> startVal = <a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>(i);</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> startErr = <a class="code" href="classTMultiDimFit.html#ae985f0b701950ec974977159a9bf138f">fCoefficientsRMS</a>(i);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <a class="code" href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">fFitter</a>-&gt;<a class="code" href="classTVirtualFitter.html#a9eaa0d7620964dce13bba1c0f785ef8c">SetParameter</a>(i, <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;coeff%02d&quot;</span>,i),</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                            startVal, startErr, 0, 0);</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;   }</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;   <span class="comment">// arglist[0]           = 0;</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;   args                 = 1;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;   <span class="comment">// fFitter-&gt;ExecuteCommand(&quot;SET PRINT&quot;,arglist,args);</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;   <a class="code" href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">fFitter</a>-&gt;<a class="code" href="classTVirtualFitter.html#aa932bc097c3ed3d5c9e33186b47a2f82">ExecuteCommand</a>(<span class="stringliteral">&quot;MIGRAD&quot;</span>,arglist,args);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; i++) {</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> val = 0, err = 0, low = 0, high = 0;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <a class="code" href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">fFitter</a>-&gt;<a class="code" href="classTVirtualFitter.html#aaf8cd96637522ebdd84bb7f08b3ce3df">GetParameter</a>(i, <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;coeff%02d&quot;</span>,i),</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                            val, err, low, high);</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      <a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>(i)    = val;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <a class="code" href="classTMultiDimFit.html#ae985f0b701950ec974977159a9bf138f">fCoefficientsRMS</a>(i) = err;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;   }</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;   <span class="keyword">delete</span> [] <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;}</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">/// Return the static instance.</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01091"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a5e87f44f9b4616741c8be44981c70e1c"> 1091</a></span>&#160;<a class="code" href="classTMultiDimFit.html">TMultiDimFit</a>* <a class="code" href="classTMultiDimFit.html#a5e87f44f9b4616741c8be44981c70e1c">TMultiDimFit::Instance</a>()</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;{</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classTMultiDimFit.html#aedb4a6da4070e3c88c84d14a096b061b">fgInstance</a>;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;}</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">/// PRIVATE METHOD:</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">/// Create list of candidate functions for the parameterisation. See</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">/// also</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01102"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a63255512123a70b8fb0ec3d01f9bb576"> 1102</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#a63255512123a70b8fb0ec3d01f9bb576">TMultiDimFit::MakeCandidates</a>()</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;{</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> j = 0;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> k = 0;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;   <span class="comment">// The temporary array to store the powers in. We don&#39;t need to</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;   <span class="comment">// initialize this array however.</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;   <a class="code" href="classTMultiDimFit.html#af6ebf85c4647ea94d84a3fee7ba4dc51">fMaxFuncNV</a> = <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> * <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> *powers = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[<a class="code" href="classTMultiDimFit.html#af6ebf85c4647ea94d84a3fee7ba4dc51">fMaxFuncNV</a>];</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;   <span class="comment">// store of `control variables&#39;</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>* control  = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>];</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;   <span class="comment">// We&#39;ve better initialize the variables</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> *iv = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[<a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>];</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      iv[i] = 1;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#a20cc6137d3c71256a9833f98f3a202c5">fIsUserFunction</a>) {</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="comment">// Number of funcs selected</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>     numberFunctions = 0;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <span class="comment">// Absolute max number of functions</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> maxNumberFunctions = 1;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;         maxNumberFunctions *= <a class="code" href="classTMultiDimFit.html#a54aaace3db3ff52251aa408a30f2a3e6">fMaxPowers</a>[i];</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <span class="keywordflow">while</span> (<a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>) {</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;         <span class="comment">// Get the control value for this function</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> = <a class="code" href="classTMultiDimFit.html#ab6c34ca711c504890abcf7e668bd1de3">EvalControl</a>(iv);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> &lt;= <a class="code" href="classTMultiDimFit.html#aea2ee066fdfc04b3bd1797aaf154d52c">fPowerLimit</a>) {</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            <span class="comment">// Call over-loadable method Select, as to allow the user to</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            <span class="comment">// interfere with the selection of functions.</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#abf9a170e41c1a529d7a00f168bdb8a1e">Select</a>(iv)) {</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;               numberFunctions++;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;               <span class="comment">// If we&#39;ve reached the user defined limit of how many</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;               <span class="comment">// functions we can consider, break out of the loop</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;               <span class="keywordflow">if</span> (numberFunctions &gt; <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>)</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;               <span class="comment">// Store the control value, so we can sort array of powers</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;               <span class="comment">// later on</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;               control[numberFunctions-1] = <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>(1.0<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>+6*<a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a>);</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;               <span class="comment">// Store the powers in powers array.</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;               <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++) {</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                  j = (numberFunctions - 1) * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + i;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                  powers[j] = iv[i];</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;               }</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            } <span class="comment">// if (Select())</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;         } <span class="comment">// if (s &lt;= fPowerLimit)</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            <span class="keywordflow">if</span> (iv[i] &lt; <a class="code" href="classTMultiDimFit.html#a54aaace3db3ff52251aa408a30f2a3e6">fMaxPowers</a>[i])</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;         <span class="comment">// If all variables have reached their maximum power, then we</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;         <span class="comment">// break out of the loop</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;         <span class="keywordflow">if</span> (i == <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>) {</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a> = numberFunctions;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;         }</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;         <span class="comment">// Next power in variable i</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;         <span class="keywordflow">if</span> (i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>) iv[i]++;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; i; j++)</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;            iv[j] = 1;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      } <span class="comment">// while (kTRUE)</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;   }</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="comment">// In case the user gave an explicit function</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>; i++) {</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;         <span class="comment">// Copy the powers to working arrays</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++) {</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            powers[i * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j] = <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[i * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j];</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            iv[j]                 = <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[i * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j];</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;         }</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;         control[i] = <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>(1.0<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>+6*<a class="code" href="classTMultiDimFit.html#ab6c34ca711c504890abcf7e668bd1de3">EvalControl</a>(iv));</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      }</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;   }</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;   <span class="comment">// Now we need to sort the powers according to least `control</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;   <span class="comment">// variable&#39;</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> *order = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[<a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>];</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>; i++)</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      order[i] = i;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;   <a class="code" href="classTMultiDimFit.html#af6ebf85c4647ea94d84a3fee7ba4dc51">fMaxFuncNV</a> = <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a> * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;   <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[<a class="code" href="classTMultiDimFit.html#af6ebf85c4647ea94d84a3fee7ba4dc51">fMaxFuncNV</a>];</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>; i++) {</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = control[i];</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>    <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = order[i];</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      k = i;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <span class="keywordflow">for</span> (j = i; j &lt; <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>; j++) {</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;         <span class="keywordflow">if</span> (control[j] &lt;= <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>) {</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = control[j];</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> = order[j];</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;            k = j;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;         }</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      }</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keywordflow">if</span> (k != i) {</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;         control[k] = control[i];</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;         control[i] = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;         order[k]   = order[i];</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;         order[i]   = <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      }</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;   }</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>; i++)</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++)</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;         <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[i * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j] = powers[order[i] * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j];</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;   <span class="keyword">delete</span> [] control;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;   <span class="keyword">delete</span> [] powers;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;   <span class="keyword">delete</span> [] order;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;   <span class="keyword">delete</span> [] iv;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;}</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment">/// Calculate Chi square over either the test sample. The optional</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">/// argument coeff is a vector of coefficients to use in the</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">/// evaluation of the parameterisation. If coeff == 0, then the found</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">/// coefficients is used.</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">/// Used my MINUIT for fit (see TMultDimFit::Fit)</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01237"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#afc84891faa78c530965d1cfc9670a079"> 1237</a></span>&#160;<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="classTMultiDimFit.html#afc84891faa78c530965d1cfc9670a079">TMultiDimFit::MakeChi2</a>(<span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>* coeff)</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;{</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac94c103fb73cd4eb775375271c74becc">fChi2</a> = 0;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i, j;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>* <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>];</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a>; i++) {</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <span class="comment">// Get the stored point</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++)</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;         <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[j] = <a class="code" href="classTMultiDimFit.html#a7ba2e7356f09f5cd1a9ee77bd238ec26">fTestVariables</a>(i * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j);</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <span class="comment">// Evaluate function. Scale to shifted values</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a> = <a class="code" href="classTMultiDimFit.html#a3383acbb4420f6dfbef6c7899d2ce82b">Eval</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,coeff);</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="comment">// Calculate contribution to Chic square</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      <a class="code" href="classTMultiDimFit.html#ac94c103fb73cd4eb775375271c74becc">fChi2</a> += 1. / <a class="code" href="namespaceTMath.html#a38e1c23e08564d17051526d7e0a5364d">TMath::Max</a>(<a class="code" href="classTMultiDimFit.html#a5749229ff5da4f6c8793c1930d441ef3">fTestSqError</a>(i),1<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-20)</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      * (<a class="code" href="classTMultiDimFit.html#a56a46526c239b3bb8677ecc95c9f1981">fTestQuantity</a>(i) - <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>) * (<a class="code" href="classTMultiDimFit.html#a56a46526c239b3bb8677ecc95c9f1981">fTestQuantity</a>(i) - <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>);</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;   }</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;   <span class="comment">// Clean up</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;   <span class="keyword">delete</span> [] <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classTMultiDimFit.html#ac94c103fb73cd4eb775375271c74becc">fChi2</a>;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;}</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">/// Generate the file &lt;filename&gt; with .C appended if argument doesn&#39;t</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">/// end in .cxx or .C. The contains the implementation of the</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">/// function:</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">///   Double_t &lt;funcname&gt;(Double_t *x)</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">/// which does the same as TMultiDimFit::Eval. Please refer to this</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">/// method.</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">/// Further, the static variables:</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">///     Int_t    gNVariables</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">///     Int_t    gNCoefficients</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">///     Double_t gDMean</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">///     Double_t gXMean[]</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">///     Double_t gXMin[]</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">///     Double_t gXMax[]</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">///     Double_t gCoefficient[]</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">///     Int_t    gPower[]</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">/// are initialized. The only ROOT header file needed is Rtypes.h</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">/// See TMultiDimFit::MakeRealCode for a list of options</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01287"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a62d9ca99ba267dc7d2d80fa88f041b1f"> 1287</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#a62d9ca99ba267dc7d2d80fa88f041b1f">TMultiDimFit::MakeCode</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* filename, <a class="code" href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a> *option)</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;{</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;   <a class="code" href="classTString.html">TString</a> outName(filename);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;   <span class="keywordflow">if</span> (!outName.<a class="code" href="classTString.html#a2b2e907b9681d08cec32c853171c06a1">EndsWith</a>(<span class="stringliteral">&quot;.C&quot;</span>) &amp;&amp; !outName.<a class="code" href="classTString.html#a2b2e907b9681d08cec32c853171c06a1">EndsWith</a>(<span class="stringliteral">&quot;.cxx&quot;</span>))</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      outName += <span class="stringliteral">&quot;.C&quot;</span>;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;   <a class="code" href="classTMultiDimFit.html#a8ea4d7c005735061af8d1246a0b6594b">MakeRealCode</a>(outName.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>(),<span class="stringliteral">&quot;&quot;</span>,option);</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;}</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="comment">/// PRIVATE METHOD:</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="comment">/// Compute the errors on the coefficients. For this to be done, the</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment">/// curvature matrix of the non-orthogonal functions, is computed.</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01304"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a11ed6eeaf562791494391e7348d080fb"> 1304</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#a11ed6eeaf562791494391e7348d080fb">TMultiDimFit::MakeCoefficientErrors</a>()</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;{</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>    i = 0;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>    j = 0;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>    k = 0;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;   <a class="code" href="classTVectorT.html">TVectorD</a> iF(<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>);</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;   <a class="code" href="classTVectorT.html">TVectorD</a> jF(<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>);</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;   <a class="code" href="classTMultiDimFit.html#ae985f0b701950ec974977159a9bf138f">fCoefficientsRMS</a>.<a class="code" href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">ResizeTo</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>);</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;   <a class="code" href="classTMatrixTSym.html">TMatrixDSym</a> curvatureMatrix(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;   <span class="comment">// Build the curvature matrix</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; i++) {</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      iF = <a class="code" href="TMatrixDUtilsfwd_8h.html#a35d231b9f8a937a9ee5cec5077fb403e">TMatrixDRow</a>(<a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a>,i);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt;= i; j++) {</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;         jF = <a class="code" href="TMatrixDUtilsfwd_8h.html#a35d231b9f8a937a9ee5cec5077fb403e">TMatrixDRow</a>(<a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a>,j);</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;         <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>; k++)</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            curvatureMatrix(i,j) +=</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            1 / <a class="code" href="namespaceTMath.html#a38e1c23e08564d17051526d7e0a5364d">TMath::Max</a>(<a class="code" href="classTMultiDimFit.html#a743cd1b44fc3bf532385b750de395621">fSqError</a>(k), 1<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-20) * iF(k) * jF(k);</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;         curvatureMatrix(j,i) = curvatureMatrix(i,j);</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      }</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;   }</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;   <span class="comment">// Calculate Chi Square</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac94c103fb73cd4eb775375271c74becc">fChi2</a> = 0;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>; i++) {</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a> = 0;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; j++)</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;         <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a> += <a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>(j) * <a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a>(j,i);</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      <a class="code" href="classTMultiDimFit.html#ac94c103fb73cd4eb775375271c74becc">fChi2</a> += 1. / <a class="code" href="namespaceTMath.html#a38e1c23e08564d17051526d7e0a5364d">TMath::Max</a>(<a class="code" href="classTMultiDimFit.html#a743cd1b44fc3bf532385b750de395621">fSqError</a>(i),1<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-20) * (<a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>(i) - <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>)</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      * (<a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>(i) - <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>);</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;   }</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;   <span class="comment">// Invert the curvature matrix</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;   <span class="keyword">const</span> <a class="code" href="classTVectorT.html">TVectorD</a> diag = <a class="code" href="TMatrixDUtilsfwd_8h.html#aad4e5705c7e6e551b332a8d991b4ff90">TMatrixDDiag_const</a>(curvatureMatrix);</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;   curvatureMatrix.<a class="code" href="classTMatrixTBase.html#afbf946ac4172ba90c03ead0a0d2f0dee">NormByDiag</a>(diag);</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;   <a class="code" href="classTDecompChol.html">TDecompChol</a> chol(curvatureMatrix);</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;   <span class="keywordflow">if</span> (!chol.<a class="code" href="classTDecompChol.html#af14df10a3c766330cb93063161ecedc0">Decompose</a>())</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;MakeCoefficientErrors&quot;</span>, <span class="stringliteral">&quot;curvature matrix is singular&quot;</span>);</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;   chol.<a class="code" href="classTDecompChol.html#aec4d827262663178ffd7d4a31c4fb23c">Invert</a>(curvatureMatrix);</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;   curvatureMatrix.<a class="code" href="classTMatrixTBase.html#afbf946ac4172ba90c03ead0a0d2f0dee">NormByDiag</a>(diag);</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; i++)</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      <a class="code" href="classTMultiDimFit.html#ae985f0b701950ec974977159a9bf138f">fCoefficientsRMS</a>(i) = <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(curvatureMatrix(i,i));</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;}</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment">/// PRIVATE METHOD:</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment">/// Invert the model matrix B, and compute final coefficients. For a</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">/// more thorough discussion of what this means, please refer to the</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment">/// First we invert the lower triangle matrix fOrthCurvatureMatrix</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment">/// and store the inverted matrix in the upper triangle.</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01362"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#aaf529206d8c377fd6b852987e7599a5d"> 1362</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#aaf529206d8c377fd6b852987e7599a5d">TMultiDimFit::MakeCoefficients</a>()</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;{</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0, j = 0;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> col = 0, row = 0;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;   <span class="comment">// Invert the B matrix</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;   <span class="keywordflow">for</span> (col = 1; col &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; col++) {</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="keywordflow">for</span> (row = col - 1; row &gt; -1; row--) {</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;         <a class="code" href="classTMultiDimFit.html#a188c31631ea14c84bbf6cbd74a6fa439">fOrthCurvatureMatrix</a>(row,col) = 0;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;         <span class="keywordflow">for</span> (i = row; i &lt;= col ; i++)</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;            <a class="code" href="classTMultiDimFit.html#a188c31631ea14c84bbf6cbd74a6fa439">fOrthCurvatureMatrix</a>(row,col) -=</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;            <a class="code" href="classTMultiDimFit.html#a188c31631ea14c84bbf6cbd74a6fa439">fOrthCurvatureMatrix</a>(i,row)</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            * <a class="code" href="classTMultiDimFit.html#a188c31631ea14c84bbf6cbd74a6fa439">fOrthCurvatureMatrix</a>(i,col);</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      }</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;   }</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;   <span class="comment">// Compute the final coefficients</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;   <a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>.<a class="code" href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">ResizeTo</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>);</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; i++) {</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="tmva_2tmva_2src_2Factory_8cxx.html#a73e5b6a37db0af518793b45eba2bbe8e">sum</a> = 0;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      <span class="keywordflow">for</span> (j = i; j &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; j++)</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;         <a class="code" href="tmva_2tmva_2src_2Factory_8cxx.html#a73e5b6a37db0af518793b45eba2bbe8e">sum</a> += <a class="code" href="classTMultiDimFit.html#a188c31631ea14c84bbf6cbd74a6fa439">fOrthCurvatureMatrix</a>(i,j) * <a class="code" href="classTMultiDimFit.html#a7bb76ca216ad08945970f45628bf0f21">fOrthCoefficients</a>(j);</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      <a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>(i) = <a class="code" href="tmva_2tmva_2src_2Factory_8cxx.html#a73e5b6a37db0af518793b45eba2bbe8e">sum</a>;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;   }</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;   <span class="comment">// Compute the final residuals</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;   <a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>.<a class="code" href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">ResizeTo</a>(<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>);</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>; i++)</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      <a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>(i) = <a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>(i);</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; i++)</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>; j++)</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;         <a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>(j) -= <a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>(i) * <a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a>(i,j);</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;   <span class="comment">// Compute the max and minimum, and squared sum of the evaluated</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;   <span class="comment">// residuals</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;   <a class="code" href="classTMultiDimFit.html#a6a131a8d119f37edf5ac7ac4b764b211">fMinResidual</a> = 10e10;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac95cb9370c928be136efbaec080195b9">fMaxResidual</a> = -10e10;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> sqRes  = 0;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>; i++){</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      sqRes += <a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>(i) * <a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>(i);</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>(i) &lt;= <a class="code" href="classTMultiDimFit.html#a6a131a8d119f37edf5ac7ac4b764b211">fMinResidual</a>) {</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;         <a class="code" href="classTMultiDimFit.html#a6a131a8d119f37edf5ac7ac4b764b211">fMinResidual</a>     = <a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>(i);</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;         <a class="code" href="classTMultiDimFit.html#a89082db5af59a8001f1f17da93cd1975">fMinResidualRow</a>  = i;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      }</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>(i) &gt;= <a class="code" href="classTMultiDimFit.html#ac95cb9370c928be136efbaec080195b9">fMaxResidual</a>) {</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;         <a class="code" href="classTMultiDimFit.html#ac95cb9370c928be136efbaec080195b9">fMaxResidual</a>     = <a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>(i);</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;         <a class="code" href="classTMultiDimFit.html#a2ba24cef5173b7bc5f55c25d57f95335">fMaxResidualRow</a>  = i;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      }</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;   }</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;   <a class="code" href="classTMultiDimFit.html#a85678efb97e963279c31d60cd4591ce0">fCorrelationCoeff</a> = <a class="code" href="classTMultiDimFit.html#aa155aa11e0a5891ddd5678e2c0b6e0a8">fSumSqResidual</a> / <a class="code" href="classTMultiDimFit.html#a482dd2926682899a1c2eadc5448fa68a">fSumSqAvgQuantity</a>;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;   <a class="code" href="classTMultiDimFit.html#a0ccafce2b1e34938ca21f8380f44c42d">fPrecision</a>        = <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(sqRes / <a class="code" href="classTMultiDimFit.html#a353ebfbe3b6be4608608a1891319f235">fSumSqQuantity</a>);</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;   <span class="comment">// If we use histograms, fill some more</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#a93170b16cd359cbf0e8643c41b987703">TESTBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#ae026def51d4bb2970016a9150e817378">HIST_RD</a>) ||</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;       <a class="code" href="Rtypes_8h.html#a93170b16cd359cbf0e8643c41b987703">TESTBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#ad15c4be1d09512b8b100f4d97ff13e09">HIST_RTRAI</a>) ||</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;       <a class="code" href="Rtypes_8h.html#a93170b16cd359cbf0e8643c41b987703">TESTBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#a280cd1275ebe4292c7e05c62740e5b3f">HIST_RX</a>)) {</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>; i++) {</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#a93170b16cd359cbf0e8643c41b987703">TESTBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#ae026def51d4bb2970016a9150e817378">HIST_RD</a>))</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            ((<a class="code" href="classTH2D.html">TH2D</a>*)<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<span class="stringliteral">&quot;res_d&quot;</span>))-&gt;Fill(<a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>(i),</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                                                            <a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>(i));</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#a93170b16cd359cbf0e8643c41b987703">TESTBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#ad15c4be1d09512b8b100f4d97ff13e09">HIST_RTRAI</a>))</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;            ((<a class="code" href="classTH1D.html">TH1D</a>*)<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<span class="stringliteral">&quot;res_train&quot;</span>))-&gt;Fill(<a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>(i));</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#a93170b16cd359cbf0e8643c41b987703">TESTBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#a280cd1275ebe4292c7e05c62740e5b3f">HIST_RX</a>))</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++)</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;               ((<a class="code" href="classTH2D.html">TH2D</a>*)<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;res_x_%d&quot;</span>,j)))</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;               -&gt;Fill(<a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>(i * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j),<a class="code" href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">fResiduals</a>(i));</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      }</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;   } <span class="comment">// If histograms</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;}</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment">/// PRIVATE METHOD:</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">/// Compute the correlation matrix</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01442"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a046de74be7fc5ba5f36df6db4e110630"> 1442</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#a046de74be7fc5ba5f36df6db4e110630">TMultiDimFit::MakeCorrelation</a>()</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;{</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#a1fa5c6ef9f25b28a1b86f1f370ba55dd">fShowCorrelation</a>)</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;   <a class="code" href="classTMultiDimFit.html#ab0e827c0499bce9f79783df14b60ec53">fCorrelationMatrix</a>.<a class="code" href="classTMatrixT.html#a208f00289448b5f78b4bf033f18abc43">ResizeTo</a>(<a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>,<a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>+1);</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> d2      = 0;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> ddotXi  = 0; <span class="comment">// G.Q. needs to be reinitialized in the loop over i fNVariables</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> xiNorm  = 0; <span class="comment">// G.Q. needs to be reinitialized in the loop over i fNVariables</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> xidotXj = 0; <span class="comment">// G.Q. needs to be reinitialized in the loop over j fNVariables</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> xjNorm  = 0; <span class="comment">// G.Q. needs to be reinitialized in the loop over j fNVariables</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i, j, k, <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>, <a class="code" href="textangle_8C.html#a15eed939eb6efebfc935e895368c847a">m</a>;  <span class="comment">// G.Q. added m variable</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>; i++)</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      d2 += <a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>(i) * <a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>(i);</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++) {</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      ddotXi = 0.; <span class="comment">// G.Q. reinitialisation</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      xiNorm = 0.; <span class="comment">// G.Q. reinitialisation</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <span class="keywordflow">for</span> (j = 0; j&lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>; j++) {</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;         <span class="comment">// Index of sample j of variable i</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;         k =  j * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + i;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;         ddotXi += <a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>(j) * (<a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>(k) - <a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>(i));</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;         xiNorm += (<a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>(k) - <a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>(i))</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;         * (<a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>(k) - <a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>(i));</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      }</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      <a class="code" href="classTMultiDimFit.html#ab0e827c0499bce9f79783df14b60ec53">fCorrelationMatrix</a>(i,0) = ddotXi / <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(d2 * xiNorm);</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; i; j++) {</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;         xidotXj = 0.; <span class="comment">// G.Q. reinitialisation</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;         xjNorm = 0.; <span class="comment">// G.Q. reinitialisation</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;         <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>; k++) {</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            <span class="comment">// Index of sample j of variable i</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            <span class="comment">// l =  j * fNVariables + k;  // G.Q.</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a> =  k * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j; <span class="comment">// G.Q.</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            <a class="code" href="textangle_8C.html#a15eed939eb6efebfc935e895368c847a">m</a> =  k * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + i; <span class="comment">// G.Q.</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                                      <span class="comment">// G.Q.        xidotXj += (fVariables(i) - fMeanVariables(i))</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                                      <span class="comment">// G.Q.          * (fVariables(l) - fMeanVariables(j));</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            xidotXj += (<a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>(<a class="code" href="textangle_8C.html#a15eed939eb6efebfc935e895368c847a">m</a>) - <a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>(i))</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            * (<a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>(<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>) - <a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>(j));  <span class="comment">// G.Q. modified index for Xi</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            xjNorm  += (<a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>(<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>) - <a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>(j))</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            * (<a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>(<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>) - <a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>(j));</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;         }</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;         <span class="comment">//fCorrelationMatrix(i+1,j) = xidotXj / TMath::Sqrt(xiNorm * xjNorm);</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;         <a class="code" href="classTMultiDimFit.html#ab0e827c0499bce9f79783df14b60ec53">fCorrelationMatrix</a>(i,j+1) = xidotXj / <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(xiNorm * xjNorm);</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      }</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;   }</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;}</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">/// PRIVATE METHOD:</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">/// Make Gram-Schmidt orthogonalisation. The class description gives</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">/// a thorough account of this algorithm, as well as</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment">/// references. Please refer to the</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01501"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a70980d4b828a22e1eb686615519d1623"> 1501</a></span>&#160;<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="classTMultiDimFit.html#a70980d4b828a22e1eb686615519d1623">TMultiDimFit::MakeGramSchmidt</a>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <span class="keyword">function</span>)</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;{</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;   <span class="comment">// calculate w_i, that is, evaluate the current function at data</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;   <span class="comment">// point i</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> f2                        = 0;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;   <a class="code" href="classTMultiDimFit.html#a7bb76ca216ad08945970f45628bf0f21">fOrthCoefficients</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>)      = 0;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;   <a class="code" href="classTMultiDimFit.html#ae8179978b62885a88d026666777f7598">fOrthFunctionNorms</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>)  = 0;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> j        = 0;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> k        = 0;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;   <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>; j++) {</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;      <a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>, j) = 1;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      <a class="code" href="classTMultiDimFit.html#ab28ec111cdb90176007d7b090e3fe7f0">fOrthFunctions</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>, j) = 0;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      <span class="comment">// First, however, we need to calculate f_fNCoefficients</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; k++) {</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;         <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>    p   =  <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[<span class="keyword">function</span> * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + k];</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>   =  <a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>(j * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + k);</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;         <a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>, j) *= <a class="code" href="classTMultiDimFit.html#ad7419aa5ebe661a8e621059954476b66">EvalFactor</a>(p,<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>);</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      }</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <span class="comment">// Calculate f dot f in f2</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      f2 += <a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>,j) *  <a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>,j);</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      <span class="comment">// Assign to w_fNCoefficients f_fNCoefficients</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      <a class="code" href="classTMultiDimFit.html#ab28ec111cdb90176007d7b090e3fe7f0">fOrthFunctions</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>, j) = <a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>, j);</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;   }</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;   <span class="comment">// the first column of w is equal to f</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;   <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; j++) {</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> fdw = 0;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      <span class="comment">// Calculate (f_fNCoefficients dot w_j) / w_j^2</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>; k++) {</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;         fdw += <a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>, k) * <a class="code" href="classTMultiDimFit.html#ab28ec111cdb90176007d7b090e3fe7f0">fOrthFunctions</a>(j,k)</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;         / <a class="code" href="classTMultiDimFit.html#ae8179978b62885a88d026666777f7598">fOrthFunctionNorms</a>(j);</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      }</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      <a class="code" href="classTMultiDimFit.html#a188c31631ea14c84bbf6cbd74a6fa439">fOrthCurvatureMatrix</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>,j) = fdw;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <span class="comment">// and subtract it from the current value of w_ij</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>; k++)</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;         <a class="code" href="classTMultiDimFit.html#ab28ec111cdb90176007d7b090e3fe7f0">fOrthFunctions</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>,k) -= fdw * <a class="code" href="classTMultiDimFit.html#ab28ec111cdb90176007d7b090e3fe7f0">fOrthFunctions</a>(j,k);</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;   }</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;   <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>; j++) {</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      <span class="comment">// calculate squared length of w_fNCoefficients</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <a class="code" href="classTMultiDimFit.html#ae8179978b62885a88d026666777f7598">fOrthFunctionNorms</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>) +=</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <a class="code" href="classTMultiDimFit.html#ab28ec111cdb90176007d7b090e3fe7f0">fOrthFunctions</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>,j)</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      * <a class="code" href="classTMultiDimFit.html#ab28ec111cdb90176007d7b090e3fe7f0">fOrthFunctions</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>,j);</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <span class="comment">// calculate D dot w_fNCoefficients in A</span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      <a class="code" href="classTMultiDimFit.html#a7bb76ca216ad08945970f45628bf0f21">fOrthCoefficients</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>) += <a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>(j)</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      * <a class="code" href="classTMultiDimFit.html#ab28ec111cdb90176007d7b090e3fe7f0">fOrthFunctions</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>, j);</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;   }</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;   <span class="comment">// First test, but only if didn&#39;t user specify</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#a20cc6137d3c71256a9833f98f3a202c5">fIsUserFunction</a>)</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="classTMultiDimFit.html#ae8179978b62885a88d026666777f7598">fOrthFunctionNorms</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>) / (f2 + 1<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-10))</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;          &lt; <a class="code" href="namespaceTMath.html#acb6531465af378f4e6e4a8a62f8c6a4d">TMath::Sin</a>(<a class="code" href="classTMultiDimFit.html#aa04e50147be5c9a8d9040e3b826c75f8">fMinAngle</a>*<a class="code" href="TMultiDimFit_8cxx.html#ac377a5fa64fdef02d0048cf0e27aca2c">DEGRAD</a>))</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;   <span class="comment">// The result found by this code for the first residual is always</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;   <span class="comment">// much less then the one found be MUDIFI. That&#39;s because it&#39;s</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;   <span class="comment">// supposed to be. The cause is the improved precision of Double_t</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;   <span class="comment">// over DOUBLE PRECISION!</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;   <a class="code" href="classTMultiDimFit.html#a188c31631ea14c84bbf6cbd74a6fa439">fOrthCurvatureMatrix</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>,<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>) = 1;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a> = <a class="code" href="classTMultiDimFit.html#a7bb76ca216ad08945970f45628bf0f21">fOrthCoefficients</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>);</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;   <a class="code" href="classTMultiDimFit.html#a7bb76ca216ad08945970f45628bf0f21">fOrthCoefficients</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>) /= <a class="code" href="classTMultiDimFit.html#ae8179978b62885a88d026666777f7598">fOrthFunctionNorms</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>);</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;   <span class="comment">// Calculate the residual from including this fNCoefficients.</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> dResidur = <a class="code" href="classTMultiDimFit.html#a7bb76ca216ad08945970f45628bf0f21">fOrthCoefficients</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>) * <a class="code" href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a>;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;   <span class="keywordflow">return</span> dResidur;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;}</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment">/// Make histograms of the result of the analysis. This message</span></div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">/// should be sent after having read all data points, but before</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="comment">/// finding the parameterization</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="comment">/// Options:</span></div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="comment">///     A         All the below</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment">///     X         Original independent variables</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment">///     D         Original dependent variables</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment">///     N         Normalised independent variables</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment">///     S         Shifted dependent variables</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment">///     R1        Residuals versus normalised independent variables</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment">///     R2        Residuals versus dependent variable</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment">///     R3        Residuals computed on training sample</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment">///     R4        Residuals computed on test sample</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="comment">/// For a description of these quantities, refer to</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01594"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#af062a8ff2b0850e9b25edd065b4d9b2e"> 1594</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#af062a8ff2b0850e9b25edd065b4d9b2e">TMultiDimFit::MakeHistograms</a>(<a class="code" href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a> *option)</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;{</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;   <a class="code" href="classTString.html">TString</a> opt(option);</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;   opt.<a class="code" href="classTString.html#a1be9e2a41facebeac4feddd9801a0034">ToLower</a>();</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#a04e631ef510bdd4071c37b54fde0c1a7">Length</a>() &lt; 1)</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>)</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      <a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a> = <span class="keyword">new</span> <a class="code" href="classTList.html">TList</a>;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;   <span class="comment">// Counter variable</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;   <span class="comment">// Histogram of original variables</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;x&quot;</span>) || opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;a&quot;</span>)) {</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <a class="code" href="Rtypes_8h.html#a673d0ae6e667e3a49b5e42f65ded566e">SETBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#a5ab555f0b173febdb3ee3e426ab261a0">HIST_XORIG</a>);</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;x_%d_orig&quot;</span>,i)))</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            <a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a1b90ccfbde1729266b585194fa45df14">Add</a>(<span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;x_%d_orig&quot;</span>,i),</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                                      <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;Original variable # %d&quot;</span>,i),</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                                      <a class="code" href="classTMultiDimFit.html#acfcf45d7b310b62d46f9908aaa7a38dc">fBinVarX</a>, <a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>(i),</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                                      <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(i)));</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;   }</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;   <span class="comment">// Histogram of original dependent variable</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;d&quot;</span>) || opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;a&quot;</span>)) {</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;      <a class="code" href="Rtypes_8h.html#a673d0ae6e667e3a49b5e42f65ded566e">SETBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#a197a8cb6c7980161c743d7406270956f">HIST_DORIG</a>);</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<span class="stringliteral">&quot;d_orig&quot;</span>))</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;         <a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a1b90ccfbde1729266b585194fa45df14">Add</a>(<span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;d_orig&quot;</span>, <span class="stringliteral">&quot;Original Quantity&quot;</span>,</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                                   <a class="code" href="classTMultiDimFit.html#acfcf45d7b310b62d46f9908aaa7a38dc">fBinVarX</a>, <a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a>, <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a>));</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;   }</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;   <span class="comment">// Histograms of normalized variables</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;n&quot;</span>) || opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;a&quot;</span>)) {</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;      <a class="code" href="Rtypes_8h.html#a673d0ae6e667e3a49b5e42f65ded566e">SETBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#a1d1ed449317205baf4318315bec57474">HIST_XNORM</a>);</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;x_%d_norm&quot;</span>,i)))</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;            <a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a1b90ccfbde1729266b585194fa45df14">Add</a>(<span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;x_%d_norm&quot;</span>,i),</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                                      <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;Normalized variable # %d&quot;</span>,i),</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                                      <a class="code" href="classTMultiDimFit.html#acfcf45d7b310b62d46f9908aaa7a38dc">fBinVarX</a>, -1,1));</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;   }</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;   <span class="comment">// Histogram of shifted dependent variable</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;s&quot;</span>) || opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;a&quot;</span>)) {</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;      <a class="code" href="Rtypes_8h.html#a673d0ae6e667e3a49b5e42f65ded566e">SETBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#a02c88c0b6d9d5d3086ceca952d079aed">HIST_DSHIF</a>);</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<span class="stringliteral">&quot;d_shifted&quot;</span>))</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;         <a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a1b90ccfbde1729266b585194fa45df14">Add</a>(<span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;d_shifted&quot;</span>, <span class="stringliteral">&quot;Shifted Quantity&quot;</span>,</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                                   <a class="code" href="classTMultiDimFit.html#acfcf45d7b310b62d46f9908aaa7a38dc">fBinVarX</a>, <a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a> - <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>,</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                                   <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a> - <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>));</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;   }</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;   <span class="comment">// Residual from training sample versus independent variables</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;r1&quot;</span>) || opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;a&quot;</span>)) {</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      <a class="code" href="Rtypes_8h.html#a673d0ae6e667e3a49b5e42f65ded566e">SETBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#a280cd1275ebe4292c7e05c62740e5b3f">HIST_RX</a>);</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;res_x_%d&quot;</span>,i)))</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;            <a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a1b90ccfbde1729266b585194fa45df14">Add</a>(<span class="keyword">new</span> <a class="code" href="classTH2D.html">TH2D</a>(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;res_x_%d&quot;</span>,i),</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                                      <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;Computed residual versus x_%d&quot;</span>, i),</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                                      <a class="code" href="classTMultiDimFit.html#acfcf45d7b310b62d46f9908aaa7a38dc">fBinVarX</a>, -1,    1,</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                                      <a class="code" href="classTMultiDimFit.html#a5b4d1c29886a160d7c10e10fedd8f23b">fBinVarY</a>,</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                                      <a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a> - <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>,</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                                      <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a> - <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>));</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;   }</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;   <span class="comment">// Residual from training sample versus. dependent variable</span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;r2&quot;</span>) || opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;a&quot;</span>)) {</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <a class="code" href="Rtypes_8h.html#a673d0ae6e667e3a49b5e42f65ded566e">SETBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#ae026def51d4bb2970016a9150e817378">HIST_RD</a>);</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<span class="stringliteral">&quot;res_d&quot;</span>))</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;         <a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a1b90ccfbde1729266b585194fa45df14">Add</a>(<span class="keyword">new</span> <a class="code" href="classTH2D.html">TH2D</a>(<span class="stringliteral">&quot;res_d&quot;</span>,</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                                   <span class="stringliteral">&quot;Computed residuals vs Quantity&quot;</span>,</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                                   <a class="code" href="classTMultiDimFit.html#acfcf45d7b310b62d46f9908aaa7a38dc">fBinVarX</a>,</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                                   <a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a> - <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>,</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                                   <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a> - <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>,</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                                   <a class="code" href="classTMultiDimFit.html#a5b4d1c29886a160d7c10e10fedd8f23b">fBinVarY</a>,</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                                   <a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a> - <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>,</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                                   <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a> - <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>));</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;   }</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;   <span class="comment">// Residual from training sample</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;r3&quot;</span>) || opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;a&quot;</span>)) {</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <a class="code" href="Rtypes_8h.html#a673d0ae6e667e3a49b5e42f65ded566e">SETBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#ad15c4be1d09512b8b100f4d97ff13e09">HIST_RTRAI</a>);</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<span class="stringliteral">&quot;res_train&quot;</span>))</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;         <a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a1b90ccfbde1729266b585194fa45df14">Add</a>(<span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;res_train&quot;</span>,</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                                   <span class="stringliteral">&quot;Computed residuals over training sample&quot;</span>,</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                                   <a class="code" href="classTMultiDimFit.html#acfcf45d7b310b62d46f9908aaa7a38dc">fBinVarX</a>, <a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a> - <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>,</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                                   <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a> - <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>));</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;   }</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;r4&quot;</span>) || opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;a&quot;</span>)) {</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <a class="code" href="Rtypes_8h.html#a673d0ae6e667e3a49b5e42f65ded566e">SETBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#abc53d6530eb580057e12ecb5b4e88b48">HIST_RTEST</a>);</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<span class="stringliteral">&quot;res_test&quot;</span>))</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;         <a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a1b90ccfbde1729266b585194fa45df14">Add</a>(<span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;res_test&quot;</span>,</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                                   <span class="stringliteral">&quot;Distribution of residuals from test&quot;</span>,</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                                   <a class="code" href="classTMultiDimFit.html#acfcf45d7b310b62d46f9908aaa7a38dc">fBinVarX</a>,<a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a> - <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>,</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                                   <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a> - <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>));</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;   }</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;}</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment">/// Generate the file &lt;classname&gt;MDF.cxx which contains the</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="comment">/// implementation of the method:</span></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="comment">///   Double_t &lt;classname&gt;::MDF(Double_t *x)</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment">/// which does the same as  TMultiDimFit::Eval. Please refer to this</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment">/// method.</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment">/// Further, the public static members:</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment">///   Int_t    &lt;classname&gt;::fgNVariables</span></div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="comment">///   Int_t    &lt;classname&gt;::fgNCoefficients</span></div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="comment">///   Double_t &lt;classname&gt;::fgDMean</span></div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="comment">///   Double_t &lt;classname&gt;::fgXMean[]       //[fgNVariables]</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="comment">///   Double_t &lt;classname&gt;::fgXMin[]        //[fgNVariables]</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="comment">///   Double_t &lt;classname&gt;::fgXMax[]        //[fgNVariables]</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="comment">///   Double_t &lt;classname&gt;::fgCoefficient[] //[fgNCoeffficents]</span></div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="comment">///   Int_t    &lt;classname&gt;::fgPower[]       //[fgNCoeffficents*fgNVariables]</span></div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="comment">/// are initialized, and assumed to exist. The class declaration is</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="comment">/// assumed to be in &lt;classname&gt;.h and assumed to be provided by the</span></div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="comment">/// user.</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="comment">/// See TMultiDimFit::MakeRealCode for a list of options</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="comment">/// The minimal class definition is:</span></div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="comment">///   class &lt;classname&gt; {</span></div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="comment">///   public:</span></div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="comment">///     Int_t    &lt;classname&gt;::fgNVariables;     // Number of variables</span></div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="comment">///     Int_t    &lt;classname&gt;::fgNCoefficients;  // Number of terms</span></div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="comment">///     Double_t &lt;classname&gt;::fgDMean;          // Mean from training sample</span></div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="comment">///     Double_t &lt;classname&gt;::fgXMean[];        // Mean from training sample</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="comment">///     Double_t &lt;classname&gt;::fgXMin[];         // Min from training sample</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="comment">///     Double_t &lt;classname&gt;::fgXMax[];         // Max from training sample</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="comment">///     Double_t &lt;classname&gt;::fgCoefficient[];  // Coefficients</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<span class="comment">///     Int_t    &lt;classname&gt;::fgPower[];        // Function powers</span></div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;<span class="comment">///     Double_t Eval(Double_t *x);</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="comment">///   };</span></div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="comment">/// Whether the method &lt;classname&gt;::Eval should be static or not, is</span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="comment">/// up to the user.</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01739"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#aa71dd7c6c4b0ed57cf64dbcd8b832827"> 1739</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#aa71dd7c6c4b0ed57cf64dbcd8b832827">TMultiDimFit::MakeMethod</a>(<span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#a72a4388b7fc57f981af8c65fefcceb1f">Char_t</a>* classname, <a class="code" href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a>* option)</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;{</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;   <a class="code" href="classTMultiDimFit.html#a8ea4d7c005735061af8d1246a0b6594b">MakeRealCode</a>(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;%sMDF.cxx&quot;</span>, classname), classname, option);</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;}</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">/// PRIVATE METHOD:</span></div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment">/// Normalize data to the interval [-1;1]. This is needed for the</span></div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="comment">/// classes method to work.</span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01751"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a505a681f417fc9e6f7a33bac37b597d4"> 1751</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#a505a681f417fc9e6f7a33bac37b597d4">TMultiDimFit::MakeNormalized</a>()</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;{</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> j = 0;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> k = 0;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>; i++) {</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#a93170b16cd359cbf0e8643c41b987703">TESTBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#a197a8cb6c7980161c743d7406270956f">HIST_DORIG</a>))</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;         ((<a class="code" href="classTH1D.html">TH1D</a>*)<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<span class="stringliteral">&quot;d_orig&quot;</span>))-&gt;Fill(<a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>(i));</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;      <a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>(i) -= <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>;</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;      <a class="code" href="classTMultiDimFit.html#a482dd2926682899a1c2eadc5448fa68a">fSumSqAvgQuantity</a>  += <a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>(i) * <a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>(i);</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#a93170b16cd359cbf0e8643c41b987703">TESTBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#a02c88c0b6d9d5d3086ceca952d079aed">HIST_DSHIF</a>))</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;         ((<a class="code" href="classTH1D.html">TH1D</a>*)<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<span class="stringliteral">&quot;d_shifted&quot;</span>))-&gt;Fill(<a class="code" href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">fQuantity</a>(i));</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++) {</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> range = 1. / (<a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(j) - <a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>(j));</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;         k              = i * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;         <span class="comment">// Fill histograms of original independent variables</span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#a93170b16cd359cbf0e8643c41b987703">TESTBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#a5ab555f0b173febdb3ee3e426ab261a0">HIST_XORIG</a>))</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;            ((<a class="code" href="classTH1D.html">TH1D</a>*)<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;x_%d_orig&quot;</span>,j)))</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;            -&gt;Fill(<a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>(k));</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;         <span class="comment">// Normalise independent variables</span></div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;         <a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>(k) = 1 + 2 * range * (<a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>(k) - <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(j));</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;         <span class="comment">// Fill histograms of normalised independent variables</span></div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="Rtypes_8h.html#a93170b16cd359cbf0e8643c41b987703">TESTBIT</a>(<a class="code" href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">fHistogramMask</a>,<a class="code" href="TMultiDimFit_8cxx.html#a1d1ed449317205baf4318315bec57474">HIST_XNORM</a>))</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            ((<a class="code" href="classTH1D.html">TH1D</a>*)<a class="code" href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">fHistograms</a>-&gt;<a class="code" href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">FindObject</a>(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;x_%d_norm&quot;</span>,j)))</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            -&gt;Fill(<a class="code" href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">fVariables</a>(k));</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      }</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;   }</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;   <span class="comment">// Shift min and max of dependent variable</span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;   <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a> -= <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;   <a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a> -= <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a>;</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;   <span class="comment">// Shift mean of independent variables</span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++) {</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> range = 1. / (<a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(i) - <a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>(i));</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      <a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>(i) = 1 + 2 * range * (<a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>(i)</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                                           - <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(i));</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;   }</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;}</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="comment">/// PRIVATE METHOD:</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="comment">/// Find the parameterization over the training sample. A full account</span></div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="comment">/// of the algorithm is given in the</span></div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01805"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#abc69e78e14f641805c364fb9f5a620fa"> 1805</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#abc69e78e14f641805c364fb9f5a620fa">TMultiDimFit::MakeParameterization</a>()</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;{</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>     i              = -1;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>     j              = 0;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>     k              = 0;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>     maxPass        = 3;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>     studied        = 0;</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>  squareResidual = <a class="code" href="classTMultiDimFit.html#a482dd2926682899a1c2eadc5448fa68a">fSumSqAvgQuantity</a>;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;   <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>            = 0;</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;   <a class="code" href="classTMultiDimFit.html#aa155aa11e0a5891ddd5678e2c0b6e0a8">fSumSqResidual</a>           = <a class="code" href="classTMultiDimFit.html#a482dd2926682899a1c2eadc5448fa68a">fSumSqAvgQuantity</a>;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;   <a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a>.<a class="code" href="classTMatrixT.html#a208f00289448b5f78b4bf033f18abc43">ResizeTo</a>(<a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a>,<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>);</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;   <a class="code" href="classTMultiDimFit.html#ab28ec111cdb90176007d7b090e3fe7f0">fOrthFunctions</a>.<a class="code" href="classTMatrixT.html#a208f00289448b5f78b4bf033f18abc43">ResizeTo</a>(<a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a>,<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>);</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;   <a class="code" href="classTMultiDimFit.html#ae8179978b62885a88d026666777f7598">fOrthFunctionNorms</a>.<a class="code" href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">ResizeTo</a>(<a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a>);</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;   <a class="code" href="classTMultiDimFit.html#a7bb76ca216ad08945970f45628bf0f21">fOrthCoefficients</a>.<a class="code" href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">ResizeTo</a>(<a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a>);</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;   <a class="code" href="classTMultiDimFit.html#a188c31631ea14c84bbf6cbd74a6fa439">fOrthCurvatureMatrix</a>.<a class="code" href="classTMatrixT.html#a208f00289448b5f78b4bf033f18abc43">ResizeTo</a>(<a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a>,<a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a>);</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;   <a class="code" href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">fFunctions</a> = 1;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;   <a class="code" href="classTMultiDimFit.html#afd6da56fd072b4d48a656001ae080e71">fFunctionCodes</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[<a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>];</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;   <a class="code" href="classTMultiDimFit.html#ab1c8c0801040a8ba1d7fefdf107a289d">fPowerIndex</a>    = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[<a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a>];</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>;</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>=0;<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>&lt;<a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>;<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>++) <a class="code" href="classTMultiDimFit.html#afd6da56fd072b4d48a656001ae080e71">fFunctionCodes</a>[<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>] = 0;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>=0;<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>&lt;<a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a>;<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>++)     <a class="code" href="classTMultiDimFit.html#ab1c8c0801040a8ba1d7fefdf107a289d">fPowerIndex</a>[<a class="code" href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a>]    = 0;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a9957717d755bac7da27236ca52a5af6b">fMaxAngle</a> != 0)  maxPass = 100;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a20cc6137d3c71256a9833f98f3a202c5">fIsUserFunction</a>) maxPass = 1;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;   <span class="comment">// Loop over the number of functions we want to study.</span></div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;   <span class="comment">// increment inspection counter</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;   <span class="keywordflow">while</span>(<a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>) {</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      <span class="comment">// Reach user defined limit of studies</span></div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;      <span class="keywordflow">if</span> (studied++ &gt;= <a class="code" href="classTMultiDimFit.html#a56a33cdba3c529818b7f8407813bab18">fMaxStudy</a>) {</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;         <a class="code" href="classTMultiDimFit.html#a969d67752c326e4456832e00ba6464f3">fParameterisationCode</a> = <a class="code" href="TMultiDimFit_8cxx.html#a634868703c8cc999d06cff35a8a289fc">PARAM_MAXSTUDY</a>;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      }</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;      <span class="comment">// Considered all functions several times</span></div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;      <span class="keywordflow">if</span> (k &gt;= maxPass) {</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;         <a class="code" href="classTMultiDimFit.html#a969d67752c326e4456832e00ba6464f3">fParameterisationCode</a> = <a class="code" href="TMultiDimFit_8cxx.html#a5bab3ed8bd37031d95ed6e105c4cfa8d">PARAM_SEVERAL</a>;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      }</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;      <span class="comment">// increment function counter</span></div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;      i++;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      <span class="comment">// If we&#39;ve reached the end of the functions, restart pass</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      <span class="keywordflow">if</span> (i == <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>) {</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a9957717d755bac7da27236ca52a5af6b">fMaxAngle</a> != 0)</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;            <a class="code" href="classTMultiDimFit.html#a9957717d755bac7da27236ca52a5af6b">fMaxAngle</a> += (90 - <a class="code" href="classTMultiDimFit.html#a9957717d755bac7da27236ca52a5af6b">fMaxAngle</a>) / 2;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;         i = 0;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;         studied--;</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;         k++;</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      }</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      <span class="keywordflow">if</span> (studied == 1)</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;         <a class="code" href="classTMultiDimFit.html#afd6da56fd072b4d48a656001ae080e71">fFunctionCodes</a>[i] = 0;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#afd6da56fd072b4d48a656001ae080e71">fFunctionCodes</a>[i] &gt;= 2)</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <span class="comment">// Print a happy message</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#af689396ca31f81ddcf49870cce1779c9">fIsVerbose</a> &amp;&amp; studied == 1)</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;Coeff   SumSqRes    Contrib   Angle      QM   Func&quot;</span></div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;     Value        W^2  Powers&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      <span class="comment">// Make the Gram-Schmidt</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> dResidur = <a class="code" href="classTMultiDimFit.html#a70980d4b828a22e1eb686615519d1623">MakeGramSchmidt</a>(i);</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <span class="keywordflow">if</span> (dResidur == 0) {</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;         <span class="comment">// This function is no good!</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;         <span class="comment">// First test is in MakeGramSchmidt</span></div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;         <a class="code" href="classTMultiDimFit.html#afd6da56fd072b4d48a656001ae080e71">fFunctionCodes</a>[i] = 1;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      }</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      <span class="comment">// If user specified function, assume they know what they are doing</span></div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#a20cc6137d3c71256a9833f98f3a202c5">fIsUserFunction</a>) {</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;         <span class="comment">// Flag this function as considered</span></div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;         <a class="code" href="classTMultiDimFit.html#afd6da56fd072b4d48a656001ae080e71">fFunctionCodes</a>[i] = 2;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;         <span class="comment">// Test if this function contributes to the fit</span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="classTMultiDimFit.html#a7e7c7d5aaa6979e17c33af220dc37b18">TestFunction</a>(squareResidual, dResidur)) {</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;            <a class="code" href="classTMultiDimFit.html#afd6da56fd072b4d48a656001ae080e71">fFunctionCodes</a>[i] = 1;</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;         }</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      }</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      <span class="comment">// If we get to here, the function currently considered is</span></div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      <span class="comment">// fNCoefficients, so we increment the counter</span></div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      <span class="comment">// Flag this function as OK, and store and the number in the</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <span class="comment">// index.</span></div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      <a class="code" href="classTMultiDimFit.html#afd6da56fd072b4d48a656001ae080e71">fFunctionCodes</a>[i]          = 3;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <a class="code" href="classTMultiDimFit.html#ab1c8c0801040a8ba1d7fefdf107a289d">fPowerIndex</a>[<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>] = i;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>++;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="comment">// We add the current contribution to the sum of square of</span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      <span class="comment">// residuals;</span></div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      squareResidual -= dResidur;</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <span class="comment">// Calculate control parameter from this function</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++) {</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a> == 1</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;             || <a class="code" href="classTMultiDimFit.html#a8868c2f37dc91673d7fe3be00bcb5eae">fMaxPowersFinal</a>[j] &lt;= <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[i * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j] - 1)</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;            <a class="code" href="classTMultiDimFit.html#a8868c2f37dc91673d7fe3be00bcb5eae">fMaxPowersFinal</a>[j] = <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[i * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j] - 1;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      }</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> = <a class="code" href="classTMultiDimFit.html#ab6c34ca711c504890abcf7e668bd1de3">EvalControl</a>(&amp;<a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[i * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>]);</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <span class="comment">// Print the statistics about this function</span></div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#af689396ca31f81ddcf49870cce1779c9">fIsVerbose</a>) {</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;         std::cout &lt;&lt; std::setw(5)  &lt;&lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;         &lt;&lt; std::setw(10) &lt;&lt; std::setprecision(4) &lt;&lt; squareResidual &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;         &lt;&lt; std::setw(10) &lt;&lt; std::setprecision(4) &lt;&lt; dResidur &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;         &lt;&lt; std::setw(7)  &lt;&lt; std::setprecision(3) &lt;&lt; <a class="code" href="classTMultiDimFit.html#a9957717d755bac7da27236ca52a5af6b">fMaxAngle</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;         &lt;&lt; std::setw(7)  &lt;&lt; std::setprecision(3) &lt;&lt; <a class="code" href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">s</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;         &lt;&lt; std::setw(5)  &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;         &lt;&lt; std::setw(10) &lt;&lt; std::setprecision(4)</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;         &lt;&lt; <a class="code" href="classTMultiDimFit.html#a7bb76ca216ad08945970f45628bf0f21">fOrthCoefficients</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>-1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;         &lt;&lt; std::setw(10) &lt;&lt; std::setprecision(4)</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;         &lt;&lt; <a class="code" href="classTMultiDimFit.html#ae8179978b62885a88d026666777f7598">fOrthFunctionNorms</a>(<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>-1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;         &lt;&lt; std::flush;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++)</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[i * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j] - 1 &lt;&lt; std::flush;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;         std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      }</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a> &gt;= <a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a> <span class="comment">/* &amp;&amp; fIsVerbose */</span>) {</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;         <a class="code" href="classTMultiDimFit.html#a969d67752c326e4456832e00ba6464f3">fParameterisationCode</a> = <a class="code" href="TMultiDimFit_8cxx.html#af90c111e0b8dbee3646b0a50da904c7d">PARAM_MAXTERMS</a>;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      }</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> err  = <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="namespaceTMath.html#a38e1c23e08564d17051526d7e0a5364d">TMath::Max</a>(1<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-20,squareResidual) /</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                                  <a class="code" href="classTMultiDimFit.html#a482dd2926682899a1c2eadc5448fa68a">fSumSqAvgQuantity</a>);</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      <span class="keywordflow">if</span> (err &lt; <a class="code" href="classTMultiDimFit.html#afc80a4fe1f39eb2124bffbc4029484cc">fMinRelativeError</a>) {</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;         <a class="code" href="classTMultiDimFit.html#a969d67752c326e4456832e00ba6464f3">fParameterisationCode</a> = <a class="code" href="TMultiDimFit_8cxx.html#a1843561a29ec05879992dc840caf4221">PARAM_RELERR</a>;</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      }</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;   }</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;   <a class="code" href="classTMultiDimFit.html#ac9cc5e457015ce9f569e0c2e865d8ecf">fError</a>          = <a class="code" href="namespaceTMath.html#a38e1c23e08564d17051526d7e0a5364d">TMath::Max</a>(1<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-20,squareResidual);</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;   <a class="code" href="classTMultiDimFit.html#aa155aa11e0a5891ddd5678e2c0b6e0a8">fSumSqResidual</a> -= <a class="code" href="classTMultiDimFit.html#ac9cc5e457015ce9f569e0c2e865d8ecf">fError</a>;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;   <a class="code" href="classTMultiDimFit.html#a915f6ba6a911fc155d32ff94d2c5ed90">fRMS</a> = <a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(<a class="code" href="classTMultiDimFit.html#ac9cc5e457015ce9f569e0c2e865d8ecf">fError</a> / <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a>);</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;}</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<span class="comment">/// PRIVATE METHOD:</span></div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;<span class="comment">/// This is the method that actually generates the code for the</span></div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="comment">/// evaluation the parameterization on some point.</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="comment">/// It&#39;s called by TMultiDimFit::MakeCode and TMultiDimFit::MakeMethod.</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="comment">/// The options are: NONE so far</span></div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01958"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a8ea4d7c005735061af8d1246a0b6594b"> 1958</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#a8ea4d7c005735061af8d1246a0b6594b">TMultiDimFit::MakeRealCode</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename,</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">char</span> *classname,</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                                <a class="code" href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a> *)</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;{</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i, j;</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;   <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a>  isMethod     = (classname[0] == <span class="charliteral">&#39;\0&#39;</span> ? <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a> : <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>);</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix   = (isMethod ? <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;%s::&quot;</span>, classname) : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *cv_qual  = (isMethod ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;static &quot;</span>);</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;   std::ofstream outFile(filename,std::ios::out|std::ios::trunc);</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;   <span class="keywordflow">if</span> (!outFile) {</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;MakeRealCode&quot;</span>,<span class="stringliteral">&quot;couldn&#39;t open output file &#39;%s&#39;&quot;</span>,filename);</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;   }</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#af689396ca31f81ddcf49870cce1779c9">fIsVerbose</a>)</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Writing on file \&quot;&quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot;\&quot; ... &quot;</span> &lt;&lt; std::flush;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;   <span class="comment">// Write header of file</span></div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;   <span class="comment">// Emacs mode line ;-)</span></div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;// -*- mode: c++ -*-&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;   <span class="comment">// Info about creator</span></div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;// &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;// File &quot;</span> &lt;&lt; filename</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;   &lt;&lt; <span class="stringliteral">&quot; generated by TMultiDimFit::MakeRealCode&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;   <span class="comment">// Time stamp</span></div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;   <a class="code" href="classTDatime.html">TDatime</a> date;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;// on &quot;</span> &lt;&lt; date.<a class="code" href="classTDatime.html#afcaa0035a009ab4b8c09a85ee01b0b7c">AsString</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;   <span class="comment">// ROOT version info</span></div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;// ROOT version &quot;</span> &lt;&lt; <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;GetVersion()</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;   &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;//&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;   <span class="comment">// General information on the code</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;// This file contains the function &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;//&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;//    double  &quot;</span> &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot;MDF(double *x); &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;//&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;// For evaluating the parameterization obtained&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;// from TMultiDimFit and the point x&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;// &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;// See TMultiDimFit class documentation for more &quot;</span></div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;information &quot;</span> &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;// &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;   <span class="comment">// Header files</span></div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;   <span class="keywordflow">if</span> (isMethod)</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      <span class="comment">// If these are methods, we need the class header</span></div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      outFile &lt;&lt; <span class="stringliteral">&quot;#include \&quot;&quot;</span> &lt;&lt; classname &lt;&lt; <span class="stringliteral">&quot;.h\&quot;&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;   <span class="comment">// Now for the data</span></div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;//&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;// Static data variables&quot;</span>  &lt;&lt; std::endl</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;//&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;   outFile &lt;&lt; cv_qual &lt;&lt; <span class="stringliteral">&quot;int    &quot;</span> &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot;gNVariables    = &quot;</span></div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;   &lt;&lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> &lt;&lt; <span class="stringliteral">&quot;;&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;   outFile &lt;&lt; cv_qual &lt;&lt; <span class="stringliteral">&quot;int    &quot;</span> &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot;gNCoefficients = &quot;</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;   &lt;&lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a> &lt;&lt; <span class="stringliteral">&quot;;&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;   outFile &lt;&lt; cv_qual &lt;&lt; <span class="stringliteral">&quot;double &quot;</span> &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot;gDMean         = &quot;</span></div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;   &lt;&lt; <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a> &lt;&lt; <span class="stringliteral">&quot;;&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;   <span class="comment">// Assignment to mean vector.</span></div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;// Assignment to mean vector.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;   outFile &lt;&lt; cv_qual &lt;&lt; <span class="stringliteral">&quot;double &quot;</span> &lt;&lt; prefix</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;gXMean[] = {&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      outFile &lt;&lt; (i != 0 ? <span class="stringliteral">&quot;, &quot;</span> : <span class="stringliteral">&quot;  &quot;</span>) &lt;&lt; <a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>(i) &lt;&lt; std::flush;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot; };&quot;</span> &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;   <span class="comment">// Assignment to minimum vector.</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;// Assignment to minimum vector.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;   outFile &lt;&lt; cv_qual &lt;&lt; <span class="stringliteral">&quot;double &quot;</span> &lt;&lt; prefix</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;gXMin[] = {&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      outFile &lt;&lt; (i != 0 ? <span class="stringliteral">&quot;, &quot;</span> : <span class="stringliteral">&quot;  &quot;</span>) &lt;&lt; <a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>(i) &lt;&lt; std::flush;</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot; };&quot;</span> &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;   <span class="comment">// Assignment to maximum vector.</span></div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;// Assignment to maximum vector.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;   outFile &lt;&lt; cv_qual &lt;&lt; <span class="stringliteral">&quot;double &quot;</span> &lt;&lt; prefix</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;gXMax[] = {&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;      outFile &lt;&lt; (i != 0 ? <span class="stringliteral">&quot;, &quot;</span> : <span class="stringliteral">&quot;  &quot;</span>) &lt;&lt; <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(i) &lt;&lt; std::flush;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot; };&quot;</span> &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;   <span class="comment">// Assignment to coefficients vector.</span></div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;// Assignment to coefficients vector.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;   outFile &lt;&lt; cv_qual &lt;&lt; <span class="stringliteral">&quot;double &quot;</span> &lt;&lt; prefix</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;gCoefficient[] = {&quot;</span> &lt;&lt; std::flush;</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; i++)</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      outFile &lt;&lt; (i != 0 ? <span class="stringliteral">&quot;,&quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt; std::endl</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>(i) &lt;&lt; std::flush;</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;   outFile &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot; };&quot;</span> &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;   <span class="comment">// Assignment to error coefficients vector.</span></div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;// Assignment to error coefficients vector.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;   outFile &lt;&lt; cv_qual &lt;&lt; <span class="stringliteral">&quot;double &quot;</span> &lt;&lt; prefix</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;gCoefficientRMS[] = {&quot;</span> &lt;&lt; std::flush;</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; i++)</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;      outFile &lt;&lt; (i != 0 ? <span class="stringliteral">&quot;,&quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt; std::endl</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#ae985f0b701950ec974977159a9bf138f">fCoefficientsRMS</a>(i) &lt;&lt; std::flush;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;   outFile &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot; };&quot;</span> &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;   <span class="comment">// Assignment to powers vector.</span></div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;// Assignment to powers vector.&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;// The powers are stored row-wise, that is&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;//  p_ij = &quot;</span> &lt;&lt; prefix</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;gPower[i * NVariables + j];&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;   outFile &lt;&lt; cv_qual &lt;&lt; <span class="stringliteral">&quot;int    &quot;</span> &lt;&lt; prefix</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;gPower[] = {&quot;</span> &lt;&lt; std::flush;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; i++) {</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++) {</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;         <span class="keywordflow">if</span> (j != 0) outFile &lt;&lt; std::flush &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>;</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;         <span class="keywordflow">else</span>        outFile &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>;</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;         outFile &lt;&lt; <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[<a class="code" href="classTMultiDimFit.html#ab1c8c0801040a8ba1d7fefdf107a289d">fPowerIndex</a>[i] * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j]</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;         &lt;&lt; (i == <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a> - 1 &amp;&amp; j == <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> - 1 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;,&quot;</span>)</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;         &lt;&lt; std::flush;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      }</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;   }</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;   outFile &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;};&quot;</span> &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;   <span class="comment">// Finally we reach the function itself</span></div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;// &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;// The &quot;</span></div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;   &lt;&lt; (isMethod ? <span class="stringliteral">&quot;method &quot;</span> : <span class="stringliteral">&quot;function &quot;</span>)</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;  double &quot;</span> &lt;&lt; prefix</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;MDF(double *x)&quot;</span></div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;   &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;// &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;double &quot;</span> &lt;&lt; prefix</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;MDF(double *x) {&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;  double returnValue = &quot;</span> &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot;gDMean;&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;  int    i = 0, j = 0, k = 0;&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;  for (i = 0; i &lt; &quot;</span> &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot;gNCoefficients ; i++) {&quot;</span></div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;   &lt;&lt; std::endl</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;    // Evaluate the ith term in the expansion&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;    double term = &quot;</span> &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot;gCoefficient[i];&quot;</span></div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;   &lt;&lt; std::endl</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;    for (j = 0; j &lt; &quot;</span> &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot;gNVariables; j++) {&quot;</span></div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;   &lt;&lt; std::endl</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;      // Evaluate the polynomial in the jth variable.&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;      int power = &quot;</span>&lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot;gPower[&quot;</span></div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;   &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot;gNVariables * i + j]; &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;      double p1 = 1, p2 = 0, p3 = 0, r = 0;&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;      double v =  1 + 2. / (&quot;</span></div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;   &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot;gXMax[j] - &quot;</span> &lt;&lt; prefix</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;gXMin[j]) * (x[j] - &quot;</span> &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot;gXMax[j]);&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;      // what is the power to use!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;      switch(power) {&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;      case 1: r = 1; break; &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;      case 2: r = v; break; &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;      default: &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;        p2 = v; &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;        for (k = 3; k &lt;= power; k++) { &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;          p3 = p2 * v;&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#abdab5d9509890288a37712774a5f61ed">fPolyType</a> == <a class="code" href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152ea6c631fe681d300f83c3a5e8334cc1ab7">kLegendre</a>)</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;      outFile &lt;&lt; <span class="stringliteral">&quot;          p3 = ((2 * i - 3) * p2 * v - (i - 2) * p1)&quot;</span></div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; / (i - 1);&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#abdab5d9509890288a37712774a5f61ed">fPolyType</a> == <a class="code" href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152eac9953ab7fc01b500168df1fa056fba5f">kChebyshev</a>)</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      outFile &lt;&lt; <span class="stringliteral">&quot;          p3 = 2 * v * p2 - p1; &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;          p1 = p2; p2 = p3; &quot;</span> &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;        }&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;        r = p3;&quot;</span> &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;      }&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;      // multiply this term by the poly in the jth var&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;      term *= r; &quot;</span> &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;    }&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;    // Add this term to the final result&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;    returnValue += term;&quot;</span> &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;  }&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;  return returnValue;&quot;</span> &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;   <span class="comment">// EOF</span></div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;   outFile &lt;&lt; <span class="stringliteral">&quot;// EOF for &quot;</span> &lt;&lt; filename &lt;&lt; std::endl;</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;   <span class="comment">// Close the file</span></div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;   outFile.close();</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#af689396ca31f81ddcf49870cce1779c9">fIsVerbose</a>)</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;done&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;}</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="comment">/// Print statistics etc.</span></div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="comment">/// Options are</span></div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="comment">///   P        Parameters</span></div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="comment">///   S        Statistics</span></div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="comment">///   C        Coefficients</span></div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="comment">///   R        Result of parameterisation</span></div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;<span class="comment">///   F        Result of fit</span></div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment">///   K        Correlation Matrix</span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="comment">///   M        Pretty print formula</span></div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02151"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#ae18eb732b7f700f28365e074d2685096"> 2151</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#ae18eb732b7f700f28365e074d2685096">TMultiDimFit::Print</a>(<a class="code" href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a> *option)<span class="keyword"> const</span></div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0;</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> j = 0;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;   <a class="code" href="classTString.html">TString</a> opt(option);</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;   opt.<a class="code" href="classTString.html#a1be9e2a41facebeac4feddd9801a0034">ToLower</a>();</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;p&quot;</span>)) {</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      <span class="comment">// Print basic parameters for this object</span></div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;User parameters:&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;----------------&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Variables:                    &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> &lt;&lt; std::endl</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Data points:                  &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a> &lt;&lt; std::endl</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Max Terms:                    &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a> &lt;&lt; std::endl</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Power Limit Parameter:        &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#aea2ee066fdfc04b3bd1797aaf154d52c">fPowerLimit</a> &lt;&lt; std::endl</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Max functions:                &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a> &lt;&lt; std::endl</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Max functions to study:       &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#a56a33cdba3c529818b7f8407813bab18">fMaxStudy</a> &lt;&lt; std::endl</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Max angle (optional):         &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#a9957717d755bac7da27236ca52a5af6b">fMaxAngle</a> &lt;&lt; std::endl</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Min angle:                    &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#aa04e50147be5c9a8d9040e3b826c75f8">fMinAngle</a> &lt;&lt; std::endl</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Relative Error accepted:      &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#afc80a4fe1f39eb2124bffbc4029484cc">fMinRelativeError</a> &lt;&lt; std::endl</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Maximum Powers:               &quot;</span> &lt;&lt; std::flush;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#a54aaace3db3ff52251aa408a30f2a3e6">fMaxPowers</a>[i] - 1 &lt;&lt; std::flush;</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;      std::cout &lt;&lt; std::endl &lt;&lt; std::endl</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Parameterisation will be done using &quot;</span> &lt;&lt; std::flush;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#abdab5d9509890288a37712774a5f61ed">fPolyType</a> == <a class="code" href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152eac9953ab7fc01b500168df1fa056fba5f">kChebyshev</a>)</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;Chebyshev polynomials&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#abdab5d9509890288a37712774a5f61ed">fPolyType</a> == <a class="code" href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152ea6c631fe681d300f83c3a5e8334cc1ab7">kLegendre</a>)</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;Legendre polynomials&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;Monomials&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;      std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;   }</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;s&quot;</span>)) {</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;      <span class="comment">// Print statistics for read data</span></div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Sample statistics:&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;------------------&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;                 D&quot;</span>  &lt;&lt; std::flush;</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(10) &lt;&lt; i+1 &lt;&lt; std::flush;</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;      std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot; Max:   &quot;</span> &lt;&lt; std::setw(10) &lt;&lt; std::setprecision(7)</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">fMaxQuantity</a> &lt;&lt; std::flush;</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(10) &lt;&lt; std::setprecision(4)</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;         &lt;&lt; <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(i) &lt;&lt; std::flush;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;      std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot; Min:   &quot;</span> &lt;&lt; std::setw(10) &lt;&lt; std::setprecision(7)</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">fMinQuantity</a> &lt;&lt; std::flush;</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(10) &lt;&lt; std::setprecision(4)</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;         &lt;&lt; <a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>(i) &lt;&lt; std::flush;</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;      std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot; Mean:  &quot;</span> &lt;&lt; std::setw(10) &lt;&lt; std::setprecision(7)</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">fMeanQuantity</a> &lt;&lt; std::flush;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(10) &lt;&lt; std::setprecision(4)</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;         &lt;&lt; <a class="code" href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">fMeanVariables</a>(i) &lt;&lt; std::flush;</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;      std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot; Function Sum Squares:         &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#a353ebfbe3b6be4608608a1891319f235">fSumSqQuantity</a></div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;      &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;   }</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;r&quot;</span>)) {</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Results of Parameterisation:&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;----------------------------&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Total reduction of square residuals    &quot;</span></div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#aa155aa11e0a5891ddd5678e2c0b6e0a8">fSumSqResidual</a> &lt;&lt; std::endl</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Relative precision obtained:           &quot;</span></div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#a0ccafce2b1e34938ca21f8380f44c42d">fPrecision</a>   &lt;&lt; std::endl</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Error obtained:                        &quot;</span></div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#ac9cc5e457015ce9f569e0c2e865d8ecf">fError</a> &lt;&lt; std::endl</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Multiple correlation coefficient:      &quot;</span></div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#a85678efb97e963279c31d60cd4591ce0">fCorrelationCoeff</a>   &lt;&lt; std::endl</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Reduced Chi square over sample:        &quot;</span></div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#ac94c103fb73cd4eb775375271c74becc">fChi2</a> / (<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a> - <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>) &lt;&lt; std::endl</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Maximum residual value:                &quot;</span></div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#ac95cb9370c928be136efbaec080195b9">fMaxResidual</a> &lt;&lt; std::endl</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Minimum residual value:                &quot;</span></div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#a6a131a8d119f37edf5ac7ac4b764b211">fMinResidual</a> &lt;&lt; std::endl</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Estimated root mean square:            &quot;</span></div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#a915f6ba6a911fc155d32ff94d2c5ed90">fRMS</a> &lt;&lt; std::endl</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Maximum powers used:                   &quot;</span> &lt;&lt; std::flush;</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++)</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;         std::cout &lt;&lt; <a class="code" href="classTMultiDimFit.html#a8868c2f37dc91673d7fe3be00bcb5eae">fMaxPowersFinal</a>[j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::flush;</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      std::cout &lt;&lt; std::endl</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Function codes of candidate functions.&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;  1: considered,&quot;</span></div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;  2: too little contribution,&quot;</span></div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;  3: accepted.&quot;</span> &lt;&lt; std::flush;</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>; i++) {</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;         <span class="keywordflow">if</span> (i % 60 == 0)</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::flush;</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i % 10 == 0)</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::flush;</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;         std::cout &lt;&lt; <a class="code" href="classTMultiDimFit.html#afd6da56fd072b4d48a656001ae080e71">fFunctionCodes</a>[i];</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;      }</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;      std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot; Loop over candidates stopped because &quot;</span> &lt;&lt; std::flush;</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;      <span class="keywordflow">switch</span>(<a class="code" href="classTMultiDimFit.html#a969d67752c326e4456832e00ba6464f3">fParameterisationCode</a>){</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="TMultiDimFit_8cxx.html#a634868703c8cc999d06cff35a8a289fc">PARAM_MAXSTUDY</a>:</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;max allowed studies reached&quot;</span> &lt;&lt; std::endl; <span class="keywordflow">break</span>;</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="TMultiDimFit_8cxx.html#a5bab3ed8bd37031d95ed6e105c4cfa8d">PARAM_SEVERAL</a>:</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;all candidates considered several times&quot;</span> &lt;&lt; std::endl; <span class="keywordflow">break</span>;</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="TMultiDimFit_8cxx.html#a1843561a29ec05879992dc840caf4221">PARAM_RELERR</a>:</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;wanted relative error obtained&quot;</span> &lt;&lt; std::endl; <span class="keywordflow">break</span>;</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="TMultiDimFit_8cxx.html#af90c111e0b8dbee3646b0a50da904c7d">PARAM_MAXTERMS</a>:</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;max number of terms reached&quot;</span> &lt;&lt; std::endl; <span class="keywordflow">break</span>;</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;         <span class="keywordflow">default</span>:</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;some unknown reason&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      }</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;      std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;   }</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;f&quot;</span>)) {</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Results of Fit:&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;---------------&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Test sample size:                      &quot;</span></div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">fTestSampleSize</a> &lt;&lt; std::endl</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Multiple correlation coefficient:      &quot;</span></div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#a9e7f168a0f08032f4f45184af3cc0019">fTestCorrelationCoeff</a> &lt;&lt; std::endl</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Relative precision obtained:           &quot;</span></div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#aad4535d5041352b9ce1e556da6c499bf">fTestPrecision</a>   &lt;&lt; std::endl</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Error obtained:                        &quot;</span></div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#a68dd2aecfd779ec22b1dfe8a0f3923e8">fTestError</a> &lt;&lt; std::endl</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; Reduced Chi square over sample:        &quot;</span></div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      &lt;&lt; <a class="code" href="classTMultiDimFit.html#ac94c103fb73cd4eb775375271c74becc">fChi2</a> / (<a class="code" href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">fSampleSize</a> - <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>) &lt;&lt; std::endl</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      &lt;&lt; std::endl;</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">fFitter</a>) {</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;         <a class="code" href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">fFitter</a>-&gt;<a class="code" href="classTVirtualFitter.html#a09f747e6d83e84f0e4bf202e287070b8">PrintResults</a>(1,1);</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;         std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      }</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;   }</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;c&quot;</span>)){</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Coefficients:&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;-------------&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;   #         Value        Error   Powers&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; ---------------------------------------&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; i++) {</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(3) &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;  &quot;</span></div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;         &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>(i) &lt;&lt; <span class="stringliteral">&quot;  &quot;</span></div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;         &lt;&lt; std::setw(12) &lt;&lt; <a class="code" href="classTMultiDimFit.html#ae985f0b701950ec974977159a9bf138f">fCoefficientsRMS</a>(i) &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; std::flush;</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++)</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::setw(3)</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;            &lt;&lt; <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[<a class="code" href="classTMultiDimFit.html#ab1c8c0801040a8ba1d7fefdf107a289d">fPowerIndex</a>[i] * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j] - 1 &lt;&lt; std::flush;</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;         std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;      }</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;   }</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;k&quot;</span>) &amp;&amp; <a class="code" href="classTMultiDimFit.html#ab0e827c0499bce9f79783df14b60ec53">fCorrelationMatrix</a>.<a class="code" href="classTMatrixTBase.html#abdd847ecced6029aa8955fbdad9771e7">IsValid</a>()) {</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Correlation Matrix:&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;-------------------&quot;</span>;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;      <a class="code" href="classTMultiDimFit.html#ab0e827c0499bce9f79783df14b60ec53">fCorrelationMatrix</a>.<a class="code" href="classTMatrixTBase.html#a25c20de42d4d395cd2f4c671b23b2781">Print</a>();</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;   }</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;   <span class="keywordflow">if</span> (opt.<a class="code" href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">Contains</a>(<span class="stringliteral">&quot;m&quot;</span>)) {</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Parameterization:&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;-----------------&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;  Normalised variables: &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;\ty_&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\t= 1 + 2 * (x_&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; - &quot;</span></div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;         &lt;&lt; <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(i) &lt;&lt; <span class="stringliteral">&quot;) / (&quot;</span></div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;         &lt;&lt; <a class="code" href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">fMaxVariables</a>(i) &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; <a class="code" href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">fMinVariables</a>(i) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;         &lt;&lt; std::endl;</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;      std::cout &lt;&lt; std::endl</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;  f(&quot;</span>;</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++) {</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;y_&quot;</span> &lt;&lt; i;</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;         <span class="keywordflow">if</span> (i != <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>-1) std::cout &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;      }</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;) = &quot;</span>;</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a>; i++) {</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;         <span class="keywordflow">if</span> (i != 0)</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;            std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; (<a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>(i) &lt; 0 ? <span class="stringliteral">&quot;- &quot;</span> : <span class="stringliteral">&quot;+ &quot;</span>)</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;            &lt;&lt; <a class="code" href="namespaceTMath.html#af682354cea223351f1306bf98a858dfd">TMath::Abs</a>(<a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>(i));</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;            std::cout &lt;&lt; <a class="code" href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">fCoefficients</a>(i);</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++) {</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;            <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> p = <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[<a class="code" href="classTMultiDimFit.html#ab1c8c0801040a8ba1d7fefdf107a289d">fPowerIndex</a>[i] * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j];</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;            <span class="keywordflow">switch</span> (p) {</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;               <span class="keywordflow">case</span> 1: <span class="keywordflow">break</span>;</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;               <span class="keywordflow">case</span> 2: std::cout &lt;&lt; <span class="stringliteral">&quot; * y_&quot;</span> &lt;&lt; j; <span class="keywordflow">break</span>;</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;               <span class="keywordflow">default</span>:</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;                  <span class="keywordflow">switch</span>(<a class="code" href="classTMultiDimFit.html#abdab5d9509890288a37712774a5f61ed">fPolyType</a>) {</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;                     <span class="keywordflow">case</span> <a class="code" href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152ea6c631fe681d300f83c3a5e8334cc1ab7">kLegendre</a>:  std::cout &lt;&lt; <span class="stringliteral">&quot; * L_&quot;</span> &lt;&lt; p-1 &lt;&lt; <span class="stringliteral">&quot;(y_&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                     <span class="keywordflow">case</span> <a class="code" href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152eac9953ab7fc01b500168df1fa056fba5f">kChebyshev</a>: std::cout &lt;&lt; <span class="stringliteral">&quot; * C_&quot;</span> &lt;&lt; p-1 &lt;&lt; <span class="stringliteral">&quot;(y_&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                     <span class="keywordflow">default</span>:         std::cout &lt;&lt; <span class="stringliteral">&quot; * y_&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;^&quot;</span> &lt;&lt; p-1; <span class="keywordflow">break</span>;</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                  }</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;            }</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;         }</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      }</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;   }</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;}</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<span class="comment">/// Selection method. User can override this method for specialized</span></div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="comment">/// selection of acceptable functions in fit. Default is to select</span></div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="comment">/// all. This message is sent during the build-up of the function</span></div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="comment">/// candidates table once for each set of powers in</span></div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="comment">/// variables. Notice, that the argument array contains the powers</span></div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="comment">/// PLUS ONE. For example, to De select the function</span></div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;<span class="comment">///     f = x1^2 * x2^4 * x3^5,</span></div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="comment">/// this method should return kFALSE if given the argument</span></div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="comment">///     { 3, 4, 6 }</span></div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02358"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#abf9a170e41c1a529d7a00f168bdb8a1e"> 2358</a></span>&#160;<a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> <a class="code" href="classTMultiDimFit.html#abf9a170e41c1a529d7a00f168bdb8a1e">TMultiDimFit::Select</a>(<span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> *)</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;{</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;}</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="comment">/// Set the max angle (in degrees) between the initial data vector to</span></div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;<span class="comment">/// be fitted, and the new candidate function to be included in the</span></div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="comment">/// fit.  By default it is 0, which automatically chooses another</span></div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="comment">/// selection criteria. See also</span></div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02370"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#aa9b31c2a4a4c02dbcb21dc4e4147755f"> 2370</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#aa9b31c2a4a4c02dbcb21dc4e4147755f">TMultiDimFit::SetMaxAngle</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> ang)</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;{</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;   <span class="keywordflow">if</span> (ang &gt;= 90 || ang &lt; 0) {</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;      <a class="code" href="classTObject.html#a75fddd7eef38a13c1374130ec7dc5cf8">Warning</a>(<span class="stringliteral">&quot;SetMaxAngle&quot;</span>, <span class="stringliteral">&quot;angle must be in [0,90)&quot;</span>);</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;   }</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;   <a class="code" href="classTMultiDimFit.html#a9957717d755bac7da27236ca52a5af6b">fMaxAngle</a> = ang;</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;}</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;<span class="comment">/// Set the min angle (in degrees) between a new candidate function</span></div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;<span class="comment">/// and the subspace spanned by the previously accepted</span></div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;<span class="comment">/// functions. See also</span></div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02386"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#adc46df2e9e96fbf1c7bcf4f0386e1641"> 2386</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#adc46df2e9e96fbf1c7bcf4f0386e1641">TMultiDimFit::SetMinAngle</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> ang)</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;{</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;   <span class="keywordflow">if</span> (ang &gt; 90 || ang &lt;= 0) {</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;      <a class="code" href="classTObject.html#a75fddd7eef38a13c1374130ec7dc5cf8">Warning</a>(<span class="stringliteral">&quot;SetMinAngle&quot;</span>, <span class="stringliteral">&quot;angle must be in [0,90)&quot;</span>);</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;   }</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;   <a class="code" href="classTMultiDimFit.html#aa04e50147be5c9a8d9040e3b826c75f8">fMinAngle</a> = ang;</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;}</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="comment">/// Define a user function. The input array must be of the form</span></div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;<span class="comment">/// (p11, ..., p1N, ... ,pL1, ..., pLN)</span></div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="comment">/// Where N is the dimension of the data sample, L is the number of</span></div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;<span class="comment">/// terms (given in terms) and the first number, labels the term, the</span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;<span class="comment">/// second the variable.  More information is given in the</span></div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02406"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a8ddcf6f441697583e514a7b03613e3b2"> 2406</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#a8ddcf6f441697583e514a7b03613e3b2">TMultiDimFit::SetPowers</a>(<span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>* powers, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> terms)</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;{</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;   <a class="code" href="classTMultiDimFit.html#a20cc6137d3c71256a9833f98f3a202c5">fIsUserFunction</a> = <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;   <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>   = terms;</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;   <a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a>       = terms;</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;   <a class="code" href="classTMultiDimFit.html#a56a33cdba3c529818b7f8407813bab18">fMaxStudy</a>       = terms;</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;   <a class="code" href="classTMultiDimFit.html#af6ebf85c4647ea94d84a3fee7ba4dc51">fMaxFuncNV</a>      = <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a> * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>;</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;   <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>         = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[<a class="code" href="classTMultiDimFit.html#af6ebf85c4647ea94d84a3fee7ba4dc51">fMaxFuncNV</a>];</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i, j;</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">fMaxFunctions</a>; i++)</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;      <span class="keywordflow">for</span>(j = 0; j &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; j++)</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;         <a class="code" href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">fPowers</a>[i * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j] = powers[i * <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a> + j]  + 1;</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;}</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="comment">/// Set the user parameter for the function selection. The bigger the</span></div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;<span class="comment">/// limit, the more functions are used. The meaning of this variable</span></div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;<span class="comment">/// is defined in the</span></div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02426"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a6bc775ada70124b1e5aa1d61e4f07f52"> 2426</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#a6bc775ada70124b1e5aa1d61e4f07f52">TMultiDimFit::SetPowerLimit</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> limit)</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;{</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;   <a class="code" href="classTMultiDimFit.html#aea2ee066fdfc04b3bd1797aaf154d52c">fPowerLimit</a> = limit;</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;}</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">/// Set the maximum power to be considered in the fit for each</span></div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">/// variable. See also</span></div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02436"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a86d869eb42826e07457c0fc10604776c"> 2436</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#a86d869eb42826e07457c0fc10604776c">TMultiDimFit::SetMaxPowers</a>(<span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>* powers)</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;{</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;   <span class="keywordflow">if</span> (!powers)</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0; i &lt; <a class="code" href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">fNVariables</a>; i++)</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;      <a class="code" href="classTMultiDimFit.html#a54aaace3db3ff52251aa408a30f2a3e6">fMaxPowers</a>[i] = powers[i]+1;</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;}</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="comment">/// Set the acceptable relative error for when sum of square</span></div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="comment">/// residuals is considered minimized. For a full account, refer to</span></div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="comment">/// the</span></div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02451"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#aa0d8c58be3bf2a36465b65d015f4cb83"> 2451</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTMultiDimFit.html#aa0d8c58be3bf2a36465b65d015f4cb83">TMultiDimFit::SetMinRelativeError</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> error)</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;{</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;   <a class="code" href="classTMultiDimFit.html#afc80a4fe1f39eb2124bffbc4029484cc">fMinRelativeError</a> = error;</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;}</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="comment">/// PRIVATE METHOD:</span></div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="comment">/// Test whether the currently considered function contributes to the</span></div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;<span class="comment">/// fit. See also</span></div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;<span class="comment">/// &lt;a href=&quot;#TMultiDimFit:description&quot;&gt;class description&lt;/a&gt;</span></div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02463"></a><span class="lineno"><a class="line" href="classTMultiDimFit.html#a7e7c7d5aaa6979e17c33af220dc37b18"> 2463</a></span>&#160;<a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> <a class="code" href="classTMultiDimFit.html#a7e7c7d5aaa6979e17c33af220dc37b18">TMultiDimFit::TestFunction</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> squareResidual,</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                                  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> dResidur)</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;{</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a> != 0) {</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;      <span class="comment">// Now for the second test:</span></div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classTMultiDimFit.html#a9957717d755bac7da27236ca52a5af6b">fMaxAngle</a> == 0) {</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;         <span class="comment">// If the user hasn&#39;t supplied a max angle do the test as,</span></div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;         <span class="keywordflow">if</span> (dResidur &lt;</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;             squareResidual / (<a class="code" href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">fMaxTerms</a> - <a class="code" href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">fNCoefficients</a> + 1 + 1<a class="code" href="namespaceTMath.html#a8a8fbe07e94608dbed9e9260283a442f">E</a>-10)) {</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;         }</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      }</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;         <span class="comment">// If the user has provided a max angle, test if the calculated</span></div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;         <span class="comment">// angle is less then the max angle.</span></div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a>(dResidur/<a class="code" href="classTMultiDimFit.html#a482dd2926682899a1c2eadc5448fa68a">fSumSqAvgQuantity</a>) &lt;</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;             <a class="code" href="namespaceTMath.html#ab1f69ad10f560a26625fe5610ab321d2">TMath::Cos</a>(<a class="code" href="classTMultiDimFit.html#a9957717d755bac7da27236ca52a5af6b">fMaxAngle</a>*<a class="code" href="TMultiDimFit_8cxx.html#ac377a5fa64fdef02d0048cf0e27aca2c">DEGRAD</a>)) {</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>;</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;         }</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;      }</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;   }</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;   <span class="comment">// If we get here, the function is OK</span></div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>;</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;}</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;<span class="comment">/// Helper function for doing the minimisation of Chi2 using Minuit</span></div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02492"></a><span class="lineno"><a class="line" href="TMultiDimFit_8cxx.html#a8cfcdcd0945476639dfb907c6aafafa1"> 2492</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="TMultiDimFit_8cxx.html#a8cfcdcd0945476639dfb907c6aafafa1">mdfHelper</a>(<span class="keywordtype">int</span>&amp; <span class="comment">/*npar*/</span>, <span class="keywordtype">double</span>* <span class="comment">/*divs*/</span>, <span class="keywordtype">double</span>&amp; chi2,</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;               <span class="keywordtype">double</span>* coeffs, <span class="keywordtype">int</span> <span class="comment">/*flag*/</span>)</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;{</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;   <span class="comment">// Get pointer  to current TMultiDimFit object.</span></div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;   <a class="code" href="classTMultiDimFit.html">TMultiDimFit</a>* mdf = <a class="code" href="classTMultiDimFit.html#a5e87f44f9b4616741c8be44981c70e1c">TMultiDimFit::Instance</a>();</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;   chi2     = mdf-&gt;<a class="code" href="classTMultiDimFit.html#afc84891faa78c530965d1cfc9670a079">MakeChi2</a>(coeffs);</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;}</div><div class="ttc" id="classTMultiDimFit_html_a8868c2f37dc91673d7fe3be00bcb5eae"><div class="ttname"><a href="classTMultiDimFit.html#a8868c2f37dc91673d7fe3be00bcb5eae">TMultiDimFit::fMaxPowersFinal</a></div><div class="ttdeci">Int_t * fMaxPowersFinal</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00068">TMultiDimFit.h:68</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_afc84891faa78c530965d1cfc9670a079"><div class="ttname"><a href="classTMultiDimFit.html#afc84891faa78c530965d1cfc9670a079">TMultiDimFit::MakeChi2</a></div><div class="ttdeci">virtual Double_t MakeChi2(const Double_t *coeff=0)</div><div class="ttdoc">Calculate Chi square over either the test sample. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01237">TMultiDimFit.cxx:1237</a></div></div>
<div class="ttc" id="classTNamed_html_a42e3142d30b08fed1b07216d4a36b090"><div class="ttname"><a href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">TNamed::GetName</a></div><div class="ttdeci">virtual const char * GetName() const</div><div class="ttdoc">Returns name of object. </div><div class="ttdef"><b>Definition:</b> <a href="TNamed_8h_source.html#l00047">TNamed.h:47</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a92ba271144c920e60c675d051af4ffb3"><div class="ttname"><a href="classTMultiDimFit.html#a92ba271144c920e60c675d051af4ffb3">TMultiDimFit::fFitter</a></div><div class="ttdeci">TVirtualFitter * fFitter</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00101">TMultiDimFit.h:101</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ad7419aa5ebe661a8e621059954476b66"><div class="ttname"><a href="classTMultiDimFit.html#ad7419aa5ebe661a8e621059954476b66">TMultiDimFit::EvalFactor</a></div><div class="ttdeci">virtual Double_t EvalFactor(Int_t p, Double_t x) const</div><div class="ttdoc">PRIVATE METHOD: Evaluate function with power p at variable value x. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00949">TMultiDimFit.cxx:949</a></div></div>
<div class="ttc" id="tmva_2tmva_2src_2Factory_8cxx_html_a73e5b6a37db0af518793b45eba2bbe8e"><div class="ttname"><a href="tmva_2tmva_2src_2Factory_8cxx.html#a73e5b6a37db0af518793b45eba2bbe8e">sum</a></div><div class="ttdeci">static long int sum(long int i)</div><div class="ttdef"><b>Definition:</b> <a href="tmva_2tmva_2src_2Factory_8cxx_source.html#l02258">Factory.cxx:2258</a></div></div>
<div class="ttc" id="classTVectorT_html_a571acb83729c9a6270de67bb7494ccc8"><div class="ttname"><a href="classTVectorT.html#a571acb83729c9a6270de67bb7494ccc8">TVectorT::ResizeTo</a></div><div class="ttdeci">TVectorT&lt; Element &gt; &amp; ResizeTo(Int_t lwb, Int_t upb)</div><div class="ttdoc">Resize the vector to [lwb:upb] . </div><div class="ttdef"><b>Definition:</b> <a href="TVectorT_8cxx_source.html#l00292">TVectorT.cxx:292</a></div></div>
<div class="ttc" id="TMultiDimFit_8cxx_html_a8cfcdcd0945476639dfb907c6aafafa1"><div class="ttname"><a href="TMultiDimFit_8cxx.html#a8cfcdcd0945476639dfb907c6aafafa1">mdfHelper</a></div><div class="ttdeci">static void mdfHelper(int &amp;, double *, double &amp;, double *, int)</div><div class="ttdoc">Helper function for doing the minimisation of Chi2 using Minuit. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02492">TMultiDimFit.cxx:2492</a></div></div>
<div class="ttc" id="TMultiDimFit_8cxx_html_a1843561a29ec05879992dc840caf4221"><div class="ttname"><a href="TMultiDimFit_8cxx.html#a1843561a29ec05879992dc840caf4221">PARAM_RELERR</a></div><div class="ttdeci">#define PARAM_RELERR</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00410">TMultiDimFit.cxx:410</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ac9cc5e457015ce9f569e0c2e865d8ecf"><div class="ttname"><a href="classTMultiDimFit.html#ac9cc5e457015ce9f569e0c2e865d8ecf">TMultiDimFit::fError</a></div><div class="ttdeci">Double_t fError</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00088">TMultiDimFit.h:88</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a7c72b379705ff15458f9df6f222d8389"><div class="ttname"><a href="classTMultiDimFit.html#a7c72b379705ff15458f9df6f222d8389">TMultiDimFit::fResiduals</a></div><div class="ttdeci">TVectorD fResiduals</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00072">TMultiDimFit.h:72</a></div></div>
<div class="ttc" id="textangle_8C_html_a15eed939eb6efebfc935e895368c847a"><div class="ttname"><a href="textangle_8C.html#a15eed939eb6efebfc935e895368c847a">m</a></div><div class="ttdeci">auto * m</div><div class="ttdef"><b>Definition:</b> <a href="textangle_8C_source.html#l00008">textangle.C:8</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ab1c8c0801040a8ba1d7fefdf107a289d"><div class="ttname"><a href="classTMultiDimFit.html#ab1c8c0801040a8ba1d7fefdf107a289d">TMultiDimFit::fPowerIndex</a></div><div class="ttdeci">Int_t * fPowerIndex</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00070">TMultiDimFit.h:70</a></div></div>
<div class="ttc" id="TMatrixDUtilsfwd_8h_html_aad4e5705c7e6e551b332a8d991b4ff90"><div class="ttname"><a href="TMatrixDUtilsfwd_8h.html#aad4e5705c7e6e551b332a8d991b4ff90">TMatrixDDiag_const</a></div><div class="ttdeci">TMatrixTDiag_const&lt; Double_t &gt; TMatrixDDiag_const</div><div class="ttdef"><b>Definition:</b> <a href="TMatrixDUtilsfwd_8h_source.html#l00056">TMatrixDUtilsfwd.h:56</a></div></div>
<div class="ttc" id="TMultiDimFit_8cxx_html_a5ab555f0b173febdb3ee3e426ab261a0"><div class="ttname"><a href="TMultiDimFit_8cxx.html#a5ab555f0b173febdb3ee3e426ab261a0">HIST_XORIG</a></div><div class="ttdeci">#define HIST_XORIG</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00400">TMultiDimFit.cxx:400</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a5b4d1c29886a160d7c10e10fedd8f23b"><div class="ttname"><a href="classTMultiDimFit.html#a5b4d1c29886a160d7c10e10fedd8f23b">TMultiDimFit::fBinVarY</a></div><div class="ttdeci">Int_t fBinVarY</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00099">TMultiDimFit.h:99</a></div></div>
<div class="ttc" id="classTMatrixTBase_html_a41f9191d986b6d99366b6e5aca353ae7"><div class="ttname"><a href="classTMatrixTBase.html#a41f9191d986b6d99366b6e5aca353ae7">TMatrixTBase::Zero</a></div><div class="ttdeci">virtual TMatrixTBase&lt; Element &gt; &amp; Zero()</div><div class="ttdoc">Set matrix elements to zero. </div><div class="ttdef"><b>Definition:</b> <a href="TMatrixTBase_8cxx_source.html#l00547">TMatrixTBase.cxx:547</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a0ccafce2b1e34938ca21f8380f44c42d"><div class="ttname"><a href="classTMultiDimFit.html#a0ccafce2b1e34938ca21f8380f44c42d">TMultiDimFit::fPrecision</a></div><div class="ttdeci">Double_t fPrecision</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00090">TMultiDimFit.h:90</a></div></div>
<div class="ttc" id="TMultiDimFit_8cxx_html_a197a8cb6c7980161c743d7406270956f"><div class="ttname"><a href="TMultiDimFit_8cxx.html#a197a8cb6c7980161c743d7406270956f">HIST_DORIG</a></div><div class="ttdeci">#define HIST_DORIG</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00401">TMultiDimFit.cxx:401</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_afc405399e08793afdff5b4692827b2a1"><div class="ttname"><a href="RtypesCore_8h.html#afc405399e08793afdff5b4692827b2a1">Option_t</a></div><div class="ttdeci">const char Option_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00062">RtypesCore.h:62</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ac175cdf9aeb02a708f0b96bd734fcbc0"><div class="ttname"><a href="classTMultiDimFit.html#ac175cdf9aeb02a708f0b96bd734fcbc0">TMultiDimFit::EvalError</a></div><div class="ttdeci">virtual Double_t EvalError(const Double_t *x, const Double_t *coeff=0) const</div><div class="ttdoc">Evaluate parameterization error at point x. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00901">TMultiDimFit.cxx:901</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_aedb4a6da4070e3c88c84d14a096b061b"><div class="ttname"><a href="classTMultiDimFit.html#aedb4a6da4070e3c88c84d14a096b061b">TMultiDimFit::fgInstance</a></div><div class="ttdeci">static TMultiDimFit * fgInstance</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00025">TMultiDimFit.h:25</a></div></div>
<div class="ttc" id="classTVirtualFitter_html_a9eaa0d7620964dce13bba1c0f785ef8c"><div class="ttname"><a href="classTVirtualFitter.html#a9eaa0d7620964dce13bba1c0f785ef8c">TVirtualFitter::SetParameter</a></div><div class="ttdeci">virtual Int_t SetParameter(Int_t ipar, const char *parname, Double_t value, Double_t verr, Double_t vlow, Double_t vhigh)=0</div></div>
<div class="ttc" id="classTMultiDimFit_html_a1fa5c6ef9f25b28a1b86f1f370ba55dd"><div class="ttname"><a href="classTMultiDimFit.html#a1fa5c6ef9f25b28a1b86f1f370ba55dd">TMultiDimFit::fShowCorrelation</a></div><div class="ttdeci">Bool_t fShowCorrelation</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00104">TMultiDimFit.h:104</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a995a6ac6f1cf39c8b2ba59fcd26641b3"><div class="ttname"><a href="classTMultiDimFit.html#a995a6ac6f1cf39c8b2ba59fcd26641b3">TMultiDimFit::Fit</a></div><div class="ttdeci">virtual void Fit(Option_t *option=&quot;&quot;)</div><div class="ttdoc">Try to fit the found parameterisation to the test sample. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01010">TMultiDimFit.cxx:1010</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a62878aaa9a99e39e2bdbc1aca637efc1"><div class="ttname"><a href="classTMultiDimFit.html#a62878aaa9a99e39e2bdbc1aca637efc1">TMultiDimFit::~TMultiDimFit</a></div><div class="ttdeci">virtual ~TMultiDimFit()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00583">TMultiDimFit.cxx:583</a></div></div>
<div class="ttc" id="TMultiDimFit_8cxx_html_a634868703c8cc999d06cff35a8a289fc"><div class="ttname"><a href="TMultiDimFit_8cxx.html#a634868703c8cc999d06cff35a8a289fc">PARAM_MAXSTUDY</a></div><div class="ttdeci">#define PARAM_MAXSTUDY</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00408">TMultiDimFit.cxx:408</a></div></div>
<div class="ttc" id="TBrowser_8h_html"><div class="ttname"><a href="TBrowser_8h.html">TBrowser.h</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_af6ebf85c4647ea94d84a3fee7ba4dc51"><div class="ttname"><a href="classTMultiDimFit.html#af6ebf85c4647ea94d84a3fee7ba4dc51">TMultiDimFit::fMaxFuncNV</a></div><div class="ttdeci">Int_t fMaxFuncNV</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00062">TMultiDimFit.h:62</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a7c0cedac219d47eeff74cd567076c398"><div class="ttname"><a href="classTMultiDimFit.html#a7c0cedac219d47eeff74cd567076c398">TMultiDimFit::fTestSampleSize</a></div><div class="ttdeci">Int_t fTestSampleSize</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00048">TMultiDimFit.h:48</a></div></div>
<div class="ttc" id="TMultiDimFit_8cxx_html_ac377a5fa64fdef02d0048cf0e27aca2c"><div class="ttname"><a href="TMultiDimFit_8cxx.html#ac377a5fa64fdef02d0048cf0e27aca2c">DEGRAD</a></div><div class="ttdeci">#define DEGRAD</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00399">TMultiDimFit.cxx:399</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a8c4c287c72e9ea58d80223b927cd152ea6c631fe681d300f83c3a5e8334cc1ab7"><div class="ttname"><a href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152ea6c631fe681d300f83c3a5e8334cc1ab7">TMultiDimFit::kLegendre</a></div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00021">TMultiDimFit.h:21</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a0c0c2db4d0368576656e0bd6ad066027"><div class="ttname"><a href="classTMultiDimFit.html#a0c0c2db4d0368576656e0bd6ad066027">TMultiDimFit::fCoefficients</a></div><div class="ttdeci">TVectorD fCoefficients</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00082">TMultiDimFit.h:82</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a8c4c287c72e9ea58d80223b927cd152e"><div class="ttname"><a href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152e">TMultiDimFit::EMDFPolyType</a></div><div class="ttdeci">EMDFPolyType</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00018">TMultiDimFit.h:18</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_afc80a4fe1f39eb2124bffbc4029484cc"><div class="ttname"><a href="classTMultiDimFit.html#afc80a4fe1f39eb2124bffbc4029484cc">TMultiDimFit::fMinRelativeError</a></div><div class="ttdeci">Double_t fMinRelativeError</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00053">TMultiDimFit.h:53</a></div></div>
<div class="ttc" id="classTVectorT_html"><div class="ttname"><a href="classTVectorT.html">TVectorT&lt; Double_t &gt;</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a86d869eb42826e07457c0fc10604776c"><div class="ttname"><a href="classTMultiDimFit.html#a86d869eb42826e07457c0fc10604776c">TMultiDimFit::SetMaxPowers</a></div><div class="ttdeci">void SetMaxPowers(const Int_t *powers)</div><div class="ttdoc">Set the maximum power to be considered in the fit for each variable. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02436">TMultiDimFit.cxx:2436</a></div></div>
<div class="ttc" id="TDecompChol_8h_html"><div class="ttname"><a href="TDecompChol_8h.html">TDecompChol.h</a></div></div>
<div class="ttc" id="classTVirtualFitter_html_aaf8cd96637522ebdd84bb7f08b3ce3df"><div class="ttname"><a href="classTVirtualFitter.html#aaf8cd96637522ebdd84bb7f08b3ce3df">TVirtualFitter::GetParameter</a></div><div class="ttdeci">virtual Double_t GetParameter(Int_t ipar) const =0</div></div>
<div class="ttc" id="classTMultiDimFit_html_ab28ec111cdb90176007d7b090e3fe7f0"><div class="ttname"><a href="classTMultiDimFit.html#ab28ec111cdb90176007d7b090e3fe7f0">TMultiDimFit::fOrthFunctions</a></div><div class="ttdeci">TMatrixD fOrthFunctions</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00064">TMultiDimFit.h:64</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a188c31631ea14c84bbf6cbd74a6fa439"><div class="ttname"><a href="classTMultiDimFit.html#a188c31631ea14c84bbf6cbd74a6fa439">TMultiDimFit::fOrthCurvatureMatrix</a></div><div class="ttdeci">TMatrixD fOrthCurvatureMatrix</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00081">TMultiDimFit.h:81</a></div></div>
<div class="ttc" id="TROOT_8h_html_a851dd11b3478372a25ba6eff6dcfa5b1"><div class="ttname"><a href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a></div><div class="ttdeci">#define gROOT</div><div class="ttdef"><b>Definition:</b> <a href="TROOT_8h_source.html#l00413">TROOT.h:413</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a68dd2aecfd779ec22b1dfe8a0f3923e8"><div class="ttname"><a href="classTMultiDimFit.html#a68dd2aecfd779ec22b1dfe8a0f3923e8">TMultiDimFit::fTestError</a></div><div class="ttdeci">Double_t fTestError</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00089">TMultiDimFit.h:89</a></div></div>
<div class="ttc" id="classTString_html"><div class="ttname"><a href="classTString.html">TString</a></div><div class="ttdoc">Basic string class. </div><div class="ttdef"><b>Definition:</b> <a href="TString_8h_source.html#l00131">TString.h:131</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a20cc6137d3c71256a9833f98f3a202c5"><div class="ttname"><a href="classTMultiDimFit.html#a20cc6137d3c71256a9833f98f3a202c5">TMultiDimFit::fIsUserFunction</a></div><div class="ttdeci">Bool_t fIsUserFunction</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00105">TMultiDimFit.h:105</a></div></div>
<div class="ttc" id="classTVectorT_html_a60abeb137f2db9084b6d5de5e40699bc"><div class="ttname"><a href="classTVectorT.html#a60abeb137f2db9084b6d5de5e40699bc">TVectorT::GetNrows</a></div><div class="ttdeci">Int_t GetNrows() const</div><div class="ttdef"><b>Definition:</b> <a href="TVectorT_8h_source.html#l00075">TVectorT.h:75</a></div></div>
<div class="ttc" id="RSha256_8hxx_html_a357394e0f6f88c8a57bd893ab28dc8f8"><div class="ttname"><a href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a></div><div class="ttdeci">#define f(i)</div><div class="ttdef"><b>Definition:</b> <a href="RSha256_8hxx_source.html#l00104">RSha256.hxx:104</a></div></div>
<div class="ttc" id="classTString_html_a1be9e2a41facebeac4feddd9801a0034"><div class="ttname"><a href="classTString.html#a1be9e2a41facebeac4feddd9801a0034">TString::ToLower</a></div><div class="ttdeci">void ToLower()</div><div class="ttdoc">Change string to lower-case. </div><div class="ttdef"><b>Definition:</b> <a href="TString_8cxx_source.html#l01125">TString.cxx:1125</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_a3885b911a54b47a4e61671f45dd45d0b"><div class="ttname"><a href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a></div><div class="ttdeci">int Int_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00041">RtypesCore.h:41</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_aa101f564ac7b845ca31aec2fbc00ce97"><div class="ttname"><a href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a></div><div class="ttdeci">bool Bool_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00059">RtypesCore.h:59</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ab66658d0c5dc0c20ce649482d336a047"><div class="ttname"><a href="classTMultiDimFit.html#ab66658d0c5dc0c20ce649482d336a047">TMultiDimFit::Clear</a></div><div class="ttdeci">virtual void Clear(Option_t *option=&quot;&quot;)</div><div class="ttdoc">Clear internal structures and variables. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00786">TMultiDimFit.cxx:786</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a9957717d755bac7da27236ca52a5af6b"><div class="ttname"><a href="classTMultiDimFit.html#a9957717d755bac7da27236ca52a5af6b">TMultiDimFit::fMaxAngle</a></div><div class="ttdeci">Double_t fMaxAngle</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00051">TMultiDimFit.h:51</a></div></div>
<div class="ttc" id="TMultiDimFit_8h_html"><div class="ttname"><a href="TMultiDimFit_8h.html">TMultiDimFit.h</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a505a681f417fc9e6f7a33bac37b597d4"><div class="ttname"><a href="classTMultiDimFit.html#a505a681f417fc9e6f7a33bac37b597d4">TMultiDimFit::MakeNormalized</a></div><div class="ttdeci">virtual void MakeNormalized()</div><div class="ttdoc">PRIVATE METHOD: Normalize data to the interval [-1;1]. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01751">TMultiDimFit.cxx:1751</a></div></div>
<div class="ttc" id="classTMatrixT_html_a208f00289448b5f78b4bf033f18abc43"><div class="ttname"><a href="classTMatrixT.html#a208f00289448b5f78b4bf033f18abc43">TMatrixT::ResizeTo</a></div><div class="ttdeci">virtual TMatrixTBase&lt; Element &gt; &amp; ResizeTo(Int_t nrows, Int_t ncols, Int_t=-1)</div><div class="ttdoc">Set size of the matrix to nrows x ncols New dynamic elements are created, the overlapping part of the...</div><div class="ttdef"><b>Definition:</b> <a href="TMatrixT_8cxx_source.html#l01210">TMatrixT.cxx:1210</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a8ea4d7c005735061af8d1246a0b6594b"><div class="ttname"><a href="classTMultiDimFit.html#a8ea4d7c005735061af8d1246a0b6594b">TMultiDimFit::MakeRealCode</a></div><div class="ttdeci">virtual void MakeRealCode(const char *filename, const char *classname, Option_t *option=&quot;&quot;)</div><div class="ttdoc">PRIVATE METHOD: This is the method that actually generates the code for the evaluation the parameteri...</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01958">TMultiDimFit.cxx:1958</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a7e7c7d5aaa6979e17c33af220dc37b18"><div class="ttname"><a href="classTMultiDimFit.html#a7e7c7d5aaa6979e17c33af220dc37b18">TMultiDimFit::TestFunction</a></div><div class="ttdeci">virtual Bool_t TestFunction(Double_t squareResidual, Double_t dResidur)</div><div class="ttdoc">PRIVATE METHOD: Test whether the currently considered function contributes to the fit...</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02463">TMultiDimFit.cxx:2463</a></div></div>
<div class="ttc" id="namespaceTMath_html_af682354cea223351f1306bf98a858dfd"><div class="ttname"><a href="namespaceTMath.html#af682354cea223351f1306bf98a858dfd">TMath::Abs</a></div><div class="ttdeci">Short_t Abs(Short_t d)</div><div class="ttdef"><b>Definition:</b> <a href="TMathBase_8h_source.html#l00120">TMathBase.h:120</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_abc69e78e14f641805c364fb9f5a620fa"><div class="ttname"><a href="classTMultiDimFit.html#abc69e78e14f641805c364fb9f5a620fa">TMultiDimFit::MakeParameterization</a></div><div class="ttdeci">virtual void MakeParameterization()</div><div class="ttdoc">PRIVATE METHOD: Find the parameterization over the training sample. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01805">TMultiDimFit.cxx:1805</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a7ba2e7356f09f5cd1a9ee77bd238ec26"><div class="ttname"><a href="classTMultiDimFit.html#a7ba2e7356f09f5cd1a9ee77bd238ec26">TMultiDimFit::fTestVariables</a></div><div class="ttdeci">TVectorD fTestVariables</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00046">TMultiDimFit.h:46</a></div></div>
<div class="ttc" id="classTList_html_a85c8734ab131c0db5f68c724e47496a7"><div class="ttname"><a href="classTList.html#a85c8734ab131c0db5f68c724e47496a7">TList::FindObject</a></div><div class="ttdeci">virtual TObject * FindObject(const char *name) const</div><div class="ttdoc">Find an object in this list using its name. </div><div class="ttdef"><b>Definition:</b> <a href="TList_8cxx_source.html#l00575">TList.cxx:575</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a353ebfbe3b6be4608608a1891319f235"><div class="ttname"><a href="classTMultiDimFit.html#a353ebfbe3b6be4608608a1891319f235">TMultiDimFit::fSumSqQuantity</a></div><div class="ttdeci">Double_t fSumSqQuantity</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00033">TMultiDimFit.h:33</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a11ed6eeaf562791494391e7348d080fb"><div class="ttname"><a href="classTMultiDimFit.html#a11ed6eeaf562791494391e7348d080fb">TMultiDimFit::MakeCoefficientErrors</a></div><div class="ttdeci">virtual void MakeCoefficientErrors()</div><div class="ttdoc">PRIVATE METHOD: Compute the errors on the coefficients. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01304">TMultiDimFit.cxx:1304</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_aa04e50147be5c9a8d9040e3b826c75f8"><div class="ttname"><a href="classTMultiDimFit.html#aa04e50147be5c9a8d9040e3b826c75f8">TMultiDimFit::fMinAngle</a></div><div class="ttdeci">Double_t fMinAngle</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00050">TMultiDimFit.h:50</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_acfcf45d7b310b62d46f9908aaa7a38dc"><div class="ttname"><a href="classTMultiDimFit.html#acfcf45d7b310b62d46f9908aaa7a38dc">TMultiDimFit::fBinVarX</a></div><div class="ttdeci">Int_t fBinVarX</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00098">TMultiDimFit.h:98</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a56a46526c239b3bb8677ecc95c9f1981"><div class="ttname"><a href="classTMultiDimFit.html#a56a46526c239b3bb8677ecc95c9f1981">TMultiDimFit::fTestQuantity</a></div><div class="ttdeci">TVectorD fTestQuantity</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00044">TMultiDimFit.h:44</a></div></div>
<div class="ttc" id="classTVirtualFitter_html_a09f747e6d83e84f0e4bf202e287070b8"><div class="ttname"><a href="classTVirtualFitter.html#a09f747e6d83e84f0e4bf202e287070b8">TVirtualFitter::PrintResults</a></div><div class="ttdeci">virtual void PrintResults(Int_t level, Double_t amin) const =0</div></div>
<div class="ttc" id="TMath_8h_html_acdb55c1010a6c379a49db0201bf55d89"><div class="ttname"><a href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a></div><div class="ttdeci">double sqrt(double)</div></div>
<div class="ttc" id="classTMultiDimFit_html_a5749229ff5da4f6c8793c1930d441ef3"><div class="ttname"><a href="classTMultiDimFit.html#a5749229ff5da4f6c8793c1930d441ef3">TMultiDimFit::fTestSqError</a></div><div class="ttdeci">TVectorD fTestSqError</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00045">TMultiDimFit.h:45</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_afd6da56fd072b4d48a656001ae080e71"><div class="ttname"><a href="classTMultiDimFit.html#afd6da56fd072b4d48a656001ae080e71">TMultiDimFit::fFunctionCodes</a></div><div class="ttdeci">Int_t * fFunctionCodes</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00060">TMultiDimFit.h:60</a></div></div>
<div class="ttc" id="legend1_8C_html_a13c6713ae496caa8195647f76887f926"><div class="ttname"><a href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a></div><div class="ttdeci">Double_t x[n]</div><div class="ttdef"><b>Definition:</b> <a href="legend1_8C_source.html#l00017">legend1.C:17</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a6bc775ada70124b1e5aa1d61e4f07f52"><div class="ttname"><a href="classTMultiDimFit.html#a6bc775ada70124b1e5aa1d61e4f07f52">TMultiDimFit::SetPowerLimit</a></div><div class="ttdeci">void SetPowerLimit(Double_t limit=1e-3)</div><div class="ttdoc">Set the user parameter for the function selection. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02426">TMultiDimFit.cxx:2426</a></div></div>
<div class="ttc" id="classTIter_html"><div class="ttname"><a href="classTIter.html">TIter</a></div><div class="ttdef"><b>Definition:</b> <a href="TCollection_8h_source.html#l00233">TCollection.h:233</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a482dd2926682899a1c2eadc5448fa68a"><div class="ttname"><a href="classTMultiDimFit.html#a482dd2926682899a1c2eadc5448fa68a">TMultiDimFit::fSumSqAvgQuantity</a></div><div class="ttdeci">Double_t fSumSqAvgQuantity</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00034">TMultiDimFit.h:34</a></div></div>
<div class="ttc" id="TMultiDimFit_8cxx_html_ae026def51d4bb2970016a9150e817378"><div class="ttname"><a href="TMultiDimFit_8cxx.html#ae026def51d4bb2970016a9150e817378">HIST_RD</a></div><div class="ttdeci">#define HIST_RD</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00405">TMultiDimFit.cxx:405</a></div></div>
<div class="ttc" id="classTNamed_html"><div class="ttname"><a href="classTNamed.html">TNamed</a></div><div class="ttdoc">The TNamed class is the base class for all named ROOT classes. </div><div class="ttdef"><b>Definition:</b> <a href="TNamed_8h_source.html#l00029">TNamed.h:29</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a5e87f44f9b4616741c8be44981c70e1c"><div class="ttname"><a href="classTMultiDimFit.html#a5e87f44f9b4616741c8be44981c70e1c">TMultiDimFit::Instance</a></div><div class="ttdeci">static TMultiDimFit * Instance()</div><div class="ttdoc">Return the static instance. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01091">TMultiDimFit.cxx:1091</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a743cd1b44fc3bf532385b750de395621"><div class="ttname"><a href="classTMultiDimFit.html#a743cd1b44fc3bf532385b750de395621">TMultiDimFit::fSqError</a></div><div class="ttdeci">TVectorD fSqError</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00029">TMultiDimFit.h:29</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ab0e827c0499bce9f79783df14b60ec53"><div class="ttname"><a href="classTMultiDimFit.html#ab0e827c0499bce9f79783df14b60ec53">TMultiDimFit::fCorrelationMatrix</a></div><div class="ttdeci">TMatrixD fCorrelationMatrix</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00093">TMultiDimFit.h:93</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ae8179978b62885a88d026666777f7598"><div class="ttname"><a href="classTMultiDimFit.html#ae8179978b62885a88d026666777f7598">TMultiDimFit::fOrthFunctionNorms</a></div><div class="ttdeci">TVectorD fOrthFunctionNorms</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00065">TMultiDimFit.h:65</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_adc46df2e9e96fbf1c7bcf4f0386e1641"><div class="ttname"><a href="classTMultiDimFit.html#adc46df2e9e96fbf1c7bcf4f0386e1641">TMultiDimFit::SetMinAngle</a></div><div class="ttdeci">void SetMinAngle(Double_t angle=1)</div><div class="ttdoc">Set the min angle (in degrees) between a new candidate function and the subspace spanned by the previ...</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02386">TMultiDimFit.cxx:2386</a></div></div>
<div class="ttc" id="classTString_html_a2b2e907b9681d08cec32c853171c06a1"><div class="ttname"><a href="classTString.html#a2b2e907b9681d08cec32c853171c06a1">TString::EndsWith</a></div><div class="ttdeci">Bool_t EndsWith(const char *pat, ECaseCompare cmp=kExact) const</div><div class="ttdoc">Return true if string ends with the specified string. </div><div class="ttdef"><b>Definition:</b> <a href="TString_8cxx_source.html#l02177">TString.cxx:2177</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a8e0c17f32d5a34e96d52ce3cdb70cf37"><div class="ttname"><a href="classTMultiDimFit.html#a8e0c17f32d5a34e96d52ce3cdb70cf37">TMultiDimFit::fMaxQuantity</a></div><div class="ttdeci">Double_t fMaxQuantity</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00031">TMultiDimFit.h:31</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_aa9b31c2a4a4c02dbcb21dc4e4147755f"><div class="ttname"><a href="classTMultiDimFit.html#aa9b31c2a4a4c02dbcb21dc4e4147755f">TMultiDimFit::SetMaxAngle</a></div><div class="ttdeci">void SetMaxAngle(Double_t angle=0)</div><div class="ttdoc">Set the max angle (in degrees) between the initial data vector to be fitted, and the new candidate fu...</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02370">TMultiDimFit.cxx:2370</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a0e62c02e45b9652d6edb0ae25f0fe9c9"><div class="ttname"><a href="classTMultiDimFit.html#a0e62c02e45b9652d6edb0ae25f0fe9c9">TMultiDimFit::fHistogramMask</a></div><div class="ttdeci">Byte_t fHistogramMask</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00097">TMultiDimFit.h:97</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ac57c70ae31572ba7bd9333dc4df57f45"><div class="ttname"><a href="classTMultiDimFit.html#ac57c70ae31572ba7bd9333dc4df57f45">TMultiDimFit::fHistograms</a></div><div class="ttdeci">TList * fHistograms</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00096">TMultiDimFit.h:96</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a74720b6e5b76b417cf809cf57401ef3c"><div class="ttname"><a href="classTMultiDimFit.html#a74720b6e5b76b417cf809cf57401ef3c">TMultiDimFit::AddRow</a></div><div class="ttdeci">virtual void AddRow(const Double_t *x, Double_t D, Double_t E=0)</div><div class="ttdoc">Add a row consisting of fNVariables independent variables, the known, dependent quantity, and optionally, the square error in the dependent quantity, to the training sample to be used for the parameterization. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00608">TMultiDimFit.cxx:608</a></div></div>
<div class="ttc" id="classTDecompChol_html_aec4d827262663178ffd7d4a31c4fb23c"><div class="ttname"><a href="classTDecompChol.html#aec4d827262663178ffd7d4a31c4fb23c">TDecompChol::Invert</a></div><div class="ttdeci">Bool_t Invert(TMatrixDSym &amp;inv)</div><div class="ttdoc">For a symmetric matrix A(m,m), its inverse A_inv(m,m) is returned . </div><div class="ttdef"><b>Definition:</b> <a href="TDecompChol_8cxx_source.html#l00341">TDecompChol.cxx:341</a></div></div>
<div class="ttc" id="namespaceTGeant4Unit_html_a5d450e80998065902b102dca2a69066a"><div class="ttname"><a href="namespaceTGeant4Unit.html#a5d450e80998065902b102dca2a69066a">TGeant4Unit::s</a></div><div class="ttdeci">static constexpr double s</div><div class="ttdef"><b>Definition:</b> <a href="TGeant4SystemOfUnits_8h_source.html#l00162">TGeant4SystemOfUnits.h:162</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_abf9a170e41c1a529d7a00f168bdb8a1e"><div class="ttname"><a href="classTMultiDimFit.html#abf9a170e41c1a529d7a00f168bdb8a1e">TMultiDimFit::Select</a></div><div class="ttdeci">virtual Bool_t Select(const Int_t *iv)</div><div class="ttdoc">Selection method. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02358">TMultiDimFit.cxx:2358</a></div></div>
<div class="ttc" id="classTMatrixTSym_html"><div class="ttname"><a href="classTMatrixTSym.html">TMatrixTSym&lt; Double_t &gt;</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a2481b20dc890f9588a77effbd950f95e"><div class="ttname"><a href="classTMultiDimFit.html#a2481b20dc890f9588a77effbd950f95e">TMultiDimFit::fNVariables</a></div><div class="ttdeci">Int_t fNVariables</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00037">TMultiDimFit.h:37</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a7920112fb8910bf3d515889cdd50141f"><div class="ttname"><a href="classTMultiDimFit.html#a7920112fb8910bf3d515889cdd50141f">TMultiDimFit::fQuantity</a></div><div class="ttdeci">TVectorD fQuantity</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00028">TMultiDimFit.h:28</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_aa2f693320b6fc8c8a1da1ddf0d523520"><div class="ttname"><a href="classTMultiDimFit.html#aa2f693320b6fc8c8a1da1ddf0d523520">TMultiDimFit::fMeanVariables</a></div><div class="ttdeci">TVectorD fMeanVariables</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00038">TMultiDimFit.h:38</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ab6c34ca711c504890abcf7e668bd1de3"><div class="ttname"><a href="classTMultiDimFit.html#ab6c34ca711c504890abcf7e668bd1de3">TMultiDimFit::EvalControl</a></div><div class="ttdeci">virtual Double_t EvalControl(const Int_t *powers) const</div><div class="ttdoc">PRIVATE METHOD: Calculate the control parameter from the passed powers. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00934">TMultiDimFit.cxx:934</a></div></div>
<div class="ttc" id="TMatrixDUtilsfwd_8h_html_a35d231b9f8a937a9ee5cec5077fb403e"><div class="ttname"><a href="TMatrixDUtilsfwd_8h.html#a35d231b9f8a937a9ee5cec5077fb403e">TMatrixDRow</a></div><div class="ttdeci">TMatrixTRow&lt; Double_t &gt; TMatrixDRow</div><div class="ttdef"><b>Definition:</b> <a href="TMatrixDUtilsfwd_8h_source.html#l00062">TMatrixDUtilsfwd.h:62</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_aad4535d5041352b9ce1e556da6c499bf"><div class="ttname"><a href="classTMultiDimFit.html#aad4535d5041352b9ce1e556da6c499bf">TMultiDimFit::fTestPrecision</a></div><div class="ttdeci">Double_t fTestPrecision</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00091">TMultiDimFit.h:91</a></div></div>
<div class="ttc" id="classTList_html"><div class="ttname"><a href="classTList.html">TList</a></div><div class="ttdoc">A doubly linked list. </div><div class="ttdef"><b>Definition:</b> <a href="TList_8h_source.html#l00044">TList.h:44</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ae89d2fead19fb22766782c68e2896330"><div class="ttname"><a href="classTMultiDimFit.html#ae89d2fead19fb22766782c68e2896330">TMultiDimFit::fMeanQuantity</a></div><div class="ttdeci">Double_t fMeanQuantity</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00030">TMultiDimFit.h:30</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ac95cb9370c928be136efbaec080195b9"><div class="ttname"><a href="classTMultiDimFit.html#ac95cb9370c928be136efbaec080195b9">TMultiDimFit::fMaxResidual</a></div><div class="ttdeci">Double_t fMaxResidual</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00073">TMultiDimFit.h:73</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a4a98861737c6b4c0140e58fcfd6a1bd2"><div class="ttname"><a href="classTMultiDimFit.html#a4a98861737c6b4c0140e58fcfd6a1bd2">TMultiDimFit::fPowers</a></div><div class="ttdeci">Int_t * fPowers</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00069">TMultiDimFit.h:69</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a54aaace3db3ff52251aa408a30f2a3e6"><div class="ttname"><a href="classTMultiDimFit.html#a54aaace3db3ff52251aa408a30f2a3e6">TMultiDimFit::fMaxPowers</a></div><div class="ttdeci">Int_t * fMaxPowers</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00054">TMultiDimFit.h:54</a></div></div>
<div class="ttc" id="classTBrowser_html"><div class="ttname"><a href="classTBrowser.html">TBrowser</a></div><div class="ttdoc">Using a TBrowser one can browse all ROOT objects. </div><div class="ttdef"><b>Definition:</b> <a href="TBrowser_8h_source.html#l00037">TBrowser.h:37</a></div></div>
<div class="ttc" id="classTMatrixTBase_html_afbf946ac4172ba90c03ead0a0d2f0dee"><div class="ttname"><a href="classTMatrixTBase.html#afbf946ac4172ba90c03ead0a0d2f0dee">TMatrixTBase::NormByDiag</a></div><div class="ttdeci">virtual TMatrixTBase&lt; Element &gt; &amp; NormByDiag(const TVectorT&lt; Element &gt; &amp;v, Option_t *option=&quot;D&quot;)</div><div class="ttdoc">option: </div><div class="ttdef"><b>Definition:</b> <a href="TMatrixTBase_8cxx_source.html#l00632">TMatrixTBase.cxx:632</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a5b203e8e8ac917b0334d80921d9c6e90"><div class="ttname"><a href="classTMultiDimFit.html#a5b203e8e8ac917b0334d80921d9c6e90">TMultiDimFit::fMaxFunctions</a></div><div class="ttdeci">Int_t fMaxFunctions</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00059">TMultiDimFit.h:59</a></div></div>
<div class="ttc" id="classTDecompChol_html"><div class="ttname"><a href="classTDecompChol.html">TDecompChol</a></div><div class="ttdoc">Cholesky Decomposition class. </div><div class="ttdef"><b>Definition:</b> <a href="TDecompChol_8h_source.html#l00024">TDecompChol.h:24</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ae18eb732b7f700f28365e074d2685096"><div class="ttname"><a href="classTMultiDimFit.html#ae18eb732b7f700f28365e074d2685096">TMultiDimFit::Print</a></div><div class="ttdeci">virtual void Print(Option_t *option=&quot;ps&quot;) const</div><div class="ttdoc">Print statistics etc. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02151">TMultiDimFit.cxx:2151</a></div></div>
<div class="ttc" id="Object_8C_html_ac15f01b9c6407e1312dfc196ad4e0870"><div class="ttname"><a href="Object_8C.html#ac15f01b9c6407e1312dfc196ad4e0870">r</a></div><div class="ttdeci">ROOT::R::TRInterface &amp; r</div><div class="ttdef"><b>Definition:</b> <a href="Object_8C_source.html#l00004">Object.C:4</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a63255512123a70b8fb0ec3d01f9bb576"><div class="ttname"><a href="classTMultiDimFit.html#a63255512123a70b8fb0ec3d01f9bb576">TMultiDimFit::MakeCandidates</a></div><div class="ttdeci">virtual void MakeCandidates()</div><div class="ttdoc">PRIVATE METHOD: Create list of candidate functions for the parameterisation. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01102">TMultiDimFit.cxx:1102</a></div></div>
<div class="ttc" id="TROOT_8h_html"><div class="ttname"><a href="TROOT_8h.html">TROOT.h</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a4497c43c6eb7b600f5dfd7805846032c"><div class="ttname"><a href="classTMultiDimFit.html#a4497c43c6eb7b600f5dfd7805846032c">TMultiDimFit::fSampleSize</a></div><div class="ttdeci">Int_t fSampleSize</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00042">TMultiDimFit.h:42</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_aa155aa11e0a5891ddd5678e2c0b6e0a8"><div class="ttname"><a href="classTMultiDimFit.html#aa155aa11e0a5891ddd5678e2c0b6e0a8">TMultiDimFit::fSumSqResidual</a></div><div class="ttdeci">Double_t fSumSqResidual</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00077">TMultiDimFit.h:77</a></div></div>
<div class="ttc" id="TMultiDimFit_8cxx_html_a02c88c0b6d9d5d3086ceca952d079aed"><div class="ttname"><a href="TMultiDimFit_8cxx.html#a02c88c0b6d9d5d3086ceca952d079aed">HIST_DSHIF</a></div><div class="ttdeci">#define HIST_DSHIF</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00403">TMultiDimFit.cxx:403</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a485d963063227c6475fb089161728200"><div class="ttname"><a href="classTMultiDimFit.html#a485d963063227c6475fb089161728200">TMultiDimFit::fMaxTerms</a></div><div class="ttdeci">Int_t fMaxTerms</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00052">TMultiDimFit.h:52</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ac94c103fb73cd4eb775375271c74becc"><div class="ttname"><a href="classTMultiDimFit.html#ac94c103fb73cd4eb775375271c74becc">TMultiDimFit::fChi2</a></div><div class="ttdeci">Double_t fChi2</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00085">TMultiDimFit.h:85</a></div></div>
<div class="ttc" id="TH2_8h_html"><div class="ttname"><a href="TH2_8h.html">TH2.h</a></div></div>
<div class="ttc" id="classTVectorT_html_a018d2fbf7d3f9de6a060b591c3f0a65d"><div class="ttname"><a href="classTVectorT.html#a018d2fbf7d3f9de6a060b591c3f0a65d">TVectorT::Zero</a></div><div class="ttdeci">TVectorT&lt; Element &gt; &amp; Zero()</div><div class="ttdoc">Set vector elements to zero. </div><div class="ttdef"><b>Definition:</b> <a href="TVectorT_8cxx_source.html#l00451">TVectorT.cxx:451</a></div></div>
<div class="ttc" id="classTMultiDimFit_html"><div class="ttname"><a href="classTMultiDimFit.html">TMultiDimFit</a></div><div class="ttdoc">Multidimensional Fits in ROOT. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00015">TMultiDimFit.h:15</a></div></div>
<div class="ttc" id="classTVectorT_html_a77305b763bac5a6dc3d623341958311f"><div class="ttname"><a href="classTVectorT.html#a77305b763bac5a6dc3d623341958311f">TVectorT::IsValid</a></div><div class="ttdeci">Bool_t IsValid() const</div><div class="ttdef"><b>Definition:</b> <a href="TVectorT_8h_source.html#l00083">TVectorT.h:83</a></div></div>
<div class="ttc" id="classTObject_html_abe1fb206304cfa1b8d1e77a4a4fd0120"><div class="ttname"><a href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">TObject::Error</a></div><div class="ttdeci">virtual void Error(const char *method, const char *msgfmt,...) const</div><div class="ttdoc">Issue error message. </div><div class="ttdef"><b>Definition:</b> <a href="TObject_8cxx_source.html#l00880">TObject.cxx:880</a></div></div>
<div class="ttc" id="TString_8h_html_acf18c5b91421ac53e91bd96ebc07dea7"><div class="ttname"><a href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a></div><div class="ttdeci">char * Form(const char *fmt,...)</div></div>
<div class="ttc" id="classTMultiDimFit_html_a969d67752c326e4456832e00ba6464f3"><div class="ttname"><a href="classTMultiDimFit.html#a969d67752c326e4456832e00ba6464f3">TMultiDimFit::fParameterisationCode</a></div><div class="ttdeci">Int_t fParameterisationCode</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00086">TMultiDimFit.h:86</a></div></div>
<div class="ttc" id="classTString_html_a04e631ef510bdd4071c37b54fde0c1a7"><div class="ttname"><a href="classTString.html#a04e631ef510bdd4071c37b54fde0c1a7">TString::Length</a></div><div class="ttdeci">Ssiz_t Length() const</div><div class="ttdef"><b>Definition:</b> <a href="TString_8h_source.html#l00405">TString.h:405</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a6fcbef530e89fe295103c1f84107ef33"><div class="ttname"><a href="classTMultiDimFit.html#a6fcbef530e89fe295103c1f84107ef33">TMultiDimFit::FindParameterization</a></div><div class="ttdeci">virtual void FindParameterization(Option_t *option=&quot;&quot;)</div><div class="ttdoc">Find the parameterization. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00991">TMultiDimFit.cxx:991</a></div></div>
<div class="ttc" id="classTVirtualFitter_html_aa932bc097c3ed3d5c9e33186b47a2f82"><div class="ttname"><a href="classTVirtualFitter.html#aa932bc097c3ed3d5c9e33186b47a2f82">TVirtualFitter::ExecuteCommand</a></div><div class="ttdeci">virtual Int_t ExecuteCommand(const char *command, Double_t *args, Int_t nargs)=0</div></div>
<div class="ttc" id="classTMultiDimFit_html_af689396ca31f81ddcf49870cce1779c9"><div class="ttname"><a href="classTMultiDimFit.html#af689396ca31f81ddcf49870cce1779c9">TMultiDimFit::fIsVerbose</a></div><div class="ttdeci">Bool_t fIsVerbose</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00106">TMultiDimFit.h:106</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a2daa8132499a0f54ff43d1438dac38bc"><div class="ttname"><a href="classTMultiDimFit.html#a2daa8132499a0f54ff43d1438dac38bc">TMultiDimFit::fMinQuantity</a></div><div class="ttdeci">Double_t fMinQuantity</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00032">TMultiDimFit.h:32</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a824dc924049225e414f4c2e7dcc909b2"><div class="ttname"><a href="classTMultiDimFit.html#a824dc924049225e414f4c2e7dcc909b2">TMultiDimFit::fVariables</a></div><div class="ttdeci">TVectorD fVariables</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00036">TMultiDimFit.h:36</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a8ddcf6f441697583e514a7b03613e3b2"><div class="ttname"><a href="classTMultiDimFit.html#a8ddcf6f441697583e514a7b03613e3b2">TMultiDimFit::SetPowers</a></div><div class="ttdeci">virtual void SetPowers(const Int_t *powers, Int_t terms)</div><div class="ttdoc">Define a user function. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02406">TMultiDimFit.cxx:2406</a></div></div>
<div class="ttc" id="TMultiDimFit_8cxx_html_a280cd1275ebe4292c7e05c62740e5b3f"><div class="ttname"><a href="TMultiDimFit_8cxx.html#a280cd1275ebe4292c7e05c62740e5b3f">HIST_RX</a></div><div class="ttdeci">#define HIST_RX</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00404">TMultiDimFit.cxx:404</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a963c212eef6e1910fd9fd2f3f05d4bdd"><div class="ttname"><a href="classTMultiDimFit.html#a963c212eef6e1910fd9fd2f3f05d4bdd">TMultiDimFit::AddTestRow</a></div><div class="ttdeci">virtual void AddTestRow(const Double_t *x, Double_t D, Double_t E=0)</div><div class="ttdoc">Add a row consisting of fNVariables independent variables, the known, dependent quantity, and optionally, the square error in the dependent quantity, to the test sample to be used for the test of the parameterization. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00687">TMultiDimFit.cxx:687</a></div></div>
<div class="ttc" id="classTH1D_html"><div class="ttname"><a href="classTH1D.html">TH1D</a></div><div class="ttdoc">1-D histogram with a double per channel (see TH1 documentation)} </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00614">TH1.h:614</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a93eed5a363dbbac0c60d168a107d5d7c"><div class="ttname"><a href="classTMultiDimFit.html#a93eed5a363dbbac0c60d168a107d5d7c">TMultiDimFit::fFunctions</a></div><div class="ttdeci">TMatrixD fFunctions</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00058">TMultiDimFit.h:58</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_aa71dd7c6c4b0ed57cf64dbcd8b832827"><div class="ttname"><a href="classTMultiDimFit.html#aa71dd7c6c4b0ed57cf64dbcd8b832827">TMultiDimFit::MakeMethod</a></div><div class="ttdeci">virtual void MakeMethod(const Char_t *className=&quot;MDF&quot;, Option_t *option=&quot;&quot;)</div><div class="ttdoc">Generate the file &lt;classname&gt;MDF.cxx which contains the implementation of the method: ...</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01739">TMultiDimFit.cxx:1739</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a6a131a8d119f37edf5ac7ac4b764b211"><div class="ttname"><a href="classTMultiDimFit.html#a6a131a8d119f37edf5ac7ac4b764b211">TMultiDimFit::fMinResidual</a></div><div class="ttdeci">Double_t fMinResidual</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00074">TMultiDimFit.h:74</a></div></div>
<div class="ttc" id="triangle_8c_html_a92508a9fbb1db78d0bbedbf68cf93d1b"><div class="ttname"><a href="triangle_8c.html#a92508a9fbb1db78d0bbedbf68cf93d1b">epsilon</a></div><div class="ttdeci">REAL epsilon</div><div class="ttdef"><b>Definition:</b> <a href="triangle_8c_source.html#l00617">triangle.c:617</a></div></div>
<div class="ttc" id="namespaceTMath_html_a8a8fbe07e94608dbed9e9260283a442f"><div class="ttname"><a href="namespaceTMath.html#a8a8fbe07e94608dbed9e9260283a442f">TMath::E</a></div><div class="ttdeci">constexpr Double_t E()</div><div class="ttdoc">Base of natural log: . </div><div class="ttdef"><b>Definition:</b> <a href="TMath_8h_source.html#l00097">TMath.h:97</a></div></div>
<div class="ttc" id="RSha256_8hxx_html_acf9942d15f0dd0ac4fc5ca66096a3f6d"><div class="ttname"><a href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a></div><div class="ttdeci">#define h(i)</div><div class="ttdef"><b>Definition:</b> <a href="RSha256_8hxx_source.html#l00106">RSha256.hxx:106</a></div></div>
<div class="ttc" id="namespaceTMath_html_ab1f69ad10f560a26625fe5610ab321d2"><div class="ttname"><a href="namespaceTMath.html#ab1f69ad10f560a26625fe5610ab321d2">TMath::Cos</a></div><div class="ttdeci">Double_t Cos(Double_t)</div><div class="ttdef"><b>Definition:</b> <a href="TMath_8h_source.html#l00629">TMath.h:629</a></div></div>
<div class="ttc" id="Riostream_8h_html"><div class="ttname"><a href="Riostream_8h.html">Riostream.h</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_a7e568baf910535e8ffd438acb843434d"><div class="ttname"><a href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a></div><div class="ttdeci">const Bool_t kFALSE</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00088">RtypesCore.h:88</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a3383acbb4420f6dfbef6c7899d2ce82b"><div class="ttname"><a href="classTMultiDimFit.html#a3383acbb4420f6dfbef6c7899d2ce82b">TMultiDimFit::Eval</a></div><div class="ttdeci">virtual Double_t Eval(const Double_t *x, const Double_t *coeff=0) const</div><div class="ttdoc">Evaluate parameterization at point x. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00873">TMultiDimFit.cxx:873</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_af062a8ff2b0850e9b25edd065b4d9b2e"><div class="ttname"><a href="classTMultiDimFit.html#af062a8ff2b0850e9b25edd065b4d9b2e">TMultiDimFit::MakeHistograms</a></div><div class="ttdeci">virtual void MakeHistograms(Option_t *option=&quot;A&quot;)</div><div class="ttdoc">Make histograms of the result of the analysis. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01594">TMultiDimFit.cxx:1594</a></div></div>
<div class="ttc" id="TMultiDimFit_8cxx_html_ad15c4be1d09512b8b100f4d97ff13e09"><div class="ttname"><a href="TMultiDimFit_8cxx.html#ad15c4be1d09512b8b100f4d97ff13e09">HIST_RTRAI</a></div><div class="ttdeci">#define HIST_RTRAI</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00406">TMultiDimFit.cxx:406</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_abdab5d9509890288a37712774a5f61ed"><div class="ttname"><a href="classTMultiDimFit.html#abdab5d9509890288a37712774a5f61ed">TMultiDimFit::fPolyType</a></div><div class="ttdeci">EMDFPolyType fPolyType</div><div class="ttdoc">Fit object (MINUIT) </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00103">TMultiDimFit.h:103</a></div></div>
<div class="ttc" id="Rtypes_8h_html_a3f9bf160bbbb44209e95556960836b96"><div class="ttname"><a href="Rtypes_8h.html#a3f9bf160bbbb44209e95556960836b96">ClassImp</a></div><div class="ttdeci">#define ClassImp(name)</div><div class="ttdef"><b>Definition:</b> <a href="Rtypes_8h_source.html#l00365">Rtypes.h:365</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_ab9b5334647b78ec4256db251e3ae1fc6"><div class="ttname"><a href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a></div><div class="ttdeci">double Double_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00055">RtypesCore.h:55</a></div></div>
<div class="ttc" id="TGX11_8cxx_html_ac765329451135abec74c45e1897abf26"><div class="ttname"><a href="TGX11_8cxx.html#ac765329451135abec74c45e1897abf26">type</a></div><div class="ttdeci">int type</div><div class="ttdef"><b>Definition:</b> <a href="TGX11_8cxx_source.html#l00120">TGX11.cxx:120</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_aa0d8c58be3bf2a36465b65d015f4cb83"><div class="ttname"><a href="classTMultiDimFit.html#aa0d8c58be3bf2a36465b65d015f4cb83">TMultiDimFit::SetMinRelativeError</a></div><div class="ttdeci">void SetMinRelativeError(Double_t error)</div><div class="ttdoc">Set the acceptable relative error for when sum of square residuals is considered minimized. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l02451">TMultiDimFit.cxx:2451</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a89082db5af59a8001f1f17da93cd1975"><div class="ttname"><a href="classTMultiDimFit.html#a89082db5af59a8001f1f17da93cd1975">TMultiDimFit::fMinResidualRow</a></div><div class="ttdeci">Int_t fMinResidualRow</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00076">TMultiDimFit.h:76</a></div></div>
<div class="ttc" id="legend1_8C_html_a1380cd153a0fc78015dd604dbcb6c841"><div class="ttname"><a href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a></div><div class="ttdeci">Double_t y[n]</div><div class="ttdef"><b>Definition:</b> <a href="legend1_8C_source.html#l00017">legend1.C:17</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ae985f0b701950ec974977159a9bf138f"><div class="ttname"><a href="classTMultiDimFit.html#ae985f0b701950ec974977159a9bf138f">TMultiDimFit::fCoefficientsRMS</a></div><div class="ttdeci">TVectorD fCoefficientsRMS</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00083">TMultiDimFit.h:83</a></div></div>
<div class="ttc" id="classTString_html_aefd4aa6797ae0fd7e63345def5c0be92"><div class="ttname"><a href="classTString.html#aefd4aa6797ae0fd7e63345def5c0be92">TString::Contains</a></div><div class="ttdeci">Bool_t Contains(const char *pat, ECaseCompare cmp=kExact) const</div><div class="ttdef"><b>Definition:</b> <a href="TString_8h_source.html#l00619">TString.h:619</a></div></div>
<div class="ttc" id="classTH1_html"><div class="ttname"><a href="classTH1.html">TH1</a></div><div class="ttdoc">The TH1 histogram class. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00056">TH1.h:56</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a99578ebef8164004d7b275009d16efa4"><div class="ttname"><a href="classTMultiDimFit.html#a99578ebef8164004d7b275009d16efa4">TMultiDimFit::fNCoefficients</a></div><div class="ttdeci">Int_t fNCoefficients</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00079">TMultiDimFit.h:79</a></div></div>
<div class="ttc" id="TRolke_8cxx_html_a680432d265de4ea2534f8ec32f1aa417"><div class="ttname"><a href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a></div><div class="ttdeci">you should not use this method at all Int_t Int_t Double_t Double_t Double_t e</div><div class="ttdef"><b>Definition:</b> <a href="TRolke_8cxx_source.html#l00630">TRolke.cxx:630</a></div></div>
<div class="ttc" id="classTDatime_html_afcaa0035a009ab4b8c09a85ee01b0b7c"><div class="ttname"><a href="classTDatime.html#afcaa0035a009ab4b8c09a85ee01b0b7c">TDatime::AsString</a></div><div class="ttdeci">const char * AsString() const</div><div class="ttdoc">Return the date &amp; time as a string (ctime() format). </div><div class="ttdef"><b>Definition:</b> <a href="TDatime_8cxx_source.html#l00101">TDatime.cxx:101</a></div></div>
<div class="ttc" id="classTVirtualFitter_html_a87b7aa8b098fdde5e0dfd44eb680ee5e"><div class="ttname"><a href="classTVirtualFitter.html#a87b7aa8b098fdde5e0dfd44eb680ee5e">TVirtualFitter::SetFCN</a></div><div class="ttdeci">virtual void SetFCN(void(*fcn)(Int_t &amp;, Double_t *, Double_t &amp;f, Double_t *, Int_t))</div><div class="ttdoc">To set the address of the minimization objective function called by the native compiler (see function...</div><div class="ttdef"><b>Definition:</b> <a href="TVirtualFitter_8cxx_source.html#l00267">TVirtualFitter.cxx:267</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a62d9ca99ba267dc7d2d80fa88f041b1f"><div class="ttname"><a href="classTMultiDimFit.html#a62d9ca99ba267dc7d2d80fa88f041b1f">TMultiDimFit::MakeCode</a></div><div class="ttdeci">virtual void MakeCode(const char *functionName=&quot;MDF&quot;, Option_t *option=&quot;&quot;)</div><div class="ttdoc">Generate the file &lt;filename&gt; with .C appended if argument doesn&amp;#39;t end in .cxx or .C. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01287">TMultiDimFit.cxx:1287</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a9b7e0799259eafefb688ec173c1dee78"><div class="ttname"><a href="classTMultiDimFit.html#a9b7e0799259eafefb688ec173c1dee78">TMultiDimFit::TMultiDimFit</a></div><div class="ttdeci">TMultiDimFit()</div><div class="ttdoc">Empty CTOR. Do not use. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00430">TMultiDimFit.cxx:430</a></div></div>
<div class="ttc" id="classTList_html_af4d5429298af281bdc7fe62b123f5385"><div class="ttname"><a href="classTList.html#af4d5429298af281bdc7fe62b123f5385">TList::Clear</a></div><div class="ttdeci">virtual void Clear(Option_t *option=&quot;&quot;)</div><div class="ttdoc">Remove all objects from the list. </div><div class="ttdef"><b>Definition:</b> <a href="TList_8cxx_source.html#l00399">TList.cxx:399</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a56a33cdba3c529818b7f8407813bab18"><div class="ttname"><a href="classTMultiDimFit.html#a56a33cdba3c529818b7f8407813bab18">TMultiDimFit::fMaxStudy</a></div><div class="ttdeci">Int_t fMaxStudy</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00061">TMultiDimFit.h:61</a></div></div>
<div class="ttc" id="classTDecompChol_html_af14df10a3c766330cb93063161ecedc0"><div class="ttname"><a href="classTDecompChol.html#af14df10a3c766330cb93063161ecedc0">TDecompChol::Decompose</a></div><div class="ttdeci">virtual Bool_t Decompose()</div><div class="ttdoc">Matrix A is decomposed in component U so that A = U^T * U If the decomposition succeeds, bit kDecomposed is set , otherwise kSingular. </div><div class="ttdef"><b>Definition:</b> <a href="TDecompChol_8cxx_source.html#l00106">TDecompChol.cxx:106</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_aea2ee066fdfc04b3bd1797aaf154d52c"><div class="ttname"><a href="classTMultiDimFit.html#aea2ee066fdfc04b3bd1797aaf154d52c">TMultiDimFit::fPowerLimit</a></div><div class="ttdeci">Double_t fPowerLimit</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00055">TMultiDimFit.h:55</a></div></div>
<div class="ttc" id="TMultiDimFit_8cxx_html_a1d1ed449317205baf4318315bec57474"><div class="ttname"><a href="TMultiDimFit_8cxx.html#a1d1ed449317205baf4318315bec57474">HIST_XNORM</a></div><div class="ttdeci">#define HIST_XNORM</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00402">TMultiDimFit.cxx:402</a></div></div>
<div class="ttc" id="classTMatrixTBase_html_a25c20de42d4d395cd2f4c671b23b2781"><div class="ttname"><a href="classTMatrixTBase.html#a25c20de42d4d395cd2f4c671b23b2781">TMatrixTBase::Print</a></div><div class="ttdeci">void Print(Option_t *name=&quot;&quot;) const</div><div class="ttdoc">Print the matrix as a table of elements. </div><div class="ttdef"><b>Definition:</b> <a href="TMatrixTBase_8cxx_source.html#l00832">TMatrixTBase.cxx:832</a></div></div>
<div class="ttc" id="Rtypes_8h_html_a673d0ae6e667e3a49b5e42f65ded566e"><div class="ttname"><a href="Rtypes_8h.html#a673d0ae6e667e3a49b5e42f65ded566e">SETBIT</a></div><div class="ttdeci">#define SETBIT(n, i)</div><div class="ttdef"><b>Definition:</b> <a href="Rtypes_8h_source.html#l00084">Rtypes.h:84</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a2ba24cef5173b7bc5f55c25d57f95335"><div class="ttname"><a href="classTMultiDimFit.html#a2ba24cef5173b7bc5f55c25d57f95335">TMultiDimFit::fMaxResidualRow</a></div><div class="ttdeci">Int_t fMaxResidualRow</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00075">TMultiDimFit.h:75</a></div></div>
<div class="ttc" id="TMultiDimFit_8cxx_html_abc53d6530eb580057e12ecb5b4e88b48"><div class="ttname"><a href="TMultiDimFit_8cxx.html#abc53d6530eb580057e12ecb5b4e88b48">HIST_RTEST</a></div><div class="ttdeci">#define HIST_RTEST</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00407">TMultiDimFit.cxx:407</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_a72a4388b7fc57f981af8c65fefcceb1f"><div class="ttname"><a href="RtypesCore_8h.html#a72a4388b7fc57f981af8c65fefcceb1f">Char_t</a></div><div class="ttdeci">char Char_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00029">RtypesCore.h:29</a></div></div>
<div class="ttc" id="classTVirtualFitter_html_aea097f4da10bb75324bd40aee976127a"><div class="ttname"><a href="classTVirtualFitter.html#aea097f4da10bb75324bd40aee976127a">TVirtualFitter::Fitter</a></div><div class="ttdeci">static TVirtualFitter * Fitter(TObject *obj, Int_t maxpar=25)</div><div class="ttdoc">Static function returning a pointer to the current fitter. </div><div class="ttdef"><b>Definition:</b> <a href="TVirtualFitter_8cxx_source.html#l00159">TVirtualFitter.cxx:159</a></div></div>
<div class="ttc" id="classTList_html_a1b90ccfbde1729266b585194fa45df14"><div class="ttname"><a href="classTList.html#a1b90ccfbde1729266b585194fa45df14">TList::Add</a></div><div class="ttdeci">virtual void Add(TObject *obj)</div><div class="ttdef"><b>Definition:</b> <a href="TList_8h_source.html#l00087">TList.h:87</a></div></div>
<div class="ttc" id="textangle_8C_html_a3359d7f1aa9fe2f8bc884b02020e8d20"><div class="ttname"><a href="textangle_8C.html#a3359d7f1aa9fe2f8bc884b02020e8d20">l</a></div><div class="ttdeci">auto * l</div><div class="ttdef"><b>Definition:</b> <a href="textangle_8C_source.html#l00004">textangle.C:4</a></div></div>
<div class="ttc" id="namespaceTMath_html_a38e1c23e08564d17051526d7e0a5364d"><div class="ttname"><a href="namespaceTMath.html#a38e1c23e08564d17051526d7e0a5364d">TMath::Max</a></div><div class="ttdeci">Short_t Max(Short_t a, Short_t b)</div><div class="ttdef"><b>Definition:</b> <a href="TMathBase_8h_source.html#l00212">TMathBase.h:212</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a915f6ba6a911fc155d32ff94d2c5ed90"><div class="ttname"><a href="classTMultiDimFit.html#a915f6ba6a911fc155d32ff94d2c5ed90">TMultiDimFit::fRMS</a></div><div class="ttdeci">Double_t fRMS</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00084">TMultiDimFit.h:84</a></div></div>
<div class="ttc" id="namespaceTMath_html_acb6531465af378f4e6e4a8a62f8c6a4d"><div class="ttname"><a href="namespaceTMath.html#acb6531465af378f4e6e4a8a62f8c6a4d">TMath::Sin</a></div><div class="ttdeci">Double_t Sin(Double_t)</div><div class="ttdef"><b>Definition:</b> <a href="TMath_8h_source.html#l00625">TMath.h:625</a></div></div>
<div class="ttc" id="TRolke_8cxx_html_a1a2354f40e332ad13673b70afc2c0dbf"><div class="ttname"><a href="TRolke_8cxx.html#a1a2354f40e332ad13673b70afc2c0dbf">b</a></div><div class="ttdeci">you should not use this method at all Int_t Int_t Double_t Double_t Double_t Int_t Double_t Double_t Double_t Double_t b</div><div class="ttdef"><b>Definition:</b> <a href="TRolke_8cxx_source.html#l00630">TRolke.cxx:630</a></div></div>
<div class="ttc" id="TH1_8h_html"><div class="ttname"><a href="TH1_8h.html">TH1.h</a></div></div>
<div class="ttc" id="Rtypes_8h_html_a93170b16cd359cbf0e8643c41b987703"><div class="ttname"><a href="Rtypes_8h.html#a93170b16cd359cbf0e8643c41b987703">TESTBIT</a></div><div class="ttdeci">#define TESTBIT(n, i)</div><div class="ttdef"><b>Definition:</b> <a href="Rtypes_8h_source.html#l00086">Rtypes.h:86</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a8c4c287c72e9ea58d80223b927cd152eac9953ab7fc01b500168df1fa056fba5f"><div class="ttname"><a href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152eac9953ab7fc01b500168df1fa056fba5f">TMultiDimFit::kChebyshev</a></div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00020">TMultiDimFit.h:20</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a046de74be7fc5ba5f36df6db4e110630"><div class="ttname"><a href="classTMultiDimFit.html#a046de74be7fc5ba5f36df6db4e110630">TMultiDimFit::MakeCorrelation</a></div><div class="ttdeci">virtual void MakeCorrelation()</div><div class="ttdoc">PRIVATE METHOD: Compute the correlation matrix. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01442">TMultiDimFit.cxx:1442</a></div></div>
<div class="ttc" id="namespaceTMath_html_a9ea900c956031cb12057acf7c322b0fa"><div class="ttname"><a href="namespaceTMath.html#a9ea900c956031cb12057acf7c322b0fa">TMath::Sqrt</a></div><div class="ttdeci">Double_t Sqrt(Double_t x)</div><div class="ttdef"><b>Definition:</b> <a href="TMath_8h_source.html#l00679">TMath.h:679</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a70980d4b828a22e1eb686615519d1623"><div class="ttname"><a href="classTMultiDimFit.html#a70980d4b828a22e1eb686615519d1623">TMultiDimFit::MakeGramSchmidt</a></div><div class="ttdeci">virtual Double_t MakeGramSchmidt(Int_t function)</div><div class="ttdoc">PRIVATE METHOD: Make Gram-Schmidt orthogonalisation. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01501">TMultiDimFit.cxx:1501</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a85678efb97e963279c31d60cd4591ce0"><div class="ttname"><a href="classTMultiDimFit.html#a85678efb97e963279c31d60cd4591ce0">TMultiDimFit::fCorrelationCoeff</a></div><div class="ttdeci">Double_t fCorrelationCoeff</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00092">TMultiDimFit.h:92</a></div></div>
<div class="ttc" id="TMath_8h_html"><div class="ttname"><a href="TMath_8h.html">TMath.h</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ae3d7287e883eeb2ffe6c67b7fdff7db4"><div class="ttname"><a href="classTMultiDimFit.html#ae3d7287e883eeb2ffe6c67b7fdff7db4">TMultiDimFit::fMinVariables</a></div><div class="ttdeci">TVectorD fMinVariables</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00040">TMultiDimFit.h:40</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a7bb76ca216ad08945970f45628bf0f21"><div class="ttname"><a href="classTMultiDimFit.html#a7bb76ca216ad08945970f45628bf0f21">TMultiDimFit::fOrthCoefficients</a></div><div class="ttdeci">TVectorD fOrthCoefficients</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00080">TMultiDimFit.h:80</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_af2f51d30ccd86e85be3e3e69793a86ef"><div class="ttname"><a href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a></div><div class="ttdeci">const Bool_t kTRUE</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00087">RtypesCore.h:87</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a8c4c287c72e9ea58d80223b927cd152ea01c4c4c755c598880447ca3ce72b0950"><div class="ttname"><a href="classTMultiDimFit.html#a8c4c287c72e9ea58d80223b927cd152ea01c4c4c755c598880447ca3ce72b0950">TMultiDimFit::kMonomials</a></div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00019">TMultiDimFit.h:19</a></div></div>
<div class="ttc" id="legend1_8C_html_a16daaa7b596941b23915a1ac1be5b42c"><div class="ttname"><a href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a></div><div class="ttdeci">const Int_t n</div><div class="ttdef"><b>Definition:</b> <a href="legend1_8C_source.html#l00016">legend1.C:16</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_aaf529206d8c377fd6b852987e7599a5d"><div class="ttname"><a href="classTMultiDimFit.html#aaf529206d8c377fd6b852987e7599a5d">TMultiDimFit::MakeCoefficients</a></div><div class="ttdeci">virtual void MakeCoefficients()</div><div class="ttdoc">PRIVATE METHOD: Invert the model matrix B, and compute final coefficients. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l01362">TMultiDimFit.cxx:1362</a></div></div>
<div class="ttc" id="TMultiDimFit_8cxx_html_af90c111e0b8dbee3646b0a50da904c7d"><div class="ttname"><a href="TMultiDimFit_8cxx.html#af90c111e0b8dbee3646b0a50da904c7d">PARAM_MAXTERMS</a></div><div class="ttdeci">#define PARAM_MAXTERMS</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00411">TMultiDimFit.cxx:411</a></div></div>
<div class="ttc" id="TMultiDimFit_8cxx_html_a5bab3ed8bd37031d95ed6e105c4cfa8d"><div class="ttname"><a href="TMultiDimFit_8cxx.html#a5bab3ed8bd37031d95ed6e105c4cfa8d">PARAM_SEVERAL</a></div><div class="ttdeci">#define PARAM_SEVERAL</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00409">TMultiDimFit.cxx:409</a></div></div>
<div class="ttc" id="classTObject_html_a75fddd7eef38a13c1374130ec7dc5cf8"><div class="ttname"><a href="classTObject.html#a75fddd7eef38a13c1374130ec7dc5cf8">TObject::Warning</a></div><div class="ttdeci">virtual void Warning(const char *method, const char *msgfmt,...) const</div><div class="ttdoc">Issue warning message. </div><div class="ttdef"><b>Definition:</b> <a href="TObject_8cxx_source.html#l00866">TObject.cxx:866</a></div></div>
<div class="ttc" id="classTMatrixTBase_html_abdd847ecced6029aa8955fbdad9771e7"><div class="ttname"><a href="classTMatrixTBase.html#abdd847ecced6029aa8955fbdad9771e7">TMatrixTBase::IsValid</a></div><div class="ttdeci">Bool_t IsValid() const</div><div class="ttdef"><b>Definition:</b> <a href="TMatrixTBase_8h_source.html#l00147">TMatrixTBase.h:147</a></div></div>
<div class="ttc" id="classTDatime_html"><div class="ttname"><a href="classTDatime.html">TDatime</a></div><div class="ttdoc">This class stores the date and time with a precision of one second in an unsigned 32 bit word (950130...</div><div class="ttdef"><b>Definition:</b> <a href="TDatime_8h_source.html#l00037">TDatime.h:37</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a37827b8b8d314fa4fc63c0fc97bcc31f"><div class="ttname"><a href="classTMultiDimFit.html#a37827b8b8d314fa4fc63c0fc97bcc31f">TMultiDimFit::fMaxVariables</a></div><div class="ttdeci">TVectorD fMaxVariables</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00039">TMultiDimFit.h:39</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_ab95ddf228f66641893679f5680217eca"><div class="ttname"><a href="classTMultiDimFit.html#ab95ddf228f66641893679f5680217eca">TMultiDimFit::Browse</a></div><div class="ttdeci">virtual void Browse(TBrowser *b)</div><div class="ttdoc">Browse the TMultiDimFit object in the TBrowser. </div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8cxx_source.html#l00734">TMultiDimFit.cxx:734</a></div></div>
<div class="ttc" id="classTH2D_html"><div class="ttname"><a href="classTH2D.html">TH2D</a></div><div class="ttdoc">2-D histogram with a double per channel (see TH1 documentation)} </div><div class="ttdef"><b>Definition:</b> <a href="TH2_8h_source.html#l00289">TH2.h:289</a></div></div>
<div class="ttc" id="classTString_html_a7e4ada8bf2407b461f3ee58b71c5959f"><div class="ttname"><a href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">TString::Data</a></div><div class="ttdeci">const char * Data() const</div><div class="ttdef"><b>Definition:</b> <a href="TString_8h_source.html#l00364">TString.h:364</a></div></div>
<div class="ttc" id="classTMultiDimFit_html_a9e7f168a0f08032f4f45184af3cc0019"><div class="ttname"><a href="classTMultiDimFit.html#a9e7f168a0f08032f4f45184af3cc0019">TMultiDimFit::fTestCorrelationCoeff</a></div><div class="ttdeci">Double_t fTestCorrelationCoeff</div><div class="ttdef"><b>Definition:</b> <a href="TMultiDimFit_8h_source.html#l00094">TMultiDimFit.h:94</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:09:21 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: math/foam/src/TFoam.cxx Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_296d53ceaeaa7e099814a6def439fe8a.html">math</a></li><li class="navelem"><a class="el" href="dir_5ac6db18b0f2ccf61bb4dcf440b3acaa.html">foam</a></li><li class="navelem"><a class="el" href="dir_cf1243ef12d59ded970b36c3a7d6286e.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TFoam.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="TFoam_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// @(#)root/foam:$Id$</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Author: S. Jadach &lt;mailto:Stanislaw.jadach@ifj.edu.pl&gt;, P.Sawicki &lt;mailto:Pawel.Sawicki@ifj.edu.pl&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//______________________________________________________________________________</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// FOAM  Version 1.02M</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// ===================</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// Authors:</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//   S. Jadach and P.Sawicki</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//   Institute of Nuclear Physics, Cracow, Poland</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//   Stanislaw. Jadach@ifj.edu.pl, Pawel.Sawicki@ifj.edu.pl</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// What is FOAM for?</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// =================</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// * Suppose you want to generate randomly points (vectors) according to</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//   an arbitrary probability distribution  in n dimensions,</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//   for which you supply your own subprogram. FOAM can do it for you!</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//   Even if your distributions has quite strong peaks and is discontinuous!</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// * FOAM generates random points with weight one or with variable weight.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// * FOAM is capable to integrate using efficient &quot;adaptive&quot; MC method.</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//   (The distribution does not need to be normalized to one.)</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// How does it work?</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// =================</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// FOAM is the simplified version of the multi-dimensional general purpose</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// Monte Carlo event generator (integrator) FOAM.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// It creates hyper-rectangular &quot;foam of cells&quot;, which is more dense around its peaks.</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// See the following 2-dim. example of the map of 1000 cells for doubly peaked distribution:</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// &lt;img src=&quot;gif/foam_MapCamel1000.gif&quot;&gt;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// FOAM is now fully integrated with the ROOT package.</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// The important bonus of the ROOT use is persistency of the FOAM objects!</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// For more sophisticated problems full version of FOAM may be more appropriate:</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// See [full version of FOAM](http://jadach.home.cern.ch/jadach/Foam/Index.html)</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// Simple example of the use of FOAM:</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// ==================================</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">// Int_t kanwa(){</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//   gSystem-&gt;Load(&quot;libFoam&quot;);</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//   TH2D  *hst_xy = new TH2D(&quot;hst_xy&quot; ,  &quot;x-y plot&quot;, 50,0,1.0, 50,0,1.0);</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//   Double_t *MCvect =new Double_t[2]; // 2-dim vector generated in the MC run</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//   TRandom3  *PseRan   = new TRandom3();  // Create random number generator</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//   PseRan-&gt;SetSeed(4357);                // Set seed</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//   TFoam   *FoamX    = new TFoam(&quot;FoamX&quot;);   // Create Simulator</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//   FoamX-&gt;SetkDim(2);          // No. of dimensions, obligatory!</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//   FoamX-&gt;SetnCells(500);      // No. of cells, can be omitted, default=2000</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//   FoamX-&gt;SetRhoInt(Camel2);   // Set 2-dim distribution, included below</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//   FoamX-&gt;SetPseRan(PseRan);   // Set random number generator</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//   FoamX-&gt;Initialize();        // Initialize simulator, takes a few seconds...</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//   // From now on FoamX is ready to generate events according to Camel2(x,y)</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//   for(Long_t loop=0; loop&lt;100000; loop++){</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//     FoamX-&gt;MakeEvent();          // generate MC event</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//     FoamX-&gt;GetMCvect( MCvect);   // get generated vector (x,y)</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//     Double_t x=MCvect[0];</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//     Double_t y=MCvect[1];</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//     if(loop&lt;10) std::cout&lt;&lt;&quot;(x,y) =  ( &quot;&lt;&lt; x &lt;&lt;&quot;, &quot;&lt;&lt; y &lt;&lt;&quot; )&quot;&lt;&lt;std::endl;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//     hst_xy-&gt;Fill(x,y);           // fill scattergram</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//   }// loop</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//   Double_t mcResult, mcError;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//   FoamX-&gt;GetIntegMC( mcResult, mcError);  // get MC integral, should be one</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//   std::cout &lt;&lt; &quot; mcResult= &quot; &lt;&lt; mcResult &lt;&lt; &quot; +- &quot; &lt;&lt; mcError &lt;&lt;std::endl;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//   // now hst_xy will be plotted visualizing generated distribution</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//   TCanvas *cKanwa = new TCanvas(&quot;cKanwa&quot;,&quot;Canvas for plotting&quot;,600,600);</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">//   cKanwa-&gt;cd();</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//   hst_xy-&gt;Draw(&quot;lego2&quot;);</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">// }//kanwa</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">// Double_t sqr(Double_t x){return x*x;};</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">// Double_t Camel2(Int_t nDim, Double_t *Xarg){</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">// // 2-dimensional distribution for FOAM, normalized to one (within 1e-5)</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//   Double_t x=Xarg[0];</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//   Double_t y=Xarg[1];</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//   Double_t GamSq= sqr(0.100e0);</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">//   Double_t Dist=exp(-(sqr(x-1./3) +sqr(y-1./3))/GamSq)/GamSq/TMath::Pi();</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">//   Dist        +=exp(-(sqr(x-2./3) +sqr(y-2./3))/GamSq)/GamSq/TMath::Pi();</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">//   return 0.5*Dist;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">// }// Camel2</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">// Two-dim. histogram of the MC points generated with the above program looks as follows:</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">// &lt;img src=&quot;gif/foam_cKanwa.gif&quot;&gt;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">// Canonical nine steering parameters of FOAM</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// ===========================================</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">//  Name     | default  | Description</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">//  kDim     | 0        | Dimension of the integration space. Must be redefined!</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">//  nCells   | 1000     | No of allocated number of cells,</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">//  nSampl   | 200      | No. of MC events in the cell MC exploration</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">//  nBin     | 8        | No. of bins in edge-histogram in cell exploration</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">//  OptRej   | 1        | OptRej = 0, weighted; OptRej=1, wt=1 MC events</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">//  OptDrive | 2        | Maximum weight reduction, =1 for variance reduction</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">//  EvPerBin | 25       | Maximum number of the effective wt=1 events/bin,</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//           |          | EvPerBin=0 deactivates this option</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">//  Chat     | 1        | =0,1,2 is the ``chat level&#39;&#39; in the standard output</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">//  MaxWtRej | 1.1      | Maximum weight used to get w=1 MC events</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">// The above can be redefined before calling &#39;Initialize()&#39; method,</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">// for instance FoamObject-&gt;SetkDim(15) sets dimension of the distribution to 15.</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">// Only kDim HAS TO BE redefined, the other parameters may be left at their defaults.</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">// nCell may be increased up to about million cells for wildly peaked distributions.</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">// Increasing nSampl sometimes helps, but it may cost CPU time.</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">// MaxWtRej may need to be increased for wild a distribution, while using OptRej=0.</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">// Past versions of FOAM: August 2003, v.1.00; September 2003 v.1.01</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">// Adopted starting from FOAM-2.06 by P. Sawicki</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">// --------------------------------------------------------------------</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">// Users of FOAM are kindly requested to cite the following work:</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">// S. Jadach, Computer Physics Communications 152 (2003) 55.</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">//______________________________________________________________________________</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TFoam_8h.html">TFoam.h</a>&quot;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TFoamIntegrand_8h.html">TFoamIntegrand.h</a>&quot;</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TFoamMaxwt_8h.html">TFoamMaxwt.h</a>&quot;</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TFoamVect_8h.html">TFoamVect.h</a>&quot;</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TFoamCell_8h.html">TFoamCell.h</a>&quot;</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Riostream_8h.html">Riostream.h</a>&quot;</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TH1_8h.html">TH1.h</a>&quot;</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TRefArray_8h.html">TRefArray.h</a>&quot;</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TMethodCall_8h.html">TMethodCall.h</a>&quot;</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TRandom_8h.html">TRandom.h</a>&quot;</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TMath_8h.html">TMath.h</a>&quot;</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TInterpreter_8h.html">TInterpreter.h</a>&quot;</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<a class="code" href="Rtypes_8h.html#a3f9bf160bbbb44209e95556960836b96">ClassImp</a>(<a class="code" href="classTFoam.html">TFoam</a>);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">//FFFFFF  BoX-FORMATs for nice and flexible outputs</span></div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="TFoam_8cxx.html#aeff7a5ba4f2535abfd56874d716676a1">  130</a></span>&#160;<span class="preprocessor">#define BXOPE std::cout&lt;&lt;\</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="preprocessor">&quot;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF&quot;&lt;&lt;std::endl&lt;&lt;\</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor">&quot;F                                                                              F&quot;&lt;&lt;std::endl</span></div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="TFoam_8cxx.html#a675bf9bc58e8545c648be3aab07403fe">  133</a></span>&#160;<span class="preprocessor">#define BXTXT(text) std::cout&lt;&lt;\</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">&quot;F                   &quot;&lt;&lt;std::setw(40)&lt;&lt;         text           &lt;&lt;&quot;                   F&quot;&lt;&lt;std::endl</span></div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="TFoam_8cxx.html#a30a4fd0f6d19430b51d6aa8656a1c78a">  135</a></span>&#160;<span class="preprocessor">#define BX1I(name,numb,text) std::cout&lt;&lt;\</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">&quot;F &quot;&lt;&lt;std::setw(10)&lt;&lt;name&lt;&lt;&quot; = &quot;&lt;&lt;std::setw(10)&lt;&lt;numb&lt;&lt;&quot; = &quot;          &lt;&lt;std::setw(50)&lt;&lt;text&lt;&lt;&quot; F&quot;&lt;&lt;std::endl</span></div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">  137</a></span>&#160;<span class="preprocessor">#define BX1F(name,numb,text)     std::cout&lt;&lt;&quot;F &quot;&lt;&lt;std::setw(10)&lt;&lt;name&lt;&lt;\</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">          &quot; = &quot;&lt;&lt;std::setw(15)&lt;&lt;std::setprecision(8)&lt;&lt;numb&lt;&lt;&quot;   =    &quot;&lt;&lt;std::setw(40)&lt;&lt;text&lt;&lt;&quot; F&quot;&lt;&lt;std::endl</span></div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="TFoam_8cxx.html#a9ccf82f4f7b8f320984dca908f83d8fa">  139</a></span>&#160;<span class="preprocessor">#define BX2F(name,numb,err,text) std::cout&lt;&lt;&quot;F &quot;&lt;&lt;std::setw(10)&lt;&lt;name&lt;&lt;\</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">&quot; = &quot;&lt;&lt;std::setw(15)&lt;&lt;std::setprecision(8)&lt;&lt;numb&lt;&lt;&quot; +- &quot;&lt;&lt;std::setw(15)&lt;&lt;std::setprecision(8)&lt;&lt;err&lt;&lt; \</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">                                                      &quot;  = &quot;&lt;&lt;std::setw(25)&lt;&lt;text&lt;&lt;&quot; F&quot;&lt;&lt;std::endl</span></div><div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="TFoam_8cxx.html#a6692b82cba0b23a6b59a8e498f9519a5">  142</a></span>&#160;<span class="preprocessor">#define BXCLO std::cout&lt;&lt;\</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="preprocessor">&quot;F                                                                              F&quot;&lt;&lt;std::endl&lt;&lt;\</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">&quot;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF&quot;&lt;&lt;std::endl</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">//FFFFFF  BoX-FORMATs ends here</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="TFoam_8cxx.html#ad485bb39a59a51c631d174213f5a6dd8">  147</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="TFoam_8cxx.html#ad485bb39a59a51c631d174213f5a6dd8">gHigh</a>= 1.0e150;</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="TFoam_8cxx.html#ab312b21ef43740f275186543f0bc5554">  148</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="TFoam_8cxx.html#ab312b21ef43740f275186543f0bc5554">gVlow</a>=-1.0e150;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="TFoam_8cxx.html#a276a7c4ba0f813d53715e2ec2595d906">  150</a></span>&#160;<span class="preprocessor">#define SW2 setprecision(7) &lt;&lt; std::setw(12)</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">// class to wrap a global function in a TFoamIntegrand function</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keyword">class </span>FoamIntegrandFunction : <span class="keyword">public</span> <a class="code" href="classTFoamIntegrand.html">TFoamIntegrand</a> {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <span class="keyword">typedef</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> (*FunctionPtr)(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>*);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   FoamIntegrandFunction(FunctionPtr func) : fFunc(func) {}</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keyword">virtual</span> ~FoamIntegrandFunction() {}</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   <span class="comment">// evaluate the density using the provided function pointer</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="classTFoamIntegrand.html#a0403f43554c1e4312efe54944ae7adbf">Density</a> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nDim, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> * <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>) {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordflow">return</span> fFunc(nDim,<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   FunctionPtr fFunc;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;};</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">/// Default constructor for streamer, user should not use it.</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="classTFoam.html#afaca66ad8bab1cf1294ec19dc2768239">  178</a></span>&#160;<a class="code" href="classTFoam.html#afaca66ad8bab1cf1294ec19dc2768239">TFoam::TFoam</a>() :</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   fDim(0), fNCells(0), fRNmax(0),</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   fOptDrive(0), fChat(0), fOptRej(0),</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   fNBin(0), fNSampl(0), fEvPerBin(0),</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   fMaskDiv(0), fInhiDiv(0), fOptPRD(0), fXdivPRD(0),</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   fNoAct(0), fLastCe(0), fCells(0),</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   fMCMonit(0), fMaxWtRej(0), fCellsAct(0), fPrimAcu(0),</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   fHistEdg(0), fHistDbg(0), fHistWt(0),</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   fMCvect(0), fMCwt(0), fRvec(0),</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   fRho(0), fMethodCall(0), fPseRan(0),</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   fNCalls(0), fNEffev(0),</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   fSumWt(0), fSumWt2(0),</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   fSumOve(0), fNevGen(0),</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   fWtMax(0), fWtMin(0),</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   fPrime(0), fMCresult(0), fMCerror(0),</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   fAlpha(0)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}<span class="comment"></span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">/// User constructor, to be employed by the user</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="classTFoam.html#a2cf137654119f559c4105eb4388ca0f7">  199</a></span>&#160;<a class="code" href="classTFoam.html#afaca66ad8bab1cf1294ec19dc2768239">TFoam::TFoam</a>(<span class="keyword">const</span> <a class="code" href="RtypesCore_8h.html#a72a4388b7fc57f981af8c65fefcceb1f">Char_t</a>* <a class="code" href="namespacexmlio.html#a08382af5894f1d98d5d0c41660c4f32f">Name</a>) :</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   fDim(0), fNCells(0), fRNmax(0),</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   fOptDrive(0), fChat(0), fOptRej(0),</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   fNBin(0), fNSampl(0), fEvPerBin(0),</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   fMaskDiv(0), fInhiDiv(0), fOptPRD(0), fXdivPRD(0),</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   fNoAct(0), fLastCe(0), fCells(0),</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   fMCMonit(0), fMaxWtRej(0), fCellsAct(0), fPrimAcu(0),</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   fHistEdg(0), fHistDbg(0), fHistWt(0),</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   fMCvect(0), fMCwt(0), fRvec(0),</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   fRho(0), fMethodCall(0), fPseRan(0),</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   fNCalls(0), fNEffev(0),</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   fSumWt(0), fSumWt2(0),</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   fSumOve(0), fNevGen(0),</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   fWtMax(0), fWtMin(0),</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   fPrime(0), fMCresult(0), fMCerror(0),</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   fAlpha(0)</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <span class="keywordflow">if</span>(strlen(<a class="code" href="namespacexmlio.html#a08382af5894f1d98d5d0c41660c4f32f">Name</a>)  &gt;129) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;TFoam&quot;</span>,<span class="stringliteral">&quot;Name too long %s \n&quot;</span>,<a class="code" href="namespacexmlio.html#a08382af5894f1d98d5d0c41660c4f32f">Name</a>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <a class="code" href="classTFoam.html#a0ef363820f5b178be9ca03d812b2cd38">fName</a>=<a class="code" href="namespacexmlio.html#a08382af5894f1d98d5d0c41660c4f32f">Name</a>;                                            <span class="comment">// Class name</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <a class="code" href="classTFoam.html#ad3022d8480a696ac4351487380d87aa7">fDate</a>=<span class="stringliteral">&quot;  Release date:  2005.04.10&quot;</span>;                   <span class="comment">// Release date</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   <a class="code" href="classTFoam.html#ac90623b8b2d148f9c7d253bd61492853">fVersion</a>= <span class="stringliteral">&quot;1.02M&quot;</span>;                                     <span class="comment">// Release version</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   <a class="code" href="classTFoam.html#ab0cbe0d35b1073cf35be21e5616f5f05">fMaskDiv</a>  = 0;             <span class="comment">// Dynamic Mask for  cell division, h-cubic</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   <a class="code" href="classTFoam.html#a4d633c10f039fc94931d0ad91c4568d2">fInhiDiv</a>  = 0;             <span class="comment">// Flag allowing to inhibit cell division in certain projection/edge</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a>  = 0;             <span class="comment">// Lists of division values encoded in one vector per direction</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>    = 0;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   <a class="code" href="classTFoam.html#a624774b519e7347376212fa1313c98fc">fAlpha</a>    = 0;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   <a class="code" href="classTFoam.html#a4037d51e21d262eb04692fa3c8268dbe">fCellsAct</a> = 0;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   <a class="code" href="classTFoam.html#ac29223eb2df913fc4223af49b940d6e0">fPrimAcu</a>  = 0;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   <a class="code" href="classTFoam.html#ade7af279b88fafa726e5f7be46b55b86">fHistEdg</a>  = 0;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <a class="code" href="classTFoam.html#a1510630fd3caa168268f61ccc802e72e">fHistWt</a>   = 0;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   <a class="code" href="classTFoam.html#a88cd859d30ef713e54cfe8076400896e">fHistDbg</a>  = 0;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   <a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>     = 0;                <span class="comment">// dimension of hyp-cubical space</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   <a class="code" href="classTFoam.html#a5bb752728a7d25ffd78fcc9dbf180079">fNCells</a>   = 1000;             <span class="comment">// Maximum number of Cells,    is usually re-set</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   <a class="code" href="classTFoam.html#ad301b78fd272d626da77c16361d399a3">fNSampl</a>   = 200;              <span class="comment">// No of sampling when dividing cell</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   <a class="code" href="classTFoam.html#a84d3266952abae597c4142ce36582cf3">fOptPRD</a>   = 0;                <span class="comment">// General Option switch for PRedefined Division, for quick check</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;   <a class="code" href="classTFoam.html#a62ab1b7b59427c82239acd39706e6f13">fOptDrive</a> = 2;                <span class="comment">// type of Drive =1,2 for TrueVol,Sigma,WtMax</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   <a class="code" href="classTFoam.html#a20be20446e99fdfc26955c5b389f92c4">fChat</a>     = 1;                <span class="comment">// Chat=0,1,2 chat level in output, Chat=1 normal level</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <a class="code" href="classTFoam.html#ac0aa4bc25859a420d0df7dd4ad17178b">fOptRej</a>   = 1;                <span class="comment">// OptRej=0, wted events; OptRej=1, wt=1 events</span><span class="comment"></span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">   /////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   <a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>     = 8;                <span class="comment">// binning of edge-histogram in cell exploration</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   <a class="code" href="classTFoam.html#a591ba605708cabe87ef3277cc3a67bfa">fEvPerBin</a> =25;                <span class="comment">// maximum no. of EFFECTIVE event per bin, =0 option is inactive</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   <span class="comment">//------------------------------------------------------</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   <a class="code" href="classTFoam.html#a50b85f60c791f766e5a197f43f661d7c">fNCalls</a> = 0;                  <span class="comment">// No of function calls</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <a class="code" href="classTFoam.html#abe93c1b1556a8c9d17de4081fdfb1641">fNEffev</a> = 0;                  <span class="comment">// Total no of eff. wt=1 events in build=up</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a> =-1;                  <span class="comment">// Index of the last cell</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   <a class="code" href="classTFoam.html#abb371f4679f22bddb17b369d9ee7f511">fNoAct</a>  = 0;                  <span class="comment">// No of active cells (used in MC generation)</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   <a class="code" href="classTFoam.html#a567ba53409fed0bd7744694a6b73eb1e">fWtMin</a> = <a class="code" href="TFoam_8cxx.html#ad485bb39a59a51c631d174213f5a6dd8">gHigh</a>;               <span class="comment">// Minimal weight</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <a class="code" href="classTFoam.html#a9c10369f795e4ea1205b6e24dcd2a0f8">fWtMax</a> = <a class="code" href="TFoam_8cxx.html#ab312b21ef43740f275186543f0bc5554">gVlow</a>;               <span class="comment">// Maximal weight</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   <a class="code" href="classTFoam.html#a5b4152159bbd69bb2e4b06b17ef414f3">fMaxWtRej</a> =1.10;              <span class="comment">// Maximum weight in rejection for getting wt=1 events</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   <a class="code" href="classTFoam.html#a1aae352244412f1e1bd6711be17f5e57">fPseRan</a>   = 0;                <span class="comment">// Initialize private copy of random number generator</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;   <a class="code" href="classTFoam.html#a4105266375bfe6f0807109680f6bc0d3">fMCMonit</a>  = 0;                <span class="comment">// MC efficiency monitoring</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <a class="code" href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">fRho</a> = 0;                     <span class="comment">// pointer to abstract class providing function to integrate</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   <a class="code" href="classTFoam.html#ac4c057ef5fe272b508f41c30a560b556">fMCvect</a>   = 0;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <a class="code" href="classTFoam.html#a5bd2f38254d10799a96618f647a659d9">fRvec</a>     = 0;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   <a class="code" href="classTFoam.html#a1aae352244412f1e1bd6711be17f5e57">fPseRan</a>   = 0;                <span class="comment">// generator of pseudorandom numbers</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   <a class="code" href="classTFoam.html#a6fb0d8cd68926217c671040c42227e5e">fMethodCall</a>=0;                <span class="comment">// ROOT&#39;s pointer to global distribution function</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">/// Default destructor</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="classTFoam.html#aac885faf09fc637e32cb59982992e148">  263</a></span>&#160;<a class="code" href="classTFoam.html#aac885faf09fc637e32cb59982992e148">TFoam::~TFoam</a>()</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;{</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>!= 0) {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="classTFoam.html#a5bb752728a7d25ffd78fcc9dbf180079">fNCells</a>; i++) <span class="keyword">delete</span> <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[i]; <span class="comment">// TFoamCell*[]</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keyword">delete</span> [] <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#a4037d51e21d262eb04692fa3c8268dbe">fCellsAct</a>) <span class="keyword">delete</span> <a class="code" href="classTFoam.html#a4037d51e21d262eb04692fa3c8268dbe">fCellsAct</a> ; <span class="comment">// WVE FIX LEAK</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#a5bd2f38254d10799a96618f647a659d9">fRvec</a>)    <span class="keyword">delete</span> [] <a class="code" href="classTFoam.html#a5bd2f38254d10799a96618f647a659d9">fRvec</a>;    <span class="comment">//double[]</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#a624774b519e7347376212fa1313c98fc">fAlpha</a>)   <span class="keyword">delete</span> [] <a class="code" href="classTFoam.html#a624774b519e7347376212fa1313c98fc">fAlpha</a>;   <span class="comment">//double[]</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#ac4c057ef5fe272b508f41c30a560b556">fMCvect</a>)  <span class="keyword">delete</span> [] <a class="code" href="classTFoam.html#ac4c057ef5fe272b508f41c30a560b556">fMCvect</a>;  <span class="comment">//double[]</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#ac29223eb2df913fc4223af49b940d6e0">fPrimAcu</a>) <span class="keyword">delete</span> [] <a class="code" href="classTFoam.html#ac29223eb2df913fc4223af49b940d6e0">fPrimAcu</a>; <span class="comment">//double[]</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#ab0cbe0d35b1073cf35be21e5616f5f05">fMaskDiv</a>) <span class="keyword">delete</span> [] <a class="code" href="classTFoam.html#ab0cbe0d35b1073cf35be21e5616f5f05">fMaskDiv</a>; <span class="comment">//int[]</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#a4d633c10f039fc94931d0ad91c4568d2">fInhiDiv</a>) <span class="keyword">delete</span> [] <a class="code" href="classTFoam.html#a4d633c10f039fc94931d0ad91c4568d2">fInhiDiv</a>; <span class="comment">//int[]</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   <span class="keywordflow">if</span>( <a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a>!= 0) {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>; i++) <span class="keyword">delete</span> <a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a>[i]; <span class="comment">// TFoamVect*[]</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keyword">delete</span> [] <a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#a4105266375bfe6f0807109680f6bc0d3">fMCMonit</a>) <span class="keyword">delete</span> <a class="code" href="classTFoam.html#a4105266375bfe6f0807109680f6bc0d3">fMCMonit</a>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#a1510630fd3caa168268f61ccc802e72e">fHistWt</a>)  <span class="keyword">delete</span> <a class="code" href="classTFoam.html#a1510630fd3caa168268f61ccc802e72e">fHistWt</a>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   <span class="comment">// delete histogram arrays</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#ade7af279b88fafa726e5f7be46b55b86">fHistEdg</a>) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <a class="code" href="classTFoam.html#ade7af279b88fafa726e5f7be46b55b86">fHistEdg</a>-&gt;<a class="code" href="classTObjArray.html#a7ebdea832148e00b8805277c79de5003">Delete</a>();</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classTFoam.html#ade7af279b88fafa726e5f7be46b55b86">fHistEdg</a>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#a88cd859d30ef713e54cfe8076400896e">fHistDbg</a>) {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <a class="code" href="classTFoam.html#a88cd859d30ef713e54cfe8076400896e">fHistDbg</a>-&gt;<a class="code" href="classTObjArray.html#a7ebdea832148e00b8805277c79de5003">Delete</a>();</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classTFoam.html#a88cd859d30ef713e54cfe8076400896e">fHistDbg</a>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   <span class="comment">// delete function object if it has been created here in SetRhoInt</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">fRho</a> &amp;&amp; dynamic_cast&lt;FoamIntegrandFunction*&gt;(<a class="code" href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">fRho</a>) ) <span class="keyword">delete</span> <a class="code" href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">fRho</a>;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;}</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">/// Copy Constructor  NOT IMPLEMENTED (NEVER USED)</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="classTFoam.html#a498001ec9b9e06dbeb72914cbd74b3c1">  303</a></span>&#160;<a class="code" href="classTFoam.html#afaca66ad8bab1cf1294ec19dc2768239">TFoam::TFoam</a>(<span class="keyword">const</span> <a class="code" href="classTFoam.html">TFoam</a> &amp;From): <a class="code" href="classTObject.html">TObject</a>(From)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;{</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;TFoam&quot;</span>, <span class="stringliteral">&quot;COPY CONSTRUCTOR NOT IMPLEMENTED \n&quot;</span>);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">/// Basic initialization of FOAM invoked by the user. Mandatory!</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">/// ============================================================</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">/// This method starts the process of the cell build-up.</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">/// User must invoke Initialize with two arguments or Initialize without arguments.</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">/// This is done BEFORE generating first MC event and AFTER allocating FOAM object</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">/// and reseting (optionally) its internal parameters/switches.</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">/// The overall operational scheme of the FOAM is the following:</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">/// &lt;img src=&quot;gif/foam_schema2.gif&quot;&gt;</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">/// This method invokes several other methods:</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">/// ==========================================</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">/// InitCells initializes memory storage for cells and begins exploration process</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">/// from the root cell. The empty cells are allocated/filled using  CellFill.</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">/// The procedure Grow which loops over cells, picks up the cell with the biggest</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">/// ``driver integral&#39;&#39;, see Comp. Phys. Commun. 152 152 (2003) 55 for explanations,</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">/// with the help of PeekMax procedure. The chosen cell is split using Divide.</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">/// Subsequently, the procedure Explore called by the Divide</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">/// (and by InitCells for the root cell) does the most important</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">/// job in the FOAM object build-up: it performs a small MC run for each</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">/// newly allocated daughter cell.</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">/// Explore calculates how profitable the future split of the cell will be</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">/// and defines the optimal cell division geometry with the help of Carver or Varedu</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">/// procedures, for maximum weight or variance optimization respectively.</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">/// All essential results of the exploration are written into</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">/// the explored cell object. At the very end of the foam build-up,</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">/// Finally, MakeActiveList is invoked to create a list of pointers to</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">/// all active cells, for the purpose of the quick access during the MC generation.</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">/// The procedure Explore employs MakeAlpha to generate random coordinates</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">/// inside a given cell with the uniform distribution.</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">/// The above sequence of the procedure calls is depicted in the following figure:</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">/// &lt;img src=&quot;gif/foam_Initialize_schema.gif&quot;&gt;</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="classTFoam.html#affdf258fb9002811aa87cdc35c85b45c">  343</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a3bcca3b6029e760b7770a3013fa9ca14">TFoam::Initialize</a>(<a class="code" href="classTRandom.html">TRandom</a> *PseRan, <a class="code" href="classTFoamIntegrand.html">TFoamIntegrand</a> *fun )</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;{</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   <a class="code" href="classTFoam.html#ad696f0c559ff6d29bc773822df842012">SetPseRan</a>(PseRan);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   <a class="code" href="classTFoam.html#ab46c94f852d34f3c1b71239b2eb19884">SetRho</a>(fun);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   <a class="code" href="classTFoam.html#a3bcca3b6029e760b7770a3013fa9ca14">Initialize</a>();</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">/// Basic initialization of FOAM invoked by the user.</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">/// IMPORTANT: Random number generator and the distribution object has to be</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">/// provided using SetPseRan and SetRho prior to invoking this initialiser!</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="classTFoam.html#a3bcca3b6029e760b7770a3013fa9ca14">  357</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a3bcca3b6029e760b7770a3013fa9ca14">TFoam::Initialize</a>()</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;{</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> addStatus = <a class="code" href="classTH1.html#af28db00a911cdc6475f5e8b805e34e11">TH1::AddDirectoryStatus</a>();</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   <a class="code" href="classTH1.html#a490b9d2cf9460f8428f104d7e0f82614">TH1::AddDirectory</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a20be20446e99fdfc26955c5b389f92c4">fChat</a>&gt;0){</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <a class="code" href="TFoam_8cxx.html#aeff7a5ba4f2535abfd56874d716676a1">BXOPE</a>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <a class="code" href="TFoam_8cxx.html#a675bf9bc58e8545c648be3aab07403fe">BXTXT</a>(<span class="stringliteral">&quot;****************************************&quot;</span>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <a class="code" href="TFoam_8cxx.html#a675bf9bc58e8545c648be3aab07403fe">BXTXT</a>(<span class="stringliteral">&quot;******      TFoam::Initialize    ******&quot;</span>);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <a class="code" href="TFoam_8cxx.html#a675bf9bc58e8545c648be3aab07403fe">BXTXT</a>(<span class="stringliteral">&quot;****************************************&quot;</span>);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <a class="code" href="TFoam_8cxx.html#a675bf9bc58e8545c648be3aab07403fe">BXTXT</a>(<a class="code" href="classTFoam.html#a0ef363820f5b178be9ca03d812b2cd38">fName</a>);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot;  Version&quot;</span>,<a class="code" href="classTFoam.html#ac90623b8b2d148f9c7d253bd61492853">fVersion</a>,  <a class="code" href="classTFoam.html#ad3022d8480a696ac4351487380d87aa7">fDate</a>);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <a class="code" href="TFoam_8cxx.html#a30a4fd0f6d19430b51d6aa8656a1c78a">BX1I</a>(<span class="stringliteral">&quot;     kDim&quot;</span>,<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>,     <span class="stringliteral">&quot; Dimension of the hyper-cubical space             &quot;</span>);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <a class="code" href="TFoam_8cxx.html#a30a4fd0f6d19430b51d6aa8656a1c78a">BX1I</a>(<span class="stringliteral">&quot;   nCells&quot;</span>,<a class="code" href="classTFoam.html#a5bb752728a7d25ffd78fcc9dbf180079">fNCells</a>,   <span class="stringliteral">&quot; Requested number of Cells (half of them active)  &quot;</span>);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <a class="code" href="TFoam_8cxx.html#a30a4fd0f6d19430b51d6aa8656a1c78a">BX1I</a>(<span class="stringliteral">&quot;   nSampl&quot;</span>,<a class="code" href="classTFoam.html#ad301b78fd272d626da77c16361d399a3">fNSampl</a>,   <span class="stringliteral">&quot; No of MC events in exploration of a cell         &quot;</span>);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <a class="code" href="TFoam_8cxx.html#a30a4fd0f6d19430b51d6aa8656a1c78a">BX1I</a>(<span class="stringliteral">&quot;     nBin&quot;</span>,<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>,     <span class="stringliteral">&quot; No of bins in histograms, MC exploration of cell &quot;</span>);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <a class="code" href="TFoam_8cxx.html#a30a4fd0f6d19430b51d6aa8656a1c78a">BX1I</a>(<span class="stringliteral">&quot; EvPerBin&quot;</span>,<a class="code" href="classTFoam.html#a591ba605708cabe87ef3277cc3a67bfa">fEvPerBin</a>, <span class="stringliteral">&quot; Maximum No effective_events/bin, MC exploration  &quot;</span>);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <a class="code" href="TFoam_8cxx.html#a30a4fd0f6d19430b51d6aa8656a1c78a">BX1I</a>(<span class="stringliteral">&quot; OptDrive&quot;</span>,<a class="code" href="classTFoam.html#a62ab1b7b59427c82239acd39706e6f13">fOptDrive</a>, <span class="stringliteral">&quot; Type of Driver   =1,2 for Sigma,WtMax            &quot;</span>);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <a class="code" href="TFoam_8cxx.html#a30a4fd0f6d19430b51d6aa8656a1c78a">BX1I</a>(<span class="stringliteral">&quot;   OptRej&quot;</span>,<a class="code" href="classTFoam.html#ac0aa4bc25859a420d0df7dd4ad17178b">fOptRej</a>,   <span class="stringliteral">&quot; MC rejection on/off for OptRej=0,1               &quot;</span>);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot; MaxWtRej&quot;</span>,<a class="code" href="classTFoam.html#a5b4152159bbd69bb2e4b06b17ef414f3">fMaxWtRej</a>, <span class="stringliteral">&quot; Maximum wt in rejection for wt=1 evts&quot;</span>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <a class="code" href="TFoam_8cxx.html#a6692b82cba0b23a6b59a8e498f9519a5">BXCLO</a>;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a1aae352244412f1e1bd6711be17f5e57">fPseRan</a>==0) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Initialize&quot;</span>, <span class="stringliteral">&quot;Random number generator not set \n&quot;</span>);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">fRho</a>==0 &amp;&amp; <a class="code" href="classTFoam.html#a6fb0d8cd68926217c671040c42227e5e">fMethodCall</a>==0 ) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Initialize&quot;</span>, <span class="stringliteral">&quot;Distribution function not set \n&quot;</span>);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>==0) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Initialize&quot;</span>, <span class="stringliteral">&quot;Zero dimension not allowed \n&quot;</span>);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">   /////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"></span>   <span class="comment">//                   ALLOCATE SMALL LISTS                              //</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   <span class="comment">//  it is done globally, not for each cell, to save on allocation time //</span><span class="comment"></span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">   /////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"></span>   <a class="code" href="classTFoam.html#a4920ec5f559a372208bc2f025562e248">fRNmax</a>= <a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>+1;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   <a class="code" href="classTFoam.html#a5bd2f38254d10799a96618f647a659d9">fRvec</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="classTFoam.html#a4920ec5f559a372208bc2f025562e248">fRNmax</a>];   <span class="comment">// Vector of random numbers</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a5bd2f38254d10799a96618f647a659d9">fRvec</a>==0)  <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Initialize&quot;</span>, <span class="stringliteral">&quot;Cannot initialize buffer fRvec \n&quot;</span>);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>&gt;0){</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <a class="code" href="classTFoam.html#a624774b519e7347376212fa1313c98fc">fAlpha</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>];    <span class="comment">// sum&lt;1 for internal parametrization of the simplex</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a624774b519e7347376212fa1313c98fc">fAlpha</a>==0)  <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Initialize&quot;</span>, <span class="stringliteral">&quot;Cannot initialize buffer fAlpha \n&quot;</span> );</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <a class="code" href="classTFoam.html#ac4c057ef5fe272b508f41c30a560b556">fMCvect</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>]; <span class="comment">// vector generated in the MC run</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ac4c057ef5fe272b508f41c30a560b556">fMCvect</a>==0)  <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Initialize&quot;</span>, <span class="stringliteral">&quot;Cannot initialize buffer fMCvect  \n&quot;</span> );</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="comment">//====== List of directions inhibited for division</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a4d633c10f039fc94931d0ad91c4568d2">fInhiDiv</a> == 0){</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <a class="code" href="classTFoam.html#a4d633c10f039fc94931d0ad91c4568d2">fInhiDiv</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>];</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>; i++) <a class="code" href="classTFoam.html#a4d633c10f039fc94931d0ad91c4568d2">fInhiDiv</a>[i]=0;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <span class="comment">//====== Dynamic mask used in Explore for edge determination</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ab0cbe0d35b1073cf35be21e5616f5f05">fMaskDiv</a> == 0){</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <a class="code" href="classTFoam.html#ab0cbe0d35b1073cf35be21e5616f5f05">fMaskDiv</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>];</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>; i++) <a class="code" href="classTFoam.html#ab0cbe0d35b1073cf35be21e5616f5f05">fMaskDiv</a>[i]=1;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <span class="comment">//====== List of predefined division values in all directions (initialized as empty)</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a> == 0){</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a> = <span class="keyword">new</span> <a class="code" href="classTFoamVect.html">TFoamVect</a>*[<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>];</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>; i++)  <a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a>[i]=0; <span class="comment">// Artificially extended beyond fDim</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <span class="comment">//====== Initialize list of histograms</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <a class="code" href="classTFoam.html#a1510630fd3caa168268f61ccc802e72e">fHistWt</a>  = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;HistWt&quot;</span>,<span class="stringliteral">&quot;Histogram of MC weight&quot;</span>,100,0.0, 1.5*<a class="code" href="classTFoam.html#a5b4152159bbd69bb2e4b06b17ef414f3">fMaxWtRej</a>); <span class="comment">// MC weight</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <a class="code" href="classTFoam.html#ade7af279b88fafa726e5f7be46b55b86">fHistEdg</a> = <span class="keyword">new</span> <a class="code" href="classTObjArray.html">TObjArray</a>(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>);           <span class="comment">// Initialize list of histograms</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <a class="code" href="classTString.html">TString</a> hname;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <a class="code" href="classTString.html">TString</a> htitle;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>;i++){</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      hname=<a class="code" href="classTFoam.html#a0ef363820f5b178be9ca03d812b2cd38">fName</a>+<a class="code" href="classTString.html">TString</a>(<span class="stringliteral">&quot;_HistEdge_&quot;</span>);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      hname+=i;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      htitle=<a class="code" href="classTString.html">TString</a>(<span class="stringliteral">&quot;Edge Histogram No. &quot;</span>);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      htitle+=i;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <span class="comment">//std::cout&lt;&lt;&quot;i= &quot;&lt;&lt;i&lt;&lt;&quot;  hname= &quot;&lt;&lt;hname&lt;&lt;&quot;  htitle= &quot;&lt;&lt;htitle&lt;&lt;std::endl;</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      (*fHistEdg)[i] = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(hname.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>(),htitle.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>(),<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>,0.0, 1.0); <span class="comment">// Initialize histogram for each edge</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      ((<a class="code" href="classTH1D.html">TH1D</a>*)(*<a class="code" href="classTFoam.html#ade7af279b88fafa726e5f7be46b55b86">fHistEdg</a>)[i])-&gt;Sumw2();</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   }</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   <span class="comment">//======  extra histograms for debug purposes</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <a class="code" href="classTFoam.html#a88cd859d30ef713e54cfe8076400896e">fHistDbg</a> = <span class="keyword">new</span> <a class="code" href="classTObjArray.html">TObjArray</a>(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>);         <span class="comment">// Initialize list of histograms</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>;i++){</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      hname=<a class="code" href="classTFoam.html#a0ef363820f5b178be9ca03d812b2cd38">fName</a>+<a class="code" href="classTString.html">TString</a>(<span class="stringliteral">&quot;_HistDebug_&quot;</span>);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      hname+=i;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      htitle=<a class="code" href="classTString.html">TString</a>(<span class="stringliteral">&quot;Debug Histogram &quot;</span>);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      htitle+=i;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      (*fHistDbg)[i] = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(hname.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>(),htitle.<a class="code" href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">Data</a>(),<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>,0.0, 1.0); <span class="comment">// Initialize histogram for each edge</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;   }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;   <span class="comment">// ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| //</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   <span class="comment">//                     BUILD-UP of the FOAM                            //</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   <span class="comment">// ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| //</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   <span class="comment">//        Define and explore root cell(s)</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   <a class="code" href="classTFoam.html#a21e66a7e649a640bab3e5f233b14a3cf">InitCells</a>();</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   <span class="comment">//        PrintCells(); std::cout&lt;&lt;&quot; ===== after InitCells =====&quot;&lt;&lt;std::endl;</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   <a class="code" href="classTFoam.html#af77b68c20f6239760ddc187f337cd624">Grow</a>();</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <span class="comment">//        PrintCells(); std::cout&lt;&lt;&quot; ===== after Grow      =====&quot;&lt;&lt;std::endl;</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <a class="code" href="classTFoam.html#a035d303af1eb6dc07a800158efe37158">MakeActiveList</a>(); <span class="comment">// Final Preparations for the M.C. generation</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   <span class="comment">// Preparations for the M.C. generation</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <a class="code" href="classTFoam.html#a2536c78efcadaa1d83007aaffa5c8a5e">fSumWt</a>  = 0.0;               <span class="comment">// M.C. generation sum of Wt</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   <a class="code" href="classTFoam.html#a248c1ffc0c849f84b4854072ad0f75d5">fSumWt2</a> = 0.0;               <span class="comment">// M.C. generation sum of Wt**2</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <a class="code" href="classTFoam.html#a8f741bf8e5dcb56ef4938fe97590948f">fSumOve</a> = 0.0;               <span class="comment">// M.C. generation sum of overweighted</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   <a class="code" href="classTFoam.html#a23552a188da40955fa06791e0b7fbe27">fNevGen</a> = 0.0;               <span class="comment">// M.C. generation sum of 1d0</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;   <a class="code" href="classTFoam.html#a9c10369f795e4ea1205b6e24dcd2a0f8">fWtMax</a>  = <a class="code" href="TFoam_8cxx.html#ab312b21ef43740f275186543f0bc5554">gVlow</a>;               <span class="comment">// M.C. generation maximum wt</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   <a class="code" href="classTFoam.html#a567ba53409fed0bd7744694a6b73eb1e">fWtMin</a>  = <a class="code" href="TFoam_8cxx.html#ad485bb39a59a51c631d174213f5a6dd8">gHigh</a>;               <span class="comment">// M.C. generation minimum wt</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   <a class="code" href="classTFoam.html#ae406c69465b2c15864c23ef4c8ac7708">fMCresult</a>=<a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[0]-&gt;<a class="code" href="classTFoamCell.html#aab2f2cd7db6945b48eda4c3845070652">GetIntg</a>(); <span class="comment">// M.C. Value of INTEGRAL,temporary assignment</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   <a class="code" href="classTFoam.html#ae406c69465b2c15864c23ef4c8ac7708">fMCresult</a>=<a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[0]-&gt;<a class="code" href="classTFoamCell.html#aab2f2cd7db6945b48eda4c3845070652">GetIntg</a>(); <span class="comment">// M.C. Value of INTEGRAL,temporary assignment</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   <a class="code" href="classTFoam.html#a1cfd0d2661f499734db8979881ffb7b5">fMCerror</a> =<a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[0]-&gt;<a class="code" href="classTFoamCell.html#aab2f2cd7db6945b48eda4c3845070652">GetIntg</a>(); <span class="comment">// M.C. Value of ERROR   ,temporary assignment</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   <a class="code" href="classTFoam.html#a4105266375bfe6f0807109680f6bc0d3">fMCMonit</a> = <span class="keyword">new</span> <a class="code" href="classTFoamMaxwt.html">TFoamMaxwt</a>(5.0,1000);  <span class="comment">// monitoring M.C. efficiency</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a20be20446e99fdfc26955c5b389f92c4">fChat</a>&gt;0){</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> driver = <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[0]-&gt;<a class="code" href="classTFoamCell.html#a412c4db128d748691c71a393e13ff069">GetDriv</a>();</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <a class="code" href="TFoam_8cxx.html#aeff7a5ba4f2535abfd56874d716676a1">BXOPE</a>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <a class="code" href="TFoam_8cxx.html#a675bf9bc58e8545c648be3aab07403fe">BXTXT</a>(<span class="stringliteral">&quot;***  TFoam::Initialize FINISHED!!!  ***&quot;</span>);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <a class="code" href="TFoam_8cxx.html#a30a4fd0f6d19430b51d6aa8656a1c78a">BX1I</a>(<span class="stringliteral">&quot;    nCalls&quot;</span>,<a class="code" href="classTFoam.html#a50b85f60c791f766e5a197f43f661d7c">fNCalls</a>,  <span class="stringliteral">&quot;Total number of function calls         &quot;</span>);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot;    XPrime&quot;</span>,<a class="code" href="classTFoam.html#a1e6a4bef13814c516e731df1ecd8e9ee">fPrime</a>,   <span class="stringliteral">&quot;Primary total integral                 &quot;</span>);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot;    XDiver&quot;</span>,driver,    <span class="stringliteral">&quot;Driver  total integral                 &quot;</span>);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot;  mcResult&quot;</span>,<a class="code" href="classTFoam.html#ae406c69465b2c15864c23ef4c8ac7708">fMCresult</a>,<span class="stringliteral">&quot;Estimate of the true MC Integral       &quot;</span>);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <a class="code" href="TFoam_8cxx.html#a6692b82cba0b23a6b59a8e498f9519a5">BXCLO</a>;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a20be20446e99fdfc26955c5b389f92c4">fChat</a>==2) <a class="code" href="classTFoam.html#a12ae6612ba756daada1f4101890718b2">PrintCells</a>();</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   <a class="code" href="classTH1.html#a490b9d2cf9460f8428f104d7e0f82614">TH1::AddDirectory</a>(addStatus);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;} <span class="comment">// Initialize</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">/// Internal subprogram used by Initialize.</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">/// It initializes &quot;root part&quot; of the FOAM of the tree of cells.</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="classTFoam.html#a21e66a7e649a640bab3e5f233b14a3cf">  481</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a21e66a7e649a640bab3e5f233b14a3cf">TFoam::InitCells</a>()</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;{</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   <a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a> =-1;                             <span class="comment">// Index of the last cell</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>!= 0) {</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="classTFoam.html#a5bb752728a7d25ffd78fcc9dbf180079">fNCells</a>; i++) <span class="keyword">delete</span> <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[i];</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keyword">delete</span> [] <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a> = <span class="keyword">new</span> <a class="code" href="classTFoamCell.html">TFoamCell</a>*[<a class="code" href="classTFoam.html#a5bb752728a7d25ffd78fcc9dbf180079">fNCells</a>];</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="classTFoam.html#a5bb752728a7d25ffd78fcc9dbf180079">fNCells</a>;i++){</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[i]= <span class="keyword">new</span> <a class="code" href="classTFoamCell.html">TFoamCell</a>(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>); <span class="comment">// Allocate BIG list of cells</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[i]-&gt;<a class="code" href="classTFoamCell.html#aaad69abc8acef72931afde11f3bca1a1">SetSerial</a>(i);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   }</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>==0) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;InitCells&quot;</span>, <span class="stringliteral">&quot;Cannot initialize CELLS \n&quot;</span>  );</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">   /////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment"></span>   <span class="comment">//              Single Root Hypercube                                      //</span><span class="comment"></span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">   /////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment"></span>   <a class="code" href="classTFoam.html#acfa16bd47ac7c6698f5fab8455bdf56c">CellFill</a>(1,   0);  <span class="comment">//  0-th cell ACTIVE</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   <span class="comment">// Exploration of the root cell(s)</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   <span class="keywordflow">for</span>(<a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> iCell=0; iCell&lt;=<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>; iCell++){</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <a class="code" href="classTFoam.html#a6430c3a52917e5c9b1f3490754deec85">Explore</a>( <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[iCell] );               <span class="comment">// Exploration of root cell(s)</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;}<span class="comment">//InitCells</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">/// Internal subprogram used by Initialize.</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">/// It initializes content of the newly allocated active cell.</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="classTFoam.html#acfa16bd47ac7c6698f5fab8455bdf56c">  513</a></span>&#160;<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="classTFoam.html#acfa16bd47ac7c6698f5fab8455bdf56c">TFoam::CellFill</a>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> Status, <a class="code" href="classTFoamCell.html">TFoamCell</a> *parent)</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;{</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   <a class="code" href="classTFoamCell.html">TFoamCell</a> *cell;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>==<a class="code" href="classTFoam.html#a5bb752728a7d25ffd78fcc9dbf180079">fNCells</a>){</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>( <span class="stringliteral">&quot;CellFill&quot;</span>, <span class="stringliteral">&quot;Too many cells\n&quot;</span>);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   <a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>++;   <span class="comment">// 0-th cell is the first</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;   <span class="keywordflow">if</span> (Status==1) <a class="code" href="classTFoam.html#abb371f4679f22bddb17b369d9ee7f511">fNoAct</a>++;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   cell = <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>];</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   cell-&gt;<a class="code" href="classTFoamCell.html#ab9a18c26dfb26260bc7e4da8e7708577">Fill</a>(Status, parent, 0, 0);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   cell-&gt;<a class="code" href="classTFoamCell.html#af5c4149a5aee111e0fd256df1170c536">SetBest</a>( -1);         <span class="comment">// pointer for planning division of the cell</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   cell-&gt;<a class="code" href="classTFoamCell.html#a086f12742a18410ac86b441ae8f7d7ac">SetXdiv</a>(0.5);         <span class="comment">// factor for division</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> xInt2,xDri2;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   <span class="keywordflow">if</span>(parent!=0){</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      xInt2  = 0.5*parent-&gt;<a class="code" href="classTFoamCell.html#aab2f2cd7db6945b48eda4c3845070652">GetIntg</a>();</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      xDri2  = 0.5*parent-&gt;<a class="code" href="classTFoamCell.html#a412c4db128d748691c71a393e13ff069">GetDriv</a>();</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      cell-&gt;<a class="code" href="classTFoamCell.html#ae818da74fa2085d36228dc41d63020a3">SetIntg</a>(xInt2);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      cell-&gt;<a class="code" href="classTFoamCell.html#acd0c5e7ff58e97dcfbf5a9251e42b304">SetDriv</a>(xDri2);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      cell-&gt;<a class="code" href="classTFoamCell.html#ae818da74fa2085d36228dc41d63020a3">SetIntg</a>(0.0);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      cell-&gt;<a class="code" href="classTFoamCell.html#acd0c5e7ff58e97dcfbf5a9251e42b304">SetDriv</a>(0.0);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;}</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">/// Internal subprogram used by Initialize.</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">/// It explores newly defined cell with help of special short MC sampling.</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">/// As a result, estimates of true and drive volume is defined/determined</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">/// Average and dispersion of the weight distribution will is found along</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">/// each edge and the best edge (minimum dispersion, best maximum weight)</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">/// is memorized for future use.</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">/// The optimal division point for eventual future cell division is</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">/// determined/recorded. Recorded are also minimum and maximum weight etc.</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">/// The volume estimate in all (inactive) parent cells is updated.</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">/// Note that links to parents and initial volume = 1/2 parent has to be</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">/// already defined prior to calling this routine.</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="classTFoam.html#a6430c3a52917e5c9b1f3490754deec85">  554</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a6430c3a52917e5c9b1f3490754deec85">TFoam::Explore</a>(<a class="code" href="classTFoamCell.html">TFoamCell</a> *cell)</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;{</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> wt, dx, xBest=0, yBest=0;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> intOld, driOld;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> iev;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> nevMC;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i, j, k;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nProj, kBest;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> ceSum[5], xproj;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   <a class="code" href="classTFoamVect.html">TFoamVect</a>  cellSize(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   <a class="code" href="classTFoamVect.html">TFoamVect</a>  cellPosi(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   cell-&gt;<a class="code" href="classTFoamCell.html#a7f6aa66669b4c5fb095cc32795a50a9f">GetHcub</a>(cellPosi,cellSize);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   <a class="code" href="classTFoamCell.html">TFoamCell</a>  *parent;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *xRand = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>];</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *volPart=0;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   cell-&gt;<a class="code" href="classTFoamCell.html#a0ff5fd567b99cbdcc20954c85f4c65cf">CalcVolume</a>();</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   dx = cell-&gt;<a class="code" href="classTFoamCell.html#a1f7b823f4c86882d8e6a749bcea97282">GetVolume</a>();</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   intOld = cell-&gt;<a class="code" href="classTFoamCell.html#aab2f2cd7db6945b48eda4c3845070652">GetIntg</a>(); <span class="comment">//memorize old values,</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   driOld = cell-&gt;<a class="code" href="classTFoamCell.html#a412c4db128d748691c71a393e13ff069">GetDriv</a>(); <span class="comment">//will be needed for correcting parent cells</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">   /////////////////////////////////////////////////////</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment"></span>   <span class="comment">//    Special Short MC sampling to probe cell      //</span><span class="comment"></span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">   /////////////////////////////////////////////////////</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment"></span>   ceSum[0]=0;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   ceSum[1]=0;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   ceSum[2]=0;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   ceSum[3]=<a class="code" href="TFoam_8cxx.html#ad485bb39a59a51c631d174213f5a6dd8">gHigh</a>;  <span class="comment">//wtmin</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   ceSum[4]=<a class="code" href="TFoam_8cxx.html#ab312b21ef43740f275186543f0bc5554">gVlow</a>;  <span class="comment">//wtmax</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>;i++) ((<a class="code" href="classTH1D.html">TH1D</a> *)(*<a class="code" href="classTFoam.html#ade7af279b88fafa726e5f7be46b55b86">fHistEdg</a>)[i])-&gt;Reset(); <span class="comment">// Reset histograms</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <a class="code" href="classTFoam.html#a1510630fd3caa168268f61ccc802e72e">fHistWt</a>-&gt;<a class="code" href="classTH1D.html#a0e2aa2350d4c0cd7bbcaccb29bff8760">Reset</a>();</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   <span class="comment">// ||||||||||||||||||||||||||BEGIN MC LOOP|||||||||||||||||||||||||||||</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> nevEff=0.;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   <span class="keywordflow">for</span>(iev=0;iev&lt;<a class="code" href="classTFoam.html#ad301b78fd272d626da77c16361d399a3">fNSampl</a>;iev++){</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <a class="code" href="classTFoam.html#a6a31e33dc6a72c83bddea5d6c24d2991">MakeAlpha</a>();               <span class="comment">// generate uniformly vector inside hypercube</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>&gt;0){</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keywordflow">for</span>(j=0; j&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>; j++)</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;         xRand[j]= cellPosi[j] +<a class="code" href="classTFoam.html#a624774b519e7347376212fa1313c98fc">fAlpha</a>[j]*(cellSize[j]);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      }</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      wt=dx*<a class="code" href="classTFoam.html#a676fd2679208cfcc67acbb899e823a26">Eval</a>(xRand);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      nProj = 0;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>&gt;0) {</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;         <span class="keywordflow">for</span>(k=0; k&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>; k++) {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            xproj =<a class="code" href="classTFoam.html#a624774b519e7347376212fa1313c98fc">fAlpha</a>[k];</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            ((<a class="code" href="classTH1D.html">TH1D</a> *)(*<a class="code" href="classTFoam.html#ade7af279b88fafa726e5f7be46b55b86">fHistEdg</a>)[nProj])-&gt;Fill(xproj,wt);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            nProj++;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;         }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <a class="code" href="classTFoam.html#a50b85f60c791f766e5a197f43f661d7c">fNCalls</a>++;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      ceSum[0] += wt;    <span class="comment">// sum of weights</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      ceSum[1] += wt*wt; <span class="comment">// sum of weights squared</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      ceSum[2]++;        <span class="comment">// sum of 1</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <span class="keywordflow">if</span> (ceSum[3]&gt;wt) ceSum[3]=wt;  <span class="comment">// minimum weight;</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keywordflow">if</span> (ceSum[4]&lt;wt) ceSum[4]=wt;  <span class="comment">// maximum weight</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="comment">// test MC loop exit condition</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      nevEff = ceSum[0]*ceSum[0]/ceSum[1];</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <span class="keywordflow">if</span>( nevEff &gt;= <a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>*<a class="code" href="classTFoam.html#a591ba605708cabe87ef3277cc3a67bfa">fEvPerBin</a>) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   }   <span class="comment">// ||||||||||||||||||||||||||END MC LOOP|||||||||||||||||||||||||||||</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   <span class="comment">//------------------------------------------------------------------</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   <span class="comment">//---  predefine logics of searching for the best division edge ---</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   <span class="keywordflow">for</span>(k=0; k&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>;k++){</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <a class="code" href="classTFoam.html#ab0cbe0d35b1073cf35be21e5616f5f05">fMaskDiv</a>[k] =1;                       <span class="comment">// default is all</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="classTFoam.html#a4d633c10f039fc94931d0ad91c4568d2">fInhiDiv</a>[k]==1) <a class="code" href="classTFoam.html#ab0cbe0d35b1073cf35be21e5616f5f05">fMaskDiv</a>[k] =0; <span class="comment">// inhibit some...</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   }</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   <span class="comment">// Note that predefined division below overrule inhibition above</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;   kBest=-1;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> rmin,rmax,rdiv;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a84d3266952abae597c4142ce36582cf3">fOptPRD</a>) {          <span class="comment">// quick check</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="keywordflow">for</span>(k=0; k&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>; k++) {</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;         rmin= cellPosi[k];</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;         rmax= cellPosi[k] +cellSize[k];</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;         <span class="keywordflow">if</span>( <a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a>[k] != 0) {</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>= (<a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a>[k])-&gt;GetDim();</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="keywordflow">for</span>(j=0; j&lt;<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; j++) {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;               rdiv=(*<a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a>[k])[j];</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;               <span class="comment">// check predefined divisions is available in this cell</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;               <span class="keywordflow">if</span>( (rmin +1<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-99 &lt;rdiv) &amp;&amp; (rdiv&lt; rmax -1<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>-99)) {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                  kBest=k;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                  xBest= (rdiv-cellPosi[k])/cellSize[k] ;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                  <span class="keywordflow">goto</span> ee05;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;               }</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;         }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      }<span class="comment">//k</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;   }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;   ee05:<span class="comment"></span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">   /////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   <a class="code" href="classTFoam.html#abe93c1b1556a8c9d17de4081fdfb1641">fNEffev</a> += (<a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a>)nevEff;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;   nevMC          = ceSum[2];</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> intTrue = ceSum[0]/(nevMC+0.000001);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> intDriv=0.;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> intPrim=0.;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   <span class="keywordflow">switch</span>(<a class="code" href="classTFoam.html#a62ab1b7b59427c82239acd39706e6f13">fOptDrive</a>){</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   <span class="keywordflow">case</span> 1:                       <span class="comment">// VARIANCE REDUCTION</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="keywordflow">if</span>(kBest == -1) <a class="code" href="classTFoam.html#a2958c5262392625ac8905307434fdce8">Varedu</a>(ceSum,kBest,xBest,yBest); <span class="comment">// determine the best edge,</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="comment">//intDriv =sqrt( ceSum[1]/nevMC -intTrue*intTrue ); // Older ansatz, numerically not bad</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      intDriv =<a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a>(ceSum[1]/nevMC) -intTrue; <span class="comment">// Foam build-up, sqrt(&lt;w**2&gt;) -&lt;w&gt;</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      intPrim =<a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a>(ceSum[1]/nevMC);          <span class="comment">// MC gen. sqrt(&lt;w**2&gt;) =sqrt(&lt;w&gt;**2 +sigma**2)</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   <span class="keywordflow">case</span> 2:                       <span class="comment">// WTMAX  REDUCTION</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keywordflow">if</span>(kBest == -1) <a class="code" href="classTFoam.html#afe76adaadb6efdb176587ea95299e1c9">Carver</a>(kBest,xBest,yBest);  <span class="comment">// determine the best edge</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      intDriv =ceSum[4] -intTrue; <span class="comment">// Foam build-up, wtmax-&lt;w&gt;</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      intPrim =ceSum[4];          <span class="comment">// MC generation, wtmax!</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Explore&quot;</span>, <span class="stringliteral">&quot;Wrong fOptDrive = \n&quot;</span> );</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   }<span class="comment">//switch</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   <span class="comment">//=================================================================================</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   <span class="comment">//hist_Neff_distrib.Fill( fLastCe/2.0+0.01, nevEff+0.01);  //</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   <span class="comment">//hist_kBest_distrib.Fill( kBest+0.50, 1.0 ); //  debug</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   <span class="comment">//hist_xBest_distrib.Fill( xBest+0.01, 1.0 ); //  debug</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   <span class="comment">//=================================================================================</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   cell-&gt;<a class="code" href="classTFoamCell.html#af5c4149a5aee111e0fd256df1170c536">SetBest</a>(kBest);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   cell-&gt;<a class="code" href="classTFoamCell.html#a086f12742a18410ac86b441ae8f7d7ac">SetXdiv</a>(xBest);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   cell-&gt;<a class="code" href="classTFoamCell.html#ae818da74fa2085d36228dc41d63020a3">SetIntg</a>(intTrue);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;   cell-&gt;<a class="code" href="classTFoamCell.html#acd0c5e7ff58e97dcfbf5a9251e42b304">SetDriv</a>(intDriv);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;   cell-&gt;<a class="code" href="classTFoamCell.html#acba04754de3ce6748d83343464b29dc8">SetPrim</a>(intPrim);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;   <span class="comment">// correct/update integrals in all parent cells to the top of the tree</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>  parIntg, parDriv;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   <span class="keywordflow">for</span>(parent = cell-&gt;<a class="code" href="classTFoamCell.html#a0a6f182e476437091122b5e62e4d5dc9">GetPare</a>(); parent!=0; parent = parent-&gt;<a class="code" href="classTFoamCell.html#a0a6f182e476437091122b5e62e4d5dc9">GetPare</a>()){</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      parIntg = parent-&gt;<a class="code" href="classTFoamCell.html#aab2f2cd7db6945b48eda4c3845070652">GetIntg</a>();</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      parDriv = parent-&gt;<a class="code" href="classTFoamCell.html#a412c4db128d748691c71a393e13ff069">GetDriv</a>();</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      parent-&gt;<a class="code" href="classTFoamCell.html#ae818da74fa2085d36228dc41d63020a3">SetIntg</a>( parIntg   +intTrue -intOld );</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      parent-&gt;<a class="code" href="classTFoamCell.html#acd0c5e7ff58e97dcfbf5a9251e42b304">SetDriv</a>( parDriv   +intDriv -driOld );</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;   }</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;   <span class="keyword">delete</span> [] volPart;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   <span class="keyword">delete</span> [] xRand;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;   <span class="comment">//cell-&gt;Print();</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;} <span class="comment">// TFoam::Explore</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">/// Internal subrogram used by Initialize.</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">/// In determines the best edge candidate and the position of the cell division plane</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">/// in case of the variance reduction for future cell division,</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">/// using results of the MC exploration run stored in fHistEdg</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00705"></a><span class="lineno"><a class="line" href="classTFoam.html#a2958c5262392625ac8905307434fdce8">  705</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a2958c5262392625ac8905307434fdce8">TFoam::Varedu</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> ceSum[5], <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> &amp;kBest, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> &amp;xBest, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> &amp;yBest)</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;{</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> nent   = ceSum[2];</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> swAll  = ceSum[0];</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> sswAll = ceSum[1];</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> ssw    = <a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a>(sswAll)/<a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a>(nent);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> swIn,swOut,sswIn,sswOut,xLo,xUp;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   kBest =-1;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;   xBest =0.5;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;   yBest =1.0;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> maxGain=0.0;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   <span class="comment">// Now go over all projections kProj</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;   <span class="keywordflow">for</span>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> kProj=0; kProj&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>; kProj++) {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="classTFoam.html#ab0cbe0d35b1073cf35be21e5616f5f05">fMaskDiv</a>[kProj]) {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;         <span class="comment">// initialize search over bins</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> sigmIn =0.0; <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> sigmOut =0.0;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> sswtBest = <a class="code" href="TFoam_8cxx.html#ad485bb39a59a51c631d174213f5a6dd8">gHigh</a>;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> gain =0.0;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> xMin=0.0; <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> xMax=0.0;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;         <span class="comment">// Double loop over all pairs jLo&lt;jUp</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;         <span class="keywordflow">for</span>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> jLo=1; jLo&lt;=<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>; jLo++) {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> aswIn=0;  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> asswIn=0;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> jUp=jLo; jUp&lt;=<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>;jUp++) {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;               aswIn  +=     ((<a class="code" href="classTH1D.html">TH1D</a> *)(*<a class="code" href="classTFoam.html#ade7af279b88fafa726e5f7be46b55b86">fHistEdg</a>)[kProj])-&gt;GetBinContent(jUp);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;               asswIn += <a class="code" href="classTFoam.html#a81e01755823887ddcbbf723fc14beb24">Sqr</a>(((<a class="code" href="classTH1D.html">TH1D</a> *)(*<a class="code" href="classTFoam.html#ade7af279b88fafa726e5f7be46b55b86">fHistEdg</a>)[kProj])-&gt;GetBinError(  jUp));</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;               xLo=(jLo-1.0)/<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;               xUp=(jUp*1.0)/<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;               swIn  =        aswIn/nent;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;               swOut = (swAll-aswIn)/nent;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;               sswIn = <a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a>(asswIn)       /<a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a>(nent*(xUp-xLo))     *(xUp-xLo);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;               sswOut= <a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a>(sswAll-asswIn)/<a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a>(nent*(1.0-xUp+xLo)) *(1.0-xUp+xLo);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;               <span class="keywordflow">if</span>( (sswIn+sswOut) &lt; sswtBest) {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                  sswtBest = sswIn+sswOut;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                  gain     = ssw-sswtBest;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                  sigmIn   = sswIn -swIn;  <span class="comment">// Debug</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                  sigmOut  = sswOut-swOut; <span class="comment">// Debug</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                  xMin    = xLo;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                  xMax    = xUp;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;               }</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            }<span class="comment">//jUp</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;         }<span class="comment">//jLo</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;         <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> iLo = (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) (<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>*xMin);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;         <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> iUp = (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) (<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>*xMax);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;         <span class="comment">//----------DEBUG printout</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;         <span class="comment">//std::cout&lt;&lt;&quot;@@@@@  xMin xMax = &quot;&lt;&lt;xMin   &lt;&lt;&quot; &quot;&lt;&lt;xMax&lt;&lt;&quot;  iLo= &quot;&lt;&lt;iLo&lt;&lt;&quot;  iUp= &quot;&lt;&lt;iUp;</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;         <span class="comment">//std::cout&lt;&lt;&quot;  sswtBest/ssw= &quot;&lt;&lt;sswtBest/ssw&lt;&lt;&quot;  Gain/ssw= &quot;&lt;&lt; Gain/ssw&lt;&lt;std::endl;</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;         <span class="comment">//----------DEBUG auxiliary Plot</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;         <span class="keywordflow">for</span>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> iBin=1;iBin&lt;=<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>;iBin++) {</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            <span class="keywordflow">if</span>( ((iBin-0.5)/<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a> &gt; xMin) &amp;&amp; ((iBin-0.5)/<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a> &lt; xMax) ){</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;               ((<a class="code" href="classTH1D.html">TH1D</a> *)(*<a class="code" href="classTFoam.html#a88cd859d30ef713e54cfe8076400896e">fHistDbg</a>)[kProj])-&gt;SetBinContent(iBin,sigmIn/(xMax-xMin));</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;               ((<a class="code" href="classTH1D.html">TH1D</a> *)(*<a class="code" href="classTFoam.html#a88cd859d30ef713e54cfe8076400896e">fHistDbg</a>)[kProj])-&gt;SetBinContent(iBin,sigmOut/(1-xMax+xMin));</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            }</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;         }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;         <span class="keywordflow">if</span>(gain&gt;=maxGain) {</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            maxGain=gain;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            kBest=kProj; <span class="comment">// &lt;--- !!!!! The best edge</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            xBest=xMin;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            yBest=xMax;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <span class="keywordflow">if</span>(iLo == 0)     xBest=yBest; <span class="comment">// The best division point</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <span class="keywordflow">if</span>(iUp == <a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>) yBest=xBest; <span class="comment">// this is not really used</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;         }</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      }</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   } <span class="comment">//kProj</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   <span class="comment">//----------DEBUG printout</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;   <span class="comment">//std::cout&lt;&lt;&quot;@@@@@@@&gt;&gt;&gt;&gt;&gt; kBest= &quot;&lt;&lt;kBest&lt;&lt;&quot;  maxGain/ssw= &quot;&lt;&lt; maxGain/ssw&lt;&lt;std::endl;</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;   <span class="keywordflow">if</span>( (kBest &gt;= <a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>) || (kBest&lt;0) ) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Varedu&quot;</span>, <span class="stringliteral">&quot;Something wrong with kBest - kBest = %d dim = %d\n&quot;</span>,kBest,<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;}          <span class="comment">//TFoam::Varedu</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">/// Internal subrogram used by Initialize.</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">/// Determines the best edge-candidate and the position of the division plane</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">/// for the future cell division, in the case of the optimization of the maximum weight.</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">/// It exploits results of the cell MC exploration run stored in fHistEdg.</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00781"></a><span class="lineno"><a class="line" href="classTFoam.html#afe76adaadb6efdb176587ea95299e1c9">  781</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#afe76adaadb6efdb176587ea95299e1c9">TFoam::Carver</a>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> &amp;kBest, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> &amp;xBest, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> &amp;yBest)</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;{</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>    kProj,iBin;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> carve,carvTot,carvMax,carvOne,binMax,binTot;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>    jLow,jUp,iLow,iUp;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> theBin;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;   <span class="comment">// Int_t    jDivi; // TEST</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> j;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *bins  = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>];      <span class="comment">// bins of histogram for single  PROJECTION</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;   <span class="keywordflow">if</span>(bins==0)    <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Carver&quot;</span>, <span class="stringliteral">&quot;Cannot initialize buffer Bins \n&quot;</span> );</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;   kBest =-1;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;   xBest =0.5;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;   yBest =1.0;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;   carvMax = <a class="code" href="TFoam_8cxx.html#ab312b21ef43740f275186543f0bc5554">gVlow</a>;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   <span class="comment">// primMax = gVlow;</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;   <span class="keywordflow">for</span>(kProj=0; kProj&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>; kProj++)</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="classTFoam.html#ab0cbe0d35b1073cf35be21e5616f5f05">fMaskDiv</a>[kProj] ) {</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;         <span class="comment">//if( kProj==1 ){</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;         <span class="comment">//std::cout&lt;&lt;&quot;==================== Carver histogram: kProj =&quot;&lt;&lt;kProj&lt;&lt;&quot;===================&quot;&lt;&lt;std::endl;</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;         <span class="comment">//((TH1D *)(*fHistEdg)[kProj])-&gt;Print(&quot;all&quot;);</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;         binMax = <a class="code" href="TFoam_8cxx.html#ab312b21ef43740f275186543f0bc5554">gVlow</a>;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;         <span class="keywordflow">for</span>(iBin=0; iBin&lt;<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>;iBin++){</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            bins[iBin]= ((<a class="code" href="classTH1D.html">TH1D</a> *)(*<a class="code" href="classTFoam.html#ade7af279b88fafa726e5f7be46b55b86">fHistEdg</a>)[kProj])-&gt;GetBinContent(iBin+1);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            binMax = <a class="code" href="namespaceTMath.html#a38e1c23e08564d17051526d7e0a5364d">TMath::Max</a>( binMax, bins[iBin]);       <span class="comment">// Maximum content/bin</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;         }</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;         <span class="keywordflow">if</span>(binMax &lt; 0 ) {       <span class="comment">//case of empty cell</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="keyword">delete</span> [] bins;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;         }</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;         carvTot = 0.0;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;         binTot  = 0.0;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;         <span class="keywordflow">for</span>(iBin=0;iBin&lt;<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>;iBin++){</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            carvTot = carvTot + (binMax-bins[iBin]);     <span class="comment">// Total Carve (more stable)</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            binTot  +=bins[iBin];</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;         }</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;         <span class="comment">// primTot = binMax*fNBin;</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;         <span class="comment">//std::cout &lt;&lt;&quot;Carver:  CarvTot &quot;&lt;&lt;CarvTot&lt;&lt; &quot;    primTot &quot;&lt;&lt;primTot&lt;&lt;std::endl;</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;         jLow =0;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;         jUp  =<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>-1;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;         carvOne = <a class="code" href="TFoam_8cxx.html#ab312b21ef43740f275186543f0bc5554">gVlow</a>;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> yLevel = <a class="code" href="TFoam_8cxx.html#ab312b21ef43740f275186543f0bc5554">gVlow</a>;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;         <span class="keywordflow">for</span>(iBin=0; iBin&lt;<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>;iBin++) {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            theBin = bins[iBin];</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="comment">//-----  walk to the left and find first bin &gt; theBin</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            iLow = iBin;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <span class="keywordflow">for</span>(j=iBin; j&gt;-1; j-- ) {</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;               <span class="keywordflow">if</span>(theBin&lt; bins[j]) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;               iLow = j;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            }</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="comment">//iLow = iBin;</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="comment">//if(iLow&gt;0)     while( (theBin &gt;= bins[iLow-1])&amp;&amp;(iLow &gt;0) ){iLow--;} // horror!!!</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="comment">//------ walk to the right and find first bin &gt; theBin</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            iUp  = iBin;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            <span class="keywordflow">for</span>(j=iBin; j&lt;<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>; j++) {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;               <span class="keywordflow">if</span>(theBin&lt; bins[j]) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;               iUp = j;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            }</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <span class="comment">//iUp  = iBin;</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="comment">//if(iUp&lt;fNBin-1) while( (theBin &gt;= bins[iUp+1])&amp;&amp;( iUp&lt;fNBin-1 ) ){iUp++;} // horror!!!</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            carve = (iUp-iLow+1)*(binMax-theBin);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="keywordflow">if</span>( carve &gt; carvOne) {</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;               carvOne = carve;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;               jLow = iLow;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;               jUp  = iUp;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;               yLevel = theBin;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            }</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;         }<span class="comment">//iBin</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;         <span class="keywordflow">if</span>( carvTot &gt; carvMax) {</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            carvMax   = carvTot;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="comment">//primMax   = primTot;</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <span class="comment">//std::cout &lt;&lt;&quot;Carver:   primMax &quot;&lt;&lt;primMax&lt;&lt;std::endl;</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            kBest = kProj;    <span class="comment">// Best edge</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            xBest = ((<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>)(jLow))/<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            yBest = ((<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>)(jUp+1))/<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <span class="keywordflow">if</span>(jLow == 0 )       xBest = yBest;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            <span class="keywordflow">if</span>(jUp  == <a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>-1) yBest = xBest;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <span class="comment">// division ratio in units of 1/fNBin, testing</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="comment">// jDivi = jLow;</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="comment">// if(jLow == 0 )     jDivi=jUp+1;</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;         }</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;         <span class="comment">//======  extra histograms for debug purposes</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;         <span class="comment">//std::cout&lt;&lt;&quot;kProj= &quot;&lt;&lt;kProj&lt;&lt;&quot; jLow= &quot;&lt;&lt;jLow&lt;&lt;&quot; jUp= &quot;&lt;&lt;jUp&lt;&lt;std::endl;</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;         <span class="keywordflow">for</span>(iBin=0;    iBin&lt;<a class="code" href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">fNBin</a>;  iBin++)</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            ((<a class="code" href="classTH1D.html">TH1D</a> *)(*fHistDbg)[kProj])-&gt;SetBinContent(iBin+1,binMax);</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;         <span class="keywordflow">for</span>(iBin=jLow; iBin&lt;jUp+1;   iBin++)</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            ((<a class="code" href="classTH1D.html">TH1D</a> *)(*fHistDbg)[kProj])-&gt;SetBinContent(iBin+1,yLevel);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      }<span class="comment">//kProj</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;   <span class="keywordflow">if</span>( (kBest &gt;= <a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>) || (kBest&lt;0) ) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Carver&quot;</span>, <span class="stringliteral">&quot;Something wrong with kBest - kBest = %d dim = %d\n&quot;</span>,kBest,<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;   <span class="keyword">delete</span> [] bins;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;}          <span class="comment">//TFoam::Carver</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">/// Internal subrogram used by Initialize.</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">/// Provides random vector Alpha  0&lt; Alpha(i) &lt; 1</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00879"></a><span class="lineno"><a class="line" href="classTFoam.html#a6a31e33dc6a72c83bddea5d6c24d2991">  879</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a6a31e33dc6a72c83bddea5d6c24d2991">TFoam::MakeAlpha</a>()</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;{</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> k;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>&lt;1) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;   <span class="comment">// simply generate and load kDim uniform random numbers</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;   <a class="code" href="classTFoam.html#a1aae352244412f1e1bd6711be17f5e57">fPseRan</a>-&gt;<a class="code" href="classTRandom.html#a13cf202d07daadbc8aa08c45e3f0999b">RndmArray</a>(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>,<a class="code" href="classTFoam.html#a5bd2f38254d10799a96618f647a659d9">fRvec</a>);   <span class="comment">// kDim random numbers needed</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;   <span class="keywordflow">for</span>(k=0; k&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>; k++) <a class="code" href="classTFoam.html#a624774b519e7347376212fa1313c98fc">fAlpha</a>[k] = <a class="code" href="classTFoam.html#a5bd2f38254d10799a96618f647a659d9">fRvec</a>[k];</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;} <span class="comment">//MakeAlpha</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">/// Internal subrogram used by Initialize.</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">/// It grow new cells by the binary division process.</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00894"></a><span class="lineno"><a class="line" href="classTFoam.html#af77b68c20f6239760ddc187f337cd624">  894</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#af77b68c20f6239760ddc187f337cd624">TFoam::Grow</a>()</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;{</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;   <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> iCell;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;   <a class="code" href="classTFoamCell.html">TFoamCell</a>* newCell;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;   <span class="keywordflow">while</span> ( (<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>+2) &lt; <a class="code" href="classTFoam.html#a5bb752728a7d25ffd78fcc9dbf180079">fNCells</a> ) {  <span class="comment">// this condition also checked inside Divide</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      iCell   = <a class="code" href="classTFoam.html#a2f8bc90b862bcf37a4fdad6a68e578f7">PeekMax</a>();            <span class="comment">// peek up cell with maximum driver integral</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <span class="keywordflow">if</span>( (iCell&lt;0) || (iCell&gt;<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>) ) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Grow&quot;</span>, <span class="stringliteral">&quot;Wrong iCell \n&quot;</span>);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      newCell = <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[iCell];</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a> !=0) {</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;         <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> kEcho=10;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;         <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>&gt;=10000) kEcho=100;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;         <span class="keywordflow">if</span>( (<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>%kEcho)==0) {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#a20be20446e99fdfc26955c5b389f92c4">fChat</a>&gt;0) {</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;               <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>&lt;10)</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                  std::cout&lt;&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>&lt;&lt;std::flush;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                  std::cout&lt;&lt;<span class="stringliteral">&quot;.&quot;</span>&lt;&lt;std::flush;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;               <span class="keywordflow">if</span>( (<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>%(100*kEcho))==0)  std::cout&lt;&lt;<span class="stringliteral">&quot;|&quot;</span>&lt;&lt;<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>&lt;&lt;std::endl&lt;&lt;std::flush;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            }</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;         }</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      }</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="classTFoam.html#a113f84bc2a1a657ae1f094183d1d1b76">Divide</a>( newCell )==0) <span class="keywordflow">break</span>;  <span class="comment">// and divide it into two</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;   }</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#a20be20446e99fdfc26955c5b389f92c4">fChat</a>&gt;0) {</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      std::cout&lt;&lt;std::endl&lt;&lt;std::flush;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;   }</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;   <a class="code" href="classTFoam.html#a09f87e40b4ac8bde2c7a91c2641a8231">CheckAll</a>(0);   <span class="comment">// set arg=1 for more info</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;}<span class="comment">// Grow</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">/// Internal subprogram used by Initialize.</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">/// It finds cell with maximal driver integral for the purpose of the division.</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00929"></a><span class="lineno"><a class="line" href="classTFoam.html#a2f8bc90b862bcf37a4fdad6a68e578f7">  929</a></span>&#160;<a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a>  <a class="code" href="classTFoam.html#a2f8bc90b862bcf37a4fdad6a68e578f7">TFoam::PeekMax</a>()</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;{</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;   <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a>  i;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> iCell = -1;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>  drivMax, driv;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;   drivMax = <a class="code" href="TFoam_8cxx.html#ab312b21ef43740f275186543f0bc5554">gVlow</a>;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;   <span class="keywordflow">for</span>(i=0; i&lt;=<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>; i++) {<span class="comment">//without root</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[i]-&gt;GetStat() == 1 ) {</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;         driv =  <a class="code" href="namespaceTMath.html#af682354cea223351f1306bf98a858dfd">TMath::Abs</a>( <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[i]-&gt;GetDriv());</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;         <span class="comment">//std::cout&lt;&lt;&quot;PeekMax: Driv = &quot;&lt;&lt;driv&lt;&lt;std::endl;</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;         <span class="keywordflow">if</span>(driv &gt; drivMax) {</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            drivMax = driv;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            iCell = i;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;         }</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      }</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;   }</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;   <span class="comment">//  std::cout &lt;&lt; &#39;TFoam_PeekMax: iCell=&#39; &lt;&lt; iCell &lt;&lt; std::endl;</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;   <span class="keywordflow">if</span> (iCell == -1)</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;STOP in TFoam::PeekMax: not found iCell=&quot;</span> &lt;&lt;  iCell &lt;&lt; std::endl;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;   <span class="keywordflow">return</span>(iCell);</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;}                 <span class="comment">// TFoam_PeekMax</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">/// Internal subrogram used by Initialize.</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">/// It divides cell iCell into two daughter cells.</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">/// The iCell is retained and tagged as inactive, daughter cells are appended</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">/// at the end of the buffer.</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">/// New vertex is added to list of vertices.</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">/// List of active cells is updated, iCell removed, two daughters added</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">/// and their properties set with help of MC sampling (TFoam_Explore)</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">/// Returns Code RC=-1 of buffer limit is reached,  fLastCe=fnBuf.</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00962"></a><span class="lineno"><a class="line" href="classTFoam.html#a113f84bc2a1a657ae1f094183d1d1b76">  962</a></span>&#160;<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="classTFoam.html#a113f84bc2a1a657ae1f094183d1d1b76">TFoam::Divide</a>(<a class="code" href="classTFoamCell.html">TFoamCell</a> *cell)</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;{</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>   kBest;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>+1 &gt;= <a class="code" href="classTFoam.html#a5bb752728a7d25ffd78fcc9dbf180079">fNCells</a>) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Divide&quot;</span>, <span class="stringliteral">&quot;Buffer limit is reached, fLastCe=fnBuf \n&quot;</span>);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;   cell-&gt;<a class="code" href="classTFoamCell.html#a50e2e4ba6158af319467fdb3a011efc7">SetStat</a>(0); <span class="comment">// reset cell as inactive</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;   <a class="code" href="classTFoam.html#abb371f4679f22bddb17b369d9ee7f511">fNoAct</a>--;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;   kBest = cell-&gt;<a class="code" href="classTFoamCell.html#a7b7fd789b6a0abe41ffc07978e1a139d">GetBest</a>();</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   <span class="keywordflow">if</span>( kBest&lt;0 || kBest&gt;=<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a> ) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;Divide&quot;</span>, <span class="stringliteral">&quot;Wrong kBest \n&quot;</span>);</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">   //////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment"></span>   <span class="comment">//           define two daughter cells (active)                 //</span><span class="comment"></span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">   //////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> d1 = <a class="code" href="classTFoam.html#acfa16bd47ac7c6698f5fab8455bdf56c">CellFill</a>(1,   cell);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> d2 = <a class="code" href="classTFoam.html#acfa16bd47ac7c6698f5fab8455bdf56c">CellFill</a>(1,   cell);</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;   cell-&gt;<a class="code" href="classTFoamCell.html#af435b723d44be73f78b7486b13ffd57c">SetDau0</a>((<a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[d1]));</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;   cell-&gt;<a class="code" href="classTFoamCell.html#ac3cd6f51d3e8878539c921f296d608e8">SetDau1</a>((<a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[d2]));</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;   <a class="code" href="classTFoam.html#a6430c3a52917e5c9b1f3490754deec85">Explore</a>( (<a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[d1]) );</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;   <a class="code" href="classTFoam.html#a6430c3a52917e5c9b1f3490754deec85">Explore</a>( (<a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[d2]) );</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;} <span class="comment">// TFoam_Divide</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">/// Internal subrogram used by Initialize.</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">/// It finds out number of active cells fNoAct,</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">/// creates list of active cell fCellsAct and primary cumulative fPrimAcu.</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">/// They are used during the MC generation to choose randomly an active cell.</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00994"></a><span class="lineno"><a class="line" href="classTFoam.html#a035d303af1eb6dc07a800158efe37158">  994</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a035d303af1eb6dc07a800158efe37158">TFoam::MakeActiveList</a>()</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;{</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>, iCell;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="tmva_2tmva_2src_2Factory_8cxx.html#a73e5b6a37db0af518793b45eba2bbe8e">sum</a>;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   <span class="comment">// flush previous result</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ac29223eb2df913fc4223af49b940d6e0">fPrimAcu</a>  != 0) <span class="keyword">delete</span> [] <a class="code" href="classTFoam.html#ac29223eb2df913fc4223af49b940d6e0">fPrimAcu</a>;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a4037d51e21d262eb04692fa3c8268dbe">fCellsAct</a> != 0) <span class="keyword">delete</span> <a class="code" href="classTFoam.html#a4037d51e21d262eb04692fa3c8268dbe">fCellsAct</a>;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;   <span class="comment">// Allocate tables of active cells</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;   <a class="code" href="classTFoam.html#a4037d51e21d262eb04692fa3c8268dbe">fCellsAct</a> = <span class="keyword">new</span> <a class="code" href="classTRefArray.html">TRefArray</a>();</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;   <span class="comment">// Count Active cells and find total Primary</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;   <span class="comment">// Fill-in tables of active cells</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;   <a class="code" href="classTFoam.html#a1e6a4bef13814c516e731df1ecd8e9ee">fPrime</a> = 0.0; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a> = 0;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;   <span class="keywordflow">for</span>(iCell=0; iCell&lt;=<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>; iCell++) {</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[iCell]-&gt;GetStat()==1) {</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;         <a class="code" href="classTFoam.html#a1e6a4bef13814c516e731df1ecd8e9ee">fPrime</a> += <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[iCell]-&gt;<a class="code" href="classTFoamCell.html#a66d40f9f7505e0afb793b0d242bbe30e">GetPrim</a>();</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;         <a class="code" href="classTFoam.html#a4037d51e21d262eb04692fa3c8268dbe">fCellsAct</a>-&gt;<a class="code" href="classTRefArray.html#a2a4f52f10ab7d7cc29ec49d98571d44e">Add</a>(<a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[iCell]);</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;         <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>++;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      }</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;   }</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#abb371f4679f22bddb17b369d9ee7f511">fNoAct</a> != <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>)  <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;MakeActiveList&quot;</span>, <span class="stringliteral">&quot;Wrong fNoAct               \n&quot;</span>  );</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a1e6a4bef13814c516e731df1ecd8e9ee">fPrime</a> == 0.) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;MakeActiveList&quot;</span>, <span class="stringliteral">&quot;Integrand function is zero  \n&quot;</span>  );</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;   <a class="code" href="classTFoam.html#ac29223eb2df913fc4223af49b940d6e0">fPrimAcu</a>  = <span class="keyword">new</span>  <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="classTFoam.html#abb371f4679f22bddb17b369d9ee7f511">fNoAct</a>]; <span class="comment">// cumulative primary for MC generation</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;   <span class="keywordflow">if</span>( <a class="code" href="classTFoam.html#a4037d51e21d262eb04692fa3c8268dbe">fCellsAct</a>==0 || <a class="code" href="classTFoam.html#ac29223eb2df913fc4223af49b940d6e0">fPrimAcu</a>==0 ) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;MakeActiveList&quot;</span>, <span class="stringliteral">&quot;Cant allocate fCellsAct or fPrimAcu \n&quot;</span>);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;   <a class="code" href="tmva_2tmva_2src_2Factory_8cxx.html#a73e5b6a37db0af518793b45eba2bbe8e">sum</a> =0.0;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;   <span class="keywordflow">for</span>(iCell=0; iCell&lt;<a class="code" href="classTFoam.html#abb371f4679f22bddb17b369d9ee7f511">fNoAct</a>; iCell++) {</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <a class="code" href="tmva_2tmva_2src_2Factory_8cxx.html#a73e5b6a37db0af518793b45eba2bbe8e">sum</a> = <a class="code" href="tmva_2tmva_2src_2Factory_8cxx.html#a73e5b6a37db0af518793b45eba2bbe8e">sum</a> + ( (<a class="code" href="classTFoamCell.html">TFoamCell</a> *) (<a class="code" href="classTFoam.html#a4037d51e21d262eb04692fa3c8268dbe">fCellsAct</a>-&gt;<a class="code" href="classTRefArray.html#ac52371aea04391462da4358302b8593e">At</a>(iCell)) )-&gt;GetPrim()/<a class="code" href="classTFoam.html#a1e6a4bef13814c516e731df1ecd8e9ee">fPrime</a>;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      <a class="code" href="classTFoam.html#ac29223eb2df913fc4223af49b940d6e0">fPrimAcu</a>[iCell]=<a class="code" href="tmva_2tmva_2src_2Factory_8cxx.html#a73e5b6a37db0af518793b45eba2bbe8e">sum</a>;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;   }</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;} <span class="comment">//MakeActiveList</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">/// User may optionally reset random number generator using this method</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">/// Usually it is done when FOAM object is restored from the disk.</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">/// IMPORTANT: this method deletes existing  random number generator registered in the FOAM object.</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">/// In particular such an object is created by the streamer during the disk-read operation.</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01037"></a><span class="lineno"><a class="line" href="classTFoam.html#a6d76eebaffa18117641f69c10536b54c"> 1037</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a6d76eebaffa18117641f69c10536b54c">TFoam::ResetPseRan</a>(<a class="code" href="classTRandom.html">TRandom</a> *PseRan)</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;{</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a1aae352244412f1e1bd6711be17f5e57">fPseRan</a>) {</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <a class="code" href="classTObject.html#afc345b772a999b230e011b316d8ae328">Info</a>(<span class="stringliteral">&quot;ResetPseRan&quot;</span>, <span class="stringliteral">&quot;Resetting random number generator  \n&quot;</span>);</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classTFoam.html#a1aae352244412f1e1bd6711be17f5e57">fPseRan</a>;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;   }</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;   <a class="code" href="classTFoam.html#ad696f0c559ff6d29bc773822df842012">SetPseRan</a>(PseRan);</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;}</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">/// User may use this method to set the distribution object</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01049"></a><span class="lineno"><a class="line" href="classTFoam.html#ab46c94f852d34f3c1b71239b2eb19884"> 1049</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#ab46c94f852d34f3c1b71239b2eb19884">TFoam::SetRho</a>(<a class="code" href="classTFoamIntegrand.html">TFoamIntegrand</a> *fun)</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;{</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;   <span class="keywordflow">if</span> (fun)</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <a class="code" href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">fRho</a>=fun;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;SetRho&quot;</span>, <span class="stringliteral">&quot;Bad function \n&quot;</span> );</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;}<span class="comment"></span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">/// User may use this method to set the distribution object as a global function pointer</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">/// (and not as an interpreted function).</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01060"></a><span class="lineno"><a class="line" href="classTFoam.html#ab960e83dda7e7825216f1afb44667c6b"> 1060</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#ab960e83dda7e7825216f1afb44667c6b">TFoam::SetRhoInt</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> (*fun)(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *) )</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;{</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;   <span class="comment">// This is needed for both AClic and Cling</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;   <span class="keywordflow">if</span> (fun) {</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="comment">// delete function object if it has been created here in SetRho</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">fRho</a> &amp;&amp; dynamic_cast&lt;FoamIntegrandFunction*&gt;(<a class="code" href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">fRho</a>) ) <span class="keyword">delete</span> <a class="code" href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">fRho</a>;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      <a class="code" href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">fRho</a>= <span class="keyword">new</span> FoamIntegrandFunction(fun);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;   } <span class="keywordflow">else</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;SetRho&quot;</span>, <span class="stringliteral">&quot;Bad function \n&quot;</span> );</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;}</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">/// User may optionally reset the distribution using this method</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">/// Usually it is done when FOAM object is restored from the disk.</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">/// IMPORTANT: this method deletes existing  distribution object registered in the FOAM object.</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">/// In particular such an object is created by the streamer diring the disk-read operation.</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">/// This method is used only in very special cases, because the distribution in most cases</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">/// should be &quot;owned&quot; by the FOAM object and should not be replaced by another one after initialization.</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01079"></a><span class="lineno"><a class="line" href="classTFoam.html#a582600cf7aa89f15eb3915d3c07fc473"> 1079</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a582600cf7aa89f15eb3915d3c07fc473">TFoam::ResetRho</a>(<a class="code" href="classTFoamIntegrand.html">TFoamIntegrand</a> *fun)</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;{</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">fRho</a>) {</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      <a class="code" href="classTObject.html#afc345b772a999b230e011b316d8ae328">Info</a>(<span class="stringliteral">&quot;ResetRho&quot;</span>, <span class="stringliteral">&quot;!!! Resetting distribution function  !!!\n&quot;</span>);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">fRho</a>;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;   }</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;   <a class="code" href="classTFoam.html#ab46c94f852d34f3c1b71239b2eb19884">SetRho</a>(fun);</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;}</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">/// Internal subprogram.</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">/// Evaluates distribution to be generated.</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01092"></a><span class="lineno"><a class="line" href="classTFoam.html#a676fd2679208cfcc67acbb899e823a26"> 1092</a></span>&#160;<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="classTFoam.html#a676fd2679208cfcc67acbb899e823a26">TFoam::Eval</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *xRand)</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;{</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> result;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;   <span class="keywordflow">if</span>(!<a class="code" href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">fRho</a>) {   <span class="comment">//interactive mode</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> paramArr[3];</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      paramArr[0]=(<a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a>)<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      paramArr[1]=(<a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a>)xRand;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      <a class="code" href="classTFoam.html#a6fb0d8cd68926217c671040c42227e5e">fMethodCall</a>-&gt;<a class="code" href="classTMethodCall.html#ae3f721deb668578ddbc74bdefedba4b8">SetParamPtrs</a>(paramArr);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      <a class="code" href="classTFoam.html#a6fb0d8cd68926217c671040c42227e5e">fMethodCall</a>-&gt;<a class="code" href="classTMethodCall.html#aca3bb7a7f971a91a1984e22b2bb97f24">Execute</a>(result);</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;   } <span class="keywordflow">else</span> {       <span class="comment">//compiled mode</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      result=<a class="code" href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">fRho</a>-&gt;<a class="code" href="classTFoamIntegrand.html#a0403f43554c1e4312efe54944ae7adbf">Density</a>(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>,xRand);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;   }</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;   <span class="keywordflow">return</span> result;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;}</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">/// Internal subprogram.</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">/// Return randomly chosen active cell with probability equal to its</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">/// contribution into total driver integral using interpolation search.</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01114"></a><span class="lineno"><a class="line" href="classTFoam.html#a30f5b5f0fc31761dec49d9890980e049"> 1114</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a30f5b5f0fc31761dec49d9890980e049">TFoam::GenerCel2</a>(<a class="code" href="classTFoamCell.html">TFoamCell</a> *&amp;pCell)</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;{</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;   <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a>  lo, <a class="code" href="THbookFile_8cxx.html#aa1a5cf287dc90c5ea8a4fb820f78b708">hi</a>, hit;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> fhit, flo, fhi;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> random;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;   random=<a class="code" href="classTFoam.html#a1aae352244412f1e1bd6711be17f5e57">fPseRan</a>-&gt;<a class="code" href="classTRandom.html#af504d4f838ab09eb48b7c252615563aa">Rndm</a>();</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;   lo  = 0;              <a class="code" href="THbookFile_8cxx.html#aa1a5cf287dc90c5ea8a4fb820f78b708">hi</a> =<a class="code" href="classTFoam.html#abb371f4679f22bddb17b369d9ee7f511">fNoAct</a>-1;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;   flo = <a class="code" href="classTFoam.html#ac29223eb2df913fc4223af49b940d6e0">fPrimAcu</a>[lo];  fhi=<a class="code" href="classTFoam.html#ac29223eb2df913fc4223af49b940d6e0">fPrimAcu</a>[<a class="code" href="THbookFile_8cxx.html#aa1a5cf287dc90c5ea8a4fb820f78b708">hi</a>];</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;   <span class="keywordflow">while</span>(lo+1&lt;<a class="code" href="THbookFile_8cxx.html#aa1a5cf287dc90c5ea8a4fb820f78b708">hi</a>) {</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      hit = lo + (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>)( (<a class="code" href="THbookFile_8cxx.html#aa1a5cf287dc90c5ea8a4fb820f78b708">hi</a>-lo)*(random-flo)/(fhi-flo)+0.5);</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <span class="keywordflow">if</span> (hit&lt;=lo)</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;         hit = lo+1;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(hit&gt;=<a class="code" href="THbookFile_8cxx.html#aa1a5cf287dc90c5ea8a4fb820f78b708">hi</a>)</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;         hit = <a class="code" href="THbookFile_8cxx.html#aa1a5cf287dc90c5ea8a4fb820f78b708">hi</a>-1;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      fhit=<a class="code" href="classTFoam.html#ac29223eb2df913fc4223af49b940d6e0">fPrimAcu</a>[hit];</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      <span class="keywordflow">if</span> (fhit&gt;random) {</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;         <a class="code" href="THbookFile_8cxx.html#aa1a5cf287dc90c5ea8a4fb820f78b708">hi</a> = hit;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;         fhi = fhit;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;         lo = hit;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;         flo = fhit;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      }</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;   }</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#ac29223eb2df913fc4223af49b940d6e0">fPrimAcu</a>[lo]&gt;random)</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      pCell = (<a class="code" href="classTFoamCell.html">TFoamCell</a> *) <a class="code" href="classTFoam.html#a4037d51e21d262eb04692fa3c8268dbe">fCellsAct</a>-&gt;<a class="code" href="classTRefArray.html#ac52371aea04391462da4358302b8593e">At</a>(lo);</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      pCell = (<a class="code" href="classTFoamCell.html">TFoamCell</a> *) <a class="code" href="classTFoam.html#a4037d51e21d262eb04692fa3c8268dbe">fCellsAct</a>-&gt;<a class="code" href="classTRefArray.html#ac52371aea04391462da4358302b8593e">At</a>(<a class="code" href="THbookFile_8cxx.html#aa1a5cf287dc90c5ea8a4fb820f78b708">hi</a>);</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;}       <span class="comment">// TFoam::GenerCel2</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">/// User subprogram.</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">/// It generates randomly point/vector according to user-defined distribution.</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">/// Prior initialization with help of Initialize() is mandatory.</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">/// Generated MC point/vector is available using GetMCvect and the MC weight with GetMCwt.</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">/// MC point is generated with wt=1 or with variable weight, see OptRej switch.</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01152"></a><span class="lineno"><a class="line" href="classTFoam.html#a23e8ee341a3aaca84fbcea42b6ed3376"> 1152</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a23e8ee341a3aaca84fbcea42b6ed3376">TFoam::MakeEvent</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;{</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>      j;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>   wt,dx,mcwt;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;   <a class="code" href="classTFoamCell.html">TFoamCell</a> *rCell;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;   <span class="comment">//********************** MC LOOP STARS HERE **********************</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;ee0:</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;   <a class="code" href="classTFoam.html#a30f5b5f0fc31761dec49d9890980e049">GenerCel2</a>(rCell);   <span class="comment">// choose randomly one cell</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;   <a class="code" href="classTFoam.html#a6a31e33dc6a72c83bddea5d6c24d2991">MakeAlpha</a>();</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;   <a class="code" href="classTFoamVect.html">TFoamVect</a>  cellPosi(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>); <a class="code" href="classTFoamVect.html">TFoamVect</a>  cellSize(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>);</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;   rCell-&gt;<a class="code" href="classTFoamCell.html#a7f6aa66669b4c5fb095cc32795a50a9f">GetHcub</a>(cellPosi,cellSize);</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;   <span class="keywordflow">for</span>(j=0; j&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>; j++)</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <a class="code" href="classTFoam.html#ac4c057ef5fe272b508f41c30a560b556">fMCvect</a>[j]= cellPosi[j] +<a class="code" href="classTFoam.html#a624774b519e7347376212fa1313c98fc">fAlpha</a>[j]*cellSize[j];</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;   dx = rCell-&gt;<a class="code" href="classTFoamCell.html#a1f7b823f4c86882d8e6a749bcea97282">GetVolume</a>();      <span class="comment">// Cartesian volume of the Cell</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;   <span class="comment">//  weight average normalized to PRIMARY integral over the cell</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;   wt=dx*<a class="code" href="classTFoam.html#a676fd2679208cfcc67acbb899e823a26">Eval</a>(<a class="code" href="classTFoam.html#ac4c057ef5fe272b508f41c30a560b556">fMCvect</a>);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;   mcwt = wt / rCell-&gt;<a class="code" href="classTFoamCell.html#a66d40f9f7505e0afb793b0d242bbe30e">GetPrim</a>();  <span class="comment">// PRIMARY controls normalization</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;   <a class="code" href="classTFoam.html#a50b85f60c791f766e5a197f43f661d7c">fNCalls</a>++;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;   <a class="code" href="classTFoam.html#a0f43c1e4c219db5d0c814b94958f24b7">fMCwt</a>   =  mcwt;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;   <span class="comment">// accumulation of statistics for the main MC weight</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;   <a class="code" href="classTFoam.html#a2536c78efcadaa1d83007aaffa5c8a5e">fSumWt</a>  += mcwt;           <span class="comment">// sum of Wt</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;   <a class="code" href="classTFoam.html#a248c1ffc0c849f84b4854072ad0f75d5">fSumWt2</a> += mcwt*mcwt;      <span class="comment">// sum of Wt**2</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;   <a class="code" href="classTFoam.html#a23552a188da40955fa06791e0b7fbe27">fNevGen</a>++;                 <span class="comment">// sum of 1d0</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;   <a class="code" href="classTFoam.html#a9c10369f795e4ea1205b6e24dcd2a0f8">fWtMax</a>  =  <a class="code" href="namespaceTMath.html#a38e1c23e08564d17051526d7e0a5364d">TMath::Max</a>(<a class="code" href="classTFoam.html#a9c10369f795e4ea1205b6e24dcd2a0f8">fWtMax</a>, mcwt);   <span class="comment">// maximum wt</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;   <a class="code" href="classTFoam.html#a567ba53409fed0bd7744694a6b73eb1e">fWtMin</a>  =  <a class="code" href="namespaceTMath.html#aaae88f888b116f98b932ba4543fa00b5">TMath::Min</a>(<a class="code" href="classTFoam.html#a567ba53409fed0bd7744694a6b73eb1e">fWtMin</a>, mcwt);   <span class="comment">// minimum wt</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;   <a class="code" href="classTFoam.html#a4105266375bfe6f0807109680f6bc0d3">fMCMonit</a>-&gt;<a class="code" href="classTFoamMaxwt.html#a1b88d2e7ed873139638191d27cac6460">Fill</a>(mcwt);</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;   <a class="code" href="classTFoam.html#a1510630fd3caa168268f61ccc802e72e">fHistWt</a>-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(mcwt,1.0);          <span class="comment">// histogram</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;   <span class="comment">//*******  Optional rejection ******</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ac0aa4bc25859a420d0df7dd4ad17178b">fOptRej</a> == 1) {</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> random;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      random=<a class="code" href="classTFoam.html#a1aae352244412f1e1bd6711be17f5e57">fPseRan</a>-&gt;<a class="code" href="classTRandom.html#af504d4f838ab09eb48b7c252615563aa">Rndm</a>();</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="classTFoam.html#a5b4152159bbd69bb2e4b06b17ef414f3">fMaxWtRej</a>*random &gt; <a class="code" href="classTFoam.html#a0f43c1e4c219db5d0c814b94958f24b7">fMCwt</a>) <span class="keywordflow">goto</span> ee0;  <span class="comment">// Wt=1 events, internal rejection</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="classTFoam.html#a0f43c1e4c219db5d0c814b94958f24b7">fMCwt</a>&lt;<a class="code" href="classTFoam.html#a5b4152159bbd69bb2e4b06b17ef414f3">fMaxWtRej</a> ) {</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;         <a class="code" href="classTFoam.html#a0f43c1e4c219db5d0c814b94958f24b7">fMCwt</a> = 1.0;                  <span class="comment">// normal Wt=1 event</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;         <a class="code" href="classTFoam.html#a0f43c1e4c219db5d0c814b94958f24b7">fMCwt</a> = <a class="code" href="classTFoam.html#a0f43c1e4c219db5d0c814b94958f24b7">fMCwt</a>/<a class="code" href="classTFoam.html#a5b4152159bbd69bb2e4b06b17ef414f3">fMaxWtRej</a>;    <span class="comment">// weight for overweighted events! kept for debug</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;         <a class="code" href="classTFoam.html#a8f741bf8e5dcb56ef4938fe97590948f">fSumOve</a> += <a class="code" href="classTFoam.html#a0f43c1e4c219db5d0c814b94958f24b7">fMCwt</a>-<a class="code" href="classTFoam.html#a5b4152159bbd69bb2e4b06b17ef414f3">fMaxWtRej</a>; <span class="comment">// contribution of overweighted</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      }</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;   }</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;   <span class="comment">//********************** MC LOOP ENDS HERE **********************</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;} <span class="comment">// MakeEvent</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">/// User may get generated MC point/vector with help of this method</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01202"></a><span class="lineno"><a class="line" href="classTFoam.html#a16d0cb66afd6b5f55f0d792c03f0a211"> 1202</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a16d0cb66afd6b5f55f0d792c03f0a211">TFoam::GetMCvect</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *MCvect)</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;{</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;   <span class="keywordflow">for</span> ( <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> k=0 ; k&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a> ; k++) *(MCvect +k) = <a class="code" href="classTFoam.html#ac4c057ef5fe272b508f41c30a560b556">fMCvect</a>[k];</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;}<span class="comment">//GetMCvect</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">/// User may get weight MC weight using this method</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01210"></a><span class="lineno"><a class="line" href="classTFoam.html#a55499afc42f0f441b1cf07c7037b6b55"> 1210</a></span>&#160;<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="classTFoam.html#a55499afc42f0f441b1cf07c7037b6b55">TFoam::GetMCwt</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;{</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;   <span class="keywordflow">return</span>(<a class="code" href="classTFoam.html#a0f43c1e4c219db5d0c814b94958f24b7">fMCwt</a>);</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;}<span class="comment"></span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">/// User may get weight MC weight using this method</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01217"></a><span class="lineno"><a class="line" href="classTFoam.html#a72afbc8f268498695a4ff5a67e476b0a"> 1217</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a55499afc42f0f441b1cf07c7037b6b55">TFoam::GetMCwt</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> &amp;mcwt)</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;{</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;   mcwt=<a class="code" href="classTFoam.html#a0f43c1e4c219db5d0c814b94958f24b7">fMCwt</a>;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;}</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">/// User subprogram which generates MC event and returns MC weight</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01225"></a><span class="lineno"><a class="line" href="classTFoam.html#ac397f5ff553e08a7f83c0bf4a1ae59b5"> 1225</a></span>&#160;<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="classTFoam.html#ac397f5ff553e08a7f83c0bf4a1ae59b5">TFoam::MCgenerate</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *MCvect)</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;{</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;   <a class="code" href="classTFoam.html#a23e8ee341a3aaca84fbcea42b6ed3376">MakeEvent</a>();</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;   <a class="code" href="classTFoam.html#a16d0cb66afd6b5f55f0d792c03f0a211">GetMCvect</a>(MCvect);</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;   <span class="keywordflow">return</span>(<a class="code" href="classTFoam.html#a0f43c1e4c219db5d0c814b94958f24b7">fMCwt</a>);</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;}<span class="comment">//MCgenerate</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">/// User subprogram.</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">/// It provides the value of the integral calculated from the averages of the MC run</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">/// May be called after (or during) the MC run.</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01237"></a><span class="lineno"><a class="line" href="classTFoam.html#a596b986685e5f58dca2a19484c6886d4"> 1237</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a596b986685e5f58dca2a19484c6886d4">TFoam::GetIntegMC</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> &amp;mcResult, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> &amp;mcError)</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;{</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> mCerelat;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;   mcResult = 0.0;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;   mCerelat = 1.0;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classTFoam.html#a23552a188da40955fa06791e0b7fbe27">fNevGen</a>&gt;0) {</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      mcResult = <a class="code" href="classTFoam.html#a1e6a4bef13814c516e731df1ecd8e9ee">fPrime</a>*<a class="code" href="classTFoam.html#a2536c78efcadaa1d83007aaffa5c8a5e">fSumWt</a>/<a class="code" href="classTFoam.html#a23552a188da40955fa06791e0b7fbe27">fNevGen</a>;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      mCerelat = <a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a>( <a class="code" href="classTFoam.html#a248c1ffc0c849f84b4854072ad0f75d5">fSumWt2</a>/(<a class="code" href="classTFoam.html#a2536c78efcadaa1d83007aaffa5c8a5e">fSumWt</a>*<a class="code" href="classTFoam.html#a2536c78efcadaa1d83007aaffa5c8a5e">fSumWt</a>) - 1/<a class="code" href="classTFoam.html#a23552a188da40955fa06791e0b7fbe27">fNevGen</a>);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;   }</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;   mcError = mcResult *mCerelat;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;}<span class="comment">//GetIntegMC</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">/// User subprogram.</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">/// It returns NORMALIZATION integral to be combined with the average weights</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">/// and content of the histograms in order to get proper absolute normalization</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment">/// of the integrand and distributions.</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">/// It can be called after initialization, before or during the MC run.</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01256"></a><span class="lineno"><a class="line" href="classTFoam.html#a3ef5aed441198587dbce162fe8515a84"> 1256</a></span>&#160;<span class="keywordtype">void</span>  <a class="code" href="classTFoam.html#a3ef5aed441198587dbce162fe8515a84">TFoam::GetIntNorm</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>&amp; IntNorm, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>&amp; Errel )</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;{</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ac0aa4bc25859a420d0df7dd4ad17178b">fOptRej</a> == 1) {    <span class="comment">// Wt=1 events, internal rejection</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> intMC,errMC;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <a class="code" href="classTFoam.html#a596b986685e5f58dca2a19484c6886d4">GetIntegMC</a>(intMC,errMC);</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      IntNorm = intMC;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      Errel   = errMC;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;   } <span class="keywordflow">else</span> {                <span class="comment">// Wted events, NO internal rejection</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      IntNorm = <a class="code" href="classTFoam.html#a1e6a4bef13814c516e731df1ecd8e9ee">fPrime</a>;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      Errel   = 0;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;   }</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;}<span class="comment">//GetIntNorm</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">/// May be called optionally after the MC run.</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">/// Returns various parameters of the MC weight for efficiency evaluation</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01273"></a><span class="lineno"><a class="line" href="classTFoam.html#af21d1cdd3845fcd50989100601105134"> 1273</a></span>&#160;<span class="keywordtype">void</span>  <a class="code" href="classTFoam.html#af21d1cdd3845fcd50989100601105134">TFoam::GetWtParams</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> eps, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> &amp;aveWt, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> &amp;wtMax, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> &amp;<a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a>)</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;{</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> mCeff, wtLim;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;   <a class="code" href="classTFoam.html#a4105266375bfe6f0807109680f6bc0d3">fMCMonit</a>-&gt;<a class="code" href="classTFoamMaxwt.html#a928bcc18579476c9560fdd571209f4c3">GetMCeff</a>(eps, mCeff, wtLim);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;   wtMax = wtLim;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;   aveWt = <a class="code" href="classTFoam.html#a2536c78efcadaa1d83007aaffa5c8a5e">fSumWt</a>/<a class="code" href="classTFoam.html#a23552a188da40955fa06791e0b7fbe27">fNevGen</a>;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;   <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a> = <a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a>( <a class="code" href="classTFoam.html#a248c1ffc0c849f84b4854072ad0f75d5">fSumWt2</a>/<a class="code" href="classTFoam.html#a23552a188da40955fa06791e0b7fbe27">fNevGen</a> -aveWt*aveWt );</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;}<span class="comment">//GetmCeff</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">/// May be called optionally by the user after the MC run.</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">/// It provides normalization and also prints some information/statistics on the MC run.</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01286"></a><span class="lineno"><a class="line" href="classTFoam.html#abe1846587b7c48d1511fe3bf5971d6b3"> 1286</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#abe1846587b7c48d1511fe3bf5971d6b3">TFoam::Finalize</a>(<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>&amp; IntNorm, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>&amp; Errel)</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;{</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;   <a class="code" href="classTFoam.html#a3ef5aed441198587dbce162fe8515a84">GetIntNorm</a>(IntNorm,Errel);</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> mcResult,mcError;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;   <a class="code" href="classTFoam.html#a596b986685e5f58dca2a19484c6886d4">GetIntegMC</a>(mcResult,mcError);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> mCerelat= mcError/mcResult;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a20be20446e99fdfc26955c5b389f92c4">fChat</a>&gt;0) {</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> eps = 0.0005;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> mCeff, mcEf2, wtMax, aveWt, <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a>;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <a class="code" href="classTFoam.html#af21d1cdd3845fcd50989100601105134">GetWtParams</a>(eps, aveWt, wtMax, <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a>);</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      mCeff=0;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      <span class="keywordflow">if</span>(wtMax&gt;0.0) mCeff=aveWt/wtMax;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      mcEf2 = <a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a>/aveWt;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> driver = <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[0]-&gt;<a class="code" href="classTFoamCell.html#a412c4db128d748691c71a393e13ff069">GetDriv</a>();</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      <span class="comment">//</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <a class="code" href="TFoam_8cxx.html#aeff7a5ba4f2535abfd56874d716676a1">BXOPE</a>;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <a class="code" href="TFoam_8cxx.html#a675bf9bc58e8545c648be3aab07403fe">BXTXT</a>(<span class="stringliteral">&quot;****************************************&quot;</span>);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      <a class="code" href="TFoam_8cxx.html#a675bf9bc58e8545c648be3aab07403fe">BXTXT</a>(<span class="stringliteral">&quot;******     TFoam::Finalize       ******&quot;</span>);</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      <a class="code" href="TFoam_8cxx.html#a675bf9bc58e8545c648be3aab07403fe">BXTXT</a>(<span class="stringliteral">&quot;****************************************&quot;</span>);</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      <a class="code" href="TFoam_8cxx.html#a30a4fd0f6d19430b51d6aa8656a1c78a">BX1I</a>(<span class="stringliteral">&quot;    NevGen&quot;</span>,<a class="code" href="classTFoam.html#a23552a188da40955fa06791e0b7fbe27">fNevGen</a>, <span class="stringliteral">&quot;Number of generated events in the MC generation   &quot;</span>);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <a class="code" href="TFoam_8cxx.html#a30a4fd0f6d19430b51d6aa8656a1c78a">BX1I</a>(<span class="stringliteral">&quot;    nCalls&quot;</span>,<a class="code" href="classTFoam.html#a50b85f60c791f766e5a197f43f661d7c">fNCalls</a>, <span class="stringliteral">&quot;Total number of function calls                    &quot;</span>);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <a class="code" href="TFoam_8cxx.html#a675bf9bc58e8545c648be3aab07403fe">BXTXT</a>(<span class="stringliteral">&quot;----------------------------------------&quot;</span>);</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot;     AveWt&quot;</span>,aveWt,    <span class="stringliteral">&quot;Average MC weight                      &quot;</span>);</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot;     WtMin&quot;</span>,<a class="code" href="classTFoam.html#a567ba53409fed0bd7744694a6b73eb1e">fWtMin</a>,  <span class="stringliteral">&quot;Minimum MC weight (absolute)           &quot;</span>);</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot;     WtMax&quot;</span>,<a class="code" href="classTFoam.html#a9c10369f795e4ea1205b6e24dcd2a0f8">fWtMax</a>,  <span class="stringliteral">&quot;Maximum MC weight (absolute)           &quot;</span>);</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      <a class="code" href="TFoam_8cxx.html#a675bf9bc58e8545c648be3aab07403fe">BXTXT</a>(<span class="stringliteral">&quot;----------------------------------------&quot;</span>);</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot;    XPrime&quot;</span>,<a class="code" href="classTFoam.html#a1e6a4bef13814c516e731df1ecd8e9ee">fPrime</a>,  <span class="stringliteral">&quot;Primary total integral, R_prime        &quot;</span>);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot;    XDiver&quot;</span>,driver,   <span class="stringliteral">&quot;Driver  total integral, R_loss         &quot;</span>);</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      <a class="code" href="TFoam_8cxx.html#a675bf9bc58e8545c648be3aab07403fe">BXTXT</a>(<span class="stringliteral">&quot;----------------------------------------&quot;</span>);</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <a class="code" href="TFoam_8cxx.html#a9ccf82f4f7b8f320984dca908f83d8fa">BX2F</a>(<span class="stringliteral">&quot;    IntMC&quot;</span>, mcResult,  mcError,      <span class="stringliteral">&quot;Result of the MC Integral&quot;</span>);</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot; mCerelat&quot;</span>, mCerelat,  <span class="stringliteral">&quot;Relative error of the MC integral      &quot;</span>);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot; &lt;w&gt;/WtMax&quot;</span>,mCeff,     <span class="stringliteral">&quot;MC efficiency, acceptance rate&quot;</span>);</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot; Sigma/&lt;w&gt;&quot;</span>,mcEf2,     <span class="stringliteral">&quot;MC efficiency, variance/ave_wt&quot;</span>);</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot;     WtMax&quot;</span>,wtMax,     <span class="stringliteral">&quot;WtMax(esp= 0.0005)            &quot;</span>);</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot;     Sigma&quot;</span>,<a class="code" href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a>,     <span class="stringliteral">&quot;variance of MC weight         &quot;</span>);</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ac0aa4bc25859a420d0df7dd4ad17178b">fOptRej</a>==1) {</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> avOve=<a class="code" href="classTFoam.html#a8f741bf8e5dcb56ef4938fe97590948f">fSumOve</a>/<a class="code" href="classTFoam.html#a2536c78efcadaa1d83007aaffa5c8a5e">fSumWt</a>;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;         <a class="code" href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a>(<span class="stringliteral">&quot;&lt;OveW&gt;/&lt;W&gt;&quot;</span>,avOve,     <span class="stringliteral">&quot;Contrib. of events wt&gt;MaxWtRej&quot;</span>);</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      }</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      <a class="code" href="TFoam_8cxx.html#a6692b82cba0b23a6b59a8e498f9519a5">BXCLO</a>;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;   }</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;}  <span class="comment">// Finalize</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="comment">/// This can be called before Initialize, after setting kDim</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">/// It defines which variables are excluded in the process of the cell division.</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">/// For example &#39;FoamX-&gt;SetInhiDiv(1, 1);&#39; inhibits division of y-variable.</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment">/// The resulting map of cells in 2-dim. case will look as follows:</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment">/// &lt;img src=&quot;gif/foam_Map2.gif&quot;&gt;</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01338"></a><span class="lineno"><a class="line" href="classTFoam.html#a96e9e404ee4b547f33b473f804a14550"> 1338</a></span>&#160;<span class="keywordtype">void</span>  <a class="code" href="classTFoam.html#a96e9e404ee4b547f33b473f804a14550">TFoam::SetInhiDiv</a>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> iDim, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> InhiDiv)</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;{</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>==0) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;TFoam&quot;</span>,<span class="stringliteral">&quot;SetInhiDiv: fDim=0 \n&quot;</span>);</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a4d633c10f039fc94931d0ad91c4568d2">fInhiDiv</a> == 0) {</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      <a class="code" href="classTFoam.html#a4d633c10f039fc94931d0ad91c4568d2">fInhiDiv</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[ <a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a> ];</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      <span class="keywordflow">for</span>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i=0; i&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>; i++) <a class="code" href="classTFoam.html#a4d633c10f039fc94931d0ad91c4568d2">fInhiDiv</a>[i]=0;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;   }</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;   <span class="keywordflow">if</span>( ( 0&lt;=iDim) &amp;&amp; (iDim&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>)) {</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      <a class="code" href="classTFoam.html#a4d633c10f039fc94931d0ad91c4568d2">fInhiDiv</a>[iDim] = InhiDiv;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;   } <span class="keywordflow">else</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;SetInhiDiv:&quot;</span>,<span class="stringliteral">&quot;Wrong iDim \n&quot;</span>);</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;}<span class="comment">//SetInhiDiv</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment">/// This should be called before Initialize, after setting  kDim</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">/// It predefines values of the cell division for certain variable iDim.</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment">/// For example setting 3 predefined division lines using:</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment">///     xDiv[0]=0.30; xDiv[1]=0.40; xDiv[2]=0.65;</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment">///     FoamX-&gt;SetXdivPRD(0,3,xDiv);</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment">/// results in the following 2-dim. pattern of the cells:</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment">/// &lt;img src=&quot;gif/foam_Map3.gif&quot;&gt;</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01363"></a><span class="lineno"><a class="line" href="classTFoam.html#a8c6c2006dfca062da0123b950ba23a5a"> 1363</a></span>&#160;<span class="keywordtype">void</span>  <a class="code" href="classTFoam.html#a8c6c2006dfca062da0123b950ba23a5a">TFoam::SetXdivPRD</a>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> iDim, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> len, <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> xDiv[])</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;{</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>&lt;=0)  <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;SetXdivPRD&quot;</span>, <span class="stringliteral">&quot;fDim=0 \n&quot;</span>);</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;   <span class="keywordflow">if</span>(   len&lt;1 )  <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;SetXdivPRD&quot;</span>, <span class="stringliteral">&quot;len&lt;1 \n&quot;</span>);</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;   <span class="comment">// allocate list of pointers, if it was not done before</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a> == 0) {</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a> = <span class="keyword">new</span> <a class="code" href="classTFoamVect.html">TFoamVect</a>*[<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>];</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>; i++)  <a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a>[i]=0;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;   }</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="comment">// set division list for direction iDim in H-cubic space!!!</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;   <span class="keywordflow">if</span>( ( 0&lt;=iDim) &amp;&amp; (iDim&lt;<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>)) {</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <a class="code" href="classTFoam.html#a84d3266952abae597c4142ce36582cf3">fOptPRD</a> =1;      <span class="comment">// !!!!</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a>[iDim] != 0)</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;         <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;SetXdivPRD&quot;</span>, <span class="stringliteral">&quot;Second allocation of XdivPRD not allowed \n&quot;</span>);</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a>[iDim] = <span class="keyword">new</span> <a class="code" href="classTFoamVect.html">TFoamVect</a>(len); <span class="comment">// allocate list of division points</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      <span class="keywordflow">for</span>(i=0; i&lt;len; i++) {</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;         (*<a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a>[iDim])[i]=xDiv[i]; <span class="comment">// set list of division points</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      }</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;SetXdivPRD&quot;</span>, <span class="stringliteral">&quot;Wrong iDim  \n&quot;</span>);</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;   }</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;   <span class="comment">// Printing predefined division points</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;   std::cout&lt;&lt;<span class="stringliteral">&quot; SetXdivPRD, idim= &quot;</span>&lt;&lt;iDim&lt;&lt;<span class="stringliteral">&quot;  len= &quot;</span>&lt;&lt;len&lt;&lt;<span class="stringliteral">&quot;   &quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;   <span class="keywordflow">for</span>(i=0; i&lt;len; i++) {</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="keywordflow">if</span> (iDim &lt; <a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>) std::cout&lt;&lt; (*<a class="code" href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">fXdivPRD</a>[iDim])[i] &lt;&lt;<span class="stringliteral">&quot;  &quot;</span>;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;   }</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;   std::cout&lt;&lt;std::endl;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;   <span class="keywordflow">for</span>(i=0; i&lt;len; i++)  std::cout&lt;&lt; xDiv[i] &lt;&lt;<span class="stringliteral">&quot;   &quot;</span>;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;   std::cout&lt;&lt;std::endl;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;}<span class="comment">//SetXdivPRD</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment">///  User utility, miscellaneous and debug.</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment">///  Checks all pointers in the tree of cells. This is useful auto diagnostic.</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment">///  level=0, no printout, failures causes STOP</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment">///  level=1, printout, failures lead to WARNINGS only</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01403"></a><span class="lineno"><a class="line" href="classTFoam.html#a09f87e40b4ac8bde2c7a91c2641a8231"> 1403</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a09f87e40b4ac8bde2c7a91c2641a8231">TFoam::CheckAll</a>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> level)</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;{</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> errors, warnings;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;   <a class="code" href="classTFoamCell.html">TFoamCell</a> *cell;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;   <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> iCell;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;   errors = 0; warnings = 0;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;   <span class="keywordflow">if</span> (level==1) std::cout &lt;&lt; <span class="stringliteral">&quot;///////////////////////////// FOAM_Checks /////////////////////////////////&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;   <span class="keywordflow">for</span>(iCell=1; iCell&lt;=<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>; iCell++) {</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      cell = <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[iCell];</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      <span class="comment">//  checking general rules</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="keywordflow">if</span>( ((cell-&gt;<a class="code" href="classTFoamCell.html#a9d6ea7d3b3773726f9aa6daa0a79dff6">GetDau0</a>()==0) &amp;&amp; (cell-&gt;<a class="code" href="classTFoamCell.html#ac825cba2d1d09bee3421196d9cbf4bed">GetDau1</a>()!=0) ) ||</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;         ((cell-&gt;<a class="code" href="classTFoamCell.html#ac825cba2d1d09bee3421196d9cbf4bed">GetDau1</a>()==0) &amp;&amp; (cell-&gt;<a class="code" href="classTFoamCell.html#a9d6ea7d3b3773726f9aa6daa0a79dff6">GetDau0</a>()!=0) ) ) {</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;         errors++;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;         <span class="keywordflow">if</span> (level==1) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;CheckAll&quot;</span>,<span class="stringliteral">&quot;ERROR: Cell&#39;s no %ld has only one daughter \n&quot;</span>,iCell);</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      }</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <span class="keywordflow">if</span>( (cell-&gt;<a class="code" href="classTFoamCell.html#a9d6ea7d3b3773726f9aa6daa0a79dff6">GetDau0</a>()==0) &amp;&amp; (cell-&gt;<a class="code" href="classTFoamCell.html#ac825cba2d1d09bee3421196d9cbf4bed">GetDau1</a>()==0) &amp;&amp; (cell-&gt;<a class="code" href="classTFoamCell.html#a414aaf8866f73aee636da6b58d02a577">GetStat</a>()==0) ) {</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;         errors++;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;         <span class="keywordflow">if</span> (level==1) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;CheckAll&quot;</span>,<span class="stringliteral">&quot;ERROR: Cell&#39;s no %ld  has no daughter and is inactive \n&quot;</span>,iCell);</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      }</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      <span class="keywordflow">if</span>( (cell-&gt;<a class="code" href="classTFoamCell.html#a9d6ea7d3b3773726f9aa6daa0a79dff6">GetDau0</a>()!=0) &amp;&amp; (cell-&gt;<a class="code" href="classTFoamCell.html#ac825cba2d1d09bee3421196d9cbf4bed">GetDau1</a>()!=0) &amp;&amp; (cell-&gt;<a class="code" href="classTFoamCell.html#a414aaf8866f73aee636da6b58d02a577">GetStat</a>()==1) ) {</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;         errors++;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;         <span class="keywordflow">if</span> (level==1) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;CheckAll&quot;</span>,<span class="stringliteral">&quot;ERROR: Cell&#39;s no %ld has two daughters and is active \n&quot;</span>,iCell);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      }</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      <span class="comment">// checking parents</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      <span class="keywordflow">if</span>( (cell-&gt;<a class="code" href="classTFoamCell.html#a0a6f182e476437091122b5e62e4d5dc9">GetPare</a>())!=<a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[0] ) { <span class="comment">// not child of the root</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;         <span class="keywordflow">if</span> ( (cell != cell-&gt;<a class="code" href="classTFoamCell.html#a0a6f182e476437091122b5e62e4d5dc9">GetPare</a>()-&gt;<a class="code" href="classTFoamCell.html#a9d6ea7d3b3773726f9aa6daa0a79dff6">GetDau0</a>()) &amp;&amp; (cell != cell-&gt;<a class="code" href="classTFoamCell.html#a0a6f182e476437091122b5e62e4d5dc9">GetPare</a>()-&gt;<a class="code" href="classTFoamCell.html#ac825cba2d1d09bee3421196d9cbf4bed">GetDau1</a>()) ) {</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            errors++;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            <span class="keywordflow">if</span> (level==1) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;CheckAll&quot;</span>,<span class="stringliteral">&quot;ERROR: Cell&#39;s no %ld parent not pointing to this cell\n &quot;</span>,iCell);</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;         }</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      }</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      <span class="comment">// checking daughters</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <span class="keywordflow">if</span>(cell-&gt;<a class="code" href="classTFoamCell.html#a9d6ea7d3b3773726f9aa6daa0a79dff6">GetDau0</a>()!=0) {</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;         <span class="keywordflow">if</span>(cell != (cell-&gt;<a class="code" href="classTFoamCell.html#a9d6ea7d3b3773726f9aa6daa0a79dff6">GetDau0</a>())-&gt;GetPare()) {</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            errors++;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            <span class="keywordflow">if</span> (level==1)  <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;CheckAll&quot;</span>,<span class="stringliteral">&quot;ERROR: Cell&#39;s no %ld daughter 0 not pointing to this cell \n&quot;</span>,iCell);</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;         }</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      }</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <span class="keywordflow">if</span>(cell-&gt;<a class="code" href="classTFoamCell.html#ac825cba2d1d09bee3421196d9cbf4bed">GetDau1</a>()!=0) {</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;         <span class="keywordflow">if</span>(cell != (cell-&gt;<a class="code" href="classTFoamCell.html#ac825cba2d1d09bee3421196d9cbf4bed">GetDau1</a>())-&gt;GetPare()) {</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;            errors++;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            <span class="keywordflow">if</span> (level==1) <a class="code" href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">Error</a>(<span class="stringliteral">&quot;CheckAll&quot;</span>,<span class="stringliteral">&quot;ERROR: Cell&#39;s no %ld daughter 1 not pointing to this cell \n&quot;</span>,iCell);</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;         }</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;      }</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;   }<span class="comment">// loop after cells;</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;   <span class="comment">// Check for empty cells</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;   <span class="keywordflow">for</span>(iCell=0; iCell&lt;=<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>; iCell++) {</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      cell = <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[iCell];</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      <span class="keywordflow">if</span>( (cell-&gt;<a class="code" href="classTFoamCell.html#a414aaf8866f73aee636da6b58d02a577">GetStat</a>()==1) &amp;&amp; (cell-&gt;<a class="code" href="classTFoamCell.html#a412c4db128d748691c71a393e13ff069">GetDriv</a>()==0) ) {</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;         warnings++;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;         <span class="keywordflow">if</span>(level==1) <a class="code" href="classTObject.html#a75fddd7eef38a13c1374130ec7dc5cf8">Warning</a>(<span class="stringliteral">&quot;CheckAll&quot;</span>, <span class="stringliteral">&quot;Warning: Cell no. %ld is active but empty \n&quot;</span>, iCell);</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      }</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;   }</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;   <span class="comment">// summary</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;   <span class="keywordflow">if</span>(level==1){</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      <a class="code" href="classTObject.html#afc345b772a999b230e011b316d8ae328">Info</a>(<span class="stringliteral">&quot;CheckAll&quot;</span>,<span class="stringliteral">&quot;Check has found %d errors and %d warnings \n&quot;</span>,errors, warnings);</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;   }</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;   <span class="keywordflow">if</span>(errors&gt;0){</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <a class="code" href="classTObject.html#afc345b772a999b230e011b316d8ae328">Info</a>(<span class="stringliteral">&quot;CheckAll&quot;</span>,<span class="stringliteral">&quot;Check - found total %d  errors \n&quot;</span>,errors);</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;   }</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;} <span class="comment">// Check</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="comment">/// Prints geometry of ALL cells of the FOAM</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01471"></a><span class="lineno"><a class="line" href="classTFoam.html#a12ae6612ba756daada1f4101890718b2"> 1471</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a12ae6612ba756daada1f4101890718b2">TFoam::PrintCells</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;{</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;   <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> iCell;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;   <span class="keywordflow">for</span>(iCell=0; iCell&lt;=<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>; iCell++) {</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      std::cout&lt;&lt;<span class="stringliteral">&quot;Cell[&quot;</span>&lt;&lt;iCell&lt;&lt;<span class="stringliteral">&quot;]={ &quot;</span>;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;      <span class="comment">//std::cout&lt;&lt;&quot;  &quot;&lt;&lt; fCells[iCell]&lt;&lt;&quot;  &quot;;  // extra DEBUG</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      std::cout&lt;&lt;std::endl;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[iCell]-&gt;<a class="code" href="classTFoamCell.html#a1196692953d4bc47dfdf994fa7490b7e">Print</a>(<span class="stringliteral">&quot;1&quot;</span>);</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;      std::cout&lt;&lt;<span class="stringliteral">&quot;}&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;   }</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;}</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="comment">////////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="comment">/// Debugging tool which plots 2-dimensional cells as rectangles</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment">/// in C++ format readable for root</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01488"></a><span class="lineno"><a class="line" href="classTFoam.html#a61b933a5adf469642dba184220783b5e"> 1488</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#a61b933a5adf469642dba184220783b5e">TFoam::RootPlot2dim</a>(<a class="code" href="RtypesCore_8h.html#a72a4388b7fc57f981af8c65fefcceb1f">Char_t</a> *filename)</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;{</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;   std::ofstream outfile(filename, std::ios::out);</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>   <a class="code" href="RooGaussKronrodIntegrator1D_8cxx.html#a568bf3de18e110c0e059ae112eb1996b">x1</a>,y1,<a class="code" href="RooGaussKronrodIntegrator1D_8cxx.html#a0ba9fe5ef42ef1dc6fcb59f909da7302">x2</a>,y2,<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;   <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a>    iCell;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> offs =0.1;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> lpag   =1-2*offs;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;   outfile&lt;&lt;<span class="stringliteral">&quot;{&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;   outfile&lt;&lt;<span class="stringliteral">&quot;cMap = new TCanvas(\&quot;Map1\&quot;,\&quot; Cell Map \&quot;,600,600);&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;   outfile&lt;&lt;<span class="stringliteral">&quot;TBox*a=new TBox();&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;   outfile&lt;&lt;<span class="stringliteral">&quot;a-&gt;SetFillStyle(0);&quot;</span>&lt;&lt;std::endl;  <span class="comment">// big frame</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;   outfile&lt;&lt;<span class="stringliteral">&quot;a-&gt;SetLineWidth(4);&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;   outfile&lt;&lt;<span class="stringliteral">&quot;a-&gt;SetLineColor(2);&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;   outfile&lt;&lt;<span class="stringliteral">&quot;a-&gt;DrawBox(&quot;</span>&lt;&lt;offs&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;offs&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;(offs+lpag)&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;(offs+lpag)&lt;&lt;<span class="stringliteral">&quot;);&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;   outfile&lt;&lt;<span class="stringliteral">&quot;TText*t=new TText();&quot;</span>&lt;&lt;std::endl;  <span class="comment">// text for numbering</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;   outfile&lt;&lt;<span class="stringliteral">&quot;t-&gt;SetTextColor(4);&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>&lt;51)</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      outfile&lt;&lt;<span class="stringliteral">&quot;t-&gt;SetTextSize(0.025);&quot;</span>&lt;&lt;std::endl;  <span class="comment">// text for numbering</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>&lt;251)</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      outfile&lt;&lt;<span class="stringliteral">&quot;t-&gt;SetTextSize(0.015);&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      outfile&lt;&lt;<span class="stringliteral">&quot;t-&gt;SetTextSize(0.008);&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;   outfile&lt;&lt;<span class="stringliteral">&quot;TBox*b=new TBox();&quot;</span>&lt;&lt;std::endl;  <span class="comment">// single cell</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;   outfile &lt;&lt;<span class="stringliteral">&quot;b-&gt;SetFillStyle(0);&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>==2 &amp;&amp; <a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>&lt;=2000) {</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      <a class="code" href="classTFoamVect.html">TFoamVect</a>  cellPosi(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>); <a class="code" href="classTFoamVect.html">TFoamVect</a>  cellSize(<a class="code" href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">fDim</a>);</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      outfile &lt;&lt; <span class="stringliteral">&quot;// =========== Rectangular cells  ===========&quot;</span>&lt;&lt; std::endl;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;      <span class="keywordflow">for</span>(iCell=1; iCell&lt;=<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>; iCell++) {</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;         <span class="keywordflow">if</span>( <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[iCell]-&gt;GetStat() == 1) {</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            <a class="code" href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">fCells</a>[iCell]-&gt;<a class="code" href="classTFoamCell.html#a7f6aa66669b4c5fb095cc32795a50a9f">GetHcub</a>(cellPosi,cellSize);</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            <a class="code" href="RooGaussKronrodIntegrator1D_8cxx.html#a568bf3de18e110c0e059ae112eb1996b">x1</a> = offs+lpag*(        cellPosi[0]); y1 = offs+lpag*(        cellPosi[1]);</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <a class="code" href="RooGaussKronrodIntegrator1D_8cxx.html#a0ba9fe5ef42ef1dc6fcb59f909da7302">x2</a> = offs+lpag*(cellPosi[0]+cellSize[0]); y2 = offs+lpag*(cellPosi[1]+cellSize[1]);</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            <span class="comment">//     cell rectangle</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>&lt;=2000)</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;            outfile&lt;&lt;<span class="stringliteral">&quot;b-&gt;DrawBox(&quot;</span>&lt;&lt;<a class="code" href="RooGaussKronrodIntegrator1D_8cxx.html#a568bf3de18e110c0e059ae112eb1996b">x1</a>&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;y1&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;<a class="code" href="RooGaussKronrodIntegrator1D_8cxx.html#a0ba9fe5ef42ef1dc6fcb59f909da7302">x2</a>&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;y2&lt;&lt;<span class="stringliteral">&quot;);&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;            <span class="comment">//     cell number</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">fLastCe</a>&lt;=250) {</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;               <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = offs+lpag*(cellPosi[0]+0.5*cellSize[0]); <a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a> = offs+lpag*(cellPosi[1]+0.5*cellSize[1]);</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;               outfile&lt;&lt;<span class="stringliteral">&quot;t-&gt;DrawText(&quot;</span>&lt;&lt;<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;<a class="code" href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a>&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\&quot;&quot;</span>&lt;&lt;iCell&lt;&lt;<span class="stringliteral">&quot;\&quot;&quot;</span>&lt;&lt;<span class="stringliteral">&quot;);&quot;</span>&lt;&lt;std::endl;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            }</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;         }</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      }</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;      outfile&lt;&lt;<span class="stringliteral">&quot;// ============== End Rectangles ===========&quot;</span>&lt;&lt; std::endl;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;   }<span class="comment">//kDim=2</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;   outfile &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;   outfile.close();</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;}</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div><div class="line"><a name="l01542"></a><span class="lineno"><a class="line" href="classTFoam.html#ab2fbbdb296cae1ffb01996e166d45cc4"> 1542</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classTFoam.html#ab2fbbdb296cae1ffb01996e166d45cc4">TFoam::LinkCells</a>()</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;{</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment">// Void function for backward compatibility</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;   <a class="code" href="classTObject.html#afc345b772a999b230e011b316d8ae328">Info</a>(<span class="stringliteral">&quot;LinkCells&quot;</span>, <span class="stringliteral">&quot;VOID function for backward compatibility \n&quot;</span>);</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;}</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div><div class="ttc" id="classTFoam_html_a4037d51e21d262eb04692fa3c8268dbe"><div class="ttname"><a href="classTFoam.html#a4037d51e21d262eb04692fa3c8268dbe">TFoam::fCellsAct</a></div><div class="ttdeci">TRefArray * fCellsAct</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00057">TFoam.h:57</a></div></div>
<div class="ttc" id="classTFoam_html_a5bb752728a7d25ffd78fcc9dbf180079"><div class="ttname"><a href="classTFoam.html#a5bb752728a7d25ffd78fcc9dbf180079">TFoam::fNCells</a></div><div class="ttdeci">Int_t fNCells</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00035">TFoam.h:35</a></div></div>
<div class="ttc" id="classTFoam_html_abb371f4679f22bddb17b369d9ee7f511"><div class="ttname"><a href="classTFoam.html#abb371f4679f22bddb17b369d9ee7f511">TFoam::fNoAct</a></div><div class="ttdeci">Int_t fNoAct</div><div class="ttdoc">Lists of division values encoded in one vector per direction. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00051">TFoam.h:51</a></div></div>
<div class="ttc" id="classTFoam_html_a09f87e40b4ac8bde2c7a91c2641a8231"><div class="ttname"><a href="classTFoam.html#a09f87e40b4ac8bde2c7a91c2641a8231">TFoam::CheckAll</a></div><div class="ttdeci">virtual void CheckAll(Int_t)</div><div class="ttdoc">User utility, miscellaneous and debug. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01403">TFoam.cxx:1403</a></div></div>
<div class="ttc" id="classTFoam_html_a61b933a5adf469642dba184220783b5e"><div class="ttname"><a href="classTFoam.html#a61b933a5adf469642dba184220783b5e">TFoam::RootPlot2dim</a></div><div class="ttdeci">virtual void RootPlot2dim(Char_t *)</div><div class="ttdoc">Debugging tool which plots 2-dimensional cells as rectangles in C++ format readable for root...</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01488">TFoam.cxx:1488</a></div></div>
<div class="ttc" id="classTFoam_html_a8333a56e13c4e05d824e6f1e88097ac5"><div class="ttname"><a href="classTFoam.html#a8333a56e13c4e05d824e6f1e88097ac5">TFoam::fLastCe</a></div><div class="ttdeci">Int_t fLastCe</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00052">TFoam.h:52</a></div></div>
<div class="ttc" id="classTFoamCell_html_a414aaf8866f73aee636da6b58d02a577"><div class="ttname"><a href="classTFoamCell.html#a414aaf8866f73aee636da6b58d02a577">TFoamCell::GetStat</a></div><div class="ttdeci">Int_t GetStat() const</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00068">TFoamCell.h:68</a></div></div>
<div class="ttc" id="classTH1_html_a77e71290a82517d317ea8d05e96b6c4a"><div class="ttname"><a href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">TH1::Fill</a></div><div class="ttdeci">virtual Int_t Fill(Double_t x)</div><div class="ttdoc">Increment bin with abscissa X by 1. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l03258">TH1.cxx:3258</a></div></div>
<div class="ttc" id="classTFoam_html_ac4c057ef5fe272b508f41c30a560b556"><div class="ttname"><a href="classTFoam.html#ac4c057ef5fe272b508f41c30a560b556">TFoam::fMCvect</a></div><div class="ttdeci">Double_t * fMCvect</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00063">TFoam.h:63</a></div></div>
<div class="ttc" id="tmva_2tmva_2src_2Factory_8cxx_html_a73e5b6a37db0af518793b45eba2bbe8e"><div class="ttname"><a href="tmva_2tmva_2src_2Factory_8cxx.html#a73e5b6a37db0af518793b45eba2bbe8e">sum</a></div><div class="ttdeci">static long int sum(long int i)</div><div class="ttdef"><b>Definition:</b> <a href="tmva_2tmva_2src_2Factory_8cxx_source.html#l02258">Factory.cxx:2258</a></div></div>
<div class="ttc" id="classTObjArray_html"><div class="ttname"><a href="classTObjArray.html">TObjArray</a></div><div class="ttdoc">An array of TObjects. </div><div class="ttdef"><b>Definition:</b> <a href="TObjArray_8h_source.html#l00037">TObjArray.h:37</a></div></div>
<div class="ttc" id="classTFoam_html_a2536c78efcadaa1d83007aaffa5c8a5e"><div class="ttname"><a href="classTFoam.html#a2536c78efcadaa1d83007aaffa5c8a5e">TFoam::fSumWt</a></div><div class="ttdeci">Double_t fSumWt</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00073">TFoam.h:73</a></div></div>
<div class="ttc" id="TMethodCall_8h_html"><div class="ttname"><a href="TMethodCall_8h.html">TMethodCall.h</a></div></div>
<div class="ttc" id="classTObject_html_afc345b772a999b230e011b316d8ae328"><div class="ttname"><a href="classTObject.html#afc345b772a999b230e011b316d8ae328">TObject::Info</a></div><div class="ttdeci">virtual void Info(const char *method, const char *msgfmt,...) const</div><div class="ttdoc">Issue info message. </div><div class="ttdef"><b>Definition:</b> <a href="TObject_8cxx_source.html#l00854">TObject.cxx:854</a></div></div>
<div class="ttc" id="TFoam_8cxx_html_a9ccf82f4f7b8f320984dca908f83d8fa"><div class="ttname"><a href="TFoam_8cxx.html#a9ccf82f4f7b8f320984dca908f83d8fa">BX2F</a></div><div class="ttdeci">#define BX2F(name, numb, err, text)</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00139">TFoam.cxx:139</a></div></div>
<div class="ttc" id="classTFoamMaxwt_html"><div class="ttname"><a href="classTFoamMaxwt.html">TFoamMaxwt</a></div><div class="ttdef"><b>Definition:</b> <a href="TFoamMaxwt_8h_source.html#l00018">TFoamMaxwt.h:18</a></div></div>
<div class="ttc" id="TFoamMaxwt_8h_html"><div class="ttname"><a href="TFoamMaxwt_8h.html">TFoamMaxwt.h</a></div></div>
<div class="ttc" id="classTRefArray_html_a2a4f52f10ab7d7cc29ec49d98571d44e"><div class="ttname"><a href="classTRefArray.html#a2a4f52f10ab7d7cc29ec49d98571d44e">TRefArray::Add</a></div><div class="ttdeci">void Add(TObject *obj)</div><div class="ttdef"><b>Definition:</b> <a href="TRefArray_8h_source.html#l00080">TRefArray.h:80</a></div></div>
<div class="ttc" id="classTFoam_html_ab2fbbdb296cae1ffb01996e166d45cc4"><div class="ttname"><a href="classTFoam.html#ab2fbbdb296cae1ffb01996e166d45cc4">TFoam::LinkCells</a></div><div class="ttdeci">virtual void LinkCells(void)</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01542">TFoam.cxx:1542</a></div></div>
<div class="ttc" id="classTFoam_html_a2f8bc90b862bcf37a4fdad6a68e578f7"><div class="ttname"><a href="classTFoam.html#a2f8bc90b862bcf37a4fdad6a68e578f7">TFoam::PeekMax</a></div><div class="ttdeci">virtual Long_t PeekMax()</div><div class="ttdoc">Internal subprogram used by Initialize. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00929">TFoam.cxx:929</a></div></div>
<div class="ttc" id="classTObjArray_html_a7ebdea832148e00b8805277c79de5003"><div class="ttname"><a href="classTObjArray.html#a7ebdea832148e00b8805277c79de5003">TObjArray::Delete</a></div><div class="ttdeci">virtual void Delete(Option_t *option=&quot;&quot;)</div><div class="ttdoc">Remove all objects from the array AND delete all heap based objects. </div><div class="ttdef"><b>Definition:</b> <a href="TObjArray_8cxx_source.html#l00355">TObjArray.cxx:355</a></div></div>
<div class="ttc" id="classTFoam_html_af21d1cdd3845fcd50989100601105134"><div class="ttname"><a href="classTFoam.html#af21d1cdd3845fcd50989100601105134">TFoam::GetWtParams</a></div><div class="ttdeci">virtual void GetWtParams(Double_t, Double_t &amp;, Double_t &amp;, Double_t &amp;)</div><div class="ttdoc">May be called optionally after the MC run. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01273">TFoam.cxx:1273</a></div></div>
<div class="ttc" id="classTFoam_html_a84d3266952abae597c4142ce36582cf3"><div class="ttname"><a href="classTFoam.html#a84d3266952abae597c4142ce36582cf3">TFoam::fOptPRD</a></div><div class="ttdeci">Int_t fOptPRD</div><div class="ttdoc">[fDim] Flags for inhibiting cell division </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00048">TFoam.h:48</a></div></div>
<div class="ttc" id="classTFoam_html_ad58187263ebdfa1ae2ec2dd97de33a2d"><div class="ttname"><a href="classTFoam.html#ad58187263ebdfa1ae2ec2dd97de33a2d">TFoam::fCells</a></div><div class="ttdeci">TFoamCell ** fCells</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00053">TFoam.h:53</a></div></div>
<div class="ttc" id="classTFoamCell_html_ac3cd6f51d3e8878539c921f296d608e8"><div class="ttname"><a href="classTFoamCell.html#ac3cd6f51d3e8878539c921f296d608e8">TFoamCell::SetDau1</a></div><div class="ttdeci">void SetDau1(TFoamCell *Daug)</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00074">TFoamCell.h:74</a></div></div>
<div class="ttc" id="classTRandom_html_a13cf202d07daadbc8aa08c45e3f0999b"><div class="ttname"><a href="classTRandom.html#a13cf202d07daadbc8aa08c45e3f0999b">TRandom::RndmArray</a></div><div class="ttdeci">virtual void RndmArray(Int_t n, Float_t *array)</div><div class="ttdoc">Return an array of n random numbers uniformly distributed in ]0,1]. </div><div class="ttdef"><b>Definition:</b> <a href="TRandom_8cxx_source.html#l00577">TRandom.cxx:577</a></div></div>
<div class="ttc" id="classTFoam_html_a2958c5262392625ac8905307434fdce8"><div class="ttname"><a href="classTFoam.html#a2958c5262392625ac8905307434fdce8">TFoam::Varedu</a></div><div class="ttdeci">virtual void Varedu(Double_t [], Int_t &amp;, Double_t &amp;, Double_t &amp;)</div><div class="ttdoc">Internal subrogram used by Initialize. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00705">TFoam.cxx:705</a></div></div>
<div class="ttc" id="classTFoam_html_ac397f5ff553e08a7f83c0bf4a1ae59b5"><div class="ttname"><a href="classTFoam.html#ac397f5ff553e08a7f83c0bf4a1ae59b5">TFoam::MCgenerate</a></div><div class="ttdeci">virtual Double_t MCgenerate(Double_t *MCvect)</div><div class="ttdoc">User subprogram which generates MC event and returns MC weight. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01225">TFoam.cxx:1225</a></div></div>
<div class="ttc" id="classTFoam_html_a0f43c1e4c219db5d0c814b94958f24b7"><div class="ttname"><a href="classTFoam.html#a0f43c1e4c219db5d0c814b94958f24b7">TFoam::fMCwt</a></div><div class="ttdeci">Double_t fMCwt</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00064">TFoam.h:64</a></div></div>
<div class="ttc" id="classTFoam_html_a5bd2f38254d10799a96618f647a659d9"><div class="ttname"><a href="classTFoam.html#a5bd2f38254d10799a96618f647a659d9">TFoam::fRvec</a></div><div class="ttdeci">Double_t * fRvec</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00065">TFoam.h:65</a></div></div>
<div class="ttc" id="classTFoam_html_af6f8e5ccef40afe28df095d965c404b6"><div class="ttname"><a href="classTFoam.html#af6f8e5ccef40afe28df095d965c404b6">TFoam::fNBin</a></div><div class="ttdeci">Int_t fNBin</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00042">TFoam.h:42</a></div></div>
<div class="ttc" id="classTFoam_html_a5b4152159bbd69bb2e4b06b17ef414f3"><div class="ttname"><a href="classTFoam.html#a5b4152159bbd69bb2e4b06b17ef414f3">TFoam::fMaxWtRej</a></div><div class="ttdeci">Double_t fMaxWtRej</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00056">TFoam.h:56</a></div></div>
<div class="ttc" id="classTFoam_html_a23552a188da40955fa06791e0b7fbe27"><div class="ttname"><a href="classTFoam.html#a23552a188da40955fa06791e0b7fbe27">TFoam::fNevGen</a></div><div class="ttdeci">Double_t fNevGen</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00075">TFoam.h:75</a></div></div>
<div class="ttc" id="TFoam_8h_html"><div class="ttname"><a href="TFoam_8h.html">TFoam.h</a></div></div>
<div class="ttc" id="classTFoam_html_ac90623b8b2d148f9c7d253bd61492853"><div class="ttname"><a href="classTFoam.html#ac90623b8b2d148f9c7d253bd61492853">TFoam::fVersion</a></div><div class="ttdeci">TString fVersion</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00032">TFoam.h:32</a></div></div>
<div class="ttc" id="classTString_html"><div class="ttname"><a href="classTString.html">TString</a></div><div class="ttdoc">Basic string class. </div><div class="ttdef"><b>Definition:</b> <a href="TString_8h_source.html#l00131">TString.h:131</a></div></div>
<div class="ttc" id="classTH1_html_af28db00a911cdc6475f5e8b805e34e11"><div class="ttname"><a href="classTH1.html#af28db00a911cdc6475f5e8b805e34e11">TH1::AddDirectoryStatus</a></div><div class="ttdeci">static Bool_t AddDirectoryStatus()</div><div class="ttdoc">Static function: cannot be inlined on Windows/NT. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l00705">TH1.cxx:705</a></div></div>
<div class="ttc" id="classTFoamCell_html_a1196692953d4bc47dfdf994fa7490b7e"><div class="ttname"><a href="classTFoamCell.html#a1196692953d4bc47dfdf994fa7490b7e">TFoamCell::Print</a></div><div class="ttdeci">void Print(Option_t *option) const</div><div class="ttdoc">Printout of the cell geometry parameters for the debug purpose. </div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8cxx_source.html#l00189">TFoamCell.cxx:189</a></div></div>
<div class="ttc" id="namespaceTMath_html_aaae88f888b116f98b932ba4543fa00b5"><div class="ttname"><a href="namespaceTMath.html#aaae88f888b116f98b932ba4543fa00b5">TMath::Min</a></div><div class="ttdeci">Short_t Min(Short_t a, Short_t b)</div><div class="ttdef"><b>Definition:</b> <a href="TMathBase_8h_source.html#l00180">TMathBase.h:180</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_a3885b911a54b47a4e61671f45dd45d0b"><div class="ttname"><a href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a></div><div class="ttdeci">int Int_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00041">RtypesCore.h:41</a></div></div>
<div class="ttc" id="classTFoam_html_a23e8ee341a3aaca84fbcea42b6ed3376"><div class="ttname"><a href="classTFoam.html#a23e8ee341a3aaca84fbcea42b6ed3376">TFoam::MakeEvent</a></div><div class="ttdeci">virtual void MakeEvent()</div><div class="ttdoc">User subprogram. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01152">TFoam.cxx:1152</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_aa101f564ac7b845ca31aec2fbc00ce97"><div class="ttname"><a href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a></div><div class="ttdeci">bool Bool_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00059">RtypesCore.h:59</a></div></div>
<div class="ttc" id="classTFoamCell_html_ac825cba2d1d09bee3421196d9cbf4bed"><div class="ttname"><a href="classTFoamCell.html#ac825cba2d1d09bee3421196d9cbf4bed">TFoamCell::GetDau1</a></div><div class="ttdeci">TFoamCell * GetDau1() const</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00072">TFoamCell.h:72</a></div></div>
<div class="ttc" id="classTFoam_html_a20be20446e99fdfc26955c5b389f92c4"><div class="ttname"><a href="classTFoam.html#a20be20446e99fdfc26955c5b389f92c4">TFoam::fChat</a></div><div class="ttdeci">Int_t fChat</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00039">TFoam.h:39</a></div></div>
<div class="ttc" id="classTFoam_html_aac885faf09fc637e32cb59982992e148"><div class="ttname"><a href="classTFoam.html#aac885faf09fc637e32cb59982992e148">TFoam::~TFoam</a></div><div class="ttdeci">virtual ~TFoam()</div><div class="ttdoc">Default destructor. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00263">TFoam.cxx:263</a></div></div>
<div class="ttc" id="classTFoam_html_a248c1ffc0c849f84b4854072ad0f75d5"><div class="ttname"><a href="classTFoam.html#a248c1ffc0c849f84b4854072ad0f75d5">TFoam::fSumWt2</a></div><div class="ttdeci">Double_t fSumWt2</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00073">TFoam.h:73</a></div></div>
<div class="ttc" id="classTFoam_html_a19ee4eab21f9ea6649404a33ce58e2b8"><div class="ttname"><a href="classTFoam.html#a19ee4eab21f9ea6649404a33ce58e2b8">TFoam::fRho</a></div><div class="ttdeci">TFoamIntegrand * fRho</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00067">TFoam.h:67</a></div></div>
<div class="ttc" id="classTRefArray_html"><div class="ttname"><a href="classTRefArray.html">TRefArray</a></div><div class="ttdoc">An array of references to TObjects. </div><div class="ttdef"><b>Definition:</b> <a href="TRefArray_8h_source.html#l00039">TRefArray.h:39</a></div></div>
<div class="ttc" id="classTFoamIntegrand_html"><div class="ttname"><a href="classTFoamIntegrand.html">TFoamIntegrand</a></div><div class="ttdef"><b>Definition:</b> <a href="TFoamIntegrand_8h_source.html#l00014">TFoamIntegrand.h:14</a></div></div>
<div class="ttc" id="classTFoam_html_ab960e83dda7e7825216f1afb44667c6b"><div class="ttname"><a href="classTFoam.html#ab960e83dda7e7825216f1afb44667c6b">TFoam::SetRhoInt</a></div><div class="ttdeci">virtual void SetRhoInt(Double_t(*fun)(Int_t, Double_t *))</div><div class="ttdoc">User may use this method to set the distribution object as a global function pointer (and not as an i...</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01060">TFoam.cxx:1060</a></div></div>
<div class="ttc" id="classTFoamMaxwt_html_a928bcc18579476c9560fdd571209f4c3"><div class="ttname"><a href="classTFoamMaxwt.html#a928bcc18579476c9560fdd571209f4c3">TFoamMaxwt::GetMCeff</a></div><div class="ttdeci">void GetMCeff(Double_t, Double_t &amp;, Double_t &amp;)</div><div class="ttdoc">Calculates Efficiency= aveWt/wtLim for a given tolerance level epsilon&lt;&lt;1 using information stored in...</div><div class="ttdef"><b>Definition:</b> <a href="TFoamMaxwt_8cxx_source.html#l00124">TFoamMaxwt.cxx:124</a></div></div>
<div class="ttc" id="classTFoam_html_a264e586a074266e1d9b7e27400a165fa"><div class="ttname"><a href="classTFoam.html#a264e586a074266e1d9b7e27400a165fa">TFoam::fXdivPRD</a></div><div class="ttdeci">TFoamVect ** fXdivPRD</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00049">TFoam.h:49</a></div></div>
<div class="ttc" id="classTFoam_html_a30f5b5f0fc31761dec49d9890980e049"><div class="ttname"><a href="classTFoam.html#a30f5b5f0fc31761dec49d9890980e049">TFoam::GenerCel2</a></div><div class="ttdeci">virtual void GenerCel2(TFoamCell *&amp;)</div><div class="ttdoc">Internal subprogram. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01114">TFoam.cxx:1114</a></div></div>
<div class="ttc" id="classTFoam_html_a1cfd0d2661f499734db8979881ffb7b5"><div class="ttname"><a href="classTFoam.html#a1cfd0d2661f499734db8979881ffb7b5">TFoam::fMCerror</a></div><div class="ttdeci">Double_t fMCerror</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00079">TFoam.h:79</a></div></div>
<div class="ttc" id="classTFoam_html_a035d303af1eb6dc07a800158efe37158"><div class="ttname"><a href="classTFoam.html#a035d303af1eb6dc07a800158efe37158">TFoam::MakeActiveList</a></div><div class="ttdeci">virtual void MakeActiveList()</div><div class="ttdoc">Internal subrogram used by Initialize. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00994">TFoam.cxx:994</a></div></div>
<div class="ttc" id="classTFoam_html_a567ba53409fed0bd7744694a6b73eb1e"><div class="ttname"><a href="classTFoam.html#a567ba53409fed0bd7744694a6b73eb1e">TFoam::fWtMin</a></div><div class="ttdeci">Double_t fWtMin</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00076">TFoam.h:76</a></div></div>
<div class="ttc" id="classTFoam_html_ae406c69465b2c15864c23ef4c8ac7708"><div class="ttname"><a href="classTFoam.html#ae406c69465b2c15864c23ef4c8ac7708">TFoam::fMCresult</a></div><div class="ttdeci">Double_t fMCresult</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00078">TFoam.h:78</a></div></div>
<div class="ttc" id="namespaceTMath_html_af682354cea223351f1306bf98a858dfd"><div class="ttname"><a href="namespaceTMath.html#af682354cea223351f1306bf98a858dfd">TMath::Abs</a></div><div class="ttdeci">Short_t Abs(Short_t d)</div><div class="ttdef"><b>Definition:</b> <a href="TMathBase_8h_source.html#l00120">TMathBase.h:120</a></div></div>
<div class="ttc" id="TFoamVect_8h_html"><div class="ttname"><a href="TFoamVect_8h.html">TFoamVect.h</a></div></div>
<div class="ttc" id="classTFoam_html_af77b68c20f6239760ddc187f337cd624"><div class="ttname"><a href="classTFoam.html#af77b68c20f6239760ddc187f337cd624">TFoam::Grow</a></div><div class="ttdeci">virtual void Grow()</div><div class="ttdoc">Internal subrogram used by Initialize. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00894">TFoam.cxx:894</a></div></div>
<div class="ttc" id="classTH1_html_a490b9d2cf9460f8428f104d7e0f82614"><div class="ttname"><a href="classTH1.html#a490b9d2cf9460f8428f104d7e0f82614">TH1::AddDirectory</a></div><div class="ttdeci">static void AddDirectory(Bool_t add=kTRUE)</div><div class="ttdoc">Sets the flag controlling the automatic add of histograms in memory. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l01225">TH1.cxx:1225</a></div></div>
<div class="ttc" id="namespacexmlio_html_a08382af5894f1d98d5d0c41660c4f32f"><div class="ttname"><a href="namespacexmlio.html#a08382af5894f1d98d5d0c41660c4f32f">xmlio::Name</a></div><div class="ttdeci">const char * Name</div><div class="ttdef"><b>Definition:</b> <a href="TXMLSetup_8cxx_source.html#l00066">TXMLSetup.cxx:66</a></div></div>
<div class="ttc" id="TInterpreter_8h_html"><div class="ttname"><a href="TInterpreter_8h.html">TInterpreter.h</a></div></div>
<div class="ttc" id="classTFoam_html_a8c6c2006dfca062da0123b950ba23a5a"><div class="ttname"><a href="classTFoam.html#a8c6c2006dfca062da0123b950ba23a5a">TFoam::SetXdivPRD</a></div><div class="ttdeci">virtual void SetXdivPRD(Int_t, Int_t, Double_t[])</div><div class="ttdoc">This should be called before Initialize, after setting kDim It predefines values of the cell division...</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01363">TFoam.cxx:1363</a></div></div>
<div class="ttc" id="classTMethodCall_html_ae3f721deb668578ddbc74bdefedba4b8"><div class="ttname"><a href="classTMethodCall.html#ae3f721deb668578ddbc74bdefedba4b8">TMethodCall::SetParamPtrs</a></div><div class="ttdeci">void SetParamPtrs(void *paramArr, Int_t nparam=-1)</div><div class="ttdoc">ParamArr is an array containing the function argument values. </div><div class="ttdef"><b>Definition:</b> <a href="TMethodCall_8cxx_source.html#l00585">TMethodCall.cxx:585</a></div></div>
<div class="ttc" id="classTFoam_html_a55499afc42f0f441b1cf07c7037b6b55"><div class="ttname"><a href="classTFoam.html#a55499afc42f0f441b1cf07c7037b6b55">TFoam::GetMCwt</a></div><div class="ttdeci">virtual Double_t GetMCwt()</div><div class="ttdoc">User may get weight MC weight using this method. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01210">TFoam.cxx:1210</a></div></div>
<div class="ttc" id="TMath_8h_html_acdb55c1010a6c379a49db0201bf55d89"><div class="ttname"><a href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a></div><div class="ttdeci">double sqrt(double)</div></div>
<div class="ttc" id="TFoamIntegrand_8h_html"><div class="ttname"><a href="TFoamIntegrand_8h.html">TFoamIntegrand.h</a></div></div>
<div class="ttc" id="RooGaussKronrodIntegrator1D_8cxx_html_a0ba9fe5ef42ef1dc6fcb59f909da7302"><div class="ttname"><a href="RooGaussKronrodIntegrator1D_8cxx.html#a0ba9fe5ef42ef1dc6fcb59f909da7302">x2</a></div><div class="ttdeci">static const double x2[5]</div><div class="ttdef"><b>Definition:</b> <a href="RooGaussKronrodIntegrator1D_8cxx_source.html#l00344">RooGaussKronrodIntegrator1D.cxx:344</a></div></div>
<div class="ttc" id="classTFoam_html_a582600cf7aa89f15eb3915d3c07fc473"><div class="ttname"><a href="classTFoam.html#a582600cf7aa89f15eb3915d3c07fc473">TFoam::ResetRho</a></div><div class="ttdeci">virtual void ResetRho(TFoamIntegrand *Rho)</div><div class="ttdoc">User may optionally reset the distribution using this method Usually it is done when FOAM object is r...</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01079">TFoam.cxx:1079</a></div></div>
<div class="ttc" id="legend1_8C_html_a13c6713ae496caa8195647f76887f926"><div class="ttname"><a href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a></div><div class="ttdeci">Double_t x[n]</div><div class="ttdef"><b>Definition:</b> <a href="legend1_8C_source.html#l00017">legend1.C:17</a></div></div>
<div class="ttc" id="TFoamCell_8h_html"><div class="ttname"><a href="TFoamCell_8h.html">TFoamCell.h</a></div></div>
<div class="ttc" id="classTFoam_html_a6fb0d8cd68926217c671040c42227e5e"><div class="ttname"><a href="classTFoam.html#a6fb0d8cd68926217c671040c42227e5e">TFoam::fMethodCall</a></div><div class="ttdeci">TMethodCall * fMethodCall</div><div class="ttdoc">Pointer to the user-defined integrand function/distribution. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00068">TFoam.h:68</a></div></div>
<div class="ttc" id="classTRandom_html"><div class="ttname"><a href="classTRandom.html">TRandom</a></div><div class="ttdoc"> This is the base class for the ROOT Random number generators. </div><div class="ttdef"><b>Definition:</b> <a href="TRandom_8h_source.html#l00027">TRandom.h:27</a></div></div>
<div class="ttc" id="classTFoam_html_a12ae6612ba756daada1f4101890718b2"><div class="ttname"><a href="classTFoam.html#a12ae6612ba756daada1f4101890718b2">TFoam::PrintCells</a></div><div class="ttdeci">virtual void PrintCells()</div><div class="ttdoc">Prints geometry of ALL cells of the FOAM. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01471">TFoam.cxx:1471</a></div></div>
<div class="ttc" id="classTFoam_html_abe93c1b1556a8c9d17de4081fdfb1641"><div class="ttname"><a href="classTFoam.html#abe93c1b1556a8c9d17de4081fdfb1641">TFoam::fNEffev</a></div><div class="ttdeci">Long_t fNEffev</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00072">TFoam.h:72</a></div></div>
<div class="ttc" id="classTFoam_html_ac0aa4bc25859a420d0df7dd4ad17178b"><div class="ttname"><a href="classTFoam.html#ac0aa4bc25859a420d0df7dd4ad17178b">TFoam::fOptRej</a></div><div class="ttdeci">Int_t fOptRej</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00040">TFoam.h:40</a></div></div>
<div class="ttc" id="classTRefArray_html_ac52371aea04391462da4358302b8593e"><div class="ttname"><a href="classTRefArray.html#ac52371aea04391462da4358302b8593e">TRefArray::At</a></div><div class="ttdeci">TObject * At(Int_t idx) const</div><div class="ttdef"><b>Definition:</b> <a href="TRefArray_8h_source.html#l00180">TRefArray.h:180</a></div></div>
<div class="ttc" id="TFoam_8cxx_html_a30a4fd0f6d19430b51d6aa8656a1c78a"><div class="ttname"><a href="TFoam_8cxx.html#a30a4fd0f6d19430b51d6aa8656a1c78a">BX1I</a></div><div class="ttdeci">#define BX1I(name, numb, text)</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00135">TFoam.cxx:135</a></div></div>
<div class="ttc" id="classTFoam_html_a81e01755823887ddcbbf723fc14beb24"><div class="ttname"><a href="classTFoam.html#a81e01755823887ddcbbf723fc14beb24">TFoam::Sqr</a></div><div class="ttdeci">Double_t Sqr(Double_t x) const</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00149">TFoam.h:149</a></div></div>
<div class="ttc" id="h1analysisProxy_8h_html_a351c2b9335dfcbe83de6eb9629c2a0e3"><div class="ttname"><a href="h1analysisProxy_8h.html#a351c2b9335dfcbe83de6eb9629c2a0e3">sigma</a></div><div class="ttdeci">const Double_t sigma</div><div class="ttdef"><b>Definition:</b> <a href="h1analysisProxy_8h_source.html#l00011">h1analysisProxy.h:11</a></div></div>
<div class="ttc" id="classTFoam_html_ade7af279b88fafa726e5f7be46b55b86"><div class="ttname"><a href="classTFoam.html#ade7af279b88fafa726e5f7be46b55b86">TFoam::fHistEdg</a></div><div class="ttdeci">TObjArray * fHistEdg</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00059">TFoam.h:59</a></div></div>
<div class="ttc" id="classTH1D_html_a0e2aa2350d4c0cd7bbcaccb29bff8760"><div class="ttname"><a href="classTH1D.html#a0e2aa2350d4c0cd7bbcaccb29bff8760">TH1D::Reset</a></div><div class="ttdeci">virtual void Reset(Option_t *option=&quot;&quot;)</div><div class="ttdoc">Reset. </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8cxx_source.html#l09698">TH1.cxx:9698</a></div></div>
<div class="ttc" id="classTFoamCell_html_a0ff5fd567b99cbdcc20954c85f4c65cf"><div class="ttname"><a href="classTFoamCell.html#a0ff5fd567b99cbdcc20954c85f4c65cf">TFoamCell::CalcVolume</a></div><div class="ttdeci">void CalcVolume()</div><div class="ttdoc">Calculates volume of the cell using size params which are calculated. </div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8cxx_source.html#l00174">TFoamCell.cxx:174</a></div></div>
<div class="ttc" id="classTFoamCell_html_a9d6ea7d3b3773726f9aa6daa0a79dff6"><div class="ttname"><a href="classTFoamCell.html#a9d6ea7d3b3773726f9aa6daa0a79dff6">TFoamCell::GetDau0</a></div><div class="ttdeci">TFoamCell * GetDau0() const</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00071">TFoamCell.h:71</a></div></div>
<div class="ttc" id="classTFoamCell_html_a66d40f9f7505e0afb793b0d242bbe30e"><div class="ttname"><a href="classTFoamCell.html#a66d40f9f7505e0afb793b0d242bbe30e">TFoamCell::GetPrim</a></div><div class="ttdeci">Double_t GetPrim() const</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00063">TFoamCell.h:63</a></div></div>
<div class="ttc" id="classTFoam_html_abe1846587b7c48d1511fe3bf5971d6b3"><div class="ttname"><a href="classTFoam.html#abe1846587b7c48d1511fe3bf5971d6b3">TFoam::Finalize</a></div><div class="ttdeci">virtual void Finalize(Double_t &amp;, Double_t &amp;)</div><div class="ttdoc">May be called optionally by the user after the MC run. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01286">TFoam.cxx:1286</a></div></div>
<div class="ttc" id="classTRandom_html_af504d4f838ab09eb48b7c252615563aa"><div class="ttname"><a href="classTRandom.html#af504d4f838ab09eb48b7c252615563aa">TRandom::Rndm</a></div><div class="ttdeci">virtual Double_t Rndm()</div><div class="ttdoc">Machine independent random number generator. </div><div class="ttdef"><b>Definition:</b> <a href="TRandom_8cxx_source.html#l00541">TRandom.cxx:541</a></div></div>
<div class="ttc" id="classTFoamCell_html_a086f12742a18410ac86b441ae8f7d7ac"><div class="ttname"><a href="classTFoamCell.html#a086f12742a18410ac86b441ae8f7d7ac">TFoamCell::SetXdiv</a></div><div class="ttdeci">void SetXdiv(Double_t Xdiv)</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00055">TFoamCell.h:55</a></div></div>
<div class="ttc" id="TFoam_8cxx_html_a675bf9bc58e8545c648be3aab07403fe"><div class="ttname"><a href="TFoam_8cxx.html#a675bf9bc58e8545c648be3aab07403fe">BXTXT</a></div><div class="ttdeci">#define BXTXT(text)</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00133">TFoam.cxx:133</a></div></div>
<div class="ttc" id="classTFoam_html_ac29223eb2df913fc4223af49b940d6e0"><div class="ttname"><a href="classTFoam.html#ac29223eb2df913fc4223af49b940d6e0">TFoam::fPrimAcu</a></div><div class="ttdeci">Double_t * fPrimAcu</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00058">TFoam.h:58</a></div></div>
<div class="ttc" id="classTFoam_html_a6a31e33dc6a72c83bddea5d6c24d2991"><div class="ttname"><a href="classTFoam.html#a6a31e33dc6a72c83bddea5d6c24d2991">TFoam::MakeAlpha</a></div><div class="ttdeci">virtual void MakeAlpha()</div><div class="ttdoc">Internal subrogram used by Initialize. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00879">TFoam.cxx:879</a></div></div>
<div class="ttc" id="classTFoamCell_html_acd0c5e7ff58e97dcfbf5a9251e42b304"><div class="ttname"><a href="classTFoamCell.html#acd0c5e7ff58e97dcfbf5a9251e42b304">TFoamCell::SetDriv</a></div><div class="ttdeci">void SetDriv(Double_t Driv)</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00065">TFoamCell.h:65</a></div></div>
<div class="ttc" id="classTFoam_html_a16d0cb66afd6b5f55f0d792c03f0a211"><div class="ttname"><a href="classTFoam.html#a16d0cb66afd6b5f55f0d792c03f0a211">TFoam::GetMCvect</a></div><div class="ttdeci">virtual void GetMCvect(Double_t *)</div><div class="ttdoc">User may get generated MC point/vector with help of this method. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01202">TFoam.cxx:1202</a></div></div>
<div class="ttc" id="classTFoam_html_a624774b519e7347376212fa1313c98fc"><div class="ttname"><a href="classTFoam.html#a624774b519e7347376212fa1313c98fc">TFoam::fAlpha</a></div><div class="ttdeci">Double_t * fAlpha</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00081">TFoam.h:81</a></div></div>
<div class="ttc" id="TRefArray_8h_html"><div class="ttname"><a href="TRefArray_8h.html">TRefArray.h</a></div></div>
<div class="ttc" id="classTFoam_html_a591ba605708cabe87ef3277cc3a67bfa"><div class="ttname"><a href="classTFoam.html#a591ba605708cabe87ef3277cc3a67bfa">TFoam::fEvPerBin</a></div><div class="ttdeci">Int_t fEvPerBin</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00044">TFoam.h:44</a></div></div>
<div class="ttc" id="classTFoam_html_a96e9e404ee4b547f33b473f804a14550"><div class="ttname"><a href="classTFoam.html#a96e9e404ee4b547f33b473f804a14550">TFoam::SetInhiDiv</a></div><div class="ttdeci">virtual void SetInhiDiv(Int_t, Int_t)</div><div class="ttdoc">This can be called before Initialize, after setting kDim It defines which variables are excluded in t...</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01338">TFoam.cxx:1338</a></div></div>
<div class="ttc" id="classTFoamIntegrand_html_a0403f43554c1e4312efe54944ae7adbf"><div class="ttname"><a href="classTFoamIntegrand.html#a0403f43554c1e4312efe54944ae7adbf">TFoamIntegrand::Density</a></div><div class="ttdeci">virtual Double_t Density(Int_t ndim, Double_t *)=0</div></div>
<div class="ttc" id="classTFoamCell_html_ae818da74fa2085d36228dc41d63020a3"><div class="ttname"><a href="classTFoamCell.html#ae818da74fa2085d36228dc41d63020a3">TFoamCell::SetIntg</a></div><div class="ttdeci">void SetIntg(Double_t Intg)</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00064">TFoamCell.h:64</a></div></div>
<div class="ttc" id="classTFoamCell_html_aab2f2cd7db6945b48eda4c3845070652"><div class="ttname"><a href="classTFoamCell.html#aab2f2cd7db6945b48eda4c3845070652">TFoamCell::GetIntg</a></div><div class="ttdeci">Double_t GetIntg() const</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00061">TFoamCell.h:61</a></div></div>
<div class="ttc" id="classTFoamCell_html_a1f7b823f4c86882d8e6a749bcea97282"><div class="ttname"><a href="classTFoamCell.html#a1f7b823f4c86882d8e6a749bcea97282">TFoamCell::GetVolume</a></div><div class="ttdeci">Double_t GetVolume() const</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00060">TFoamCell.h:60</a></div></div>
<div class="ttc" id="classTObject_html_abe1fb206304cfa1b8d1e77a4a4fd0120"><div class="ttname"><a href="classTObject.html#abe1fb206304cfa1b8d1e77a4a4fd0120">TObject::Error</a></div><div class="ttdeci">virtual void Error(const char *method, const char *msgfmt,...) const</div><div class="ttdoc">Issue error message. </div><div class="ttdef"><b>Definition:</b> <a href="TObject_8cxx_source.html#l00880">TObject.cxx:880</a></div></div>
<div class="ttc" id="classTFoam_html_a3bcca3b6029e760b7770a3013fa9ca14"><div class="ttname"><a href="classTFoam.html#a3bcca3b6029e760b7770a3013fa9ca14">TFoam::Initialize</a></div><div class="ttdeci">virtual void Initialize()</div><div class="ttdoc">Basic initialization of FOAM invoked by the user. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00357">TFoam.cxx:357</a></div></div>
<div class="ttc" id="classTFoam_html_ab0cbe0d35b1073cf35be21e5616f5f05"><div class="ttname"><a href="classTFoam.html#ab0cbe0d35b1073cf35be21e5616f5f05">TFoam::fMaskDiv</a></div><div class="ttdeci">Int_t * fMaskDiv</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00046">TFoam.h:46</a></div></div>
<div class="ttc" id="classTFoamCell_html_a412c4db128d748691c71a393e13ff069"><div class="ttname"><a href="classTFoamCell.html#a412c4db128d748691c71a393e13ff069">TFoamCell::GetDriv</a></div><div class="ttdeci">Double_t GetDriv() const</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00062">TFoamCell.h:62</a></div></div>
<div class="ttc" id="classTFoamCell_html_a0a6f182e476437091122b5e62e4d5dc9"><div class="ttname"><a href="classTFoamCell.html#a0a6f182e476437091122b5e62e4d5dc9">TFoamCell::GetPare</a></div><div class="ttdeci">TFoamCell * GetPare() const</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00070">TFoamCell.h:70</a></div></div>
<div class="ttc" id="classTFoam_html_a0ef363820f5b178be9ca03d812b2cd38"><div class="ttname"><a href="classTFoam.html#a0ef363820f5b178be9ca03d812b2cd38">TFoam::fName</a></div><div class="ttdeci">TString fName</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00031">TFoam.h:31</a></div></div>
<div class="ttc" id="classTH1D_html"><div class="ttname"><a href="classTH1D.html">TH1D</a></div><div class="ttdoc">1-D histogram with a double per channel (see TH1 documentation)} </div><div class="ttdef"><b>Definition:</b> <a href="TH1_8h_source.html#l00614">TH1.h:614</a></div></div>
<div class="ttc" id="classTFoamCell_html_a50e2e4ba6158af319467fdb3a011efc7"><div class="ttname"><a href="classTFoamCell.html#a50e2e4ba6158af319467fdb3a011efc7">TFoamCell::SetStat</a></div><div class="ttdeci">void SetStat(Int_t Stat)</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00069">TFoamCell.h:69</a></div></div>
<div class="ttc" id="classTFoam_html_a9c10369f795e4ea1205b6e24dcd2a0f8"><div class="ttname"><a href="classTFoam.html#a9c10369f795e4ea1205b6e24dcd2a0f8">TFoam::fWtMax</a></div><div class="ttdeci">Double_t fWtMax</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00076">TFoam.h:76</a></div></div>
<div class="ttc" id="classTFoam_html_ad299f252e7232d9777d8a39a20699297"><div class="ttname"><a href="classTFoam.html#ad299f252e7232d9777d8a39a20699297">TFoam::fDim</a></div><div class="ttdeci">Int_t fDim</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00034">TFoam.h:34</a></div></div>
<div class="ttc" id="TFoam_8cxx_html_ab312b21ef43740f275186543f0bc5554"><div class="ttname"><a href="TFoam_8cxx.html#ab312b21ef43740f275186543f0bc5554">gVlow</a></div><div class="ttdeci">static const Double_t gVlow</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00148">TFoam.cxx:148</a></div></div>
<div class="ttc" id="TFoam_8cxx_html_a6692b82cba0b23a6b59a8e498f9519a5"><div class="ttname"><a href="TFoam_8cxx.html#a6692b82cba0b23a6b59a8e498f9519a5">BXCLO</a></div><div class="ttdeci">#define BXCLO</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00142">TFoam.cxx:142</a></div></div>
<div class="ttc" id="Riostream_8h_html"><div class="ttname"><a href="Riostream_8h.html">Riostream.h</a></div></div>
<div class="ttc" id="classTFoamCell_html_ab9a18c26dfb26260bc7e4da8e7708577"><div class="ttname"><a href="classTFoamCell.html#ab9a18c26dfb26260bc7e4da8e7708577">TFoamCell::Fill</a></div><div class="ttdeci">void Fill(Int_t, TFoamCell *, TFoamCell *, TFoamCell *)</div><div class="ttdoc">Fills in certain data into newly allocated cell. </div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8cxx_source.html#l00103">TFoamCell.cxx:103</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_a7e568baf910535e8ffd438acb843434d"><div class="ttname"><a href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a></div><div class="ttdeci">const Bool_t kFALSE</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00088">RtypesCore.h:88</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_a84701346fdad56d1d91e06fcbc1b87dc"><div class="ttname"><a href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a></div><div class="ttdeci">long Long_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00050">RtypesCore.h:50</a></div></div>
<div class="ttc" id="classTFoam_html_a4920ec5f559a372208bc2f025562e248"><div class="ttname"><a href="classTFoam.html#a4920ec5f559a372208bc2f025562e248">TFoam::fRNmax</a></div><div class="ttdeci">Int_t fRNmax</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00036">TFoam.h:36</a></div></div>
<div class="ttc" id="classTFoamCell_html_a7b7fd789b6a0abe41ffc07978e1a139d"><div class="ttname"><a href="classTFoamCell.html#a7b7fd789b6a0abe41ffc07978e1a139d">TFoamCell::GetBest</a></div><div class="ttdeci">Int_t GetBest() const</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00053">TFoamCell.h:53</a></div></div>
<div class="ttc" id="classTFoam_html_afe76adaadb6efdb176587ea95299e1c9"><div class="ttname"><a href="classTFoam.html#afe76adaadb6efdb176587ea95299e1c9">TFoam::Carver</a></div><div class="ttdeci">virtual void Carver(Int_t &amp;, Double_t &amp;, Double_t &amp;)</div><div class="ttdoc">Internal subrogram used by Initialize. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00781">TFoam.cxx:781</a></div></div>
<div class="ttc" id="classTFoamVect_html"><div class="ttname"><a href="classTFoamVect.html">TFoamVect</a></div><div class="ttdef"><b>Definition:</b> <a href="TFoamVect_8h_source.html#l00018">TFoamVect.h:18</a></div></div>
<div class="ttc" id="RooGaussKronrodIntegrator1D_8cxx_html_a568bf3de18e110c0e059ae112eb1996b"><div class="ttname"><a href="RooGaussKronrodIntegrator1D_8cxx.html#a568bf3de18e110c0e059ae112eb1996b">x1</a></div><div class="ttdeci">static const double x1[5]</div><div class="ttdef"><b>Definition:</b> <a href="RooGaussKronrodIntegrator1D_8cxx_source.html#l00326">RooGaussKronrodIntegrator1D.cxx:326</a></div></div>
<div class="ttc" id="Rtypes_8h_html_a3f9bf160bbbb44209e95556960836b96"><div class="ttname"><a href="Rtypes_8h.html#a3f9bf160bbbb44209e95556960836b96">ClassImp</a></div><div class="ttdeci">#define ClassImp(name)</div><div class="ttdef"><b>Definition:</b> <a href="Rtypes_8h_source.html#l00365">Rtypes.h:365</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_ab9b5334647b78ec4256db251e3ae1fc6"><div class="ttname"><a href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a></div><div class="ttdeci">double Double_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00055">RtypesCore.h:55</a></div></div>
<div class="ttc" id="classTFoamCell_html_a7f6aa66669b4c5fb095cc32795a50a9f"><div class="ttname"><a href="classTFoamCell.html#a7f6aa66669b4c5fb095cc32795a50a9f">TFoamCell::GetHcub</a></div><div class="ttdeci">void GetHcub(TFoamVect &amp;, TFoamVect &amp;) const</div><div class="ttdoc">Provides size and position of the cell These parameter are calculated by analyzing information in all...</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8cxx_source.html#l00120">TFoamCell.cxx:120</a></div></div>
<div class="ttc" id="TRandom_8h_html"><div class="ttname"><a href="TRandom_8h.html">TRandom.h</a></div></div>
<div class="ttc" id="classTFoam_html_a8f741bf8e5dcb56ef4938fe97590948f"><div class="ttname"><a href="classTFoam.html#a8f741bf8e5dcb56ef4938fe97590948f">TFoam::fSumOve</a></div><div class="ttdeci">Double_t fSumOve</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00074">TFoam.h:74</a></div></div>
<div class="ttc" id="legend1_8C_html_a1380cd153a0fc78015dd604dbcb6c841"><div class="ttname"><a href="legend1_8C.html#a1380cd153a0fc78015dd604dbcb6c841">y</a></div><div class="ttdeci">Double_t y[n]</div><div class="ttdef"><b>Definition:</b> <a href="legend1_8C_source.html#l00017">legend1.C:17</a></div></div>
<div class="ttc" id="TFoam_8cxx_html_aeff7a5ba4f2535abfd56874d716676a1"><div class="ttname"><a href="TFoam_8cxx.html#aeff7a5ba4f2535abfd56874d716676a1">BXOPE</a></div><div class="ttdeci">#define BXOPE</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00130">TFoam.cxx:130</a></div></div>
<div class="ttc" id="classTFoam_html_ad696f0c559ff6d29bc773822df842012"><div class="ttname"><a href="classTFoam.html#ad696f0c559ff6d29bc773822df842012">TFoam::SetPseRan</a></div><div class="ttdeci">virtual void SetPseRan(TRandom *PseRan)</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00121">TFoam.h:121</a></div></div>
<div class="ttc" id="TRolke_8cxx_html_a680432d265de4ea2534f8ec32f1aa417"><div class="ttname"><a href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a></div><div class="ttdeci">you should not use this method at all Int_t Int_t Double_t Double_t Double_t e</div><div class="ttdef"><b>Definition:</b> <a href="TRolke_8cxx_source.html#l00630">TRolke.cxx:630</a></div></div>
<div class="ttc" id="classTFoam_html_a21e66a7e649a640bab3e5f233b14a3cf"><div class="ttname"><a href="classTFoam.html#a21e66a7e649a640bab3e5f233b14a3cf">TFoam::InitCells</a></div><div class="ttdeci">virtual void InitCells()</div><div class="ttdoc">Internal subprogram used by Initialize. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00481">TFoam.cxx:481</a></div></div>
<div class="ttc" id="classTFoam_html_a62ab1b7b59427c82239acd39706e6f13"><div class="ttname"><a href="classTFoam.html#a62ab1b7b59427c82239acd39706e6f13">TFoam::fOptDrive</a></div><div class="ttdeci">Int_t fOptDrive</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00038">TFoam.h:38</a></div></div>
<div class="ttc" id="classTFoamCell_html_aaad69abc8acef72931afde11f3bca1a1"><div class="ttname"><a href="classTFoamCell.html#aaad69abc8acef72931afde11f3bca1a1">TFoamCell::SetSerial</a></div><div class="ttdeci">void SetSerial(Int_t Serial)</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00075">TFoamCell.h:75</a></div></div>
<div class="ttc" id="classTObject_html"><div class="ttname"><a href="classTObject.html">TObject</a></div><div class="ttdoc">Mother of all ROOT objects. </div><div class="ttdef"><b>Definition:</b> <a href="TObject_8h_source.html#l00037">TObject.h:37</a></div></div>
<div class="ttc" id="RtypesCore_8h_html_a72a4388b7fc57f981af8c65fefcceb1f"><div class="ttname"><a href="RtypesCore_8h.html#a72a4388b7fc57f981af8c65fefcceb1f">Char_t</a></div><div class="ttdeci">char Char_t</div><div class="ttdef"><b>Definition:</b> <a href="RtypesCore_8h_source.html#l00029">RtypesCore.h:29</a></div></div>
<div class="ttc" id="classTFoam_html_acfa16bd47ac7c6698f5fab8455bdf56c"><div class="ttname"><a href="classTFoam.html#acfa16bd47ac7c6698f5fab8455bdf56c">TFoam::CellFill</a></div><div class="ttdeci">virtual Int_t CellFill(Int_t, TFoamCell *)</div><div class="ttdoc">Internal subprogram used by Initialize. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00513">TFoam.cxx:513</a></div></div>
<div class="ttc" id="classTFoam_html_a3ef5aed441198587dbce162fe8515a84"><div class="ttname"><a href="classTFoam.html#a3ef5aed441198587dbce162fe8515a84">TFoam::GetIntNorm</a></div><div class="ttdeci">virtual void GetIntNorm(Double_t &amp;, Double_t &amp;)</div><div class="ttdoc">User subprogram. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01256">TFoam.cxx:1256</a></div></div>
<div class="ttc" id="classTFoamCell_html"><div class="ttname"><a href="classTFoamCell.html">TFoamCell</a></div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00020">TFoamCell.h:20</a></div></div>
<div class="ttc" id="classTFoam_html_a6430c3a52917e5c9b1f3490754deec85"><div class="ttname"><a href="classTFoam.html#a6430c3a52917e5c9b1f3490754deec85">TFoam::Explore</a></div><div class="ttdeci">virtual void Explore(TFoamCell *Cell)</div><div class="ttdoc">Internal subprogram used by Initialize. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00554">TFoam.cxx:554</a></div></div>
<div class="ttc" id="classTFoam_html_ad3022d8480a696ac4351487380d87aa7"><div class="ttname"><a href="classTFoam.html#ad3022d8480a696ac4351487380d87aa7">TFoam::fDate</a></div><div class="ttdeci">TString fDate</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00033">TFoam.h:33</a></div></div>
<div class="ttc" id="classTFoam_html_a88cd859d30ef713e54cfe8076400896e"><div class="ttname"><a href="classTFoam.html#a88cd859d30ef713e54cfe8076400896e">TFoam::fHistDbg</a></div><div class="ttdeci">TObjArray * fHistDbg</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00060">TFoam.h:60</a></div></div>
<div class="ttc" id="classTMethodCall_html_aca3bb7a7f971a91a1984e22b2bb97f24"><div class="ttname"><a href="classTMethodCall.html#aca3bb7a7f971a91a1984e22b2bb97f24">TMethodCall::Execute</a></div><div class="ttdeci">void Execute(const char *, const char *, int *=0)</div><div class="ttdoc">Execute method on this object with the given parameter string, e.g. </div><div class="ttdef"><b>Definition:</b> <a href="TMethodCall_8h_source.html#l00064">TMethodCall.h:64</a></div></div>
<div class="ttc" id="namespaceTMath_html_a38e1c23e08564d17051526d7e0a5364d"><div class="ttname"><a href="namespaceTMath.html#a38e1c23e08564d17051526d7e0a5364d">TMath::Max</a></div><div class="ttdeci">Short_t Max(Short_t a, Short_t b)</div><div class="ttdef"><b>Definition:</b> <a href="TMathBase_8h_source.html#l00212">TMathBase.h:212</a></div></div>
<div class="ttc" id="classTFoam_html_a1e6a4bef13814c516e731df1ecd8e9ee"><div class="ttname"><a href="classTFoam.html#a1e6a4bef13814c516e731df1ecd8e9ee">TFoam::fPrime</a></div><div class="ttdeci">Double_t fPrime</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00077">TFoam.h:77</a></div></div>
<div class="ttc" id="classTFoamCell_html_af5c4149a5aee111e0fd256df1170c536"><div class="ttname"><a href="classTFoamCell.html#af5c4149a5aee111e0fd256df1170c536">TFoamCell::SetBest</a></div><div class="ttdeci">void SetBest(Int_t Best)</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00054">TFoamCell.h:54</a></div></div>
<div class="ttc" id="classTFoamCell_html_acba04754de3ce6748d83343464b29dc8"><div class="ttname"><a href="classTFoamCell.html#acba04754de3ce6748d83343464b29dc8">TFoamCell::SetPrim</a></div><div class="ttdeci">void SetPrim(Double_t Prim)</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00066">TFoamCell.h:66</a></div></div>
<div class="ttc" id="TH1_8h_html"><div class="ttname"><a href="TH1_8h.html">TH1.h</a></div></div>
<div class="ttc" id="classTFoam_html_a6d76eebaffa18117641f69c10536b54c"><div class="ttname"><a href="classTFoam.html#a6d76eebaffa18117641f69c10536b54c">TFoam::ResetPseRan</a></div><div class="ttdeci">virtual void ResetPseRan(TRandom *PseRan)</div><div class="ttdoc">User may optionally reset random number generator using this method Usually it is done when FOAM obje...</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01037">TFoam.cxx:1037</a></div></div>
<div class="ttc" id="classTFoamMaxwt_html_a1b88d2e7ed873139638191d27cac6460"><div class="ttname"><a href="classTFoamMaxwt.html#a1b88d2e7ed873139638191d27cac6460">TFoamMaxwt::Fill</a></div><div class="ttdeci">void Fill(Double_t)</div><div class="ttdoc">Filling analyzed weight. </div><div class="ttdef"><b>Definition:</b> <a href="TFoamMaxwt_8cxx_source.html#l00097">TFoamMaxwt.cxx:97</a></div></div>
<div class="ttc" id="TFoam_8cxx_html_a1aeeba9847685e5f357b230c4fee9758"><div class="ttname"><a href="TFoam_8cxx.html#a1aeeba9847685e5f357b230c4fee9758">BX1F</a></div><div class="ttdeci">#define BX1F(name, numb, text)</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00137">TFoam.cxx:137</a></div></div>
<div class="ttc" id="classTFoam_html_a4105266375bfe6f0807109680f6bc0d3"><div class="ttname"><a href="classTFoam.html#a4105266375bfe6f0807109680f6bc0d3">TFoam::fMCMonit</a></div><div class="ttdeci">TFoamMaxwt * fMCMonit</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00055">TFoam.h:55</a></div></div>
<div class="ttc" id="THbookFile_8cxx_html_aa1a5cf287dc90c5ea8a4fb820f78b708"><div class="ttname"><a href="THbookFile_8cxx.html#aa1a5cf287dc90c5ea8a4fb820f78b708">hi</a></div><div class="ttdeci">float type_of_call hi(const int &amp;, const int &amp;)</div></div>
<div class="ttc" id="classTFoam_html_a676fd2679208cfcc67acbb899e823a26"><div class="ttname"><a href="classTFoam.html#a676fd2679208cfcc67acbb899e823a26">TFoam::Eval</a></div><div class="ttdeci">virtual Double_t Eval(Double_t *)</div><div class="ttdoc">Internal subprogram. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01092">TFoam.cxx:1092</a></div></div>
<div class="ttc" id="classTFoam_html_a113f84bc2a1a657ae1f094183d1d1b76"><div class="ttname"><a href="classTFoam.html#a113f84bc2a1a657ae1f094183d1d1b76">TFoam::Divide</a></div><div class="ttdeci">virtual Int_t Divide(TFoamCell *)</div><div class="ttdoc">Internal subrogram used by Initialize. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00962">TFoam.cxx:962</a></div></div>
<div class="ttc" id="TFoam_8cxx_html_ad485bb39a59a51c631d174213f5a6dd8"><div class="ttname"><a href="TFoam_8cxx.html#ad485bb39a59a51c631d174213f5a6dd8">gHigh</a></div><div class="ttdeci">static const Double_t gHigh</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00147">TFoam.cxx:147</a></div></div>
<div class="ttc" id="classTFoam_html_a1510630fd3caa168268f61ccc802e72e"><div class="ttname"><a href="classTFoam.html#a1510630fd3caa168268f61ccc802e72e">TFoam::fHistWt</a></div><div class="ttdeci">TH1D * fHistWt</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00061">TFoam.h:61</a></div></div>
<div class="ttc" id="TMath_8h_html"><div class="ttname"><a href="TMath_8h.html">TMath.h</a></div></div>
<div class="ttc" id="classTFoam_html_a4d633c10f039fc94931d0ad91c4568d2"><div class="ttname"><a href="classTFoam.html#a4d633c10f039fc94931d0ad91c4568d2">TFoam::fInhiDiv</a></div><div class="ttdeci">Int_t * fInhiDiv</div><div class="ttdoc">[fDim] Dynamic Mask for cell division </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00047">TFoam.h:47</a></div></div>
<div class="ttc" id="classTFoamCell_html_af435b723d44be73f78b7486b13ffd57c"><div class="ttname"><a href="classTFoamCell.html#af435b723d44be73f78b7486b13ffd57c">TFoamCell::SetDau0</a></div><div class="ttdeci">void SetDau0(TFoamCell *Daug)</div><div class="ttdef"><b>Definition:</b> <a href="TFoamCell_8h_source.html#l00073">TFoamCell.h:73</a></div></div>
<div class="ttc" id="legend1_8C_html_a16daaa7b596941b23915a1ac1be5b42c"><div class="ttname"><a href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a></div><div class="ttdeci">const Int_t n</div><div class="ttdef"><b>Definition:</b> <a href="legend1_8C_source.html#l00016">legend1.C:16</a></div></div>
<div class="ttc" id="classTFoam_html_ab46c94f852d34f3c1b71239b2eb19884"><div class="ttname"><a href="classTFoam.html#ab46c94f852d34f3c1b71239b2eb19884">TFoam::SetRho</a></div><div class="ttdeci">virtual void SetRho(TFoamIntegrand *Rho)</div><div class="ttdoc">User may use this method to set the distribution object. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01049">TFoam.cxx:1049</a></div></div>
<div class="ttc" id="classTFoam_html_a50b85f60c791f766e5a197f43f661d7c"><div class="ttname"><a href="classTFoam.html#a50b85f60c791f766e5a197f43f661d7c">TFoam::fNCalls</a></div><div class="ttdeci">Long_t fNCalls</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00071">TFoam.h:71</a></div></div>
<div class="ttc" id="classTFoam_html_a596b986685e5f58dca2a19484c6886d4"><div class="ttname"><a href="classTFoam.html#a596b986685e5f58dca2a19484c6886d4">TFoam::GetIntegMC</a></div><div class="ttdeci">virtual void GetIntegMC(Double_t &amp;, Double_t &amp;)</div><div class="ttdoc">User subprogram. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l01237">TFoam.cxx:1237</a></div></div>
<div class="ttc" id="classTObject_html_a75fddd7eef38a13c1374130ec7dc5cf8"><div class="ttname"><a href="classTObject.html#a75fddd7eef38a13c1374130ec7dc5cf8">TObject::Warning</a></div><div class="ttdeci">virtual void Warning(const char *method, const char *msgfmt,...) const</div><div class="ttdoc">Issue warning message. </div><div class="ttdef"><b>Definition:</b> <a href="TObject_8cxx_source.html#l00866">TObject.cxx:866</a></div></div>
<div class="ttc" id="classTFoam_html"><div class="ttname"><a href="classTFoam.html">TFoam</a></div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00027">TFoam.h:27</a></div></div>
<div class="ttc" id="classTFoam_html_ad301b78fd272d626da77c16361d399a3"><div class="ttname"><a href="classTFoam.html#ad301b78fd272d626da77c16361d399a3">TFoam::fNSampl</a></div><div class="ttdeci">Int_t fNSampl</div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00043">TFoam.h:43</a></div></div>
<div class="ttc" id="classTString_html_a7e4ada8bf2407b461f3ee58b71c5959f"><div class="ttname"><a href="classTString.html#a7e4ada8bf2407b461f3ee58b71c5959f">TString::Data</a></div><div class="ttdeci">const char * Data() const</div><div class="ttdef"><b>Definition:</b> <a href="TString_8h_source.html#l00364">TString.h:364</a></div></div>
<div class="ttc" id="classTFoam_html_afaca66ad8bab1cf1294ec19dc2768239"><div class="ttname"><a href="classTFoam.html#afaca66ad8bab1cf1294ec19dc2768239">TFoam::TFoam</a></div><div class="ttdeci">TFoam()</div><div class="ttdoc">Default constructor for streamer, user should not use it. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8cxx_source.html#l00178">TFoam.cxx:178</a></div></div>
<div class="ttc" id="classTFoam_html_a1aae352244412f1e1bd6711be17f5e57"><div class="ttname"><a href="classTFoam.html#a1aae352244412f1e1bd6711be17f5e57">TFoam::fPseRan</a></div><div class="ttdeci">TRandom * fPseRan</div><div class="ttdoc">ROOT&amp;#39;s pointer to user-defined global distribution function. </div><div class="ttdef"><b>Definition:</b> <a href="TFoam_8h_source.html#l00069">TFoam.h:69</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:09:25 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

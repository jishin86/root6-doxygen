<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/roostats/rs_numbercountingutils.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_87facaa6959ceb8d3dacccaf663f7b84.html">roostats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">rs_numbercountingutils.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__roostats.html">RooStats Tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/rs_numbercountingutils.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/rs_numbercountingutils.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  'Number Counting Utils' <a class="el" href="namespaceRooStats.html" title="Namespace for the RooStats classes. ">RooStats</a> tutorial </p>
<p>This tutorial shows an example of the <a class="el" href="namespaceRooStats.html" title="Namespace for the RooStats classes. ">RooStats</a> standalone utilities that calculate the p-value or Z value (eg. significance in 1-sided Gaussian standard deviations) for a number counting experiment. This is a hypothesis test between background only and signal-plus-background. The background estimate has uncertainty derived from an auxiliary or sideband measurement.</p>
<p>Documentation for these utilities can be found here: <a href="http://root.cern.ch/root/html/RooStats__NumberCountingUtils.html">http://root.cern.ch/root/html/RooStats__NumberCountingUtils.html</a></p>
<p>This problem is often called a proto-type problem for high energy physics. In some references it is referred to as the on/off problem.</p>
<p>The problem is treated in a fully frequentist fashion by interpreting the relative background uncertainty as being due to an auxiliary or sideband observation that is also Poisson distributed with only background. Finally, one considers the test as a ratio of Poisson means where an interval is well known based on the conditioning on the total number of events and the binomial distribution. For more on this, see</p><ul>
<li><a href="http://arxiv.org/abs/0905.3831">http://arxiv.org/abs/0905.3831</a></li>
<li><a href="http://arxiv.org/abs/physics/physics/0702156">http://arxiv.org/abs/physics/physics/0702156</a></li>
<li><a href="http://arxiv.org/abs/physics/0511028">http://arxiv.org/abs/physics/0511028</a></li>
</ul>
<div class="fragment"><div class="line"></div><div class="line"></div><div class="line">[1mRooFit v3.60 -- Developed by Wouter Verkerke and David Kirkby[0m </div><div class="line">                Copyright (C) 2000-2013 NIKHEF, University of California &amp; Stanford University</div><div class="line">                All rights reserved, please read http://roofit.sourceforge.net/license.txt</div><div class="line"></div><div class="line">expected p-value =0.00094165  Z value (Gaussian sigma) = 3.10804</div><div class="line">observed p-value =0.00094165  Z value (Gaussian sigma) = 3.10804</div><div class="line">expected p-value =0.00094165  Z value (Gaussian sigma) = 3.10804</div><div class="line">observed p-value =0.00094165  Z value (Gaussian sigma) = 3.10804</div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooStatsUtils_8h.html">RooStats/RooStatsUtils.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooFit.html">RooFit</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooStats.html">RooStats</a>; <span class="comment">// the utilities are in the RooStats namespace</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> rs_numbercountingutils()</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// From the root prompt, you can see the full list of functions by using tab-completion</span></div><div class="line">   <span class="comment">// ~~~{.bash}</span></div><div class="line">   <span class="comment">// root [0] RooStats::NumberCountingUtils::  &lt;tab&gt;</span></div><div class="line">   <span class="comment">// BinomialExpZ</span></div><div class="line">   <span class="comment">// BinomialWithTauExpZ</span></div><div class="line">   <span class="comment">// BinomialObsZ</span></div><div class="line">   <span class="comment">// BinomialWithTauObsZ</span></div><div class="line">   <span class="comment">// BinomialExpP</span></div><div class="line">   <span class="comment">// BinomialWithTauExpP</span></div><div class="line">   <span class="comment">// BinomialObsP</span></div><div class="line">   <span class="comment">// BinomialWithTauObsP</span></div><div class="line">   <span class="comment">// ~~~</span></div><div class="line"></div><div class="line">   <span class="comment">// For each of the utilities you can inspect the arguments by tab completion</span></div><div class="line">   <span class="comment">// ~~~{.bash}</span></div><div class="line">   <span class="comment">// root [1] NumberCountingUtils::BinomialExpZ( &lt;tab&gt;</span></div><div class="line">   <span class="comment">// Double_t BinomialExpZ(Double_t sExp, Double_t bExp, Double_t fractionalBUncertainty)</span></div><div class="line">   <span class="comment">// ~~~</span></div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------</span></div><div class="line">   <span class="comment">// Here we see common usages where the experimenter</span></div><div class="line">   <span class="comment">// has a relative background uncertainty, without</span></div><div class="line">   <span class="comment">// explicit reference to the auxiliary or sideband</span></div><div class="line">   <span class="comment">// measurement</span></div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------------------</span></div><div class="line">   <span class="comment">// Expected p-values and significance with background uncertainty</span></div><div class="line">   <span class="keywordtype">double</span> sExpected = 50;</div><div class="line">   <span class="keywordtype">double</span> bExpected = 100;</div><div class="line">   <span class="keywordtype">double</span> relativeBkgUncert = 0.1;</div><div class="line"></div><div class="line">   <span class="keywordtype">double</span> pExp = <a class="code" href="namespaceRooStats_1_1NumberCountingUtils.html#aed9fa0f43f9268a8f53a55c36a111378">NumberCountingUtils::BinomialExpP</a>(sExpected, bExpected, relativeBkgUncert);</div><div class="line">   <span class="keywordtype">double</span> zExp = <a class="code" href="namespaceRooStats_1_1NumberCountingUtils.html#acc62261fa2a9671cf80a70285133ff40">NumberCountingUtils::BinomialExpZ</a>(sExpected, bExpected, relativeBkgUncert);</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;expected p-value =&quot;</span> &lt;&lt; pExp &lt;&lt; <span class="stringliteral">&quot;  Z value (Gaussian sigma) = &quot;</span> &lt;&lt; zExp &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------</span></div><div class="line">   <span class="comment">// Expected p-values and significance with background uncertainty</span></div><div class="line">   <span class="keywordtype">double</span> observed = 150;</div><div class="line">   <span class="keywordtype">double</span> pObs = <a class="code" href="namespaceRooStats_1_1NumberCountingUtils.html#ab18af69a738d81a582d6dc0fef838ab4">NumberCountingUtils::BinomialObsP</a>(observed, bExpected, relativeBkgUncert);</div><div class="line">   <span class="keywordtype">double</span> zObs = <a class="code" href="namespaceRooStats_1_1NumberCountingUtils.html#a4ac05df7796855dca2d8b24473bf7d4e">NumberCountingUtils::BinomialObsZ</a>(observed, bExpected, relativeBkgUncert);</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;observed p-value =&quot;</span> &lt;&lt; pObs &lt;&lt; <span class="stringliteral">&quot;  Z value (Gaussian sigma) = &quot;</span> &lt;&lt; zObs &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">// ---------------------------------------------------------</span></div><div class="line">   <span class="comment">// Here we see usages where the experimenter has knowledge</span></div><div class="line">   <span class="comment">// about the properties of the auxiliary or sideband</span></div><div class="line">   <span class="comment">// measurement.  In particular, the ratio tau of background</span></div><div class="line">   <span class="comment">// in the auxiliary measurement to the main measurement.</span></div><div class="line">   <span class="comment">// Large values of tau mean small background uncertainty</span></div><div class="line">   <span class="comment">// because the sideband is very constraining.</span></div><div class="line"></div><div class="line">   <span class="comment">// Usage:</span></div><div class="line">   <span class="comment">// ~~~{.bash}</span></div><div class="line">   <span class="comment">// root [0] RooStats::NumberCountingUtils::BinomialWithTauExpP(</span></div><div class="line">   <span class="comment">// Double_t BinomialWithTauExpP(Double_t sExp, Double_t bExp, Double_t tau)</span></div><div class="line">   <span class="comment">// ~~~</span></div><div class="line"></div><div class="line">   <span class="comment">// --------------------------------------------------------------</span></div><div class="line">   <span class="comment">// Expected p-values and significance with background uncertainty</span></div><div class="line">   <span class="keywordtype">double</span> <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a> = 1;</div><div class="line"></div><div class="line">   <span class="keywordtype">double</span> pExpWithTau = <a class="code" href="namespaceRooStats_1_1NumberCountingUtils.html#abcadb2472c59fb022c7e98743ac78786">NumberCountingUtils::BinomialWithTauExpP</a>(sExpected, bExpected, <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a>);</div><div class="line">   <span class="keywordtype">double</span> zExpWithTau = <a class="code" href="namespaceRooStats_1_1NumberCountingUtils.html#a12e4a8867f6eefc551dbd92db8376dc6">NumberCountingUtils::BinomialWithTauExpZ</a>(sExpected, bExpected, <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a>);</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;expected p-value =&quot;</span> &lt;&lt; pExpWithTau &lt;&lt; <span class="stringliteral">&quot;  Z value (Gaussian sigma) = &quot;</span> &lt;&lt; zExpWithTau &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">// ---------------------------------------------------------------</span></div><div class="line">   <span class="comment">// Expected p-values and significance with background uncertainty</span></div><div class="line">   <span class="keywordtype">double</span> pObsWithTau = <a class="code" href="namespaceRooStats_1_1NumberCountingUtils.html#aa30c8bc91fab6ad0dc30c6e70fe7847b">NumberCountingUtils::BinomialWithTauObsP</a>(observed, bExpected, <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a>);</div><div class="line">   <span class="keywordtype">double</span> zObsWithTau = <a class="code" href="namespaceRooStats_1_1NumberCountingUtils.html#a8c4ed450b4236877ff9d7e064262e538">NumberCountingUtils::BinomialWithTauObsZ</a>(observed, bExpected, <a class="code" href="TRolke_8cxx.html#a059d63a443e7120112e24975e7c62449">tau</a>);</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;observed p-value =&quot;</span> &lt;&lt; pObsWithTau &lt;&lt; <span class="stringliteral">&quot;  Z value (Gaussian sigma) = &quot;</span> &lt;&lt; zObsWithTau &lt;&lt; endl;</div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>Kyle Cranmer </dd></dl>

<p class="definition">Definition in file <a class="el" href="rs__numbercountingutils_8C_source.html">rs_numbercountingutils.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:27 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

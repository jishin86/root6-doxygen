<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/geom/parallel_world.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_5154a470e4613b6eb808d16f7e983769.html">geom</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">parallel_world.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__geom.html">Geometry tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Misaligning geometry generate in many cases overlaps, due to the idealization of the design and the fact that in real life movements of the geometry volumes have constraints and are correlated. </p>
<p>This typically generates inconsistent response of the navigation methods, leading to inefficiencies during tracking, errors in the material budget calculations, and so on. Among those, there are dangerous cases when the hidden volumes are sensitive. This macro demonstrates how to use the "parallel world" feature to assign highest navigation priority to some physical paths in geometry.</p>
<div class="image">
<img src="pict1_parallel_world.C.png" alt="pict1_parallel_world.C.png" width="800"/>
</div>
 <div class="fragment"><div class="line"></div><div class="line"><span class="keywordtype">void</span> align();</div><div class="line"></div><div class="line"><span class="comment">//______________________________________________________________________________</span></div><div class="line"><span class="keywordtype">void</span> parallel_world(<a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> usepw=<a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>, <a class="code" href="RtypesCore_8h.html#aa101f564ac7b845ca31aec2fbc00ce97">Bool_t</a> useovlp=<a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>)</div><div class="line">{</div><div class="line">   <a class="code" href="classTGeoManager.html">TGeoManager</a> *geom = <span class="keyword">new</span> <a class="code" href="classTGeoManager.html">TGeoManager</a>(<span class="stringliteral">&quot;parallel_world&quot;</span>, <span class="stringliteral">&quot;Showcase for prioritized physical paths&quot;</span>);</div><div class="line">   <a class="code" href="classTGeoMaterial.html">TGeoMaterial</a> *matV = <span class="keyword">new</span> <a class="code" href="classTGeoMaterial.html">TGeoMaterial</a>(<span class="stringliteral">&quot;Vac&quot;</span>, 0,0,0);</div><div class="line">   <a class="code" href="classTGeoMedium.html">TGeoMedium</a> *medV = <span class="keyword">new</span> <a class="code" href="classTGeoMedium.html">TGeoMedium</a>(<span class="stringliteral">&quot;MEDVAC&quot;</span>,1,matV);</div><div class="line">   <a class="code" href="classTGeoMaterial.html">TGeoMaterial</a> *matAl = <span class="keyword">new</span> <a class="code" href="classTGeoMaterial.html">TGeoMaterial</a>(<span class="stringliteral">&quot;Al&quot;</span>, 26.98,13,2.7);</div><div class="line">   <a class="code" href="classTGeoMedium.html">TGeoMedium</a> *medAl = <span class="keyword">new</span> <a class="code" href="classTGeoMedium.html">TGeoMedium</a>(<span class="stringliteral">&quot;MEDAL&quot;</span>,2,matAl);</div><div class="line">   <a class="code" href="classTGeoMaterial.html">TGeoMaterial</a> *matSi = <span class="keyword">new</span> <a class="code" href="classTGeoMaterial.html">TGeoMaterial</a>(<span class="stringliteral">&quot;Si&quot;</span>, 28.085,14,2.329);</div><div class="line">   <a class="code" href="classTGeoMedium.html">TGeoMedium</a> *medSi = <span class="keyword">new</span> <a class="code" href="classTGeoMedium.html">TGeoMedium</a>(<span class="stringliteral">&quot;MEDSI&quot;</span>,3,matSi);</div><div class="line">   <a class="code" href="classTGeoVolume.html">TGeoVolume</a> *top = <a class="code" href="TGeoManager_8h.html#a360faeee9ffc18063d8a4d38da753c3d">gGeoManager</a>-&gt;<a class="code" href="classTGeoManager.html#a91a16be136520a6478346dd764d91ef0">MakeBox</a>(<span class="stringliteral">&quot;TOP&quot;</span>,medV,100,400,1000);</div><div class="line">   <a class="code" href="TGeoManager_8h.html#a360faeee9ffc18063d8a4d38da753c3d">gGeoManager</a>-&gt;<a class="code" href="classTGeoManager.html#aa26893d9888f1edb39fb17769ea1292a">SetTopVolume</a>(top);</div><div class="line"></div><div class="line">   <span class="comment">// Shape for the support block</span></div><div class="line">   <a class="code" href="classTGeoBBox.html">TGeoBBox</a> *sblock = <span class="keyword">new</span> <a class="code" href="classTGeoBBox.html">TGeoBBox</a>(<span class="stringliteral">&quot;sblock&quot;</span>, 20,10,2);</div><div class="line">   <span class="comment">// The volume for the support</span></div><div class="line">   <a class="code" href="classTGeoVolume.html">TGeoVolume</a> *support = <span class="keyword">new</span> <a class="code" href="classTGeoVolume.html">TGeoVolume</a>(<span class="stringliteral">&quot;block&quot;</span>,sblock, medAl);</div><div class="line">   support-&gt;<a class="code" href="classTGeoVolume.html#add15250d325b7cd55532ed2aabe1d143">SetLineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a8ea4b941d1d41f4bd88387c38e13e9d3">kGreen</a>);</div><div class="line"></div><div class="line">   <span class="comment">// Shape for the sensor to be prioritized in case of overlap</span></div><div class="line">   <a class="code" href="classTGeoBBox.html">TGeoBBox</a> *ssensor = <span class="keyword">new</span> <a class="code" href="classTGeoBBox.html">TGeoBBox</a>(<span class="stringliteral">&quot;sensor&quot;</span>, 19,9,0.2);</div><div class="line">   <span class="comment">// The volume for the sensor</span></div><div class="line">   <a class="code" href="classTGeoVolume.html">TGeoVolume</a> *sensor = <span class="keyword">new</span> <a class="code" href="classTGeoVolume.html">TGeoVolume</a>(<span class="stringliteral">&quot;sensor&quot;</span>,ssensor, medSi);</div><div class="line">   sensor-&gt;<a class="code" href="classTGeoVolume.html#add15250d325b7cd55532ed2aabe1d143">SetLineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a5a655b1a02e5b0311571ca57ce4f3900">kRed</a>);</div><div class="line"></div><div class="line">   <span class="comment">// Chip assembly of support+sensor</span></div><div class="line">   <a class="code" href="classTGeoVolumeAssembly.html">TGeoVolumeAssembly</a> *chip = <span class="keyword">new</span> <a class="code" href="classTGeoVolumeAssembly.html">TGeoVolumeAssembly</a>(<span class="stringliteral">&quot;chip&quot;</span>);</div><div class="line">   chip-&gt;<a class="code" href="classTGeoVolumeAssembly.html#aa452c411158f98862840b0b1ba7d896e">AddNode</a>(support, 1);</div><div class="line">   chip-&gt;<a class="code" href="classTGeoVolumeAssembly.html#aa452c411158f98862840b0b1ba7d896e">AddNode</a>(sensor,1, <span class="keyword">new</span> <a class="code" href="classTGeoTranslation.html">TGeoTranslation</a>(0,0,-2.1));</div><div class="line"></div><div class="line">   <span class="comment">// A ladder that normally sags</span></div><div class="line">   <a class="code" href="classTGeoBBox.html">TGeoBBox</a> *sladder = <span class="keyword">new</span> <a class="code" href="classTGeoBBox.html">TGeoBBox</a>(<span class="stringliteral">&quot;sladder&quot;</span>, 20,300,5);</div><div class="line">   <span class="comment">// The volume for the ladder</span></div><div class="line">   <a class="code" href="classTGeoVolume.html">TGeoVolume</a> *ladder = <span class="keyword">new</span> <a class="code" href="classTGeoVolume.html">TGeoVolume</a>(<span class="stringliteral">&quot;ladder&quot;</span>,sladder, medAl);</div><div class="line">   ladder-&gt;<a class="code" href="classTGeoVolume.html#add15250d325b7cd55532ed2aabe1d143">SetLineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8aab48c32302f7159d81e081c41dc2d3d2">kBlue</a>);</div><div class="line"></div><div class="line">   <span class="comment">// Add nodes</span></div><div class="line">   top-&gt;<a class="code" href="classTGeoVolume.html#ae552ec9aa0618eb294fa83e60d4643d4">AddNode</a>(ladder,1);</div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i=0; i&lt;10; i++)</div><div class="line">      top-&gt;<a class="code" href="classTGeoVolume.html#ae552ec9aa0618eb294fa83e60d4643d4">AddNode</a>(chip, i+1, <span class="keyword">new</span> <a class="code" href="classTGeoTranslation.html">TGeoTranslation</a>(0, -225.+50.*i, 10));</div><div class="line"></div><div class="line">   <a class="code" href="TGeoManager_8h.html#a360faeee9ffc18063d8a4d38da753c3d">gGeoManager</a>-&gt;<a class="code" href="classTGeoManager.html#a7ea0792e9918521f8c5bd95546c3b708">CloseGeometry</a>();</div><div class="line">   <a class="code" href="classTGeoParallelWorld.html">TGeoParallelWorld</a> *pw = 0;</div><div class="line">   <span class="keywordflow">if</span> (usepw) pw = <a class="code" href="TGeoManager_8h.html#a360faeee9ffc18063d8a4d38da753c3d">gGeoManager</a>-&gt;<a class="code" href="classTGeoManager.html#ae3702d1d2fd1367c689e6b593970f853">CreateParallelWorld</a>(<span class="stringliteral">&quot;priority_sensors&quot;</span>);</div><div class="line"><span class="comment">// Align chips</span></div><div class="line">   align();</div><div class="line">   <span class="keywordflow">if</span> (usepw) {</div><div class="line">      <span class="keywordflow">if</span> (useovlp) pw-&gt;<a class="code" href="classTGeoParallelWorld.html#ab0fa384d7143d850ef6941549b495dab">AddOverlap</a>(ladder);</div><div class="line">      pw-&gt;<a class="code" href="classTGeoParallelWorld.html#a2fdc1332cfb51f2cf8e53d91d3f204e9">CloseGeometry</a>();</div><div class="line">      <a class="code" href="TGeoManager_8h.html#a360faeee9ffc18063d8a4d38da753c3d">gGeoManager</a>-&gt;<a class="code" href="classTGeoManager.html#add1bdd2bdac0718032011e594c02c480">SetUseParallelWorldNav</a>(<a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>);</div><div class="line">   }</div><div class="line">   <a class="code" href="classTString.html">TString</a> cname;</div><div class="line">   cname = usepw ? <span class="stringliteral">&quot;cpw&quot;</span> : <span class="stringliteral">&quot;cnopw&quot;</span>;</div><div class="line">   <a class="code" href="classTCanvas.html">TCanvas</a> *<a class="code" href="RSha256_8hxx.html#a63f410abde93141c9013b7d3f3971738">c</a> = (<a class="code" href="classTCanvas.html">TCanvas</a>*)<a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;GetListOfCanvases()-&gt;FindObject(cname);</div><div class="line">   <span class="keywordflow">if</span> (<a class="code" href="RSha256_8hxx.html#a63f410abde93141c9013b7d3f3971738">c</a>) <a class="code" href="RSha256_8hxx.html#a63f410abde93141c9013b7d3f3971738">c</a>-&gt;cd();</div><div class="line">   <span class="keywordflow">else</span>   <a class="code" href="RSha256_8hxx.html#a63f410abde93141c9013b7d3f3971738">c</a> = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>(cname, <span class="stringliteral">&quot;&quot;</span>,800,600);</div><div class="line">   top-&gt;<a class="code" href="classTGeoVolume.html#ab617a99d2dc87ae4224911a03a06e226">Draw</a>();</div><div class="line"><span class="comment">//   top-&gt;RandomRays(0,0,0,0,sensor-&gt;GetName());</span></div><div class="line">   <span class="comment">// Track random &quot;particles&quot; coming from the block side and draw only the tracklets</span></div><div class="line">   <span class="comment">// actually crossing one of the sensors. Note that some of the tracks coming</span></div><div class="line">   <span class="comment">// from the outer side may see the full sensor, while the others only part of it.</span></div><div class="line">   <a class="code" href="classTStopwatch.html">TStopwatch</a> timer;</div><div class="line">   timer.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">   top-&gt;<a class="code" href="classTGeoVolume.html#a18475581b077202e4d026201805149db">RandomRays</a>(100000,0,0,-30,sensor-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>());</div><div class="line">   timer.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   timer.<a class="code" href="classTStopwatch.html#aa393762ec66c9732940dccf05e8be7ec">Print</a>();</div><div class="line">   <a class="code" href="classTView3D.html">TView3D</a> *view = (<a class="code" href="classTView3D.html">TView3D</a>*)<a class="code" href="TVirtualPad_8h.html#a376b3a920d36f3366fb6a4c9e424aa8c">gPad</a>-&gt;GetView();</div><div class="line">   view-&gt;<a class="code" href="classTView3D.html#a31af783a63c62f7fde83ca25ad347a75">SetParallel</a>();</div><div class="line">   view-&gt;<a class="code" href="classTView3D.html#a18cca083fcb3ddc3eee1aaacc49d1aca">Side</a>();</div><div class="line">   <span class="keywordflow">if</span> (usepw) pw-&gt;<a class="code" href="classTGeoParallelWorld.html#a8cc9f53c2c0ef7fa484f2bc95b46a560">PrintDetectedOverlaps</a>();</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//______________________________________________________________________________</span></div><div class="line"><span class="keywordtype">void</span> align()</div><div class="line">{</div><div class="line"><span class="comment">// Aligning 2 sensors so they will overlap with the support. One sensor is positioned</span></div><div class="line"><span class="comment">// normally while the other using the shared matrix</span></div><div class="line">   <a class="code" href="classTGeoPhysicalNode.html">TGeoPhysicalNode</a> *node;</div><div class="line">   <a class="code" href="classTGeoParallelWorld.html">TGeoParallelWorld</a> *pw = <a class="code" href="TGeoManager_8h.html#a360faeee9ffc18063d8a4d38da753c3d">gGeoManager</a>-&gt;<a class="code" href="classTGeoManager.html#ad154945a48dfbfa16d02dd91ccf33676">GetParallelWorld</a>();</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> sag;</div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i=0; i&lt;10; i++) {</div><div class="line">      node = <a class="code" href="TGeoManager_8h.html#a360faeee9ffc18063d8a4d38da753c3d">gGeoManager</a>-&gt;<a class="code" href="classTGeoManager.html#ae24c48db17b54da25ca8dd6bb29749d8">MakePhysicalNode</a>(<a class="code" href="classTString.html#ac34bbb89627e20624a416dfbb7a3db70">TString::Format</a>(<span class="stringliteral">&quot;/TOP_1/chip_%d&quot;</span>,i+1));</div><div class="line">      sag = 8.-0.494*(i-4.5)*(i-4.5);</div><div class="line">      <a class="code" href="classTGeoTranslation.html">TGeoTranslation</a> *tr = <span class="keyword">new</span> <a class="code" href="classTGeoTranslation.html">TGeoTranslation</a>(0., -225.+50.*i, 10-sag);</div><div class="line">      node-&gt;<a class="code" href="classTGeoPhysicalNode.html#a4bc72f3178d570ea2d1631753750e621">Align</a>(tr);</div><div class="line">      <span class="keywordflow">if</span> (pw) pw-&gt;<a class="code" href="classTGeoParallelWorld.html#a3392e2bb16716183b02748de5e1618c9">AddNode</a>(<a class="code" href="classTString.html#ac34bbb89627e20624a416dfbb7a3db70">TString::Format</a>(<span class="stringliteral">&quot;/TOP_1/chip_%d&quot;</span>,i+1));</div><div class="line">   }</div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>Andrei Gheata </dd></dl>

<p class="definition">Definition in file <a class="el" href="parallel__world_8C_source.html">parallel_world.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:09 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

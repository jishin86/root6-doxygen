<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/hist/sparsehist.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_d19fad060e71a4fa91e5d42b7a1a4b08.html">hist</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">sparsehist.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__hist.html">Histograms tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Evaluate the performance of <a class="el" href="classTHnSparse.html" title="Efficient multidimensional histogram. ">THnSparse</a> vs TH1/2/3/nF for different numbers of dimensions and bins per dimension. </p>
<p>The script calculates the bandwidth for filling and retrieving bin contents (in million entries per second) for these two histogramming techniques, where "seconds" is CPU and real time.</p>
<p>The first line of the plots contains the bandwidth based on the CPU time (THnSpase, TH1/2/3/nF*, ratio), the second line shows the plots for real time, and the third line shows the fraction of filled bins and memory used by <a class="el" href="classTHnSparse.html" title="Efficient multidimensional histogram. ">THnSparse</a> vs. TH1/2/3/nF.</p>
<p>The timing depends on the distribution and the amount of entries in the histograms; here, a Gaussian distribution (center is contained in the histograms) is used to fill each histogram with 1000 entries. The filling and reading is repeated until enough statistics have been collected.</p>
<p><a class="el" href="drawsparse_8C.html" title=" &lt;a href=&quot;http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/drawsparse.C.nbconvert.ipynb&quot; target=&quot;_blank&quot;&gt;&lt;img src= notebook.gif alt=&quot;View in nbviewer&quot; style=&quot;height:1em&quot; &gt;&lt;/a&gt; &lt;a href=&quot;https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/drawsparse.C.nbconvert.ipynb&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png&quot;  alt=&quot;Open in SWAN&quot; style=&quot;height:1em&quot; &gt;&lt;/a&gt;  Convert a THnSparse to a TTree using efficient iteration through the THnSparse and draw a THnSparse using TParallelCoord. ">tutorials/tree/drawsparse.C</a> shows an example for visualizing a <a class="el" href="classTHnSparse.html" title="Efficient multidimensional histogram. ">THnSparse</a>. It creates a <a class="el" href="classTTree.html" title="A TTree represents a columnar dataset. ">TTree</a> which is then drawn using <a class="el" href="classTParallelCoord.html" title="Parallel Coordinates class. ">TParallelCoord</a>.</p>
<p>This macro should be run in compiled mode due to the many nested loops that force CINT to disable its optimization. If run interpreted one would not benchmark <a class="el" href="classTHnSparse.html" title="Efficient multidimensional histogram. ">THnSparse</a> but CINT.</p>
<p>Run as: </p><div class="fragment"><div class="line">root[0] .L $ROOTSYS/tutorials/hist/sparsehist.C+</div><div class="line">root[1] sparsehist()</div></div><!-- fragment --><div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TH1_8h.html">TH1.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TH2_8h.html">TH2.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TH3_8h.html">TH3.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="THn_8h.html">THn.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="THnSparse_8h.html">THnSparse.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TStopwatch_8h.html">TStopwatch.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TRandom_8h.html">TRandom.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TFile_8h.html">TFile.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TStyle_8h.html">TStyle.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TSystem_8h.html">TSystem.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#ifndef INT_MAX</span></div><div class="line"><span class="preprocessor">#define INT_MAX std::numeric_limits&lt;int&gt;::max()</span></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>TTimeHists {</div><div class="line"><span class="keyword">public</span>:</div><div class="line">   <span class="keyword">enum</span> EHist { kHist, kSparse, kNumHist };</div><div class="line">   <span class="keyword">enum</span> ETime { kReal, kCPU, kNumTime };</div><div class="line">   TTimeHists(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> dim, <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> bins, <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> num):</div><div class="line">      <a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a>(0), fDim(dim), fBins(bins), fNum(num),</div><div class="line">      fSparse(0), fHist(0), fHn(0) {}</div><div class="line">   ~TTimeHists();</div><div class="line">   <span class="keywordtype">bool</span> Run();</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> GetTime(EHist hist, ETime time)<span class="keyword"> const </span>{</div><div class="line">      <span class="keywordflow">if</span> (time == kReal) <span class="keywordflow">return</span> fTime[hist][0];</div><div class="line">      <span class="keywordflow">return</span> fTime[hist][1]; }</div><div class="line">   <span class="keyword">static</span> <span class="keywordtype">void</span> SetDebug(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> lvl) { fgDebug = lvl; }</div><div class="line">   <a class="code" href="classTHnSparse.html">THnSparse</a>* GetSparse()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> fSparse; }</div><div class="line"></div><div class="line"><span class="keyword">protected</span>:</div><div class="line">   <span class="keywordtype">void</span> Fill(EHist hist);</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> Check(EHist hist);</div><div class="line">   <span class="keywordtype">void</span> SetupHist(EHist hist);</div><div class="line">   <span class="keywordtype">void</span> NextValues();</div><div class="line">   <span class="keywordtype">void</span> SetupValues();</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>* <a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a>;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> fDim;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> fBins;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> fNum;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> fTime[2][2];</div><div class="line">   <a class="code" href="classTHnSparse.html">THnSparse</a>* fSparse;</div><div class="line">   <a class="code" href="classTH1.html">TH1</a>*       fHist;</div><div class="line">   <a class="code" href="classTHn.html">THn</a>*       fHn;</div><div class="line">   <span class="keyword">static</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> fgDebug;</div><div class="line">};</div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> TTimeHists::fgDebug = 0;</div><div class="line"></div><div class="line">TTimeHists::~TTimeHists()</div><div class="line">{</div><div class="line">   <span class="keyword">delete</span> [] <a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a>;</div><div class="line">   <span class="keyword">delete</span> fSparse;</div><div class="line">   <span class="keyword">delete</span> fHist;</div><div class="line">   <span class="keyword">delete</span> fHn;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">bool</span> TTimeHists::Run()</div><div class="line">{</div><div class="line">   <span class="comment">// run all tests with current settings, and check for identity of content.</span></div><div class="line"></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> check[2];</div><div class="line">   <a class="code" href="RtypesCore_8h.html#adaf6e69e06203ab5ae4994d1e7590647">Long64_t</a> rep[2];</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> = 0; <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> &lt; 2; ++<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>) {</div><div class="line">      rep[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>] = 0;</div><div class="line">      SetupValues();</div><div class="line">      <span class="keywordflow">try</span> {</div><div class="line">         <a class="code" href="classTStopwatch.html">TStopwatch</a> w;</div><div class="line">         w.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">         SetupHist((EHist) <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>);</div><div class="line">         w.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">         <span class="keywordflow">do</span> {</div><div class="line">            w.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>);</div><div class="line">            Fill((EHist) <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>);</div><div class="line">            check[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>] = Check((EHist) <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>);</div><div class="line">            w.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">            ++rep[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>];</div><div class="line">         } <span class="keywordflow">while</span> ((!<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> &amp;&amp; w.<a class="code" href="classTStopwatch.html#a1129ef63661a2e23d37d22aeba56bb21">RealTime</a>() &lt; 0.1)</div><div class="line">            || (<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> &amp;&amp; rep[0] &gt; 0 &amp;&amp; rep[1] &lt; rep[0]));</div><div class="line"></div><div class="line">         fTime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][0] = (1.* fNum * rep[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>]) / w.<a class="code" href="classTStopwatch.html#a1129ef63661a2e23d37d22aeba56bb21">RealTime</a>() / 1E6;</div><div class="line">         fTime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][1] = (1.* fNum * rep[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>]) / w.<a class="code" href="classTStopwatch.html#a6cd3ec9942388d9186d23d66f88d70b8">CpuTime</a>() / 1E6;</div><div class="line"></div><div class="line">         <span class="keywordflow">if</span> (<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> == 1 &amp;&amp; (fTime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][0] &gt; 1E20 || fTime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][1] &gt; 1E20)) {</div><div class="line">            <span class="keywordflow">do</span> {</div><div class="line">               <span class="comment">// some more cycles:</span></div><div class="line">               w.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>);</div><div class="line">               Fill((EHist) <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>);</div><div class="line">               Check((EHist) <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>);</div><div class="line">               w.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">               ++rep[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>];</div><div class="line">            } <span class="keywordflow">while</span> (w.<a class="code" href="classTStopwatch.html#a1129ef63661a2e23d37d22aeba56bb21">RealTime</a>() &lt; 0.1);</div><div class="line"></div><div class="line">            fTime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][0] = (1.* fNum * rep[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>]) / w.<a class="code" href="classTStopwatch.html#a1129ef63661a2e23d37d22aeba56bb21">RealTime</a>() / 1E6;</div><div class="line">            fTime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][1] = (1.* fNum * rep[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>]) / w.<a class="code" href="classTStopwatch.html#a6cd3ec9942388d9186d23d66f88d70b8">CpuTime</a>() / 1E6;</div><div class="line">         }</div><div class="line"></div><div class="line">         <span class="keywordflow">if</span> (fTime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][0] &gt; 1E20) fTime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][0] = 1E20;</div><div class="line">         <span class="keywordflow">if</span> (fTime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][1] &gt; 1E20) fTime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][1] = 1E20;</div><div class="line">      }</div><div class="line">      <span class="keywordflow">catch</span> (std::exception&amp;) {</div><div class="line">         fTime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][0] = fTime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][1] = -1.;</div><div class="line">         check[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>] = -1.; <span class="comment">// can never be &lt; 1 without exception</span></div><div class="line">         rep[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>] = -1;</div><div class="line">      }</div><div class="line">   }</div><div class="line">   <span class="keywordflow">if</span> (check[0] != check[1])</div><div class="line">      <span class="keywordflow">if</span> (check[0] != -1.)</div><div class="line">         printf(<span class="stringliteral">&quot;ERROR: mismatch of histogram (%g) and sparse histogram (%g) for dim=%d, bins=%d!\n&quot;</span>,</div><div class="line">                check[0], check[1], fDim, fBins);</div><div class="line">      <span class="comment">// else</span></div><div class="line">      <span class="comment">//   printf(&quot;ERROR: cannot allocate histogram for dim=%d, bins=%d - out of memory!\n&quot;,</span></div><div class="line">      <span class="comment">//          fDim, fBins);</span></div><div class="line">   <span class="keywordflow">return</span> (check[0] == check[1]);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> TTimeHists::NextValues()</div><div class="line">{</div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> = 0; <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> &lt; fDim; ++<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>)</div><div class="line">      <a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a>[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>] = <a class="code" href="TRandom_8h.html#a9ee275021031e1e27291bb36baa0e3e2">gRandom</a>-&gt;<a class="code" href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">Gaus</a>() / 4.;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> TTimeHists::SetupValues()</div><div class="line">{</div><div class="line">   <span class="comment">// define fValue</span></div><div class="line">   <span class="keywordflow">if</span> (!<a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a>) <a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[fDim];</div><div class="line">   <a class="code" href="TRandom_8h.html#a9ee275021031e1e27291bb36baa0e3e2">gRandom</a>-&gt;<a class="code" href="classTRandom.html#a2007ae15ce828266aecb783ed3410e8b">SetSeed</a>(42);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> TTimeHists::Fill(EHist hist)</div><div class="line">{</div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a> = 0; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a> &lt; fNum; ++<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>) {</div><div class="line">      NextValues();</div><div class="line">      <span class="keywordflow">if</span> (fgDebug &gt; 1) {</div><div class="line">         printf(<span class="stringliteral">&quot;%ld: fill %s&quot;</span>, <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>, hist == kHist? (fDim &lt; 4 ? <span class="stringliteral">&quot;hist&quot;</span> : <span class="stringliteral">&quot;arr&quot;</span>) : <span class="stringliteral">&quot;sparse&quot;</span>);</div><div class="line">         <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> = 0; <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> &lt; fDim; ++<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>)</div><div class="line">            printf(<span class="stringliteral">&quot;[%g]&quot;</span>, <a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a>[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>]);</div><div class="line">         printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line">      }</div><div class="line">      <span class="keywordflow">if</span> (hist == kHist) {</div><div class="line">         <span class="keywordflow">switch</span> (fDim) {</div><div class="line">         <span class="keywordflow">case</span> 1: fHist-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(<a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a>[0]); <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">case</span> 2: ((<a class="code" href="classTH2F.html">TH2F</a>*)fHist)-&gt;Fill(<a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a>[0], <a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a>[1]); <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">case</span> 3: ((<a class="code" href="classTH3F.html">TH3F</a>*)fHist)-&gt;Fill(<a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a>[0], <a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a>[1], <a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a>[2]); <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">default</span>: fHn-&gt;Fill(<a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a>); <span class="keywordflow">break</span>;</div><div class="line">         }</div><div class="line">      } <span class="keywordflow">else</span> {</div><div class="line">         fSparse-&gt;Fill(<a class="code" href="MethodProxy_8cxx.html#ad9a34bcbe7aedcdf202b11944978855d">fValue</a>);</div><div class="line">      }</div><div class="line">   }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> TTimeHists::SetupHist(EHist hist)</div><div class="line">{</div><div class="line">   <span class="keywordflow">if</span> (hist == kHist) {</div><div class="line">      <span class="keywordflow">switch</span> (fDim) {</div><div class="line">      <span class="keywordflow">case</span> 1: fHist = <span class="keyword">new</span> <a class="code" href="classTH1F.html">TH1F</a>(<span class="stringliteral">&quot;h1&quot;</span>, <span class="stringliteral">&quot;h1&quot;</span>, fBins, -1., 1.); <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> 2: fHist = <span class="keyword">new</span> <a class="code" href="classTH2F.html">TH2F</a>(<span class="stringliteral">&quot;h2&quot;</span>, <span class="stringliteral">&quot;h2&quot;</span>, fBins, -1., 1., fBins, -1., 1.); <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">case</span> 3: fHist = <span class="keyword">new</span> <a class="code" href="classTH3F.html">TH3F</a>(<span class="stringliteral">&quot;h3&quot;</span>, <span class="stringliteral">&quot;h3&quot;</span>, fBins, -1., 1., fBins, -1., 1., fBins, -1., 1.); <span class="keywordflow">break</span>;</div><div class="line">      <span class="keywordflow">default</span>:</div><div class="line">         {</div><div class="line">            <a class="code" href="structMemInfo__t.html">MemInfo_t</a> meminfo;</div><div class="line">            <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a685c95228dba71cdd38828266d922ac5">GetMemInfo</a>(&amp;meminfo);</div><div class="line">            <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> size = 1;</div><div class="line">            <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> = 0; <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> &lt; fDim; ++<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>) {</div><div class="line">               <span class="keywordflow">if</span> ((<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>)(size * <span class="keyword">sizeof</span>(<a class="code" href="RtypesCore_8h.html#aeea98adf47c4604318761944f6780133">Float_t</a>)) &gt; INT_MAX / (fBins + 2)</div><div class="line">                  || (meminfo.<a class="code" href="structMemInfo__t.html#a62b63e5e24efd2e2b5d0f60456e239d6">fMemFree</a> &gt; 0</div><div class="line">                  &amp;&amp; meminfo.<a class="code" href="structMemInfo__t.html#a62b63e5e24efd2e2b5d0f60456e239d6">fMemFree</a> / 2 &lt; (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) (size * <span class="keyword">sizeof</span>(<a class="code" href="RtypesCore_8h.html#aeea98adf47c4604318761944f6780133">Float_t</a>)/1000/1000)))</div><div class="line">                  <span class="keywordflow">throw</span> std::bad_alloc();</div><div class="line">               size *= (fBins + 2);</div><div class="line">            }</div><div class="line">            <span class="keywordflow">if</span> (meminfo.<a class="code" href="structMemInfo__t.html#a62b63e5e24efd2e2b5d0f60456e239d6">fMemFree</a> &gt; 0</div><div class="line">               &amp;&amp; meminfo.<a class="code" href="structMemInfo__t.html#a62b63e5e24efd2e2b5d0f60456e239d6">fMemFree</a> / 2 &lt; (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) (size * <span class="keyword">sizeof</span>(<a class="code" href="RtypesCore_8h.html#aeea98adf47c4604318761944f6780133">Float_t</a>)/1000/1000))</div><div class="line">               <span class="keywordflow">throw</span> std::bad_alloc();</div><div class="line">            <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>* bins = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[fDim];</div><div class="line">            <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[fDim];</div><div class="line">            <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *<a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[fDim];</div><div class="line">            <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> = 0; <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> &lt; fDim; ++<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>) {</div><div class="line">               bins[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>] = fBins;</div><div class="line">               <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>] = -1.;</div><div class="line">               <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>] =  1.;</div><div class="line">            }</div><div class="line">            fHn = <span class="keyword">new</span> <a class="code" href="THn_8h.html#a3981aab373c83d04c6b05ba2b53ff115">THnF</a>(<span class="stringliteral">&quot;hn&quot;</span>, <span class="stringliteral">&quot;hn&quot;</span>, fDim, bins, <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>, <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>);</div><div class="line">         }</div><div class="line">      }</div><div class="line">   } <span class="keywordflow">else</span> {</div><div class="line">      <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>* bins = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[fDim];</div><div class="line">      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *<a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[fDim];</div><div class="line">      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *<a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[fDim];</div><div class="line">      <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> = 0; <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> &lt; fDim; ++<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>) {</div><div class="line">         bins[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>] = fBins;</div><div class="line">         <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>] = -1.;</div><div class="line">         <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>] =  1.;</div><div class="line">      }</div><div class="line">      fSparse = <span class="keyword">new</span> <a class="code" href="THnSparse_8h.html#a79ee42bedcae5740b06045942e3eacf2">THnSparseF</a>(<span class="stringliteral">&quot;hs&quot;</span>, <span class="stringliteral">&quot;hs&quot;</span>, fDim, bins, <a class="code" href="THbookFile_8cxx.html#a058f249a5e6d20724cb0784b40a183e8">xmin</a>, <a class="code" href="THbookFile_8cxx.html#a9c42f51718ed192ed1841a53d2b0e507">xmax</a>);</div><div class="line">   }</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> TTimeHists::Check(EHist hist)</div><div class="line">{</div><div class="line">   <span class="comment">// Check bin content of all bins</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> check = 0.;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>* <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>[fDim];</div><div class="line">   memset(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a>) * fDim);</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (hist == kHist) {</div><div class="line">      <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> idx = 0;</div><div class="line">      <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> size = 1;</div><div class="line">      <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> = 0; <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> &lt; fDim; ++<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>)</div><div class="line">         size *= (fBins + 2);</div><div class="line">      <span class="keywordflow">while</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0] &lt;= fBins + 1) {</div><div class="line">         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a> = -1.;</div><div class="line">         <span class="keywordflow">if</span> (fDim &lt; 4) {</div><div class="line">            <a class="code" href="RtypesCore_8h.html#a84701346fdad56d1d91e06fcbc1b87dc">Long_t</a> histidx = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0];</div><div class="line">            <span class="keywordflow">if</span> (fDim == 2) histidx = fHist-&gt;<a class="code" href="classTH1.html#a641262682144d465d7e2bc6101a04bf6">GetBin</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0], <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[1]);</div><div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fDim == 3) histidx = fHist-&gt;<a class="code" href="classTH1.html#a641262682144d465d7e2bc6101a04bf6">GetBin</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0], <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[1], <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[2]);</div><div class="line">            <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a> = fHist-&gt;<a class="code" href="classTH1.html#ac70dcb4082bd510f5aa3e6efeb043f39">GetBinContent</a>(histidx);</div><div class="line">         }</div><div class="line">         <span class="keywordflow">else</span> <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a> = fHn-&gt;GetBinContent(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>);</div><div class="line">         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> checkx = 0.;</div><div class="line">         <span class="keywordflow">if</span> (<a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>)</div><div class="line">            <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> = 0; <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> &lt; fDim; ++<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>)</div><div class="line">               checkx += <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>];</div><div class="line">         check += checkx * <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>;</div><div class="line"></div><div class="line">         <span class="keywordflow">if</span> (fgDebug &gt; 2 || (fgDebug &gt; 1 &amp;&amp; <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>)) {</div><div class="line">            printf(<span class="stringliteral">&quot;%s%d&quot;</span>, fDim &lt; 4 ? <span class="stringliteral">&quot;hist&quot;</span> : <span class="stringliteral">&quot;arr&quot;</span>, fDim);</div><div class="line">            <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> = 0; <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> &lt; fDim; ++<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>)</div><div class="line">               printf(<span class="stringliteral">&quot;[%d]&quot;</span>, <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>]);</div><div class="line">            printf(<span class="stringliteral">&quot; = %g\n&quot;</span>, <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>);</div><div class="line">         }</div><div class="line"></div><div class="line">         ++<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[fDim - 1];</div><div class="line">         <span class="comment">// Adjust the bin idx</span></div><div class="line">         <span class="comment">// no wrapping for dim 0 - it&#39;s what we break on!</span></div><div class="line">         <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> = fDim - 1; <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> &gt; 0; --<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>) {</div><div class="line">            <span class="keywordflow">if</span> (<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>] &gt; fBins + 1) {</div><div class="line">               <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>] = 0;</div><div class="line">               ++<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> - 1];</div><div class="line">            }</div><div class="line">         }</div><div class="line">         ++idx;</div><div class="line">      } <span class="comment">// while next bin</span></div><div class="line">   } <span class="keywordflow">else</span> {</div><div class="line">      <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#adaf6e69e06203ab5ae4994d1e7590647">Long64_t</a> i = 0; i &lt; fSparse-&gt;GetNbins(); ++i) {</div><div class="line">         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a> = fSparse-&gt;GetBinContent(i, <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>);</div><div class="line">         <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> checkx = 0.;</div><div class="line">         <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> = 0; <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> &lt; fDim; ++<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>)</div><div class="line">            checkx += <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>];</div><div class="line">         check += checkx * <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>;</div><div class="line"></div><div class="line">         <span class="keywordflow">if</span> (fgDebug &gt; 1) {</div><div class="line">            printf(<span class="stringliteral">&quot;sparse%d&quot;</span>, fDim);</div><div class="line">            <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> = 0; <a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a> &lt; fDim; ++<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>)</div><div class="line">               printf(<span class="stringliteral">&quot;[%d]&quot;</span>, <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[<a class="code" href="RSha256_8hxx.html#a23b5b0a85bf5762c93a855f40c0343ce">d</a>]);</div><div class="line">            printf(<span class="stringliteral">&quot; = %g\n&quot;</span>, <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a>);</div><div class="line">         }</div><div class="line">      }</div><div class="line">   }</div><div class="line">   check /= fNum;</div><div class="line">   <span class="keywordflow">if</span> (fgDebug &gt; 0)</div><div class="line">      printf(<span class="stringliteral">&quot;check %s%d = %g\n&quot;</span>, hist == kHist ? (fDim &lt; 4 ? <span class="stringliteral">&quot;hist&quot;</span> : <span class="stringliteral">&quot;arr&quot;</span>) : <span class="stringliteral">&quot;sparse&quot;</span>, fDim, check);</div><div class="line">   <span class="keywordflow">return</span> check;</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> sparsehist() {</div><div class="line"><span class="comment">// Exclude this macro also for Cling as this script requires exception support</span></div><div class="line"><span class="comment">// which is not supported in Cling as of v6.00/00.</span></div><div class="line"><span class="preprocessor">#if defined (__CLING__)</span></div><div class="line">   printf(<span class="stringliteral">&quot;Please run this script in compiled mode by running \&quot;.x sparsehist.C+\&quot;\n&quot;</span>);</div><div class="line">   <span class="keywordflow">return</span>;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line">   <a class="code" href="classTH2F.html">TH2F</a>* htime[TTimeHists::kNumHist][TTimeHists::kNumTime];</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> = 0; <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> &lt; TTimeHists::kNumHist; ++<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>)</div><div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t = 0; t &lt; TTimeHists::kNumTime; ++t) {</div><div class="line">         <a class="code" href="classTString.html">TString</a> name(<span class="stringliteral">&quot;htime_&quot;</span>);</div><div class="line">         <span class="keywordflow">if</span> (<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> == 0) name += <span class="stringliteral">&quot;arr&quot;</span>;</div><div class="line">         <span class="keywordflow">else</span> name += <span class="stringliteral">&quot;sp&quot;</span>;</div><div class="line">         <span class="keywordflow">if</span> (t == 0) name += <span class="stringliteral">&quot;_r&quot;</span>;</div><div class="line"></div><div class="line">         <a class="code" href="classTString.html">TString</a> title;</div><div class="line">         title.<a class="code" href="classTString.html#aeb44d6183d8b1f1b7090dbd3c93f5e39">Form</a>(<span class="stringliteral">&quot;Throughput (fill,get) %s (%s, 1M entries/sec);dim;bins;1M entries/sec&quot;</span>, <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> == 0 ? <span class="stringliteral">&quot;TH1/2/3/nF&quot;</span> : <span class="stringliteral">&quot;THnSparseF&quot;</span>, t == 0 ? <span class="stringliteral">&quot;real&quot;</span> : <span class="stringliteral">&quot;CPU&quot;</span>);</div><div class="line">         htime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][t] = <span class="keyword">new</span> <a class="code" href="classTH2F.html">TH2F</a>(name, title, 6, 0.5, 6.5, 10, 5, 105);</div><div class="line">      }</div><div class="line"></div><div class="line">   <a class="code" href="classTH2F.html">TH2F</a>* hsparse_mem = <span class="keyword">new</span> <a class="code" href="classTH2F.html">TH2F</a>(<span class="stringliteral">&quot;hsparse_mem&quot;</span>, <span class="stringliteral">&quot;Fractional memory usage;dim;bins;fraction of memory used&quot;</span>, 6, 0.5, 6.5, 10, 5, 105);</div><div class="line">   <a class="code" href="classTH2F.html">TH2F</a>* hsparse_bins = <span class="keyword">new</span> <a class="code" href="classTH2F.html">TH2F</a>(<span class="stringliteral">&quot;hsparse_bins&quot;</span>, <span class="stringliteral">&quot;Fractional number of used bins;dim;bins;fraction of filled bins&quot;</span>, 6, 0.5, 6.5, 10, 5, 105);</div><div class="line"></div><div class="line">   <span class="comment">// TTimeHists::SetDebug(2);</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> max = -1.;</div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> dim = 1; dim &lt; 7; ++dim) {</div><div class="line">      printf(<span class="stringliteral">&quot;Processing dimension %d&quot;</span>, dim);</div><div class="line">      <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> bins = 10; bins &lt;= 100; bins += 10) {</div><div class="line">         TTimeHists timer(dim, bins, <span class="comment">/*num*/</span> 1000);</div><div class="line">         timer.Run();</div><div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> = 0; <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> &lt; TTimeHists::kNumHist; ++<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>) {</div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t = 0; t &lt; TTimeHists::kNumTime; ++t) {</div><div class="line">               <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> time = timer.<a class="code" href="classTTimer.html#aac6413767579c3420c2ca767f900e265">GetTime</a>((TTimeHists::EHist)<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>, (TTimeHists::ETime)t);</div><div class="line">               <span class="keywordflow">if</span> (time &gt;= 0.)</div><div class="line">                  htime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][t]-&gt;<a class="code" href="classTH2.html#a4cf5530929bd446be82148884d0d1fa3">Fill</a>(dim, bins, time);</div><div class="line">            }</div><div class="line">         }</div><div class="line">         hsparse_mem-&gt;<a class="code" href="classTH2.html#a4cf5530929bd446be82148884d0d1fa3">Fill</a>(dim, bins, timer.GetSparse()-&gt;GetSparseFractionMem());</div><div class="line">         hsparse_bins-&gt;<a class="code" href="classTH2.html#a4cf5530929bd446be82148884d0d1fa3">Fill</a>(dim, bins, timer.GetSparse()-&gt;GetSparseFractionBins());</div><div class="line"></div><div class="line">         <span class="keywordflow">if</span> (max &lt; timer.<a class="code" href="classTTimer.html#aac6413767579c3420c2ca767f900e265">GetTime</a>(TTimeHists::kSparse, TTimeHists::kReal))</div><div class="line">            max = timer.<a class="code" href="classTTimer.html#aac6413767579c3420c2ca767f900e265">GetTime</a>(TTimeHists::kSparse, TTimeHists::kReal);</div><div class="line">         printf(<span class="stringliteral">&quot;.&quot;</span>);</div><div class="line">         fflush(stdout);</div><div class="line">      }</div><div class="line">      printf(<span class="stringliteral">&quot; done\n&quot;</span>);</div><div class="line">   }</div><div class="line"></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> markersize = 2.5;</div><div class="line">   hsparse_mem-&gt;<a class="code" href="classTAttMarker.html#a95522acfc3fa6157f317f9993edfa047">SetMarkerSize</a>(markersize);</div><div class="line">   hsparse_bins-&gt;<a class="code" href="classTAttMarker.html#a95522acfc3fa6157f317f9993edfa047">SetMarkerSize</a>(markersize);</div><div class="line"></div><div class="line">   <a class="code" href="classTH2F.html">TH2F</a>* htime_ratio[TTimeHists::kNumTime];</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t = 0; t &lt; TTimeHists::kNumTime; ++t) {</div><div class="line">      <span class="keyword">const</span> <span class="keywordtype">char</span>* name = t ? <span class="stringliteral">&quot;htime_ratio&quot;</span> : <span class="stringliteral">&quot;htime_ratio_r&quot;</span>;</div><div class="line">      htime_ratio[t] = (<a class="code" href="classTH2F.html">TH2F</a>*) htime[TTimeHists::kSparse][t]-&gt;Clone(name);</div><div class="line">      <a class="code" href="classTString.html">TString</a> title;</div><div class="line">      title.<a class="code" href="classTString.html#aeb44d6183d8b1f1b7090dbd3c93f5e39">Form</a>(<span class="stringliteral">&quot;Relative speed improvement (%s, 1M entries/sec): sparse/hist;dim;bins;#Delta 1M entries/sec&quot;</span>, t == 0 ? <span class="stringliteral">&quot;real&quot;</span> : <span class="stringliteral">&quot;CPU&quot;</span>);</div><div class="line">      htime_ratio[t]-&gt;<a class="code" href="classTH1.html#a0b3078e8577dd9009d7d269cfae23442">SetTitle</a>(title);</div><div class="line">      htime_ratio[t]-&gt;<a class="code" href="classTH1.html#ae7c34d74d043ff9d6816e5b026f85133">Divide</a>(htime[TTimeHists::kHist][t]);</div><div class="line">      htime_ratio[t]-&gt;<a class="code" href="classTH1.html#a89a5d8fc84154b504566f367ba8d0238">SetMinimum</a>(0.1);</div><div class="line">      htime_ratio[t]-&gt;<a class="code" href="classTAttMarker.html#a95522acfc3fa6157f317f9993edfa047">SetMarkerSize</a>(markersize);</div><div class="line">   }</div><div class="line"></div><div class="line">   <a class="code" href="classTFile.html">TFile</a>* <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a> = <span class="keyword">new</span> <a class="code" href="classTFile.html">TFile</a>(<span class="stringliteral">&quot;sparsehist.root&quot;</span>,<span class="stringliteral">&quot;RECREATE&quot;</span>);</div><div class="line"></div><div class="line">   <a class="code" href="classTCanvas.html">TCanvas</a>* canv= <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>(<span class="stringliteral">&quot;c&quot;</span>,<span class="stringliteral">&quot;c&quot;</span>);</div><div class="line">   canv-&gt;<a class="code" href="classTPad.html#a064b8ae1d12a9be393c0e22c5958cc7c">Divide</a>(3,3);</div><div class="line"></div><div class="line">   <a class="code" href="TStyle_8h.html#ace94cabdcf18c1e8a7856d8c3f388cfe">gStyle</a>-&gt;<a class="code" href="classTStyle.html#a444681d8ec1f3f5db43104fdb9dfce33">SetPalette</a>(8,0);</div><div class="line">   <a class="code" href="TStyle_8h.html#ace94cabdcf18c1e8a7856d8c3f388cfe">gStyle</a>-&gt;<a class="code" href="classTStyle.html#a19a993a256c960cff7fc19d5c2409b32">SetPaintTextFormat</a>(<span class="stringliteral">&quot;.2g&quot;</span>);</div><div class="line">   <a class="code" href="TStyle_8h.html#ace94cabdcf18c1e8a7856d8c3f388cfe">gStyle</a>-&gt;<a class="code" href="classTStyle.html#a0ae6f6044b6d7a32756d7e98bb210d6c">SetOptStat</a>(0);</div><div class="line">   <span class="keyword">const</span> <span class="keywordtype">char</span>* opt = <span class="stringliteral">&quot;TEXT COL&quot;</span>;</div><div class="line"></div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t = 0; t &lt; TTimeHists::kNumTime; ++t) {</div><div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> = 0; <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> &lt; TTimeHists::kNumHist; ++<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>) {</div><div class="line">         htime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][t]-&gt;<a class="code" href="classTH1.html#a68e78664002d109dd4747964d66778a3">SetMaximum</a>(max);</div><div class="line">         htime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][t]-&gt;<a class="code" href="classTAttMarker.html#a95522acfc3fa6157f317f9993edfa047">SetMarkerSize</a>(markersize);</div><div class="line">         canv-&gt;<a class="code" href="classTCanvas.html#ad996aa7bc34186944363b48963de4de5">cd</a>(1 + <a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a> + 3 * t);</div><div class="line">         htime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][t]-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>(opt);</div><div class="line">         htime[<a class="code" href="RSha256_8hxx.html#acf9942d15f0dd0ac4fc5ca66096a3f6d">h</a>][t]-&gt;<a class="code" href="classTObject.html#a19782a4717dbfd4857ccd9ffa68aa06d">Write</a>();</div><div class="line">      }</div><div class="line">      canv-&gt;<a class="code" href="classTCanvas.html#ad996aa7bc34186944363b48963de4de5">cd</a>(3 + t * 3);</div><div class="line">      htime_ratio[t]-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>(opt); <a class="code" href="TVirtualPad_8h.html#a376b3a920d36f3366fb6a4c9e424aa8c">gPad</a>-&gt;SetLogz();</div><div class="line">      htime_ratio[t]-&gt;<a class="code" href="classTObject.html#a19782a4717dbfd4857ccd9ffa68aa06d">Write</a>();</div><div class="line">   }</div><div class="line"></div><div class="line">   canv-&gt;<a class="code" href="classTCanvas.html#ad996aa7bc34186944363b48963de4de5">cd</a>(7); hsparse_mem-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>(opt);</div><div class="line">   canv-&gt;<a class="code" href="classTCanvas.html#ad996aa7bc34186944363b48963de4de5">cd</a>(8); hsparse_bins-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>(opt);</div><div class="line">   hsparse_mem-&gt;<a class="code" href="classTObject.html#a19782a4717dbfd4857ccd9ffa68aa06d">Write</a>();</div><div class="line">   hsparse_bins-&gt;<a class="code" href="classTObject.html#a19782a4717dbfd4857ccd9ffa68aa06d">Write</a>();</div><div class="line"></div><div class="line">   canv-&gt;<a class="code" href="classTObject.html#a19782a4717dbfd4857ccd9ffa68aa06d">Write</a>();</div><div class="line"></div><div class="line">   <span class="keyword">delete</span> <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>;</div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>Axel.Naumann </dd></dl>

<p class="definition">Definition in file <a class="el" href="sparsehist_8C_source.html">sparsehist.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:16 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

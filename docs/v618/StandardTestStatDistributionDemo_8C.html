<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/roostats/StandardTestStatDistributionDemo.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_87facaa6959ceb8d3dacccaf663f7b84.html">roostats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">StandardTestStatDistributionDemo.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__roostats.html">RooStats Tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/StandardTestStatDistributionDemo.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/StandardTestStatDistributionDemo.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  <a class="el" href="StandardTestStatDistributionDemo_8C.html" title=" &lt;a href=&quot;http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/StandardTestStatDistribut...">StandardTestStatDistributionDemo.C</a> </p>
<p>This simple script plots the sampling distribution of the profile likelihood ratio test statistic based on the input Model File. To do this one needs to specify the value of the parameter of interest that will be used for evaluating the test statistic and the value of the parameters used for generating the toy data. In this case, it uses the upper-limit estimated from the ProfileLikleihoodCalculator, which assumes the asymptotic chi-square distribution for -2 log profile likelihood ratio. Thus, the script is handy for checking to see if the asymptotic approximations are valid. To aid, that comparison, the script overlays a chi-square distribution as well. The most common parameter of interest is a parameter proportional to the signal rate, and often that has a lower-limit of 0, which breaks the standard chi-square distribution. Thus the script allows the parameter to be negative so that the overlay chi-square is the correct asymptotic distribution.</p>
<div class="image">
<img src="pict1_StandardTestStatDistributionDemo.C.png" alt="pict1_StandardTestStatDistributionDemo.C.png" width="700"/>
</div>
 <div class="fragment"><div class="line"></div><div class="line"></div><div class="line">[1mRooFit v3.60 -- Developed by Wouter Verkerke and David Kirkby[0m </div><div class="line">                Copyright (C) 2000-2013 NIKHEF, University of California &amp; Stanford University</div><div class="line">                All rights reserved, please read http://roofit.sourceforge.net/license.txt</div><div class="line"></div><div class="line"></div><div class="line">=== Using the following for ModelConfig ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.174888</div><div class="line"></div><div class="line">[#1] INFO:Minization -- p.d.f. provides expected number of events, including extended term in likelihood.</div><div class="line">[#1] INFO:Minization -- createNLL: caching constraint set under name CONSTR_OF_PDF_simPdf_FOR_OBS_channelCat:obs_x_channel1 with 4 entries</div><div class="line">[#1] INFO:Minization --  Including the following contraint terms in minimization: (alpha_syst2Constraint,alpha_syst3Constraint,gamma_stat_channel1_bin_0_constraint,gamma_stat_channel1_bin_1_constraint)</div><div class="line">[#1] INFO:Minization -- The following global observables have been defined: (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::DoGLobalFit - find MLE </div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::DoMinimizeNLL - using Minuit / Migrad with strategy 1</div><div class="line">[#1] INFO:Fitting -- RooAddition::defaultErrorLevel(nll_simPdf_obsData_with_constr) Summation contains a RooNLLVar, using its error level</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">RooAbsTestStatistic::initSimMode: creating slave calculator #0 for state channel1 (2 dataset entries)</div><div class="line">[#1] INFO:NumericIntegration -- RooRealIntegral::init(channel1_model_Int[obs_x_channel1]) using numeric integrator RooBinIntegrator to calculate Int(obs_x_channel1)</div><div class="line">[#1] INFO:Fitting -- RooAbsTestStatistic::initSimMode: created 1 slave calculators.</div><div class="line">[#1] INFO:NumericIntegration -- RooRealIntegral::init(channel1_model_Int[obs_x_channel1]) using numeric integrator RooBinIntegrator to calculate Int(obs_x_channel1)</div><div class="line">[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal_channel1_nominal,background1_channel1_nominal,background2_channel1_nominal)</div><div class="line">[#1] INFO:Minization --  The following expressions will be evaluated in cache-and-track mode: (mc_stat_channel1)</div><div class="line">[#1] INFO:Minization -- </div><div class="line">  RooFitResult: minimized FCN value: -1033.78, estimated distance to minimum: 2.39561e-08</div><div class="line">                covariance matrix quality: Full, accurate covariance matrix</div><div class="line">                Status : MINIMIZE=0 </div><div class="line"></div><div class="line">    Floating Parameter    FinalValue +/-  Error   </div><div class="line">  --------------------  --------------------------</div><div class="line">         SigXsecOverSM    1.1153e+00 +/-  5.86e-01</div><div class="line">           alpha_syst2   -8.9017e-03 +/-  9.82e-01</div><div class="line">           alpha_syst3    1.7918e-02 +/-  9.48e-01</div><div class="line">  gamma_stat_channel1_bin_0    9.9955e-01 +/-  4.93e-02</div><div class="line">  gamma_stat_channel1_bin_1    1.0036e+00 +/-  8.01e-02</div><div class="line"></div><div class="line">Warning: lower value for SigXsecOverSM is at limit 0</div><div class="line"></div><div class="line"></div><div class="line">--------------------------------------</div><div class="line">Will generate sampling distribution at SigXsecOverSM = 2.32744</div><div class="line">  1) 0x36dc750 RooRealVar::             SigXsecOverSM = 2.32744 +/- 0.586082  L(-3 - 3)  &quot;SigXsecOverSM&quot;</div><div class="line">  2) 0x36d8ec0 RooRealVar::               alpha_syst2 = 0.710796 +/- 0.982182  L(-5 - 5)  &quot;alpha_syst2&quot;</div><div class="line">  3) 0x36dfd80 RooRealVar::               alpha_syst3 = 0.260222 +/- 0.947589  L(-5 - 5)  &quot;alpha_syst3&quot;</div><div class="line">  4) 0x291e840 RooRealVar:: gamma_stat_channel1_bin_0 = 1.03668 +/- 0.0493173  L(0 - 1.25)  &quot;gamma_stat_channel1_bin_0&quot;</div><div class="line">  5) 0x36983e0 RooRealVar:: gamma_stat_channel1_bin_1 = 1.05157 +/- 0.080065  L(0 - 1.5)  &quot;gamma_stat_channel1_bin_1&quot;</div><div class="line">[#0] PROGRESS:Generation -- generated toys: 500 / 1000</div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TFile_8h.html">TFile.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TROOT_8h.html">TROOT.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TH1F_8h.html">TH1F.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TSystem_8h.html">TSystem.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TF1_8h.html">TF1.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TSystem_8h.html">TSystem.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooWorkspace_8h.html">RooWorkspace.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooAbsData_8h.html">RooAbsData.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ModelConfig_8h.html">RooStats/ModelConfig.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="FeldmanCousins_8h.html">RooStats/FeldmanCousins.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ToyMCSampler_8h.html">RooStats/ToyMCSampler.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="PointSetInterval_8h.html">RooStats/PointSetInterval.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ConfidenceBelt_8h.html">RooStats/ConfidenceBelt.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ProfileLikelihoodCalculator_8h.html">RooStats/ProfileLikelihoodCalculator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="LikelihoodInterval_8h.html">RooStats/LikelihoodInterval.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ProfileLikelihoodTestStat_8h.html">RooStats/ProfileLikelihoodTestStat.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SamplingDistribution_8h.html">RooStats/SamplingDistribution.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SamplingDistPlot_8h.html">RooStats/SamplingDistPlot.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooFit.html">RooFit</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooStats.html">RooStats</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">bool</span> useProof = <span class="keyword">false</span>; <span class="comment">// flag to control whether to use Proof</span></div><div class="line"><span class="keywordtype">int</span> nworkers = 0;      <span class="comment">// number of workers (default use all available cores)</span></div><div class="line"></div><div class="line"><span class="comment">// -------------------------------------------------------</span></div><div class="line"><span class="comment">// The actual macro</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> StandardTestStatDistributionDemo(<span class="keyword">const</span> <span class="keywordtype">char</span> *infile = <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *workspaceName = <span class="stringliteral">&quot;combined&quot;</span>,</div><div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *modelConfigName = <span class="stringliteral">&quot;ModelConfig&quot;</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *dataName = <span class="stringliteral">&quot;obsData&quot;</span>)</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// the number of toy MC used to generate the distribution</span></div><div class="line">   <span class="keywordtype">int</span> nToyMC = 1000;</div><div class="line">   <span class="comment">// The parameter below is needed for asymptotic distribution to be chi-square,</span></div><div class="line">   <span class="comment">// but set to false if your model is not numerically stable if mu&lt;0</span></div><div class="line">   <span class="keywordtype">bool</span> allowNegativeMu = <span class="keyword">true</span>;</div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------------</span></div><div class="line">   <span class="comment">// First part is just to access a user-defined file</span></div><div class="line">   <span class="comment">// or create the standard example file if it doesn&#39;t exist</span></div><div class="line">   <span class="keyword">const</span> <span class="keywordtype">char</span> *filename = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line">   <span class="keywordflow">if</span> (!strcmp(infile, <span class="stringliteral">&quot;&quot;</span>)) {</div><div class="line">      filename = <span class="stringliteral">&quot;results/example_combined_GaussExample_model.root&quot;</span>;</div><div class="line">      <span class="keywordtype">bool</span> fileExist = !<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(filename); <span class="comment">// note opposite return code</span></div><div class="line">      <span class="comment">// if file does not exists generate with histfactory</span></div><div class="line">      <span class="keywordflow">if</span> (!fileExist) {</div><div class="line"><span class="preprocessor">#ifdef _WIN32</span></div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;HistFactory file cannot be generated on Windows - exit&quot;</span> &lt;&lt; endl;</div><div class="line">         <span class="keywordflow">return</span>;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">         <span class="comment">// Normally this would be run on the command line</span></div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;will run standard hist2workspace example&quot;</span> &lt;&lt; endl;</div><div class="line">         <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLine(<span class="stringliteral">&quot;.! prepareHistFactory .&quot;</span>);</div><div class="line">         <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLine(<span class="stringliteral">&quot;.! hist2workspace config/example.xml&quot;</span>);</div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;\n\n---------------------&quot;</span> &lt;&lt; endl;</div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;Done creating example input&quot;</span> &lt;&lt; endl;</div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;---------------------\n\n&quot;</span> &lt;&lt; endl;</div><div class="line">      }</div><div class="line"></div><div class="line">   } <span class="keywordflow">else</span></div><div class="line">      filename = infile;</div><div class="line"></div><div class="line">   <span class="comment">// Try to open the file</span></div><div class="line">   <a class="code" href="classTFile.html">TFile</a> *<a class="code" href="namespacefile.html">file</a> = <a class="code" href="classTFile.html#aec5f3fae0774aabfc615ebb4b00fe5e0">TFile::Open</a>(filename);</div><div class="line"></div><div class="line">   <span class="comment">// if input file was specified byt not found, quit</span></div><div class="line">   <span class="keywordflow">if</span> (!<a class="code" href="namespacefile.html">file</a>) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;StandardRooStatsDemoMacro: Input file &quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot; is not found&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------------</span></div><div class="line">   <span class="comment">// Now get the data and workspace</span></div><div class="line"></div><div class="line">   <span class="comment">// get the workspace out of the file</span></div><div class="line">   <a class="code" href="classRooWorkspace.html">RooWorkspace</a> *w = (<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *)<a class="code" href="namespacefile.html">file</a>-&gt;Get(workspaceName);</div><div class="line">   <span class="keywordflow">if</span> (!w) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;workspace not found&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// get the modelConfig out of the file</span></div><div class="line">   <a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> *mc = (<a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> *)w-&gt;<a class="code" href="classRooWorkspace.html#af56548d1c16301ebaf951c452d52f5c3">obj</a>(modelConfigName);</div><div class="line"></div><div class="line">   <span class="comment">// get the modelConfig out of the file</span></div><div class="line">   <a class="code" href="classRooAbsData.html">RooAbsData</a> *data = w-&gt;<a class="code" href="classRooWorkspace.html#a2e0683ca1b7375eaa434a9cc1298e736">data</a>(dataName);</div><div class="line"></div><div class="line">   <span class="comment">// make sure ingredients are found</span></div><div class="line">   <span class="keywordflow">if</span> (!data || !mc) {</div><div class="line">      w-&gt;<a class="code" href="classRooWorkspace.html#a9131cf30e7ea371b14a619ebf0d7e18f">Print</a>();</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;data or ModelConfig was not found&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ab2661258bee58609834f02ab52b1e634">Print</a>();</div><div class="line">   <span class="comment">// -------------------------------------------------------</span></div><div class="line">   <span class="comment">// Now find the upper limit based on the asymptotic results</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *firstPOI = (<a class="code" href="classRooRealVar.html">RooRealVar</a> *)mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>()-&gt;<a class="code" href="classRooAbsCollection.html#a225c780c4c32077d6923e956225e437a">first</a>();</div><div class="line">   <a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html">ProfileLikelihoodCalculator</a> plc(*data, *mc);</div><div class="line">   <a class="code" href="classRooStats_1_1LikelihoodInterval.html">LikelihoodInterval</a> *interval = plc.<a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html#a67b7b9939206276888006e195d7d30f6">GetInterval</a>();</div><div class="line">   <span class="keywordtype">double</span> plcUpperLimit = interval-&gt;<a class="code" href="classRooStats_1_1LikelihoodInterval.html#a8083e0c3adbd18cd86f0048846981d36">UpperLimit</a>(*firstPOI);</div><div class="line">   <span class="keyword">delete</span> interval;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;\n\n--------------------------------------&quot;</span> &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Will generate sampling distribution at &quot;</span> &lt;&lt; firstPOI-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>() &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; plcUpperLimit &lt;&lt; endl;</div><div class="line">   <span class="keywordtype">int</span> nPOI = mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>()-&gt;<a class="code" href="classRooAbsCollection.html#a4cd5c184f7be3a6a1ec80d7f8ff5842e">getSize</a>();</div><div class="line">   <span class="keywordflow">if</span> (nPOI &gt; 1) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;not sure what to do with other parameters of interest, but here are their values&quot;</span> &lt;&lt; endl;</div><div class="line">      mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>()-&gt;<a class="code" href="classRooAbsCollection.html#ab988655a6fe646baa9c6a6b5456c3aa0">Print</a>(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------------</span></div><div class="line">   <span class="comment">// create the test stat sampler</span></div><div class="line">   <a class="code" href="classRooStats_1_1ProfileLikelihoodTestStat.html">ProfileLikelihoodTestStat</a> ts(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>());</div><div class="line"></div><div class="line">   <span class="comment">// to avoid effects from boundary and simplify asymptotic comparison, set min=-max</span></div><div class="line">   <span class="keywordflow">if</span> (allowNegativeMu)</div><div class="line">      firstPOI-&gt;<a class="code" href="classRooRealVar.html#a444de70cdf8b4f87deed67a7760a2a45">setMin</a>(-1 * firstPOI-&gt;<a class="code" href="classRooAbsRealLValue.html#a07d826bfa29ecd48e8e31ed28bd0bc48">getMax</a>());</div><div class="line"></div><div class="line">   <span class="comment">// temporary RooArgSet</span></div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> poi;</div><div class="line">   poi.<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>());</div><div class="line"></div><div class="line">   <span class="comment">// create and configure the ToyMCSampler</span></div><div class="line">   <a class="code" href="classRooStats_1_1ToyMCSampler.html">ToyMCSampler</a> sampler(ts, nToyMC);</div><div class="line">   sampler.<a class="code" href="classRooStats_1_1ToyMCSampler.html#a71dc144f902f42b228577480068cb773">SetPdf</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>());</div><div class="line">   sampler.<a class="code" href="classRooStats_1_1ToyMCSampler.html#a4e48a6405f68f626268ccb81f38187d2">SetObservables</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a658c1a5b9ba572686d72acf76587e913">GetObservables</a>());</div><div class="line">   sampler.<a class="code" href="classRooStats_1_1ToyMCSampler.html#aa838b03fde977cb8363cdacf1cf9c56f">SetGlobalObservables</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>());</div><div class="line">   <span class="keywordflow">if</span> (!mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#a69d77200d6313129397ac2aa8deef408">canBeExtended</a>() &amp;&amp; (data-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>() == 1)) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;tell it to use 1 event&quot;</span> &lt;&lt; endl;</div><div class="line">      sampler.<a class="code" href="classRooStats_1_1ToyMCSampler.html#adce3c86f2a53dab084118e650e743cd4">SetNEventsPerToy</a>(1);</div><div class="line">   }</div><div class="line">   firstPOI-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(plcUpperLimit);                                  <span class="comment">// set POI value for generation</span></div><div class="line">   sampler.<a class="code" href="classRooStats_1_1ToyMCSampler.html#afa67278f920990157eaa2449922559c8">SetParametersForTestStat</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>()); <span class="comment">// set POI value for evaluation</span></div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (useProof) {</div><div class="line">      <a class="code" href="classRooStats_1_1ProofConfig.html">ProofConfig</a> <a class="code" href="namespaceTGeant4Unit.html#a9b9c22ca28407dfecdc404f99df537bb">pc</a>(*w, nworkers, <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">false</span>);</div><div class="line">      sampler.<a class="code" href="classRooStats_1_1ToyMCSampler.html#a3518c12aaf49b74d3ef58e22b41de58c">SetProofConfig</a>(&amp;<a class="code" href="namespaceTGeant4Unit.html#a9b9c22ca28407dfecdc404f99df537bb">pc</a>); <span class="comment">// enable proof</span></div><div class="line">   }</div><div class="line"></div><div class="line">   firstPOI-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(plcUpperLimit);</div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> allParameters;</div><div class="line">   allParameters.<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>());</div><div class="line">   allParameters.<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>());</div><div class="line">   allParameters.<a class="code" href="classRooAbsCollection.html#ab988655a6fe646baa9c6a6b5456c3aa0">Print</a>(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1SamplingDistribution.html">SamplingDistribution</a> *sampDist = sampler.<a class="code" href="classRooStats_1_1ToyMCSampler.html#aeba969d7cd79e6ed126eecdd6bbbb1f6">GetSamplingDistribution</a>(allParameters);</div><div class="line">   <a class="code" href="classRooStats_1_1SamplingDistPlot.html">SamplingDistPlot</a> plot;</div><div class="line">   plot.<a class="code" href="classRooStats_1_1SamplingDistPlot.html#a35cc770c722060802599d98a01ca62e3">AddSamplingDistribution</a>(sampDist);</div><div class="line">   plot.<a class="code" href="classRooStats_1_1SamplingDistPlot.html#af6ad75919b0c2a80a71dcf12f86faff3">GetTH1F</a>(sampDist)-&gt;<a class="code" href="classTH1.html#a5cadfed83a4db70b4eae6b0a1cea3532">GetYaxis</a>()-&gt;<a class="code" href="classTNamed.html#a72f4d419b48a5fbfef07485b335139ca">SetTitle</a>(</div><div class="line">      <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;f(-log #lambda(#mu=%.2f) | #mu=%.2f)&quot;</span>, plcUpperLimit, plcUpperLimit));</div><div class="line">   plot.<a class="code" href="classRooStats_1_1SamplingDistPlot.html#adf1b28490fac37d5c9f0dce981b7d551">SetAxisTitle</a>(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;-log #lambda(#mu=%.2f)&quot;</span>, plcUpperLimit));</div><div class="line"></div><div class="line">   <a class="code" href="classTCanvas.html">TCanvas</a> *<a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a> = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>(<span class="stringliteral">&quot;c1&quot;</span>);</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;SetLogy();</div><div class="line">   plot.<a class="code" href="classRooStats_1_1SamplingDistPlot.html#aa7d6b8754c005683cf57b7bb5067fc29">Draw</a>();</div><div class="line">   <span class="keywordtype">double</span> min = plot.<a class="code" href="classRooStats_1_1SamplingDistPlot.html#af6ad75919b0c2a80a71dcf12f86faff3">GetTH1F</a>(sampDist)-&gt;<a class="code" href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">GetXaxis</a>()-&gt;<a class="code" href="classTAxis.html#abd579eacfc232c998e7e7dac2f246e57">GetXmin</a>();</div><div class="line">   <span class="keywordtype">double</span> max = plot.<a class="code" href="classRooStats_1_1SamplingDistPlot.html#af6ad75919b0c2a80a71dcf12f86faff3">GetTH1F</a>(sampDist)-&gt;<a class="code" href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">GetXaxis</a>()-&gt;<a class="code" href="classTAxis.html#a5ae359f6f1fbbb078cd425a383582b11">GetXmax</a>();</div><div class="line"></div><div class="line">   <a class="code" href="classTF1.html">TF1</a> *<a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a> = <span class="keyword">new</span> <a class="code" href="classTF1.html">TF1</a>(<span class="stringliteral">&quot;f&quot;</span>, <a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;2*ROOT::Math::chisquared_pdf(2*x,%d,0)&quot;</span>, nPOI), min, max);</div><div class="line">   <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;SaveAs(<span class="stringliteral">&quot;standard_test_stat_distribution.pdf&quot;</span>);</div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>Kyle Cranmer </dd></dl>

<p class="definition">Definition in file <a class="el" href="StandardTestStatDistributionDemo_8C_source.html">StandardTestStatDistributionDemo.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:28 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

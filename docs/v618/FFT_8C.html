<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/fft/FFT.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_b4678383c7398ea4b7537ec7b59c32f5.html">fft</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">FFT.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__fft.html">Fast Fourier Transforms tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/FFT.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/FFT.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  This tutorial illustrates the Fast Fourier Transforms interface in <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a>. </p>
<p>FFT transform types provided in <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a>:</p>
<ul>
<li>"C2CFORWARD" - a complex input/output discrete Fourier transform (DFT) in one or more dimensions, -1 in the exponent</li>
<li>"C2CBACKWARD"- a complex input/output discrete Fourier transform (DFT) in one or more dimensions, +1 in the exponent</li>
<li>"R2C" - a real-input/complex-output discrete Fourier transform (DFT) in one or more dimensions,</li>
<li>"C2R" - inverse transforms to "R2C", taking complex input (storing the non-redundant half of a logically Hermitian array) to real output</li>
<li>"R2HC" - a real-input DFT with output in "halfcomplex" format, i.e. real and imaginary parts for a transform of size n stored as r0, r1, r2, ..., rn/2, i(n+1)/2-1, ..., i2, i1</li>
<li>"HC2R" - computes the reverse of FFTW_R2HC, above</li>
<li>"DHT" - computes a discrete Hartley transform</li>
</ul>
<p>Sine/cosine transforms:</p>
<ul>
<li>DCT-I (REDFT00 in FFTW3 notation)</li>
<li>DCT-II (REDFT10 in FFTW3 notation)</li>
<li>DCT-III(REDFT01 in FFTW3 notation)</li>
<li>DCT-IV (REDFT11 in FFTW3 notation)</li>
<li>DST-I (RODFT00 in FFTW3 notation)</li>
<li>DST-II (RODFT10 in FFTW3 notation)</li>
<li>DST-III(RODFT01 in FFTW3 notation)</li>
<li>DST-IV (RODFT11 in FFTW3 notation)</li>
</ul>
<p>First part of the tutorial shows how to transform the histograms Second part shows how to transform the data arrays directly</p>
<div class="image">
<img src="pict1_FFT.C.png" alt="pict1_FFT.C.png" width="800"/>
</div>
 <div class="fragment"><div class="line"></div><div class="line">1st transform: DC component: 26.000000</div><div class="line">1st transform: Nyquist harmonic: -0.932840</div><div class="line">2nd transform: DC component: 29.000000</div><div class="line">2nd transform: Nyquist harmonic: -0.000000</div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TH1D_8h.html">TH1D.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TVirtualFFT_8h.html">TVirtualFFT.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TF1_8h.html">TF1.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TMath_8h.html">TMath.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> FFT()</div><div class="line">{</div><div class="line">   <span class="comment">// Histograms</span></div><div class="line">   <span class="comment">// =========</span></div><div class="line">   <span class="comment">//prepare the canvas for drawing</span></div><div class="line">   <a class="code" href="classTCanvas.html">TCanvas</a> *myc = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>(<span class="stringliteral">&quot;myc&quot;</span>, <span class="stringliteral">&quot;Fast Fourier Transform&quot;</span>, 800, 600);</div><div class="line">   myc-&gt;<a class="code" href="classTAttFill.html#a4c21db248e10de0dca2300f07f379ec9">SetFillColor</a>(45);</div><div class="line">   <a class="code" href="classTPad.html">TPad</a> *c1_1 = <span class="keyword">new</span> <a class="code" href="classTPad.html">TPad</a>(<span class="stringliteral">&quot;c1_1&quot;</span>, <span class="stringliteral">&quot;c1_1&quot;</span>,0.01,0.67,0.49,0.99);</div><div class="line">   <a class="code" href="classTPad.html">TPad</a> *c1_2 = <span class="keyword">new</span> <a class="code" href="classTPad.html">TPad</a>(<span class="stringliteral">&quot;c1_2&quot;</span>, <span class="stringliteral">&quot;c1_2&quot;</span>,0.51,0.67,0.99,0.99);</div><div class="line">   <a class="code" href="classTPad.html">TPad</a> *c1_3 = <span class="keyword">new</span> <a class="code" href="classTPad.html">TPad</a>(<span class="stringliteral">&quot;c1_3&quot;</span>, <span class="stringliteral">&quot;c1_3&quot;</span>,0.01,0.34,0.49,0.65);</div><div class="line">   <a class="code" href="classTPad.html">TPad</a> *c1_4 = <span class="keyword">new</span> <a class="code" href="classTPad.html">TPad</a>(<span class="stringliteral">&quot;c1_4&quot;</span>, <span class="stringliteral">&quot;c1_4&quot;</span>,0.51,0.34,0.99,0.65);</div><div class="line">   <a class="code" href="classTPad.html">TPad</a> *c1_5 = <span class="keyword">new</span> <a class="code" href="classTPad.html">TPad</a>(<span class="stringliteral">&quot;c1_5&quot;</span>, <span class="stringliteral">&quot;c1_5&quot;</span>,0.01,0.01,0.49,0.32);</div><div class="line">   <a class="code" href="classTPad.html">TPad</a> *c1_6 = <span class="keyword">new</span> <a class="code" href="classTPad.html">TPad</a>(<span class="stringliteral">&quot;c1_6&quot;</span>, <span class="stringliteral">&quot;c1_6&quot;</span>,0.51,0.01,0.99,0.32);</div><div class="line">   c1_1-&gt;<a class="code" href="classTPad.html#ad61b17f888595b7cff7fe84aafae4b6b">Draw</a>();</div><div class="line">   c1_2-&gt;<a class="code" href="classTPad.html#ad61b17f888595b7cff7fe84aafae4b6b">Draw</a>();</div><div class="line">   c1_3-&gt;<a class="code" href="classTPad.html#ad61b17f888595b7cff7fe84aafae4b6b">Draw</a>();</div><div class="line">   c1_4-&gt;<a class="code" href="classTPad.html#ad61b17f888595b7cff7fe84aafae4b6b">Draw</a>();</div><div class="line">   c1_5-&gt;<a class="code" href="classTPad.html#ad61b17f888595b7cff7fe84aafae4b6b">Draw</a>();</div><div class="line">   c1_6-&gt;<a class="code" href="classTPad.html#ad61b17f888595b7cff7fe84aafae4b6b">Draw</a>();</div><div class="line">   c1_1-&gt;<a class="code" href="classTAttFill.html#a4c21db248e10de0dca2300f07f379ec9">SetFillColor</a>(30);</div><div class="line">   c1_1-&gt;<a class="code" href="classTAttPad.html#a1c8f28668a5a41795d2a126f34e55880">SetFrameFillColor</a>(42);</div><div class="line">   c1_2-&gt;<a class="code" href="classTAttFill.html#a4c21db248e10de0dca2300f07f379ec9">SetFillColor</a>(30);</div><div class="line">   c1_2-&gt;<a class="code" href="classTAttPad.html#a1c8f28668a5a41795d2a126f34e55880">SetFrameFillColor</a>(42);</div><div class="line">   c1_3-&gt;<a class="code" href="classTAttFill.html#a4c21db248e10de0dca2300f07f379ec9">SetFillColor</a>(30);</div><div class="line">   c1_3-&gt;<a class="code" href="classTAttPad.html#a1c8f28668a5a41795d2a126f34e55880">SetFrameFillColor</a>(42);</div><div class="line">   c1_4-&gt;<a class="code" href="classTAttFill.html#a4c21db248e10de0dca2300f07f379ec9">SetFillColor</a>(30);</div><div class="line">   c1_4-&gt;<a class="code" href="classTAttPad.html#a1c8f28668a5a41795d2a126f34e55880">SetFrameFillColor</a>(42);</div><div class="line">   c1_5-&gt;<a class="code" href="classTAttFill.html#a4c21db248e10de0dca2300f07f379ec9">SetFillColor</a>(30);</div><div class="line">   c1_5-&gt;<a class="code" href="classTAttPad.html#a1c8f28668a5a41795d2a126f34e55880">SetFrameFillColor</a>(42);</div><div class="line">   c1_6-&gt;<a class="code" href="classTAttFill.html#a4c21db248e10de0dca2300f07f379ec9">SetFillColor</a>(30);</div><div class="line">   c1_6-&gt;<a class="code" href="classTAttPad.html#a1c8f28668a5a41795d2a126f34e55880">SetFrameFillColor</a>(42);</div><div class="line"></div><div class="line">   c1_1-&gt;<a class="code" href="classTPad.html#aec4a3ba705d14dc2fd95ca64a0886620">cd</a>();</div><div class="line">   <a class="code" href="classTH1.html#a490b9d2cf9460f8428f104d7e0f82614">TH1::AddDirectory</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>);</div><div class="line"></div><div class="line">   <span class="comment">//A function to sample</span></div><div class="line">   <a class="code" href="classTF1.html">TF1</a> *fsin = <span class="keyword">new</span> <a class="code" href="classTF1.html">TF1</a>(<span class="stringliteral">&quot;fsin&quot;</span>, <span class="stringliteral">&quot;sin(x)+sin(2*x)+sin(0.5*x)+1&quot;</span>, 0, 4*<a class="code" href="namespaceTMath.html#ab7512d834c08404cd5110251f5a31099">TMath::Pi</a>());</div><div class="line">   fsin-&gt;<a class="code" href="classTF1.html#ab2c6b27e1558988dc7399408666588fa">Draw</a>();</div><div class="line"></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>=25;</div><div class="line">   <a class="code" href="classTH1D.html">TH1D</a> *hsin = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;hsin&quot;</span>, <span class="stringliteral">&quot;hsin&quot;</span>, <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>+1, 0, 4*<a class="code" href="namespaceTMath.html#ab7512d834c08404cd5110251f5a31099">TMath::Pi</a>());</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>;</div><div class="line"></div><div class="line">   <span class="comment">//Fill the histogram with function values</span></div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i=0; i&lt;=<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; i++){</div><div class="line">      <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>(i)/<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>)*(4*<a class="code" href="namespaceTMath.html#ab7512d834c08404cd5110251f5a31099">TMath::Pi</a>());</div><div class="line">      hsin-&gt;<a class="code" href="classTH1.html#a9599e2dae40c574fd9d8970aaf638ee6">SetBinContent</a>(i+1, fsin-&gt;<a class="code" href="classTF1.html#ada14729afe8e4d63d07c28a71e0585d4">Eval</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>));</div><div class="line">   }</div><div class="line">   hsin-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>(<span class="stringliteral">&quot;same&quot;</span>);</div><div class="line">   fsin-&gt;<a class="code" href="classTF1.html#afaede67f5a31577ab43b53da7f3ceb4e">GetXaxis</a>()-&gt;<a class="code" href="classTAttAxis.html#a59684f3441f945f1b2d4e6970ad3d1b5">SetLabelSize</a>(0.05);</div><div class="line">   fsin-&gt;<a class="code" href="classTF1.html#a1ddafd32fb486c0c065ba7bbe019cf91">GetYaxis</a>()-&gt;<a class="code" href="classTAttAxis.html#a59684f3441f945f1b2d4e6970ad3d1b5">SetLabelSize</a>(0.05);</div><div class="line"></div><div class="line">   c1_2-&gt;<a class="code" href="classTPad.html#aec4a3ba705d14dc2fd95ca64a0886620">cd</a>();</div><div class="line">   <span class="comment">//Compute the transform and look at the magnitude of the output</span></div><div class="line">   <a class="code" href="classTH1.html">TH1</a> *hm =0;</div><div class="line">   <a class="code" href="classTVirtualFFT.html#a242edf3faf69bbea89745ba89a5d257e">TVirtualFFT::SetTransform</a>(0);</div><div class="line">   hm = hsin-&gt;<a class="code" href="classTH1.html#a69321e3106e4a26db3fef4d126d835ff">FFT</a>(hm, <span class="stringliteral">&quot;MAG&quot;</span>);</div><div class="line">   hm-&gt;<a class="code" href="classTH1.html#a0b3078e8577dd9009d7d269cfae23442">SetTitle</a>(<span class="stringliteral">&quot;Magnitude of the 1st transform&quot;</span>);</div><div class="line">   hm-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line">   <span class="comment">//NOTE: for &quot;real&quot; frequencies you have to divide the x-axes range with the range of your function</span></div><div class="line">   <span class="comment">//(in this case 4*Pi); y-axes has to be rescaled by a factor of 1/SQRT(n) to be right: this is not done automatically!</span></div><div class="line"></div><div class="line">   hm-&gt;<a class="code" href="classTH1.html#afd36e57d93056e578d73291ae3e1bb01">SetStats</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>);</div><div class="line">   hm-&gt;<a class="code" href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">GetXaxis</a>()-&gt;<a class="code" href="classTAttAxis.html#a59684f3441f945f1b2d4e6970ad3d1b5">SetLabelSize</a>(0.05);</div><div class="line">   hm-&gt;<a class="code" href="classTH1.html#a5cadfed83a4db70b4eae6b0a1cea3532">GetYaxis</a>()-&gt;<a class="code" href="classTAttAxis.html#a59684f3441f945f1b2d4e6970ad3d1b5">SetLabelSize</a>(0.05);</div><div class="line">   c1_3-&gt;<a class="code" href="classTPad.html#aec4a3ba705d14dc2fd95ca64a0886620">cd</a>();</div><div class="line">   <span class="comment">//Look at the phase of the output</span></div><div class="line">   <a class="code" href="classTH1.html">TH1</a> *hp = 0;</div><div class="line">   hp = hsin-&gt;<a class="code" href="classTH1.html#a69321e3106e4a26db3fef4d126d835ff">FFT</a>(hp, <span class="stringliteral">&quot;PH&quot;</span>);</div><div class="line">   hp-&gt;<a class="code" href="classTH1.html#a0b3078e8577dd9009d7d269cfae23442">SetTitle</a>(<span class="stringliteral">&quot;Phase of the 1st transform&quot;</span>);</div><div class="line">   hp-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line">   hp-&gt;<a class="code" href="classTH1.html#afd36e57d93056e578d73291ae3e1bb01">SetStats</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>);</div><div class="line">   hp-&gt;<a class="code" href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">GetXaxis</a>()-&gt;<a class="code" href="classTAttAxis.html#a59684f3441f945f1b2d4e6970ad3d1b5">SetLabelSize</a>(0.05);</div><div class="line">   hp-&gt;<a class="code" href="classTH1.html#a5cadfed83a4db70b4eae6b0a1cea3532">GetYaxis</a>()-&gt;<a class="code" href="classTAttAxis.html#a59684f3441f945f1b2d4e6970ad3d1b5">SetLabelSize</a>(0.05);</div><div class="line"></div><div class="line">   <span class="comment">//Look at the DC component and the Nyquist harmonic:</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> re, im;</div><div class="line">   <span class="comment">//That&#39;s the way to get the current transform object:</span></div><div class="line">   <a class="code" href="classTVirtualFFT.html">TVirtualFFT</a> *fft = <a class="code" href="classTVirtualFFT.html#a733ae128e3aba19db2281a9652e109ce">TVirtualFFT::GetCurrentTransform</a>();</div><div class="line">   c1_4-&gt;<a class="code" href="classTPad.html#aec4a3ba705d14dc2fd95ca64a0886620">cd</a>();</div><div class="line">   <span class="comment">//Use the following method to get just one point of the output</span></div><div class="line">   fft-&gt;<a class="code" href="classTVirtualFFT.html#a8a4e9b64f5b0e715ff354e4441180dfb">GetPointComplex</a>(0, re, im);</div><div class="line">   printf(<span class="stringliteral">&quot;1st transform: DC component: %f\n&quot;</span>, re);</div><div class="line">   fft-&gt;<a class="code" href="classTVirtualFFT.html#a8a4e9b64f5b0e715ff354e4441180dfb">GetPointComplex</a>(<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>/2+1, re, im);</div><div class="line">   printf(<span class="stringliteral">&quot;1st transform: Nyquist harmonic: %f\n&quot;</span>, re);</div><div class="line"></div><div class="line">   <span class="comment">//Use the following method to get the full output:</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *re_full = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>];</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *im_full = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>];</div><div class="line">   fft-&gt;<a class="code" href="classTVirtualFFT.html#a9e815f4a8d799f46e7e1393751878c19">GetPointsComplex</a>(re_full,im_full);</div><div class="line"></div><div class="line">   <span class="comment">//Now let&#39;s make a backward transform:</span></div><div class="line">   <a class="code" href="classTVirtualFFT.html">TVirtualFFT</a> *fft_back = <a class="code" href="classTVirtualFFT.html#a68f66680ce0198f6ceddf380b55bedeb">TVirtualFFT::FFT</a>(1, &amp;<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>, <span class="stringliteral">&quot;C2R M K&quot;</span>);</div><div class="line">   fft_back-&gt;<a class="code" href="classTVirtualFFT.html#a7da8d51795a5a595a51b5849be095a7a">SetPointsComplex</a>(re_full,im_full);</div><div class="line">   fft_back-&gt;<a class="code" href="classTVirtualFFT.html#a81dafc6932ba31922e1c4b9350be8562">Transform</a>();</div><div class="line">   <a class="code" href="classTH1.html">TH1</a> *hb = 0;</div><div class="line">   <span class="comment">//Let&#39;s look at the output</span></div><div class="line">   hb = <a class="code" href="classTH1.html#a32f93abdded52db93b4eec74e817ee7d">TH1::TransformHisto</a>(fft_back,hb,<span class="stringliteral">&quot;Re&quot;</span>);</div><div class="line">   hb-&gt;<a class="code" href="classTH1.html#a0b3078e8577dd9009d7d269cfae23442">SetTitle</a>(<span class="stringliteral">&quot;The backward transform result&quot;</span>);</div><div class="line">   hb-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line">   <span class="comment">//NOTE: here you get at the x-axes number of bins and not real values</span></div><div class="line">   <span class="comment">//(in this case 25 bins has to be rescaled to a range between 0 and 4*Pi;</span></div><div class="line">   <span class="comment">//also here the y-axes has to be rescaled (factor 1/bins)</span></div><div class="line">   hb-&gt;<a class="code" href="classTH1.html#afd36e57d93056e578d73291ae3e1bb01">SetStats</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>);</div><div class="line">   hb-&gt;<a class="code" href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">GetXaxis</a>()-&gt;<a class="code" href="classTAttAxis.html#a59684f3441f945f1b2d4e6970ad3d1b5">SetLabelSize</a>(0.05);</div><div class="line">   hb-&gt;<a class="code" href="classTH1.html#a5cadfed83a4db70b4eae6b0a1cea3532">GetYaxis</a>()-&gt;<a class="code" href="classTAttAxis.html#a59684f3441f945f1b2d4e6970ad3d1b5">SetLabelSize</a>(0.05);</div><div class="line">   <span class="keyword">delete</span> fft_back;</div><div class="line">   fft_back=0;</div><div class="line"></div><div class="line"><span class="comment">// Data array - same transform</span></div><div class="line"><span class="comment">// ===========================</span></div><div class="line"></div><div class="line">   <span class="comment">//Allocate an array big enough to hold the transform output</span></div><div class="line">   <span class="comment">//Transform output in 1d contains, for a transform of size N,</span></div><div class="line">   <span class="comment">//N/2+1 complex numbers, i.e. 2*(N/2+1) real numbers</span></div><div class="line">   <span class="comment">//our transform is of size n+1, because the histogram has n+1 bins</span></div><div class="line"></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *in = <span class="keyword">new</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>[2*((<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>+1)/2+1)];</div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> re_2,im_2;</div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i=0; i&lt;=<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; i++){</div><div class="line">      <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>(i)/<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>)*(4*<a class="code" href="namespaceTMath.html#ab7512d834c08404cd5110251f5a31099">TMath::Pi</a>());</div><div class="line">      in[i] =  fsin-&gt;<a class="code" href="classTF1.html#ada14729afe8e4d63d07c28a71e0585d4">Eval</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>);</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">//Make our own TVirtualFFT object (using option &quot;K&quot;)</span></div><div class="line">   <span class="comment">//Third parameter (option) consists of 3 parts:</span></div><div class="line">   <span class="comment">//- transform type:</span></div><div class="line">   <span class="comment">// real input/complex output in our case</span></div><div class="line">   <span class="comment">//- transform flag:</span></div><div class="line">   <span class="comment">// the amount of time spent in planning</span></div><div class="line">   <span class="comment">// the transform (see TVirtualFFT class description)</span></div><div class="line">   <span class="comment">//- to create a new TVirtualFFT object (option &quot;K&quot;) or use the global (default)</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> n_size = <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>+1;</div><div class="line">   <a class="code" href="classTVirtualFFT.html">TVirtualFFT</a> *fft_own = <a class="code" href="classTVirtualFFT.html#a68f66680ce0198f6ceddf380b55bedeb">TVirtualFFT::FFT</a>(1, &amp;n_size, <span class="stringliteral">&quot;R2C ES K&quot;</span>);</div><div class="line">   <span class="keywordflow">if</span> (!fft_own) <span class="keywordflow">return</span>;</div><div class="line">   fft_own-&gt;<a class="code" href="classTVirtualFFT.html#a7b31e4957fda89515a158846a172c0d3">SetPoints</a>(in);</div><div class="line">   fft_own-&gt;<a class="code" href="classTVirtualFFT.html#a81dafc6932ba31922e1c4b9350be8562">Transform</a>();</div><div class="line"></div><div class="line">   <span class="comment">//Copy all the output points:</span></div><div class="line">   fft_own-&gt;<a class="code" href="classTVirtualFFT.html#a511742e54c1108b6b7cff331b194b935">GetPoints</a>(in);</div><div class="line">   <span class="comment">//Draw the real part of the output</span></div><div class="line">   c1_5-&gt;<a class="code" href="classTPad.html#aec4a3ba705d14dc2fd95ca64a0886620">cd</a>();</div><div class="line">   <a class="code" href="classTH1.html">TH1</a> *hr = 0;</div><div class="line">   hr = <a class="code" href="classTH1.html#a32f93abdded52db93b4eec74e817ee7d">TH1::TransformHisto</a>(fft_own, hr, <span class="stringliteral">&quot;RE&quot;</span>);</div><div class="line">   hr-&gt;<a class="code" href="classTH1.html#a0b3078e8577dd9009d7d269cfae23442">SetTitle</a>(<span class="stringliteral">&quot;Real part of the 3rd (array) tranfsorm&quot;</span>);</div><div class="line">   hr-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line">   hr-&gt;<a class="code" href="classTH1.html#afd36e57d93056e578d73291ae3e1bb01">SetStats</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>);</div><div class="line">   hr-&gt;<a class="code" href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">GetXaxis</a>()-&gt;<a class="code" href="classTAttAxis.html#a59684f3441f945f1b2d4e6970ad3d1b5">SetLabelSize</a>(0.05);</div><div class="line">   hr-&gt;<a class="code" href="classTH1.html#a5cadfed83a4db70b4eae6b0a1cea3532">GetYaxis</a>()-&gt;<a class="code" href="classTAttAxis.html#a59684f3441f945f1b2d4e6970ad3d1b5">SetLabelSize</a>(0.05);</div><div class="line">   c1_6-&gt;<a class="code" href="classTPad.html#aec4a3ba705d14dc2fd95ca64a0886620">cd</a>();</div><div class="line">   <a class="code" href="classTH1.html">TH1</a> *him = 0;</div><div class="line">   him = <a class="code" href="classTH1.html#a32f93abdded52db93b4eec74e817ee7d">TH1::TransformHisto</a>(fft_own, him, <span class="stringliteral">&quot;IM&quot;</span>);</div><div class="line">   him-&gt;<a class="code" href="classTH1.html#a0b3078e8577dd9009d7d269cfae23442">SetTitle</a>(<span class="stringliteral">&quot;Im. part of the 3rd (array) transform&quot;</span>);</div><div class="line">   him-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line">   him-&gt;<a class="code" href="classTH1.html#afd36e57d93056e578d73291ae3e1bb01">SetStats</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>);</div><div class="line">   him-&gt;<a class="code" href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">GetXaxis</a>()-&gt;<a class="code" href="classTAttAxis.html#a59684f3441f945f1b2d4e6970ad3d1b5">SetLabelSize</a>(0.05);</div><div class="line">   him-&gt;<a class="code" href="classTH1.html#a5cadfed83a4db70b4eae6b0a1cea3532">GetYaxis</a>()-&gt;<a class="code" href="classTAttAxis.html#a59684f3441f945f1b2d4e6970ad3d1b5">SetLabelSize</a>(0.05);</div><div class="line"></div><div class="line">   myc-&gt;<a class="code" href="classTCanvas.html#ad996aa7bc34186944363b48963de4de5">cd</a>();</div><div class="line">   <span class="comment">//Now let&#39;s make another transform of the same size</span></div><div class="line">   <span class="comment">//The same transform object can be used, as the size and the type of the transform</span></div><div class="line">   <span class="comment">//haven&#39;t changed</span></div><div class="line">   <a class="code" href="classTF1.html">TF1</a> *fcos = <span class="keyword">new</span> <a class="code" href="classTF1.html">TF1</a>(<span class="stringliteral">&quot;fcos&quot;</span>, <span class="stringliteral">&quot;cos(x)+cos(0.5*x)+cos(2*x)+1&quot;</span>, 0, 4*<a class="code" href="namespaceTMath.html#ab7512d834c08404cd5110251f5a31099">TMath::Pi</a>());</div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i=0; i&lt;=<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; i++){</div><div class="line">      <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = (<a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a>(i)/<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>)*(4*<a class="code" href="namespaceTMath.html#ab7512d834c08404cd5110251f5a31099">TMath::Pi</a>());</div><div class="line">      in[i] =  fcos-&gt;<a class="code" href="classTF1.html#ada14729afe8e4d63d07c28a71e0585d4">Eval</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>);</div><div class="line">   }</div><div class="line">   fft_own-&gt;<a class="code" href="classTVirtualFFT.html#a7b31e4957fda89515a158846a172c0d3">SetPoints</a>(in);</div><div class="line">   fft_own-&gt;<a class="code" href="classTVirtualFFT.html#a81dafc6932ba31922e1c4b9350be8562">Transform</a>();</div><div class="line">   fft_own-&gt;<a class="code" href="classTVirtualFFT.html#a8a4e9b64f5b0e715ff354e4441180dfb">GetPointComplex</a>(0, re_2, im_2);</div><div class="line">   printf(<span class="stringliteral">&quot;2nd transform: DC component: %f\n&quot;</span>, re_2);</div><div class="line">   fft_own-&gt;<a class="code" href="classTVirtualFFT.html#a8a4e9b64f5b0e715ff354e4441180dfb">GetPointComplex</a>(<a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>/2+1, re_2, im_2);</div><div class="line">   printf(<span class="stringliteral">&quot;2nd transform: Nyquist harmonic: %f\n&quot;</span>, re_2);</div><div class="line">   <span class="keyword">delete</span> fft_own;</div><div class="line">   <span class="keyword">delete</span> [] in;</div><div class="line">   <span class="keyword">delete</span> [] re_full;</div><div class="line">   <span class="keyword">delete</span> [] im_full;</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><dl class="section author"><dt>Authors</dt><dd>Anna Kreshuk, Jens Hoffmann </dd></dl>

<p class="definition">Definition in file <a class="el" href="FFT_8C_source.html">FFT.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:06 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

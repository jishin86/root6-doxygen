<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/roostats/rs102_hypotestwithshapes.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_87facaa6959ceb8d3dacccaf663f7b84.html">roostats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">rs102_hypotestwithshapes.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__roostats.html">RooStats Tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/rs102_hypotestwithshapes.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/rs102_hypotestwithshapes.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  A typical search for a new particle by studying an invariant mass distribution </p>
<p>The macro creates a simple signal model and two background models, which are added to a <a class="el" href="classRooWorkspace.html" title="The RooWorkspace is a persistable container for RooFit projects. ">RooWorkspace</a>. The macro creates a toy dataset, and then uses a <a class="el" href="namespaceRooStats.html" title="Namespace for the RooStats classes. ">RooStats</a> ProfileLikleihoodCalculator to do a hypothesis test of the background-only and signal+background hypotheses. In this example, shape uncertainties are not taken into account, but normalization uncertainties are.</p>
<div class="image">
<img src="pict1_rs102_hypotestwithshapes.C.png" alt="pict1_rs102_hypotestwithshapes.C.png" width="700"/>
</div>
 <div class="image">
<img src="pict2_rs102_hypotestwithshapes.C.png" alt="pict2_rs102_hypotestwithshapes.C.png" width="700"/>
</div>
 <div class="fragment"><div class="line"></div><div class="line"></div><div class="line">[1mRooFit v3.60 -- Developed by Wouter Verkerke and David Kirkby[0m </div><div class="line">                Copyright (C) 2000-2013 NIKHEF, University of California &amp; Stanford University</div><div class="line">                All rights reserved, please read http://roofit.sourceforge.net/license.txt</div><div class="line"></div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooAddPdf::model</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooGaussian::sigModel</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::invMass</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::mH</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::sigma1</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooProduct::fsig</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::mu</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::ratioSigEff</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::fsigExpected</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooGaussian::zjjModel</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::mZ</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::sigma1_z</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::fzjj</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooChebychev::qcdModel</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::a0</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::a1</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::a2</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing dataset modelData</div><div class="line">[#1] INFO:ObjectHandling -- RooWorkSpace::import(myWS) changing name of dataset from  modelData to data</div><div class="line">[#1] INFO:Minization -- createNLL: caching constraint set under name CONSTR_OF_PDF_model_FOR_OBS_invMass with 0 entries</div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::DoGLobalFit - find MLE </div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::DoMinimizeNLL - using Minuit / Migrad with strategy 1</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (sigModel,zjjModel,qcdModel)</div><div class="line">[#1] INFO:Minization -- </div><div class="line">  RooFitResult: minimized FCN value: 717.039, estimated distance to minimum: 8.90226e-10</div><div class="line">                covariance matrix quality: Full, accurate covariance matrix</div><div class="line">                Status : MINIMIZE=0 </div><div class="line"></div><div class="line">    Floating Parameter    FinalValue +/-  Error   </div><div class="line">  --------------------  --------------------------</div><div class="line">                  fzjj    3.1152e-01 +/-  5.03e-02</div><div class="line">                    mu    1.0968e+00 +/-  3.03e-01</div><div class="line"></div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::GetHypoTest - do conditional fit </div><div class="line">[#0] PROGRESS:Minization -- ProfileLikelihoodCalcultor::DoMinimizeNLL - using Minuit / Migrad with strategy 1</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization -- </div><div class="line">  RooFitResult: minimized FCN value: 723.97, estimated distance to minimum: 2.09862e-09</div><div class="line">                covariance matrix quality: Full, accurate covariance matrix</div><div class="line">                Status : MINIMIZE=0 </div><div class="line"></div><div class="line">    Floating Parameter    FinalValue +/-  Error   </div><div class="line">  --------------------  --------------------------</div><div class="line">                  fzjj    2.6213e-01 +/-  5.18e-02</div><div class="line"></div><div class="line">-------------------------------------------------</div><div class="line">The p-value for the null is 9.83108e-05</div><div class="line">Corresponding to a significance of 3.72332</div><div class="line">-------------------------------------------------</div><div class="line"></div><div class="line"></div><div class="line">[#1] INFO:Minization -- createNLL picked up cached consraints from workspace with 0 entries</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (sigModel,zjjModel,qcdModel)</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization</div><div class="line">[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (sigModel)</div><div class="line">[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: ()</div><div class="line">[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (zjjModel)</div><div class="line">[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: ()</div><div class="line">[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (qcdModel)</div><div class="line">[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: ()</div><div class="line">[#1] INFO:Minization -- createNLL picked up cached consraints from workspace with 0 entries</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization</div><div class="line">[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (sigModel,zjjModel,qcdModel)</div><div class="line">[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization</div><div class="line">[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (zjjModel)</div><div class="line">[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: ()</div><div class="line">[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (qcdModel)</div><div class="line">[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: ()</div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooDataSet_8h.html">RooDataSet.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooRealVar_8h.html">RooRealVar.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooGaussian_8h.html">RooGaussian.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooAddPdf_8h.html">RooAddPdf.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooProdPdf_8h.html">RooProdPdf.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooAddition_8h.html">RooAddition.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooProduct_8h.html">RooProduct.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooChebychev_8h.html">RooChebychev.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooAbsPdf_8h.html">RooAbsPdf.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooFit_8h.html">RooFit.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooFitResult_8h.html">RooFitResult.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooPlot_8h.html">RooPlot.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooAbsArg_8h.html">RooAbsArg.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooWorkspace_8h.html">RooWorkspace.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ProfileLikelihoodCalculator_8h.html">RooStats/ProfileLikelihoodCalculator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="HypoTestResult_8h.html">RooStats/HypoTestResult.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// use this order for safety on library loading</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooFit.html">RooFit</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooStats.html">RooStats</a>;</div><div class="line"></div><div class="line"><span class="comment">// see below for implementation</span></div><div class="line"><span class="keywordtype">void</span> AddModel(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *);</div><div class="line"><span class="keywordtype">void</span> AddData(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *);</div><div class="line"><span class="keywordtype">void</span> DoHypothesisTest(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *);</div><div class="line"><span class="keywordtype">void</span> MakePlots(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *);</div><div class="line"></div><div class="line"><span class="comment">//____________________________________</span></div><div class="line"><span class="keywordtype">void</span> rs102_hypotestwithshapes()</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// The main macro.</span></div><div class="line"></div><div class="line">   <span class="comment">// Create a workspace to manage the project.</span></div><div class="line">   <a class="code" href="classRooWorkspace.html">RooWorkspace</a> *wspace = <span class="keyword">new</span> <a class="code" href="classRooWorkspace.html">RooWorkspace</a>(<span class="stringliteral">&quot;myWS&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// add the signal and background models to the workspace</span></div><div class="line">   AddModel(wspace);</div><div class="line"></div><div class="line">   <span class="comment">// add some toy data to the workspace</span></div><div class="line">   AddData(wspace);</div><div class="line"></div><div class="line">   <span class="comment">// inspect the workspace if you wish</span></div><div class="line">   <span class="comment">//  wspace-&gt;Print();</span></div><div class="line"></div><div class="line">   <span class="comment">// do the hypothesis test</span></div><div class="line">   DoHypothesisTest(wspace);</div><div class="line"></div><div class="line">   <span class="comment">// make some plots</span></div><div class="line">   MakePlots(wspace);</div><div class="line"></div><div class="line">   <span class="comment">// cleanup</span></div><div class="line">   <span class="keyword">delete</span> wspace;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//____________________________________</span></div><div class="line"><span class="keywordtype">void</span> AddModel(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *wks)</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// Make models for signal (Higgs) and background (Z+jets and QCD)</span></div><div class="line">   <span class="comment">// In real life, this part requires an intelligent modeling</span></div><div class="line">   <span class="comment">// of signal and background -- this is only an example.</span></div><div class="line"></div><div class="line">   <span class="comment">// set range of observable</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> lowRange = 60, highRange = 200;</div><div class="line"></div><div class="line">   <span class="comment">// make a RooRealVar for the observable</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> invMass(<span class="stringliteral">&quot;invMass&quot;</span>, <span class="stringliteral">&quot;M_{inv}&quot;</span>, lowRange, highRange, <span class="stringliteral">&quot;GeV&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// --------------------------------------</span></div><div class="line">   <span class="comment">// make a simple signal model.</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> mH(<span class="stringliteral">&quot;mH&quot;</span>, <span class="stringliteral">&quot;Higgs Mass&quot;</span>, 130, 90, 160);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> sigma1(<span class="stringliteral">&quot;sigma1&quot;</span>, <span class="stringliteral">&quot;Width of Gaussian&quot;</span>, 12., 2, 100);</div><div class="line">   <a class="code" href="classRooGaussian.html">RooGaussian</a> sigModel(<span class="stringliteral">&quot;sigModel&quot;</span>, <span class="stringliteral">&quot;Signal Model&quot;</span>, invMass, mH, sigma1);</div><div class="line">   <span class="comment">// we will test this specific mass point for the signal</span></div><div class="line">   mH.setConstant();</div><div class="line">   <span class="comment">// and we assume we know the mass resolution</span></div><div class="line">   sigma1.setConstant();</div><div class="line"></div><div class="line">   <span class="comment">// --------------------------------------</span></div><div class="line">   <span class="comment">// make zjj model.  Just like signal model</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> mZ(<span class="stringliteral">&quot;mZ&quot;</span>, <span class="stringliteral">&quot;Z Mass&quot;</span>, 91.2, 0, 100);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> sigma1_z(<span class="stringliteral">&quot;sigma1_z&quot;</span>, <span class="stringliteral">&quot;Width of Gaussian&quot;</span>, 10., 6, 100);</div><div class="line">   <a class="code" href="classRooGaussian.html">RooGaussian</a> zjjModel(<span class="stringliteral">&quot;zjjModel&quot;</span>, <span class="stringliteral">&quot;Z+jets Model&quot;</span>, invMass, mZ, sigma1_z);</div><div class="line">   <span class="comment">// we know Z mass</span></div><div class="line">   mZ.setConstant();</div><div class="line">   <span class="comment">// assume we know resolution too</span></div><div class="line">   sigma1_z.setConstant();</div><div class="line"></div><div class="line">   <span class="comment">// --------------------------------------</span></div><div class="line">   <span class="comment">// make QCD model</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> a0(<span class="stringliteral">&quot;a0&quot;</span>, <span class="stringliteral">&quot;a0&quot;</span>, 0.26, -1, 1);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> a1(<span class="stringliteral">&quot;a1&quot;</span>, <span class="stringliteral">&quot;a1&quot;</span>, -0.17596, -1, 1);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> a2(<span class="stringliteral">&quot;a2&quot;</span>, <span class="stringliteral">&quot;a2&quot;</span>, 0.018437, -1, 1);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> a3(<span class="stringliteral">&quot;a3&quot;</span>, <span class="stringliteral">&quot;a3&quot;</span>, 0.02, -1, 1);</div><div class="line">   <a class="code" href="classRooChebychev.html">RooChebychev</a> qcdModel(<span class="stringliteral">&quot;qcdModel&quot;</span>, <span class="stringliteral">&quot;A  Polynomial for QCD&quot;</span>, invMass, <a class="code" href="classRooArgList.html">RooArgList</a>(a0, a1, a2));</div><div class="line"></div><div class="line">   <span class="comment">// let&#39;s assume this shape is known, but the normalization is not</span></div><div class="line">   a0.setConstant();</div><div class="line">   a1.setConstant();</div><div class="line">   a2.setConstant();</div><div class="line"></div><div class="line">   <span class="comment">// --------------------------------------</span></div><div class="line">   <span class="comment">// combined model</span></div><div class="line"></div><div class="line">   <span class="comment">// Setting the fraction of Zjj to be 40% for initial guess.</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> fzjj(<span class="stringliteral">&quot;fzjj&quot;</span>, <span class="stringliteral">&quot;fraction of zjj background events&quot;</span>, .4, 0., 1);</div><div class="line"></div><div class="line">   <span class="comment">// Set the expected fraction of signal to 20%.</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> fsigExpected(<span class="stringliteral">&quot;fsigExpected&quot;</span>, <span class="stringliteral">&quot;expected fraction of signal events&quot;</span>, .2, 0., 1);</div><div class="line">   fsigExpected.setConstant(); <span class="comment">// use mu as main parameter, so fix this.</span></div><div class="line"></div><div class="line">   <span class="comment">// Introduce mu: the signal strength in units of the expectation.</span></div><div class="line">   <span class="comment">// eg. mu = 1 is the SM, mu = 0 is no signal, mu=2 is 2x the SM</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> mu(<span class="stringliteral">&quot;mu&quot;</span>, <span class="stringliteral">&quot;signal strength in units of SM expectation&quot;</span>, 1, 0., 2);</div><div class="line"></div><div class="line">   <span class="comment">// Introduce ratio of signal efficiency to nominal signal efficiency.</span></div><div class="line">   <span class="comment">// This is useful if you want to do limits on cross section.</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> ratioSigEff(<span class="stringliteral">&quot;ratioSigEff&quot;</span>, <span class="stringliteral">&quot;ratio of signal efficiency to nominal signal efficiency&quot;</span>, 1., 0., 2);</div><div class="line">   ratioSigEff.<a class="code" href="classRooAbsRealLValue.html#ada206bf5e97d88491e89032c1bd7789c">setConstant</a>(<a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>);</div><div class="line"></div><div class="line">   <span class="comment">// finally the signal fraction is the product of the terms above.</span></div><div class="line">   <a class="code" href="classRooProduct.html">RooProduct</a> fsig(<span class="stringliteral">&quot;fsig&quot;</span>, <span class="stringliteral">&quot;fraction of signal events&quot;</span>, <a class="code" href="classRooArgSet.html">RooArgSet</a>(mu, ratioSigEff, fsigExpected));</div><div class="line"></div><div class="line">   <span class="comment">// full model</span></div><div class="line">   <a class="code" href="classRooAddPdf.html">RooAddPdf</a> model(<span class="stringliteral">&quot;model&quot;</span>, <span class="stringliteral">&quot;sig+zjj+qcd background shapes&quot;</span>, <a class="code" href="classRooArgList.html">RooArgList</a>(sigModel, zjjModel, qcdModel),</div><div class="line">                   <a class="code" href="classRooArgList.html">RooArgList</a>(fsig, fzjj));</div><div class="line"></div><div class="line">   <span class="comment">// interesting for debugging and visualizing the model</span></div><div class="line">   <span class="comment">//  model.printCompactTree(&quot;&quot;,&quot;fullModel.txt&quot;);</span></div><div class="line">   <span class="comment">//  model.graphVizTree(&quot;fullModel.dot&quot;);</span></div><div class="line"></div><div class="line">   wks-&gt;<a class="code" href="classRooWorkspace.html#acff0ca83ad63c5b7a4cb8ea39d0e1669">import</a>(model);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//____________________________________</span></div><div class="line"><span class="keywordtype">void</span> AddData(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *wks)</div><div class="line">{</div><div class="line">   <span class="comment">// Add a toy dataset</span></div><div class="line"></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nEvents = 150;</div><div class="line">   <a class="code" href="classRooAbsPdf.html">RooAbsPdf</a> *model = wks-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;model&quot;</span>);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *invMass = wks-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;invMass&quot;</span>);</div><div class="line"></div><div class="line">   <a class="code" href="classRooDataSet.html">RooDataSet</a> *data = model-&gt;<a class="code" href="classRooAbsPdf.html#aff9a0b0fd2e1cab5124bd0d209ecbb18">generate</a>(*invMass, nEvents);</div><div class="line"></div><div class="line">   wks-&gt;<a class="code" href="classRooWorkspace.html#acff0ca83ad63c5b7a4cb8ea39d0e1669">import</a>(*data, <a class="code" href="namespaceRooFit.html#a93649fc02f13b843c7fb5a5e81e097ff">Rename</a>(<span class="stringliteral">&quot;data&quot;</span>));</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//____________________________________</span></div><div class="line"><span class="keywordtype">void</span> DoHypothesisTest(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *wks)</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// Use a RooStats ProfileLikleihoodCalculator to do the hypothesis test.</span></div><div class="line">   <a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> model;</div><div class="line">   model.<a class="code" href="classRooStats_1_1ModelConfig.html#a4fb60011fc248f5919f06718a15961da">SetWorkspace</a>(*wks);</div><div class="line">   model.<a class="code" href="classRooStats_1_1ModelConfig.html#afdd514ddbe92c70b56d0a3cc87f0a745">SetPdf</a>(<span class="stringliteral">&quot;model&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// plc.SetData(&quot;data&quot;);</span></div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html">ProfileLikelihoodCalculator</a> plc;</div><div class="line">   plc.<a class="code" href="classRooStats_1_1CombinedCalculator.html#a81f681d1c21d6b95a6b9a47ae064e90b">SetData</a>(*(wks-&gt;<a class="code" href="classRooWorkspace.html#a2e0683ca1b7375eaa434a9cc1298e736">data</a>(<span class="stringliteral">&quot;data&quot;</span>)));</div><div class="line"></div><div class="line">   <span class="comment">// here we explicitly set the value of the parameters for the null.</span></div><div class="line">   <span class="comment">// We want no signal contribution, eg. mu = 0</span></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *mu = wks-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;mu&quot;</span>);</div><div class="line">   <span class="comment">//   RooArgSet* nullParams = new RooArgSet(&quot;nullParams&quot;);</span></div><div class="line">   <span class="comment">//   nullParams-&gt;addClone(*mu);</span></div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> poi(*mu);</div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *nullParams = (<a class="code" href="classRooArgSet.html">RooArgSet</a> *)poi.<a class="code" href="classRooArgSet.html#a3b35aea24edd191f95e24ec17d0fdb35">snapshot</a>();</div><div class="line">   nullParams-&gt;<a class="code" href="classRooArgSet.html#aa9a4cb32cd2340a40d45683aaf817f05">setRealValue</a>(<span class="stringliteral">&quot;mu&quot;</span>, 0);</div><div class="line"></div><div class="line">   <span class="comment">// plc.SetNullParameters(*nullParams);</span></div><div class="line">   plc.<a class="code" href="classRooStats_1_1CombinedCalculator.html#a4cd7e62fdc7551df5a96bae001e96278">SetModel</a>(model);</div><div class="line">   <span class="comment">// NOTE: using snapshot will import nullparams</span></div><div class="line">   <span class="comment">// in the WS and merge with existing &quot;mu&quot;</span></div><div class="line">   <span class="comment">// model.SetSnapshot(*nullParams);</span></div><div class="line"></div><div class="line">   <span class="comment">// use instead setNuisanceParameters</span></div><div class="line">   plc.<a class="code" href="classRooStats_1_1CombinedCalculator.html#a01808d327b34db5af132fafbd11f79c4">SetNullParameters</a>(*nullParams);</div><div class="line"></div><div class="line">   <span class="comment">// We get a HypoTestResult out of the calculator, and we can query it.</span></div><div class="line">   <a class="code" href="classRooStats_1_1HypoTestResult.html">HypoTestResult</a> *htr = plc.<a class="code" href="classRooStats_1_1ProfileLikelihoodCalculator.html#a009a281b2b5bca48deb74abfb9769774">GetHypoTest</a>();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------&quot;</span> &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;The p-value for the null is &quot;</span> &lt;&lt; htr-&gt;<a class="code" href="classRooStats_1_1HypoTestResult.html#a7bf8cbedc29b95b16a76d8b0fdf53e96">NullPValue</a>() &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Corresponding to a significance of &quot;</span> &lt;&lt; htr-&gt;<a class="code" href="classRooStats_1_1HypoTestResult.html#a68158d24df55c70a58c061e130132cce">Significance</a>() &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------\n\n&quot;</span> &lt;&lt; endl;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//____________________________________</span></div><div class="line"><span class="keywordtype">void</span> MakePlots(<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *wks)</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// Make plots of the data and the best fit model in two cases:</span></div><div class="line">   <span class="comment">// first the signal+background case</span></div><div class="line">   <span class="comment">// second the background-only case.</span></div><div class="line"></div><div class="line">   <span class="comment">// get some things out of workspace</span></div><div class="line">   <a class="code" href="classRooAbsPdf.html">RooAbsPdf</a> *model = wks-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;model&quot;</span>);</div><div class="line">   <a class="code" href="classRooAbsPdf.html">RooAbsPdf</a> *sigModel = wks-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;sigModel&quot;</span>);</div><div class="line">   <a class="code" href="classRooAbsPdf.html">RooAbsPdf</a> *zjjModel = wks-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;zjjModel&quot;</span>);</div><div class="line">   <a class="code" href="classRooAbsPdf.html">RooAbsPdf</a> *qcdModel = wks-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;qcdModel&quot;</span>);</div><div class="line"></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *mu = wks-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;mu&quot;</span>);</div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *invMass = wks-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;invMass&quot;</span>);</div><div class="line">   <a class="code" href="classRooAbsData.html">RooAbsData</a> *data = wks-&gt;<a class="code" href="classRooWorkspace.html#a2e0683ca1b7375eaa434a9cc1298e736">data</a>(<span class="stringliteral">&quot;data&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// --------------------------------------</span></div><div class="line">   <span class="comment">// Make plots for the Alternate hypothesis, eg. let mu float</span></div><div class="line"></div><div class="line">   mu-&gt;<a class="code" href="classRooAbsRealLValue.html#ada206bf5e97d88491e89032c1bd7789c">setConstant</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>);</div><div class="line"></div><div class="line">   model-&gt;<a class="code" href="classRooAbsPdf.html#a8f802a3a93467d5b7b089e3ccaec0fa8">fitTo</a>(*data, <a class="code" href="namespaceRooFit.html#aaccf9043976e51d28313a373a022f003">Save</a>(<a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>), <a class="code" href="namespaceRooFit.html#afec7d7076d7655f8287f167192bab613">Minos</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>), <a class="code" href="namespaceRooFit.html#a848284da2f0155b04dbdbbc82936ba23">Hesse</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>), <a class="code" href="namespaceRooFit.html#aaec91c86d0bb20f56844412530e5c9fb">PrintLevel</a>(-1));</div><div class="line"></div><div class="line">   <span class="comment">// plot sig candidates, full model, and individual components</span></div><div class="line">   <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>();</div><div class="line">   <a class="code" href="classRooPlot.html">RooPlot</a> *frame = invMass-&gt;<a class="code" href="classRooAbsRealLValue.html#a745190bca471b18f1b2d46a86961f0c6">frame</a>();</div><div class="line">   data-&gt;<a class="code" href="classRooAbsData.html#ac27709a0077810f29787f046e8d03898">plotOn</a>(frame);</div><div class="line">   model-&gt;<a class="code" href="classRooAbsPdf.html#a16d579415ec8eb8160ae212d683324f2">plotOn</a>(frame);</div><div class="line">   model-&gt;<a class="code" href="classRooAbsPdf.html#a16d579415ec8eb8160ae212d683324f2">plotOn</a>(frame, <a class="code" href="namespaceRooFit.html#a9a389f7a6ebfc4bf6b82df5de6f14e7c">Components</a>(*sigModel), <a class="code" href="namespaceRooFit.html#af1f7922ba5965c1a5a9791a00ef354cb">LineStyle</a>(<a class="code" href="TAttLine_8h.html#a7092c0c4616367016b70d54e5c680a69a079153995f89acb1ea87c52e9b45949a">kDashed</a>), <a class="code" href="namespaceRooFit.html#ad309cf5f63ec87ae5a7025d530f0398f">LineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a5a655b1a02e5b0311571ca57ce4f3900">kRed</a>));</div><div class="line">   model-&gt;<a class="code" href="classRooAbsPdf.html#a16d579415ec8eb8160ae212d683324f2">plotOn</a>(frame, <a class="code" href="namespaceRooFit.html#a9a389f7a6ebfc4bf6b82df5de6f14e7c">Components</a>(*zjjModel), <a class="code" href="namespaceRooFit.html#af1f7922ba5965c1a5a9791a00ef354cb">LineStyle</a>(<a class="code" href="TAttLine_8h.html#a7092c0c4616367016b70d54e5c680a69a079153995f89acb1ea87c52e9b45949a">kDashed</a>), <a class="code" href="namespaceRooFit.html#ad309cf5f63ec87ae5a7025d530f0398f">LineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a84bb4627f551fc5ff2d9aedb8f3b4947">kBlack</a>));</div><div class="line">   model-&gt;<a class="code" href="classRooAbsPdf.html#a16d579415ec8eb8160ae212d683324f2">plotOn</a>(frame, <a class="code" href="namespaceRooFit.html#a9a389f7a6ebfc4bf6b82df5de6f14e7c">Components</a>(*qcdModel), <a class="code" href="namespaceRooFit.html#af1f7922ba5965c1a5a9791a00ef354cb">LineStyle</a>(<a class="code" href="TAttLine_8h.html#a7092c0c4616367016b70d54e5c680a69a079153995f89acb1ea87c52e9b45949a">kDashed</a>), <a class="code" href="namespaceRooFit.html#ad309cf5f63ec87ae5a7025d530f0398f">LineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a8ea4b941d1d41f4bd88387c38e13e9d3">kGreen</a>));</div><div class="line"></div><div class="line">   frame-&gt;<a class="code" href="classRooPlot.html#a5e0cfc6c61278a25cdc5a63dfe4cc0b3">SetTitle</a>(<span class="stringliteral">&quot;An example fit to the signal + background model&quot;</span>);</div><div class="line">   frame-&gt;<a class="code" href="classRooPlot.html#ad7cdede86cb3721e079ec55fcb3b4edc">Draw</a>();</div><div class="line">   <span class="comment">//  cdata-&gt;SaveAs(&quot;alternateFit.gif&quot;);</span></div><div class="line"></div><div class="line">   <span class="comment">// --------------------------------------</span></div><div class="line">   <span class="comment">// Do Fit to the Null hypothesis.  Eg. fix mu=0</span></div><div class="line"></div><div class="line">   mu-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(0);          <span class="comment">// set signal fraction to 0</span></div><div class="line">   mu-&gt;<a class="code" href="classRooAbsRealLValue.html#ada206bf5e97d88491e89032c1bd7789c">setConstant</a>(<a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>); <span class="comment">// set constant</span></div><div class="line"></div><div class="line">   model-&gt;<a class="code" href="classRooAbsPdf.html#a8f802a3a93467d5b7b089e3ccaec0fa8">fitTo</a>(*data, <a class="code" href="namespaceRooFit.html#aaccf9043976e51d28313a373a022f003">Save</a>(<a class="code" href="RtypesCore_8h.html#af2f51d30ccd86e85be3e3e69793a86ef">kTRUE</a>), <a class="code" href="namespaceRooFit.html#afec7d7076d7655f8287f167192bab613">Minos</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>), <a class="code" href="namespaceRooFit.html#a848284da2f0155b04dbdbbc82936ba23">Hesse</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>), <a class="code" href="namespaceRooFit.html#aaec91c86d0bb20f56844412530e5c9fb">PrintLevel</a>(-1));</div><div class="line"></div><div class="line">   <span class="comment">// plot signal candidates with background model and components</span></div><div class="line">   <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>();</div><div class="line">   <a class="code" href="classRooPlot.html">RooPlot</a> *xframe2 = invMass-&gt;<a class="code" href="classRooAbsRealLValue.html#a745190bca471b18f1b2d46a86961f0c6">frame</a>();</div><div class="line">   data-&gt;<a class="code" href="classRooAbsData.html#ac27709a0077810f29787f046e8d03898">plotOn</a>(xframe2, <a class="code" href="namespaceRooFit.html#acdff7ce05ee41600dffa2211de146e7f">DataError</a>(<a class="code" href="classRooAbsData.html#a3f1b47ae0cc4e217f514a8e4331f7e88a6e2e8176c8957a92f68ad94e8f8e0b7f">RooAbsData::SumW2</a>));</div><div class="line">   model-&gt;<a class="code" href="classRooAbsPdf.html#a16d579415ec8eb8160ae212d683324f2">plotOn</a>(xframe2);</div><div class="line">   model-&gt;<a class="code" href="classRooAbsPdf.html#a16d579415ec8eb8160ae212d683324f2">plotOn</a>(xframe2, <a class="code" href="namespaceRooFit.html#a9a389f7a6ebfc4bf6b82df5de6f14e7c">Components</a>(*zjjModel), <a class="code" href="namespaceRooFit.html#af1f7922ba5965c1a5a9791a00ef354cb">LineStyle</a>(<a class="code" href="TAttLine_8h.html#a7092c0c4616367016b70d54e5c680a69a079153995f89acb1ea87c52e9b45949a">kDashed</a>), <a class="code" href="namespaceRooFit.html#ad309cf5f63ec87ae5a7025d530f0398f">LineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a84bb4627f551fc5ff2d9aedb8f3b4947">kBlack</a>));</div><div class="line">   model-&gt;<a class="code" href="classRooAbsPdf.html#a16d579415ec8eb8160ae212d683324f2">plotOn</a>(xframe2, <a class="code" href="namespaceRooFit.html#a9a389f7a6ebfc4bf6b82df5de6f14e7c">Components</a>(*qcdModel), <a class="code" href="namespaceRooFit.html#af1f7922ba5965c1a5a9791a00ef354cb">LineStyle</a>(<a class="code" href="TAttLine_8h.html#a7092c0c4616367016b70d54e5c680a69a079153995f89acb1ea87c52e9b45949a">kDashed</a>), <a class="code" href="namespaceRooFit.html#ad309cf5f63ec87ae5a7025d530f0398f">LineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a8ea4b941d1d41f4bd88387c38e13e9d3">kGreen</a>));</div><div class="line"></div><div class="line">   xframe2-&gt;<a class="code" href="classRooPlot.html#a5e0cfc6c61278a25cdc5a63dfe4cc0b3">SetTitle</a>(<span class="stringliteral">&quot;An example fit to the background-only model&quot;</span>);</div><div class="line">   xframe2-&gt;<a class="code" href="classRooPlot.html#ad7cdede86cb3721e079ec55fcb3b4edc">Draw</a>();</div><div class="line">   <span class="comment">//  cbkgonly-&gt;SaveAs(&quot;nullFit.gif&quot;);</span></div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>Kyle Cranmer </dd></dl>

<p class="definition">Definition in file <a class="el" href="rs102__hypotestwithshapes_8C_source.html">rs102_hypotestwithshapes.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:26 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/roostats/OneSidedFrequentistUpperLimitWithBands.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_87facaa6959ceb8d3dacccaf663f7b84.html">roostats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">OneSidedFrequentistUpperLimitWithBands.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__roostats.html">RooStats Tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/OneSidedFrequentistUpperLimitWithBands.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/OneSidedFrequentistUpperLimitWithBands.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  OneSidedFrequentistUpperLimitWithBands </p>
<p>This is a standard demo that can be used with any <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a> file prepared in the standard way. You specify:</p><ul>
<li>name for input <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a> file</li>
<li>name of workspace inside <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a> file that holds model and data</li>
<li>name of ModelConfig that specifies details for calculator tools</li>
<li>name of dataset</li>
</ul>
<p>With default parameters the macro will attempt to run the standard hist2workspace example and read the <a class="el" href="namespaceROOT.html" title="Namespace for new ROOT classes and functions. ">ROOT</a> file that it produces.</p>
<p>The first ~100 lines define a new test statistic, then the main macro starts. You may want to control: </p><div class="fragment"><div class="line"><span class="keywordtype">double</span> confidenceLevel=0.95;</div><div class="line"><span class="keywordtype">int</span> nPointsToScan = 12;</div><div class="line"><span class="keywordtype">int</span> nToyMC = 150;</div></div><!-- fragment --><p> This uses a modified version of the profile likelihood ratio as a test statistic for upper limits (eg. test stat = 0 if muhat&gt;mu).</p>
<p>Based on the observed data, one defines a set of parameter points to be tested based on the value of the parameter of interest and the conditional MLE (eg. profiled) values of the nuisance parameters.</p>
<p>At each parameter point, pseudo-experiments are generated using this fixed reference model and then the test statistic is evaluated. Note, the nuisance parameters are floating in the fits. For each point, the threshold that defines the 95% acceptance region is found. This forms a "Confidence Belt".</p>
<p>After constructing the confidence belt, one can find the confidence interval for any particular dataset by finding the intersection of the observed test statistic and the confidence belt. First this is done on the observed data to get an observed 1-sided upper limt.</p>
<p>Finally, there expected limit and bands (from background-only) are formed by generating background-only data and finding the upper limit. This is done by hand for now, will later be part of the <a class="el" href="namespaceRooStats.html" title="Namespace for the RooStats classes. ">RooStats</a> tools.</p>
<p>On a technical note, this technique is NOT the Feldman-Cousins technique, because that is a 2-sided interval BY DEFINITION. However, like the Feldman-Cousins technique this is a Neyman-Construction. For technical reasons the easiest way to implement this right now is to use the FeldmanCousins tool and then change the test statistic that it is using.</p>
<p>Building the confidence belt can be computationally expensive. Once it is built, one could save it to a file and use it in a separate step.</p>
<p>We can use PROOF to speed things along in parallel, however, the test statistic has to be installed on the workers so either turn off PROOF or include the modified test statistic in your <code>$ROOTSYS/roofit/roostats/inc</code> directory, add the additional line to the LinkDef.h file, and recompile root.</p>
<p>Note, if you have a boundary on the parameter of interest (eg. cross-section) the threshold on the one-sided test statistic starts off very small because we are only including downward fluctuations. You can see the threshold in these printouts: </p><div class="fragment"><div class="line">[#0] <a class="code" href="namespaceRooFit.html#a36e12ae9ea9c0d3ab48f71c4ffcdace3a8755d785e26b824e5a490ecc72c574cd">PROGRESS</a>:<a class="code" href="namespaceRooFit.html#a9924e612cb358cd013b50c0e1e6d6148a38c62e03a73cd43d90b65e0cf4557942">Generation</a> -- generated toys: 500 / 999</div><div class="line">NeymanConstruction: Prog: 12/50 <a class="code" href="TGWin32ProxyDefs_8h.html#af9031f7978e957b9979e78873830ce46">total</a> MC = 39 <span class="keyword">this</span> <a class="code" href="namespacetest.html">test</a> stat = 0</div><div class="line"> SigXsecOverSM=0.69 alpha_syst1=0.136515 alpha_syst3=0.425415 beta_syst2=1.08496 [-1<a class="code" href="TRolke_8cxx.html#a680432d265de4ea2534f8ec32f1aa417">e</a>+30, 0.011215]  in interval = 1</div></div><!-- fragment --><p> this tells you the values of the parameters being used to generate the pseudo-experiments and the threshold in this case is 0.011215. One would expect for 95% that the threshold would be ~1.35 once the cross-section is far enough away from 0 that it is essentially unaffected by the boundary. As one reaches the last points in the scan, the theshold starts to get artificially high. This is because the range of the parameter in the fit is the same as the range in the scan. In the future, these should be independently controlled, but they are not now. As a result the ~50% of pseudo-experiments that have an upward fluctuation end up with muhat = muMax. Because of this, the upper range of the parameter should be well above the expected upper limit... but not too high or one will need a very large value of nPointsToScan to resolve the relevant region. This can be improved, but this is the first version of this script.</p>
<p>Important note: when the model includes external constraint terms, like a Gaussian constraint to a nuisance parameter centered around some nominal value there is a subtlety. The asymptotic results are all based on the assumption that all the measurements fluctuate... including the nominal values from auxiliary measurements. If these do not fluctuate, this corresponds to an "conditional ensemble". The result is that the distribution of the test statistic can become very non-chi^2. This results in thresholds that become very large. This can be seen in the following thought experiment. Say the model is \( Pois(N | s + b)G(b0|b,sigma) \) where \( G(b0|b,sigma) \) is the external constraint and b0 is 100. If N is also 100 then the profiled value of b given s is going to be some trade off between 100-s and b0. If sigma is \( \sqrt(N) \), then the profiled value of b is probably 100 - s/2 So for s=60 we are going to have a profiled value of b~70. Now when we generate pseudo-experiments for s=60, b=70 we will have N~130 and the average shat will be 30, not 60. In practice, this is only an issue for values of s that are very excluded. For values of s near the 95% limit this should not be a big effect. This can be avoided if the nominal values of the constraints also fluctuate, but that requires that those parameters are RooRealVars in the model. This version does not deal with this issue, but it will be addressed in a future version.</p>
<div class="image">
<img src="pict1_OneSidedFrequentistUpperLimitWithBands.C.png" alt="pict1_OneSidedFrequentistUpperLimitWithBands.C.png" width="700"/>
</div>
 <div class="fragment"><div class="line"></div><div class="line"></div><div class="line">[1mRooFit v3.60 -- Developed by Wouter Verkerke and David Kirkby[0m </div><div class="line">                Copyright (C) 2000-2013 NIKHEF, University of California &amp; Stanford University</div><div class="line">                All rights reserved, please read http://roofit.sourceforge.net/license.txt</div><div class="line"></div><div class="line">FeldmanCousins: ntoys per point = 499</div><div class="line">FeldmanCousins: nEvents per toy will fluctuate about  expectation</div><div class="line">will use global observables for unconditional ensemble</div><div class="line">RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line"></div><div class="line">=== Using the following for ModelConfig ===</div><div class="line">Observables:             RooArgSet:: = (obs_x_channel1,weightVar,channelCat)</div><div class="line">Parameters of Interest:  RooArgSet:: = (SigXsecOverSM)</div><div class="line">Nuisance Parameters:     RooArgSet:: = (alpha_syst2,alpha_syst3,gamma_stat_channel1_bin_0,gamma_stat_channel1_bin_1)</div><div class="line">Global Observables:      RooArgSet:: = (nom_alpha_syst2,nom_alpha_syst3,nom_gamma_stat_channel1_bin_0,nom_gamma_stat_channel1_bin_1)</div><div class="line">PDF:                     RooSimultaneous::simPdf[ indexCat=channelCat channel1=model_channel1 ] = 0.174888</div><div class="line"></div><div class="line">FeldmanCousins: Model has nuisance parameters, will do profile construction</div><div class="line">FeldmanCousins: # points to test = 12</div><div class="line">lookup index = 0</div><div class="line">NeymanConstruction: Prog: 1/12 total MC = 499 this test stat = 0</div><div class="line"> SigXsecOverSM=0.125 alpha_syst2=0.620013 alpha_syst3=0.233371 gamma_stat_channel1_bin_0=1.03213 gamma_stat_channel1_bin_1=1.04741 [-1e+30, 0.352289]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 2/12 total MC = 499 this test stat = 0</div><div class="line"> SigXsecOverSM=0.375 alpha_syst2=0.447753 alpha_syst3=0.177838 gamma_stat_channel1_bin_0=1.02318 gamma_stat_channel1_bin_1=1.03602 [-1e+30, 0.880615]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 3/12 total MC = 499 this test stat = 0</div><div class="line"> SigXsecOverSM=0.625 alpha_syst2=0.286439 alpha_syst3=0.123101 gamma_stat_channel1_bin_0=1.01471 gamma_stat_channel1_bin_1=1.02485 [-1e+30, 1.24865]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 4/12 total MC = 499 this test stat = 0</div><div class="line"> SigXsecOverSM=0.875 alpha_syst2=0.135227 alpha_syst3=0.0712312 gamma_stat_channel1_bin_0=1.00681 gamma_stat_channel1_bin_1=1.01342 [-1e+30, 1.67695]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 5/12 total MC = 499 this test stat = 0.000123982</div><div class="line"> SigXsecOverSM=1.125 alpha_syst2=-0.0145151 alpha_syst3=0.0140841 gamma_stat_channel1_bin_0=0.999276 gamma_stat_channel1_bin_1=1.00325 [-1e+30, 1.27013]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 6/12 total MC = 499 this test stat = 0.0914826</div><div class="line"> SigXsecOverSM=1.375 alpha_syst2=-0.158296 alpha_syst3=-0.0388344 gamma_stat_channel1_bin_0=0.992172 gamma_stat_channel1_bin_1=0.99314 [-1e+30, 1.2931]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 7/12 total MC = 499 this test stat = 0.348977</div><div class="line"> SigXsecOverSM=1.625 alpha_syst2=-0.293123 alpha_syst3=-0.0887596 gamma_stat_channel1_bin_0=0.985749 gamma_stat_channel1_bin_1=0.98241 [-1e+30, 1.38422]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 8/12 total MC = 499 this test stat = 0.767852</div><div class="line"> SigXsecOverSM=1.875 alpha_syst2=-0.422662 alpha_syst3=-0.140488 gamma_stat_channel1_bin_0=0.979598 gamma_stat_channel1_bin_1=0.972408 [-1e+30, 1.44103]  in interval = 1</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 9/12 total MC = 499 this test stat = 1.34349</div><div class="line"> SigXsecOverSM=2.125 alpha_syst2=-0.544231 alpha_syst3=-0.191113 gamma_stat_channel1_bin_0=0.973832 gamma_stat_channel1_bin_1=0.962561 [-1e+30, 1.18511]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 10/12 total MC = 499 this test stat = 2.07144</div><div class="line"> SigXsecOverSM=2.375 alpha_syst2=-0.657507 alpha_syst3=-0.240928 gamma_stat_channel1_bin_0=0.968401 gamma_stat_channel1_bin_1=0.952927 [-1e+30, 1.49941]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 11/12 total MC = 499 this test stat = 2.94737</div><div class="line"> SigXsecOverSM=2.625 alpha_syst2=-0.763071 alpha_syst3=-0.290559 gamma_stat_channel1_bin_0=0.963225 gamma_stat_channel1_bin_1=0.943651 [-1e+30, 1.38056]  in interval = 0</div><div class="line"></div><div class="line">NeymanConstruction: Prog: 12/12 total MC = 499 this test stat = 3.9668</div><div class="line"> SigXsecOverSM=2.875 alpha_syst2=-0.861426 alpha_syst3=-0.338746 gamma_stat_channel1_bin_0=0.958365 gamma_stat_channel1_bin_1=0.934518 [-1e+30, 1.33024]  in interval = 0</div><div class="line"></div><div class="line">[#1] INFO:Eval -- 8 points in interval</div><div class="line"></div><div class="line">95% interval on SigXsecOverSM is : [0.125, 1.875] </div><div class="line">[#1] INFO:Minization -- p.d.f. provides expected number of events, including extended term in likelihood.</div><div class="line">[#1] INFO:Minization -- createNLL picked up cached consraints from workspace with 6 entries</div><div class="line">[#1] INFO:Minization --  Including the following contraint terms in minimization: (lumiConstraint,alpha_syst1Constraint,alpha_syst2Constraint,alpha_syst3Constraint,gamma_stat_channel1_bin_0_constraint,gamma_stat_channel1_bin_1_constraint)</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_simPdf_obsData_with_constr_Profile[SigXsecOverSM]) Creating instance of MINUIT</div><div class="line">[#1] INFO:Fitting -- RooAddition::defaultErrorLevel(nll_simPdf_obsData_with_constr) Summation contains a RooNLLVar, using its error level</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_simPdf_obsData_with_constr_Profile[SigXsecOverSM]) determining minimum likelihood for current configurations w.r.t all observable</div><div class="line">RooAbsTestStatistic::initSimMode: creating slave calculator #0 for state channel1 (2 dataset entries)</div><div class="line">[#1] INFO:Fitting -- RooAbsTestStatistic::initSimMode: created 1 slave calculators.</div><div class="line">[#1] INFO:Minization -- RooProfileLL::evaluate(nll_simPdf_obsData_with_constr_Profile[SigXsecOverSM]) minimum found at (SigXsecOverSM=1.11573)</div><div class="line">.</div><div class="line">Will use these parameter points to generate pseudo data for bkg only</div><div class="line">  1) 0x3046fb0 RooRealVar::               alpha_syst2 = 0.71117 +/- 0.914105  L(-5 - 5)  &quot;alpha_syst2&quot;</div><div class="line">  2) 0x315c220 RooRealVar::               alpha_syst3 = 0.261459 +/- 0.9291  L(-5 - 5)  &quot;alpha_syst3&quot;</div><div class="line">  3) 0x52dcaa0 RooRealVar:: gamma_stat_channel1_bin_0 = 1.03677 +/- 0.0462899  L(0 - 1.25)  &quot;gamma_stat_channel1_bin_0&quot;</div><div class="line">  4) 0x304af50 RooRealVar:: gamma_stat_channel1_bin_1 = 1.05319 +/- 0.0761205  L(0 - 1.5)  &quot;gamma_stat_channel1_bin_1&quot;</div><div class="line">  5) 0x3041440 RooRealVar::             SigXsecOverSM = 0 +/- 0  L(0 - 3) B(12)  &quot;SigXsecOverSM&quot;</div><div class="line">-2 sigma  band 6.44719e-317</div><div class="line">-1 sigma  band 0.345 [Power Constraint)]</div><div class="line">median of band 0.855</div><div class="line">+1 sigma  band 1.605</div><div class="line">+2 sigma  band 2.085</div><div class="line"></div><div class="line">observed 95% upper-limit 1.875</div><div class="line">CLb strict [P(toy&gt;obs|0)] for observed 95% upper-limit 0.946667</div><div class="line">CLb inclusive [P(toy&gt;=obs|0)] for observed 95% upper-limit 0.946667</div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TFile_8h.html">TFile.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TROOT_8h.html">TROOT.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TH1F_8h.html">TH1F.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TSystem_8h.html">TSystem.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooWorkspace_8h.html">RooWorkspace.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooSimultaneous_8h.html">RooSimultaneous.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooAbsData_8h.html">RooAbsData.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ModelConfig_8h.html">RooStats/ModelConfig.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="FeldmanCousins_8h.html">RooStats/FeldmanCousins.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ToyMCSampler_8h.html">RooStats/ToyMCSampler.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="PointSetInterval_8h.html">RooStats/PointSetInterval.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ConfidenceBelt_8h.html">RooStats/ConfidenceBelt.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooStatsUtils_8h.html">RooStats/RooStatsUtils.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ProfileLikelihoodTestStat_8h.html">RooStats/ProfileLikelihoodTestStat.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooFit.html">RooFit</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooStats.html">RooStats</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">bool</span> useProof = <span class="keyword">false</span>; <span class="comment">// flag to control whether to use Proof</span></div><div class="line"><span class="keywordtype">int</span> nworkers = 0;      <span class="comment">// number of workers (default use all available cores)</span></div><div class="line"></div><div class="line"><span class="comment">// -------------------------------------------------------</span></div><div class="line"><span class="comment">// The actual macro</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> OneSidedFrequentistUpperLimitWithBands(<span class="keyword">const</span> <span class="keywordtype">char</span> *infile = <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *workspaceName = <span class="stringliteral">&quot;combined&quot;</span>,</div><div class="line">                                            <span class="keyword">const</span> <span class="keywordtype">char</span> *modelConfigName = <span class="stringliteral">&quot;ModelConfig&quot;</span>,</div><div class="line">                                            <span class="keyword">const</span> <span class="keywordtype">char</span> *dataName = <span class="stringliteral">&quot;obsData&quot;</span>)</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="keywordtype">double</span> confidenceLevel = 0.95;</div><div class="line">   <span class="keywordtype">int</span> nPointsToScan = 12;</div><div class="line">   <span class="keywordtype">int</span> nToyMC = 150;</div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------------</span></div><div class="line">   <span class="comment">// First part is just to access a user-defined file</span></div><div class="line">   <span class="comment">// or create the standard example file if it doesn&#39;t exist</span></div><div class="line">   <span class="keyword">const</span> <span class="keywordtype">char</span> *filename = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line">   <span class="keywordflow">if</span> (!strcmp(infile, <span class="stringliteral">&quot;&quot;</span>)) {</div><div class="line">      filename = <span class="stringliteral">&quot;results/example_combined_GaussExample_model.root&quot;</span>;</div><div class="line">      <span class="keywordtype">bool</span> fileExist = !<a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a849c28ea0dd3b3aa3310a4d447c7b21a">AccessPathName</a>(filename); <span class="comment">// note opposite return code</span></div><div class="line">      <span class="comment">// if file does not exists generate with histfactory</span></div><div class="line">      <span class="keywordflow">if</span> (!fileExist) {</div><div class="line"><span class="preprocessor">#ifdef _WIN32</span></div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;HistFactory file cannot be generated on Windows - exit&quot;</span> &lt;&lt; endl;</div><div class="line">         <span class="keywordflow">return</span>;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">         <span class="comment">// Normally this would be run on the command line</span></div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;will run standard hist2workspace example&quot;</span> &lt;&lt; endl;</div><div class="line">         <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLine(<span class="stringliteral">&quot;.! prepareHistFactory .&quot;</span>);</div><div class="line">         <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLine(<span class="stringliteral">&quot;.! hist2workspace config/example.xml&quot;</span>);</div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;\n\n---------------------&quot;</span> &lt;&lt; endl;</div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;Done creating example input&quot;</span> &lt;&lt; endl;</div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;---------------------\n\n&quot;</span> &lt;&lt; endl;</div><div class="line">      }</div><div class="line"></div><div class="line">   } <span class="keywordflow">else</span></div><div class="line">      filename = infile;</div><div class="line"></div><div class="line">   <span class="comment">// Try to open the file</span></div><div class="line">   <a class="code" href="classTFile.html">TFile</a> *<a class="code" href="namespacefile.html">file</a> = <a class="code" href="classTFile.html#aec5f3fae0774aabfc615ebb4b00fe5e0">TFile::Open</a>(filename);</div><div class="line"></div><div class="line">   <span class="comment">// if input file was specified byt not found, quit</span></div><div class="line">   <span class="keywordflow">if</span> (!<a class="code" href="namespacefile.html">file</a>) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;StandardRooStatsDemoMacro: Input file &quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot; is not found&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------------</span></div><div class="line">   <span class="comment">// Now get the data and workspace</span></div><div class="line"></div><div class="line">   <span class="comment">// get the workspace out of the file</span></div><div class="line">   <a class="code" href="classRooWorkspace.html">RooWorkspace</a> *w = (<a class="code" href="classRooWorkspace.html">RooWorkspace</a> *)<a class="code" href="namespacefile.html">file</a>-&gt;Get(workspaceName);</div><div class="line">   <span class="keywordflow">if</span> (!w) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;workspace not found&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// get the modelConfig out of the file</span></div><div class="line">   <a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> *mc = (<a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> *)w-&gt;<a class="code" href="classRooWorkspace.html#af56548d1c16301ebaf951c452d52f5c3">obj</a>(modelConfigName);</div><div class="line"></div><div class="line">   <span class="comment">// get the modelConfig out of the file</span></div><div class="line">   <a class="code" href="classRooAbsData.html">RooAbsData</a> *data = w-&gt;<a class="code" href="classRooWorkspace.html#a2e0683ca1b7375eaa434a9cc1298e736">data</a>(dataName);</div><div class="line"></div><div class="line">   <span class="comment">// make sure ingredients are found</span></div><div class="line">   <span class="keywordflow">if</span> (!data || !mc) {</div><div class="line">      w-&gt;<a class="code" href="classRooWorkspace.html#a9131cf30e7ea371b14a619ebf0d7e18f">Print</a>();</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;data or ModelConfig was not found&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------------</span></div><div class="line">   <span class="comment">// Now get the POI for convenience</span></div><div class="line">   <span class="comment">// you may want to adjust the range of your POI</span></div><div class="line"></div><div class="line">   <a class="code" href="classRooRealVar.html">RooRealVar</a> *firstPOI = (<a class="code" href="classRooRealVar.html">RooRealVar</a> *)mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>()-&gt;<a class="code" href="classRooAbsCollection.html#a225c780c4c32077d6923e956225e437a">first</a>();</div><div class="line">   <span class="comment">/*  firstPOI-&gt;setMin(0);*/</span></div><div class="line">   <span class="comment">/*  firstPOI-&gt;setMax(10);*/</span></div><div class="line"></div><div class="line">   <span class="comment">// --------------------------------------------</span></div><div class="line">   <span class="comment">// Create and use the FeldmanCousins tool</span></div><div class="line">   <span class="comment">// to find and plot the 95% confidence interval</span></div><div class="line">   <span class="comment">// on the parameter of interest as specified</span></div><div class="line">   <span class="comment">// in the model config</span></div><div class="line">   <span class="comment">// REMEMBER, we will change the test statistic</span></div><div class="line">   <span class="comment">// so this is NOT a Feldman-Cousins interval</span></div><div class="line">   <a class="code" href="classRooStats_1_1FeldmanCousins.html">FeldmanCousins</a> <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>(*data, *mc);</div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.SetConfidenceLevel(confidenceLevel);</div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.AdditionalNToysFactor(</div><div class="line">      0.5); <span class="comment">// degrade/improve sampling that defines confidence belt: in this case makes the example faster</span></div><div class="line">   <span class="comment">/*  fc.UseAdaptiveSampling(true); // speed it up a bit, don&#39;t use for expected limits*/</span></div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.SetNBins(nPointsToScan); <span class="comment">// set how many points per parameter of interest to scan</span></div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.CreateConfBelt(<span class="keyword">true</span>);    <span class="comment">// save the information in the belt for plotting</span></div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------------</span></div><div class="line">   <span class="comment">// Feldman-Cousins is a unified limit by definition</span></div><div class="line">   <span class="comment">// but the tool takes care of a few things for us like which values</span></div><div class="line">   <span class="comment">// of the nuisance parameters should be used to generate toys.</span></div><div class="line">   <span class="comment">// so let&#39;s just change the test statistic and realize this is</span></div><div class="line">   <span class="comment">// no longer &quot;Feldman-Cousins&quot; but is a fully frequentist Neyman-Construction.</span></div><div class="line">   <span class="comment">/*  ProfileLikelihoodTestStatModified onesided(*mc-&gt;GetPdf());*/</span></div><div class="line">   <span class="comment">/*  fc.GetTestStatSampler()-&gt;SetTestStatistic(&amp;onesided);*/</span></div><div class="line">   <span class="comment">/* ((ToyMCSampler*) fc.GetTestStatSampler())-&gt;SetGenerateBinned(true); */</span></div><div class="line">   <a class="code" href="classRooStats_1_1ToyMCSampler.html">ToyMCSampler</a> *toymcsampler = (<a class="code" href="classRooStats_1_1ToyMCSampler.html">ToyMCSampler</a> *)<a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetTestStatSampler();</div><div class="line">   <a class="code" href="classRooStats_1_1ProfileLikelihoodTestStat.html">ProfileLikelihoodTestStat</a> *testStat = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classRooStats_1_1ProfileLikelihoodTestStat.html">ProfileLikelihoodTestStat</a> *<span class="keyword">&gt;</span>(toymcsampler-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#a4290c66879dd450673e16265fbc2caa6">GetTestStatistic</a>());</div><div class="line">   testStat-&gt;<a class="code" href="classRooStats_1_1ProfileLikelihoodTestStat.html#ac9ebe2bcbbcf47d550e5d08b483e7c23">SetOneSided</a>(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">   <span class="comment">// Since this tool needs to throw toy MC the PDF needs to be</span></div><div class="line">   <span class="comment">// extended or the tool needs to know how many entries in a dataset</span></div><div class="line">   <span class="comment">// per pseudo experiment.</span></div><div class="line">   <span class="comment">// In the &#39;number counting form&#39; where the entries in the dataset</span></div><div class="line">   <span class="comment">// are counts, and not values of discriminating variables, the</span></div><div class="line">   <span class="comment">// datasets typically only have one entry and the PDF is not</span></div><div class="line">   <span class="comment">// extended.</span></div><div class="line">   <span class="keywordflow">if</span> (!mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#a69d77200d6313129397ac2aa8deef408">canBeExtended</a>()) {</div><div class="line">      <span class="keywordflow">if</span> (data-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>() == 1)</div><div class="line">         <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.FluctuateNumDataEntries(<span class="keyword">false</span>);</div><div class="line">      <span class="keywordflow">else</span></div><div class="line">         cout &lt;&lt; <span class="stringliteral">&quot;Not sure what to do about this model&quot;</span> &lt;&lt; endl;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// We can use PROOF to speed things along in parallel</span></div><div class="line">   <span class="comment">// However, the test statistic has to be installed on the workers</span></div><div class="line">   <span class="comment">// so either turn off PROOF or include the modified test statistic</span></div><div class="line">   <span class="comment">// in your `$ROOTSYS/roofit/roostats/inc` directory,</span></div><div class="line">   <span class="comment">// add the additional line to the LinkDef.h file,</span></div><div class="line">   <span class="comment">// and recompile root.</span></div><div class="line">   <span class="keywordflow">if</span> (useProof) {</div><div class="line">      <a class="code" href="classRooStats_1_1ProofConfig.html">ProofConfig</a> <a class="code" href="namespaceTGeant4Unit.html#a9b9c22ca28407dfecdc404f99df537bb">pc</a>(*w, nworkers, <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">false</span>);</div><div class="line">      toymcsampler-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#a3518c12aaf49b74d3ef58e22b41de58c">SetProofConfig</a>(&amp;<a class="code" href="namespaceTGeant4Unit.html#a9b9c22ca28407dfecdc404f99df537bb">pc</a>); <span class="comment">// enable proof</span></div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>()) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;will use global observables for unconditional ensemble&quot;</span> &lt;&lt; endl;</div><div class="line">      mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>()-&gt;<a class="code" href="classRooAbsCollection.html#ab988655a6fe646baa9c6a6b5456c3aa0">Print</a>();</div><div class="line">      toymcsampler-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#aa838b03fde977cb8363cdacf1cf9c56f">SetGlobalObservables</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>());</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// Now get the interval</span></div><div class="line">   <a class="code" href="classRooStats_1_1PointSetInterval.html">PointSetInterval</a> *interval = <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetInterval();</div><div class="line">   <a class="code" href="classRooStats_1_1ConfidenceBelt.html">ConfidenceBelt</a> *belt = <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetConfidenceBelt();</div><div class="line"></div><div class="line">   <span class="comment">// print out the interval on the first Parameter of Interest</span></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;\n95% interval on &quot;</span> &lt;&lt; firstPOI-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>() &lt;&lt; <span class="stringliteral">&quot; is : [&quot;</span> &lt;&lt; interval-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#aa221cea064f8013ff5f7fde218a226e3">LowerLimit</a>(*firstPOI) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line">        &lt;&lt; interval-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#a8c43f888bbc5ba55ec8553a0506dcfc6">UpperLimit</a>(*firstPOI) &lt;&lt; <span class="stringliteral">&quot;] &quot;</span> &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">// get observed UL and value of test statistic evaluated there</span></div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> tmpPOI(*firstPOI);</div><div class="line">   <span class="keywordtype">double</span> observedUL = interval-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#a8c43f888bbc5ba55ec8553a0506dcfc6">UpperLimit</a>(*firstPOI);</div><div class="line">   firstPOI-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(observedUL);</div><div class="line">   <span class="keywordtype">double</span> obsTSatObsUL = <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetTestStatSampler()-&gt;EvaluateTestStatistic(*data, tmpPOI);</div><div class="line"></div><div class="line">   <span class="comment">// Ask the calculator which points were scanned</span></div><div class="line">   <a class="code" href="classRooDataSet.html">RooDataSet</a> *parameterScan = (<a class="code" href="classRooDataSet.html">RooDataSet</a> *)<a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetPointsToScan();</div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *tmpPoint;</div><div class="line"></div><div class="line">   <span class="comment">// make a histogram of parameter vs. threshold</span></div><div class="line">   <a class="code" href="classTH1F.html">TH1F</a> *histOfThresholds =</div><div class="line">      <span class="keyword">new</span> <a class="code" href="classTH1F.html">TH1F</a>(<span class="stringliteral">&quot;histOfThresholds&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, parameterScan-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>(), firstPOI-&gt;<a class="code" href="classRooAbsRealLValue.html#af16e9d798cdd32874357e57430803a82">getMin</a>(), firstPOI-&gt;<a class="code" href="classRooAbsRealLValue.html#a07d826bfa29ecd48e8e31ed28bd0bc48">getMax</a>());</div><div class="line">   histOfThresholds-&gt;<a class="code" href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">GetXaxis</a>()-&gt;<a class="code" href="classTNamed.html#a72f4d419b48a5fbfef07485b335139ca">SetTitle</a>(firstPOI-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>());</div><div class="line">   histOfThresholds-&gt;<a class="code" href="classTH1.html#a5cadfed83a4db70b4eae6b0a1cea3532">GetYaxis</a>()-&gt;<a class="code" href="classTNamed.html#a72f4d419b48a5fbfef07485b335139ca">SetTitle</a>(<span class="stringliteral">&quot;Threshold&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// loop through the points that were tested and ask confidence belt</span></div><div class="line">   <span class="comment">// what the upper/lower thresholds were.</span></div><div class="line">   <span class="comment">// For FeldmanCousins, the lower cut off is always 0</span></div><div class="line">   <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0; i &lt; parameterScan-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>(); ++i) {</div><div class="line">      tmpPoint = (<a class="code" href="classRooArgSet.html">RooArgSet</a> *)parameterScan-&gt;<a class="code" href="classRooDataSet.html#a2d2355b7a32be47b906312f113ee75c0">get</a>(i)-&gt;<a class="code" href="classRooArgSet.html#a693748866f98afb0b4e9efd40de6b405">clone</a>(<span class="stringliteral">&quot;temp&quot;</span>);</div><div class="line">      <span class="comment">// cout &lt;&lt;&quot;get threshold&quot;&lt;&lt;endl;</span></div><div class="line">      <span class="keywordtype">double</span> arMax = belt-&gt;<a class="code" href="classRooStats_1_1ConfidenceBelt.html#ad465a9878549db5398cabbffb57ff7fb">GetAcceptanceRegionMax</a>(*tmpPoint);</div><div class="line">      <span class="keywordtype">double</span> poiVal = tmpPoint-&gt;<a class="code" href="classRooArgSet.html#a72568bf2b2726891810ba3b3e8251f0b">getRealValue</a>(firstPOI-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>());</div><div class="line">      histOfThresholds-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(poiVal, arMax);</div><div class="line">   }</div><div class="line">   <a class="code" href="classTCanvas.html">TCanvas</a> *<a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a> = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>();</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;Divide(2);</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(1);</div><div class="line">   histOfThresholds-&gt;<a class="code" href="classTH1.html#a89a5d8fc84154b504566f367ba8d0238">SetMinimum</a>(0);</div><div class="line">   histOfThresholds-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(2);</div><div class="line"></div><div class="line">   <span class="comment">// -------------------------------------------------------</span></div><div class="line">   <span class="comment">// Now we generate the expected bands and power-constraint</span></div><div class="line"></div><div class="line">   <span class="comment">// First: find parameter point for mu=0, with conditional MLEs for nuisance parameters</span></div><div class="line">   <a class="code" href="classRooAbsReal.html">RooAbsReal</a> *nll = mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#a44f3ac4e956a5ba4abb0b74841f22704">createNLL</a>(*data);</div><div class="line">   <a class="code" href="classRooAbsReal.html">RooAbsReal</a> *profile = nll-&gt;<a class="code" href="classRooAbsReal.html#a391d1fa138cca9d2ccc3cb80f26944a3">createProfile</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>());</div><div class="line">   firstPOI-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(0.);</div><div class="line">   profile-&gt;<a class="code" href="classRooAbsReal.html#a8881da431598c6d15e06cc80518d323d">getVal</a>(); <span class="comment">// this will do fit and set nuisance parameters to profiled values</span></div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *poiAndNuisance = <span class="keyword">new</span> <a class="code" href="classRooArgSet.html">RooArgSet</a>();</div><div class="line">   <span class="keywordflow">if</span> (mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>())</div><div class="line">      poiAndNuisance-&gt;<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a71662b373fbf8bb1c0e41d069f786f42">GetNuisanceParameters</a>());</div><div class="line">   poiAndNuisance-&gt;<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#ac7cfabdd34b5a35c4252f665d7f132ce">GetParametersOfInterest</a>());</div><div class="line">   w-&gt;<a class="code" href="classRooWorkspace.html#ac7892f937bf7e2135f4b318897a9b4e9">saveSnapshot</a>(<span class="stringliteral">&quot;paramsToGenerateData&quot;</span>, *poiAndNuisance);</div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> *paramsToGenerateData = (<a class="code" href="classRooArgSet.html">RooArgSet</a> *)poiAndNuisance-&gt;<a class="code" href="classRooArgSet.html#a3b35aea24edd191f95e24ec17d0fdb35">snapshot</a>();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;\nWill use these parameter points to generate pseudo data for bkg only&quot;</span> &lt;&lt; endl;</div><div class="line">   paramsToGenerateData-&gt;<a class="code" href="classRooAbsCollection.html#ab988655a6fe646baa9c6a6b5456c3aa0">Print</a>(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"></div><div class="line">   <a class="code" href="classRooArgSet.html">RooArgSet</a> unconditionalObs;</div><div class="line">   unconditionalObs.<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a658c1a5b9ba572686d72acf76587e913">GetObservables</a>());</div><div class="line">   unconditionalObs.<a class="code" href="classRooArgSet.html#abbf07d101f0bce2a8b43545e336bd08c">add</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>()); <span class="comment">// comment this out for the original conditional ensemble</span></div><div class="line"></div><div class="line">   <span class="keywordtype">double</span> CLb = 0;</div><div class="line">   <span class="keywordtype">double</span> CLbinclusive = 0;</div><div class="line"></div><div class="line">   <span class="comment">// Now we generate background only and find distribution of upper limits</span></div><div class="line">   <a class="code" href="classTH1F.html">TH1F</a> *histOfUL = <span class="keyword">new</span> <a class="code" href="classTH1F.html">TH1F</a>(<span class="stringliteral">&quot;histOfUL&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 100, 0, firstPOI-&gt;<a class="code" href="classRooAbsRealLValue.html#a07d826bfa29ecd48e8e31ed28bd0bc48">getMax</a>());</div><div class="line">   histOfUL-&gt;<a class="code" href="classTH1.html#a3d91d3762b9789bd6e54e67d8ccce2e6">GetXaxis</a>()-&gt;<a class="code" href="classTNamed.html#a72f4d419b48a5fbfef07485b335139ca">SetTitle</a>(<span class="stringliteral">&quot;Upper Limit (background only)&quot;</span>);</div><div class="line">   histOfUL-&gt;<a class="code" href="classTH1.html#a5cadfed83a4db70b4eae6b0a1cea3532">GetYaxis</a>()-&gt;<a class="code" href="classTNamed.html#a72f4d419b48a5fbfef07485b335139ca">SetTitle</a>(<span class="stringliteral">&quot;Entries&quot;</span>);</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> imc = 0; imc &lt; nToyMC; ++imc) {</div><div class="line"></div><div class="line">      <span class="comment">// set parameters back to values for generating pseudo data</span></div><div class="line">      <span class="comment">//    cout &lt;&lt; &quot;\n get current nuis, set vals, print again&quot; &lt;&lt; endl;</span></div><div class="line">      w-&gt;<a class="code" href="classRooWorkspace.html#ac8768aaaa04a55beaafbdcc4c074b728">loadSnapshot</a>(<span class="stringliteral">&quot;paramsToGenerateData&quot;</span>);</div><div class="line">      <span class="comment">//    poiAndNuisance-&gt;Print(&quot;v&quot;);</span></div><div class="line"></div><div class="line">      <a class="code" href="classRooDataSet.html">RooDataSet</a> *toyData = 0;</div><div class="line">      <span class="comment">// now generate a toy dataset</span></div><div class="line">      <span class="keywordflow">if</span> (!mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#a69d77200d6313129397ac2aa8deef408">canBeExtended</a>()) {</div><div class="line">         <span class="keywordflow">if</span> (data-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>() == 1)</div><div class="line">            toyData = mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#aff9a0b0fd2e1cab5124bd0d209ecbb18">generate</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a658c1a5b9ba572686d72acf76587e913">GetObservables</a>(), 1);</div><div class="line">         <span class="keywordflow">else</span></div><div class="line">            cout &lt;&lt; <span class="stringliteral">&quot;Not sure what to do about this model&quot;</span> &lt;&lt; endl;</div><div class="line">      } <span class="keywordflow">else</span> {</div><div class="line">         <span class="comment">//      cout &lt;&lt; &quot;generating extended dataset&quot;&lt;&lt;endl;</span></div><div class="line">         toyData = mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#aff9a0b0fd2e1cab5124bd0d209ecbb18">generate</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a658c1a5b9ba572686d72acf76587e913">GetObservables</a>(), <a class="code" href="namespaceRooFit.html#a5b78dee63fd4e5fcdb5e8992f726cfc8">Extended</a>());</div><div class="line">      }</div><div class="line"></div><div class="line">      <span class="comment">// generate global observables</span></div><div class="line">      <span class="comment">// need to be careful for simpdf</span></div><div class="line">      <span class="comment">//    RooDataSet* globalData = mc-&gt;GetPdf()-&gt;generate(*mc-&gt;GetGlobalObservables(),1);</span></div><div class="line"></div><div class="line">      <a class="code" href="classRooSimultaneous.html">RooSimultaneous</a> *simPdf = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classRooSimultaneous.html">RooSimultaneous</a> *<span class="keyword">&gt;</span>(mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>());</div><div class="line">      <span class="keywordflow">if</span> (!simPdf) {</div><div class="line">         <a class="code" href="classRooDataSet.html">RooDataSet</a> *one = mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsPdf.html#aff9a0b0fd2e1cab5124bd0d209ecbb18">generate</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>(), 1);</div><div class="line">         <span class="keyword">const</span> <a class="code" href="classRooArgSet.html">RooArgSet</a> *values = one-&gt;<a class="code" href="classRooDataSet.html#a2d2355b7a32be47b906312f113ee75c0">get</a>();</div><div class="line">         <a class="code" href="classRooArgSet.html">RooArgSet</a> *allVars = mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a2341cf8446e32485934d7428f84b2900">GetPdf</a>()-&gt;<a class="code" href="classRooAbsArg.html#a84863f9944bb01b6614a0898cab944e8">getVariables</a>();</div><div class="line">         *allVars = *values;</div><div class="line">         <span class="keyword">delete</span> allVars;</div><div class="line">         <span class="keyword">delete</span> values;</div><div class="line">         <span class="keyword">delete</span> one;</div><div class="line">      } <span class="keywordflow">else</span> {</div><div class="line"></div><div class="line">         <span class="comment">// try fix for sim pdf</span></div><div class="line">         <a class="code" href="classTIterator.html">TIterator</a> *iter = simPdf-&gt;<a class="code" href="classRooSimultaneous.html#a782f41c630d9e7455bf8f88ecac91402">indexCat</a>().<a class="code" href="classRooAbsCategory.html#a21016d01326d9bde83f642a8c34d678f">typeIterator</a>();</div><div class="line">         <a class="code" href="classRooCatType.html">RooCatType</a> *<a class="code" href="textangle_8C.html#a22f75618656fffab2e5cb4ad2c8c3bd3">tt</a> = NULL;</div><div class="line">         <span class="keywordflow">while</span> ((<a class="code" href="textangle_8C.html#a22f75618656fffab2e5cb4ad2c8c3bd3">tt</a> = (<a class="code" href="classRooCatType.html">RooCatType</a> *)iter-&gt;<a class="code" href="classTIterator.html#a84fc49025ff66ab1854d366a2fbc8a90">Next</a>())) {</div><div class="line"></div><div class="line">            <span class="comment">// Get pdf associated with state from simpdf</span></div><div class="line">            <a class="code" href="classRooAbsPdf.html">RooAbsPdf</a> *pdftmp = simPdf-&gt;<a class="code" href="classRooSimultaneous.html#afd602ab9fc0e232be2b9fb2a6d63a132">getPdf</a>(<a class="code" href="textangle_8C.html#a22f75618656fffab2e5cb4ad2c8c3bd3">tt</a>-&gt;GetName());</div><div class="line"></div><div class="line">            <span class="comment">// Generate only global variables defined by the pdf associated with this state</span></div><div class="line">            <a class="code" href="classRooArgSet.html">RooArgSet</a> *globtmp = pdftmp-&gt;<a class="code" href="classRooAbsArg.html#a774e108868fca1a6819275f0a304fc0d">getObservables</a>(*mc-&gt;<a class="code" href="classRooStats_1_1ModelConfig.html#a97a9dc6d7758e6c08bd54234462f0539">GetGlobalObservables</a>());</div><div class="line">            <a class="code" href="classRooDataSet.html">RooDataSet</a> *tmp = pdftmp-&gt;<a class="code" href="classRooAbsPdf.html#aff9a0b0fd2e1cab5124bd0d209ecbb18">generate</a>(*globtmp, 1);</div><div class="line"></div><div class="line">            <span class="comment">// Transfer values to output placeholder</span></div><div class="line">            *globtmp = *tmp-&gt;<a class="code" href="classRooDataSet.html#a2d2355b7a32be47b906312f113ee75c0">get</a>(0);</div><div class="line"></div><div class="line">            <span class="comment">// Cleanup</span></div><div class="line">            <span class="keyword">delete</span> globtmp;</div><div class="line">            <span class="keyword">delete</span> tmp;</div><div class="line">         }</div><div class="line">      }</div><div class="line"></div><div class="line">      <span class="comment">//    globalData-&gt;Print(&quot;v&quot;);</span></div><div class="line">      <span class="comment">//    unconditionalObs = *globalData-&gt;get();</span></div><div class="line">      <span class="comment">//    mc-&gt;GetGlobalObservables()-&gt;Print(&quot;v&quot;);</span></div><div class="line">      <span class="comment">//    delete globalData;</span></div><div class="line">      <span class="comment">//    cout &lt;&lt; &quot;toy data = &quot; &lt;&lt; endl;</span></div><div class="line">      <span class="comment">//    toyData-&gt;get()-&gt;Print(&quot;v&quot;);</span></div><div class="line"></div><div class="line">      <span class="comment">// get test stat at observed UL in observed data</span></div><div class="line">      firstPOI-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(observedUL);</div><div class="line">      <span class="keywordtype">double</span> toyTSatObsUL = <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetTestStatSampler()-&gt;EvaluateTestStatistic(*toyData, tmpPOI);</div><div class="line">      <span class="comment">//    toyData-&gt;get()-&gt;Print(&quot;v&quot;);</span></div><div class="line">      <span class="comment">//    cout &lt;&lt;&quot;obsTSatObsUL &quot; &lt;&lt;obsTSatObsUL &lt;&lt; &quot;toyTS &quot; &lt;&lt; toyTSatObsUL &lt;&lt; endl;</span></div><div class="line">      <span class="keywordflow">if</span> (obsTSatObsUL &lt; toyTSatObsUL) <span class="comment">// not sure about &lt;= part yet</span></div><div class="line">         CLb += (1.) / nToyMC;</div><div class="line">      <span class="keywordflow">if</span> (obsTSatObsUL &lt;= toyTSatObsUL) <span class="comment">// not sure about &lt;= part yet</span></div><div class="line">         CLbinclusive += (1.) / nToyMC;</div><div class="line"></div><div class="line">      <span class="comment">// loop over points in belt to find upper limit for this toy data</span></div><div class="line">      <span class="keywordtype">double</span> thisUL = 0;</div><div class="line">      <span class="keywordflow">for</span> (<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i = 0; i &lt; parameterScan-&gt;<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>(); ++i) {</div><div class="line">         tmpPoint = (<a class="code" href="classRooArgSet.html">RooArgSet</a> *)parameterScan-&gt;<a class="code" href="classRooDataSet.html#a2d2355b7a32be47b906312f113ee75c0">get</a>(i)-&gt;<a class="code" href="classRooArgSet.html#a693748866f98afb0b4e9efd40de6b405">clone</a>(<span class="stringliteral">&quot;temp&quot;</span>);</div><div class="line">         <span class="keywordtype">double</span> arMax = belt-&gt;<a class="code" href="classRooStats_1_1ConfidenceBelt.html#ad465a9878549db5398cabbffb57ff7fb">GetAcceptanceRegionMax</a>(*tmpPoint);</div><div class="line">         firstPOI-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(tmpPoint-&gt;<a class="code" href="classRooArgSet.html#a72568bf2b2726891810ba3b3e8251f0b">getRealValue</a>(firstPOI-&gt;<a class="code" href="classTNamed.html#a42e3142d30b08fed1b07216d4a36b090">GetName</a>()));</div><div class="line">         <span class="comment">//   double thisTS = profile-&gt;getVal();</span></div><div class="line">         <span class="keywordtype">double</span> thisTS = <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>.GetTestStatSampler()-&gt;EvaluateTestStatistic(*toyData, tmpPOI);</div><div class="line"></div><div class="line">         <span class="comment">//   cout &lt;&lt; &quot;poi = &quot; &lt;&lt; firstPOI-&gt;getVal()</span></div><div class="line">         <span class="comment">// &lt;&lt; &quot; max is &quot; &lt;&lt; arMax &lt;&lt; &quot; this profile = &quot; &lt;&lt; thisTS &lt;&lt; endl;</span></div><div class="line">         <span class="comment">//      cout &lt;&lt; &quot;thisTS = &quot; &lt;&lt; thisTS&lt;&lt;endl;</span></div><div class="line">         <span class="keywordflow">if</span> (thisTS &lt;= arMax) {</div><div class="line">            thisUL = firstPOI-&gt;<a class="code" href="classRooAbsReal.html#a8881da431598c6d15e06cc80518d323d">getVal</a>();</div><div class="line">         } <span class="keywordflow">else</span> {</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">         }</div><div class="line">      }</div><div class="line"></div><div class="line">      <span class="comment">/*</span></div><div class="line"><span class="comment">      // loop over points in belt to find upper limit for this toy data</span></div><div class="line"><span class="comment">      double thisUL = 0;</span></div><div class="line"><span class="comment">      for(Int_t i=0; i&lt;histOfThresholds-&gt;GetNbinsX(); ++i){</span></div><div class="line"><span class="comment">         tmpPoint = (RooArgSet*) parameterScan-&gt;get(i)-&gt;clone(&quot;temp&quot;);</span></div><div class="line"><span class="comment">         cout &lt;&lt;&quot;----------------  &quot;&lt;&lt;i&lt;&lt;endl;</span></div><div class="line"><span class="comment">         tmpPoint-&gt;Print(&quot;v&quot;);</span></div><div class="line"><span class="comment">         cout &lt;&lt; &quot;from hist &quot; &lt;&lt; histOfThresholds-&gt;GetBinCenter(i+1) &lt;&lt;endl;</span></div><div class="line"><span class="comment">         double arMax = histOfThresholds-&gt;GetBinContent(i+1);</span></div><div class="line"><span class="comment">         // cout &lt;&lt; &quot; threhold from Hist = aMax &quot; &lt;&lt; arMax&lt;&lt;endl;</span></div><div class="line"><span class="comment">         // double arMax2 = belt-&gt;GetAcceptanceRegionMax(*tmpPoint);</span></div><div class="line"><span class="comment">         // cout &lt;&lt; &quot;from scan arMax2 = &quot;&lt;&lt; arMax2 &lt;&lt; endl; // not the same due to TH1F not TH1D</span></div><div class="line"><span class="comment">         // cout &lt;&lt; &quot;scan - hist&quot; &lt;&lt; arMax2-arMax &lt;&lt; endl;</span></div><div class="line"><span class="comment">         firstPOI-&gt;setVal( histOfThresholds-&gt;GetBinCenter(i+1));</span></div><div class="line"><span class="comment">         //   double thisTS = profile-&gt;getVal();</span></div><div class="line"><span class="comment">         double thisTS = fc.GetTestStatSampler()-&gt;EvaluateTestStatistic(*toyData,tmpPOI);</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">         //   cout &lt;&lt; &quot;poi = &quot; &lt;&lt; firstPOI-&gt;getVal()</span></div><div class="line"><span class="comment">         // &lt;&lt; &quot; max is &quot; &lt;&lt; arMax &lt;&lt; &quot; this profile = &quot; &lt;&lt; thisTS &lt;&lt; endl;</span></div><div class="line"><span class="comment">         //      cout &lt;&lt; &quot;thisTS = &quot; &lt;&lt; thisTS&lt;&lt;endl;</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">         // NOTE: need to add a small epsilon term for single precision vs. double precision</span></div><div class="line"><span class="comment">         if(thisTS&lt;=arMax + 1e-7){</span></div><div class="line"><span class="comment">            thisUL = firstPOI-&gt;getVal();</span></div><div class="line"><span class="comment">         } else{</span></div><div class="line"><span class="comment">            break;</span></div><div class="line"><span class="comment">         }</span></div><div class="line"><span class="comment">      }</span></div><div class="line"><span class="comment">      */</span></div><div class="line"></div><div class="line">      histOfUL-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(thisUL);</div><div class="line"></div><div class="line">      <span class="comment">// for few events, data is often the same, and UL is often the same</span></div><div class="line">      <span class="comment">//    cout &lt;&lt; &quot;thisUL = &quot; &lt;&lt; thisUL&lt;&lt;endl;</span></div><div class="line"></div><div class="line">      <span class="keyword">delete</span> toyData;</div><div class="line">   }</div><div class="line">   histOfUL-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;SaveAs(<span class="stringliteral">&quot;one-sided_upper_limit_output.pdf&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// if you want to see a plot of the sampling distribution for a particular scan point:</span></div><div class="line">   <span class="comment">/*</span></div><div class="line"><span class="comment">   SamplingDistPlot sampPlot;</span></div><div class="line"><span class="comment">   int indexInScan = 0;</span></div><div class="line"><span class="comment">   tmpPoint = (RooArgSet*) parameterScan-&gt;get(indexInScan)-&gt;clone(&quot;temp&quot;);</span></div><div class="line"><span class="comment">   firstPOI-&gt;setVal( tmpPoint-&gt;getRealValue(firstPOI-&gt;GetName()) );</span></div><div class="line"><span class="comment">   toymcsampler-&gt;SetParametersForTestStat(tmpPOI);</span></div><div class="line"><span class="comment">   SamplingDistribution* samp = toymcsampler-&gt;GetSamplingDistribution(*tmpPoint);</span></div><div class="line"><span class="comment">   sampPlot.AddSamplingDistribution(samp);</span></div><div class="line"><span class="comment">   sampPlot.Draw();</span></div><div class="line"><span class="comment">      */</span></div><div class="line"></div><div class="line">   <span class="comment">// Now find bands and power constraint</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> *bins = histOfUL-&gt;<a class="code" href="classTH1.html#ac16748d3e7ba02e47772cd2eecdcbbbb">GetIntegral</a>();</div><div class="line">   <a class="code" href="classTH1F.html">TH1F</a> *cumulative = (<a class="code" href="classTH1F.html">TH1F</a> *)histOfUL-&gt;<a class="code" href="classTH1.html#a61f001c11f9b4a6dabc96af989009c40">Clone</a>(<span class="stringliteral">&quot;cumulative&quot;</span>);</div><div class="line">   cumulative-&gt;<a class="code" href="classTH1.html#a828aa3b97264611a20c3849e1820b28b">SetContent</a>(bins);</div><div class="line">   <span class="keywordtype">double</span> band2sigDown, band1sigDown, bandMedian, band1sigUp, band2sigUp;</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= cumulative-&gt;<a class="code" href="classTH1.html#a68ac42aeb65a689b5b32e1865b4dfd13">GetNbinsX</a>(); ++i) {</div><div class="line">      <span class="keywordflow">if</span> (bins[i] &lt; <a class="code" href="namespaceRooStats.html#af3f5718b59a3add827d2d3b322e4d5d3">RooStats::SignificanceToPValue</a>(2))</div><div class="line">         band2sigDown = cumulative-&gt;<a class="code" href="classTH1.html#a0ee88e02b75d885985097dcde0a9eaa1">GetBinCenter</a>(i);</div><div class="line">      <span class="keywordflow">if</span> (bins[i] &lt; <a class="code" href="namespaceRooStats.html#af3f5718b59a3add827d2d3b322e4d5d3">RooStats::SignificanceToPValue</a>(1))</div><div class="line">         band1sigDown = cumulative-&gt;<a class="code" href="classTH1.html#a0ee88e02b75d885985097dcde0a9eaa1">GetBinCenter</a>(i);</div><div class="line">      <span class="keywordflow">if</span> (bins[i] &lt; 0.5)</div><div class="line">         bandMedian = cumulative-&gt;<a class="code" href="classTH1.html#a0ee88e02b75d885985097dcde0a9eaa1">GetBinCenter</a>(i);</div><div class="line">      <span class="keywordflow">if</span> (bins[i] &lt; <a class="code" href="namespaceRooStats.html#af3f5718b59a3add827d2d3b322e4d5d3">RooStats::SignificanceToPValue</a>(-1))</div><div class="line">         band1sigUp = cumulative-&gt;<a class="code" href="classTH1.html#a0ee88e02b75d885985097dcde0a9eaa1">GetBinCenter</a>(i);</div><div class="line">      <span class="keywordflow">if</span> (bins[i] &lt; <a class="code" href="namespaceRooStats.html#af3f5718b59a3add827d2d3b322e4d5d3">RooStats::SignificanceToPValue</a>(-2))</div><div class="line">         band2sigUp = cumulative-&gt;<a class="code" href="classTH1.html#a0ee88e02b75d885985097dcde0a9eaa1">GetBinCenter</a>(i);</div><div class="line">   }</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-2 sigma  band &quot;</span> &lt;&lt; band2sigDown &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-1 sigma  band &quot;</span> &lt;&lt; band1sigDown &lt;&lt; <span class="stringliteral">&quot; [Power Constraint)]&quot;</span> &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;median of band &quot;</span> &lt;&lt; bandMedian &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;+1 sigma  band &quot;</span> &lt;&lt; band1sigUp &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;+2 sigma  band &quot;</span> &lt;&lt; band2sigUp &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="comment">// print out the interval on the first Parameter of Interest</span></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;\nobserved 95% upper-limit &quot;</span> &lt;&lt; interval-&gt;<a class="code" href="classRooStats_1_1PointSetInterval.html#a8c43f888bbc5ba55ec8553a0506dcfc6">UpperLimit</a>(*firstPOI) &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;CLb strict [P(toy&gt;obs|0)] for observed 95% upper-limit &quot;</span> &lt;&lt; CLb &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;CLb inclusive [P(toy&gt;=obs|0)] for observed 95% upper-limit &quot;</span> &lt;&lt; CLbinclusive &lt;&lt; endl;</div><div class="line"></div><div class="line">   <span class="keyword">delete</span> profile;</div><div class="line">   <span class="keyword">delete</span> nll;</div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Authors</dt><dd>Kyle Cranmer Haichen Wang Daniel Whiteson </dd></dl>

<p class="definition">Definition in file <a class="el" href="OneSidedFrequentistUpperLimitWithBands_8C_source.html">OneSidedFrequentistUpperLimitWithBands.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:26 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

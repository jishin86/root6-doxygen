<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/io/mergeSelective.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_c6274b5c933425c4fa2529bf46083e7c.html">io</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">mergeSelective.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__io.html">IO tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/mergeSelective.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/mergeSelective.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  Merge only part of the content of a set of files. </p>
<p>This macro demonstrates how to merge only a part of the content of a set of input files, specified via the interface. </p><div class="fragment"><div class="line"><a class="code" href="classTFileMerger.html#a889624eb9525d63a4860758eb7d7ed5f">TFileMerger::AddObjectNames</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *names)</div></div><!-- fragment --><p> The method can be called several times to add object names, or using a single string with names separated by a blank. Directory names contained in the files to be merged are accepted.</p>
<p>Two modes are supported:</p><ol type="1">
<li>kOnlyListed: via <code>TFileMerger::PartialMerge(kOnlyListed)</code> This will merge only the objects in the files having the names in the specified list. If a folder is specified, its whole content will be merged</li>
<li>kSkipListed: via <code>TFileMerger::PartialMerge(kSkipListed)</code> This will skip merging of specified objects. If a folder is specified, its whole content will be skipped.</li>
</ol>
<p>Important note: the kOnlyListed and kSkipListed flags have to be bitwise OR-ed on top of the merging defaults: kAll | kIncremental (as in the example)</p>
<p>The files to be merged have the following structure:</p><ul>
<li>hpx (<a class="el" href="classTH1F.html" title="1-D histogram with a float per channel (see TH1 documentation)} ">TH1F</a>)</li>
<li>hpxpy (<a class="el" href="classTH2F.html" title="2-D histogram with a float per channel (see TH1 documentation)} ">TH2F</a>)</li>
<li>hprof (<a class="el" href="classTProfile.html" title="Profile Histogram. ">TProfile</a>)</li>
<li>ntuple (<a class="el" href="classTNtuple.html" title="A simple TTree restricted to a list of float variables only. ">TNtuple</a>)</li>
<li>folder (<a class="el" href="classTDirectory.html" title="Describe directory structure in memory. ">TDirectory</a>)<ul>
<li>hpx1 (<a class="el" href="classTH1F.html" title="1-D histogram with a float per channel (see TH1 documentation)} ">TH1F</a>)</li>
</ul>
</li>
</ul>
<p>The example first merges exclusively hprof and the content of "folder", producing the file exclusive.root, then merges all content but skipping hprof and the content of "folder". The result can be inspected in the browser.</p>
<div class="fragment"><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> CreateFile(<span class="keyword">const</span> <span class="keywordtype">char</span> *);</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> mergeSelective(<a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> nfiles=5)</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// Create the files to be merged</span></div><div class="line">   <a class="code" href="classTStopwatch.html">TStopwatch</a> timer;</div><div class="line">   timer.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">   <a class="code" href="classTString.html">TString</a> tutdir = <a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;GetTutorialDir();</div><div class="line">   <span class="keywordflow">if</span> (<a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;LoadMacro(tutdir + <span class="stringliteral">&quot;/hsimple.C&quot;</span>)) <span class="keywordflow">return</span>;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> i;</div><div class="line">   <span class="keywordflow">for</span> (i=0; i&lt;nfiles; i++) CreateFile(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;tomerge%03d.root&quot;</span>,i));</div><div class="line"></div><div class="line">   <span class="comment">//------------------------------------</span></div><div class="line">   <span class="comment">// Merge only the listed objects</span></div><div class="line">   <span class="comment">//------------------------------------</span></div><div class="line">   <a class="code" href="classTFileMerger.html">TFileMerger</a> *fm;</div><div class="line">   fm = <span class="keyword">new</span> <a class="code" href="classTFileMerger.html">TFileMerger</a>(<a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>);</div><div class="line">   fm-&gt;<a class="code" href="classTFileMerger.html#a107416b7da987bc2292e730e26798be1">OutputFile</a>(<span class="stringliteral">&quot;exclusive.root&quot;</span>);</div><div class="line">   fm-&gt;<a class="code" href="classTFileMerger.html#a889624eb9525d63a4860758eb7d7ed5f">AddObjectNames</a>(<span class="stringliteral">&quot;hprof folder&quot;</span>);</div><div class="line">   <span class="keywordflow">for</span> (i=0; i&lt;nfiles; i++) fm-&gt;<a class="code" href="classTFileMerger.html#a20a821acc11ca31dbe7a9df70c11ebfb">AddFile</a>(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;tomerge%03d.root&quot;</span>,i));</div><div class="line">   <span class="comment">// Must add new merging flag on top of the the default ones</span></div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> default_mode = <a class="code" href="classTFileMerger.html#a8ea43dc0722ce413c7332584d8c3ef0fa278edb8e627a28c77e16ada2a402590e">TFileMerger::kAll</a> | <a class="code" href="classTFileMerger.html#a8ea43dc0722ce413c7332584d8c3ef0fa77af3901d1515a61946a79669794c280">TFileMerger::kIncremental</a>;</div><div class="line">   <a class="code" href="RtypesCore_8h.html#a3885b911a54b47a4e61671f45dd45d0b">Int_t</a> mode = default_mode | <a class="code" href="classTFileMerger.html#a8ea43dc0722ce413c7332584d8c3ef0fae4560e559a3bcbfd06ebf139a6af9170">TFileMerger::kOnlyListed</a>;</div><div class="line">   fm-&gt;<a class="code" href="classTFileMerger.html#ad51083b4d0fbd86ff058f0583e33a5b2">PartialMerge</a>(mode);</div><div class="line">   fm-&gt;<a class="code" href="classTFileMerger.html#adc60bef936b9dd7a4884cc6cbf763abe">Reset</a>();</div><div class="line"></div><div class="line">   <span class="comment">//------------------------------------</span></div><div class="line">   <span class="comment">// Skip merging of the listed objects</span></div><div class="line">   <span class="comment">//------------------------------------</span></div><div class="line">   fm-&gt;<a class="code" href="classTFileMerger.html#a107416b7da987bc2292e730e26798be1">OutputFile</a>(<span class="stringliteral">&quot;skipped.root&quot;</span>);</div><div class="line">   fm-&gt;<a class="code" href="classTFileMerger.html#a889624eb9525d63a4860758eb7d7ed5f">AddObjectNames</a>(<span class="stringliteral">&quot;hprof folder&quot;</span>);</div><div class="line">   <span class="keywordflow">for</span> (i=0; i&lt;nfiles; i++) fm-&gt;<a class="code" href="classTFileMerger.html#a20a821acc11ca31dbe7a9df70c11ebfb">AddFile</a>(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;tomerge%03d.root&quot;</span>,i));</div><div class="line">   <span class="comment">// Must add new merging flag on top of the the default ones</span></div><div class="line">   mode = default_mode | <a class="code" href="classTFileMerger.html#a8ea43dc0722ce413c7332584d8c3ef0fabe1c8b5bfebca864b5f56597c4c5a99e">TFileMerger::kSkipListed</a>;</div><div class="line">   fm-&gt;<a class="code" href="classTFileMerger.html#ad51083b4d0fbd86ff058f0583e33a5b2">PartialMerge</a>(mode);</div><div class="line">   <span class="keyword">delete</span> fm;</div><div class="line"></div><div class="line"></div><div class="line">   <span class="comment">// Cleanup initial files</span></div><div class="line">   <span class="keywordflow">for</span> (i=0; i&lt;nfiles; i++) <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#af029c44ab5002d353abf8c0e51659bd9">Unlink</a>(<a class="code" href="TString_8h.html#acf18c5b91421ac53e91bd96ebc07dea7">Form</a>(<span class="stringliteral">&quot;tomerge%03d.root&quot;</span>,i));</div><div class="line">   <span class="comment">// Open files to inspect in the browser</span></div><div class="line">   <a class="code" href="classTFile.html#aec5f3fae0774aabfc615ebb4b00fe5e0">TFile::Open</a>(<span class="stringliteral">&quot;exclusive.root&quot;</span>);</div><div class="line">   <a class="code" href="classTFile.html#aec5f3fae0774aabfc615ebb4b00fe5e0">TFile::Open</a>(<span class="stringliteral">&quot;skipped.root&quot;</span>);</div><div class="line">   <span class="keyword">new</span> <a class="code" href="classTBrowser.html">TBrowser</a>();</div><div class="line">   timer.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   timer.<a class="code" href="classTStopwatch.html#aa393762ec66c9732940dccf05e8be7ec">Print</a>();</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> CreateFile(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname)</div><div class="line">{</div><div class="line">   <a class="code" href="classTFile.html">TFile</a> *<a class="code" href="namespaceexample.html">example</a> = (<a class="code" href="classTFile.html">TFile</a>*)<a class="code" href="TROOT_8h.html#a851dd11b3478372a25ba6eff6dcfa5b1">gROOT</a>-&gt;ProcessLineFast(<span class="stringliteral">&quot;hsimple(1)&quot;</span>);</div><div class="line">   <span class="keywordflow">if</span> (!<a class="code" href="namespaceexample.html">example</a>) <span class="keywordflow">return</span>;</div><div class="line">   <a class="code" href="classTH1F.html">TH1F</a> *hpx = (<a class="code" href="classTH1F.html">TH1F</a>*)<a class="code" href="namespaceexample.html">example</a>-&gt;Get(<span class="stringliteral">&quot;hpx&quot;</span>);</div><div class="line">   hpx-&gt;<a class="code" href="classTH1.html#abc53ba2aa433ec4134d93970e5000680">SetName</a>(<span class="stringliteral">&quot;hpx1&quot;</span>);</div><div class="line">   <a class="code" href="classTFile.html#aaf0edbf57091f9d941caf134f1207156">TFile::Cp</a>(<a class="code" href="namespaceexample.html">example</a>-&gt;GetName(), fname);</div><div class="line">   <a class="code" href="classTFile.html">TFile</a> *<a class="code" href="namespacefile.html">file</a> = <a class="code" href="classTFile.html#aec5f3fae0774aabfc615ebb4b00fe5e0">TFile::Open</a>(fname, <span class="stringliteral">&quot;UPDATE&quot;</span>);</div><div class="line">   <a class="code" href="namespacefile.html">file</a>-&gt;mkdir(<span class="stringliteral">&quot;folder&quot;</span>)-&gt;cd();</div><div class="line">   hpx-&gt;<a class="code" href="classTObject.html#a19782a4717dbfd4857ccd9ffa68aa06d">Write</a>();</div><div class="line">   <a class="code" href="namespacefile.html">file</a>-&gt;Close();</div><div class="line">   <a class="code" href="namespaceexample.html">example</a>-&gt;Close();</div><div class="line">   <a class="code" href="classTString.html">TString</a> sname(fname);</div><div class="line">   <span class="keywordflow">if</span> (sname.Contains(<span class="stringliteral">&quot;000&quot;</span>)) {</div><div class="line">      <a class="code" href="classTFile.html#aaf0edbf57091f9d941caf134f1207156">TFile::Cp</a>(fname, <span class="stringliteral">&quot;original.root&quot;</span>);</div><div class="line">      <a class="code" href="classTFile.html#aec5f3fae0774aabfc615ebb4b00fe5e0">TFile::Open</a>(<span class="stringliteral">&quot;original.root&quot;</span>);</div><div class="line">   }</div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>The Root Team </dd></dl>

<p class="definition">Definition in file <a class="el" href="mergeSelective_8C_source.html">mergeSelective.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:16 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

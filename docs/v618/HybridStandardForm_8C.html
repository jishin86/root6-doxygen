<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/roostats/HybridStandardForm.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_87facaa6959ceb8d3dacccaf663f7b84.html">roostats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">HybridStandardForm.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__roostats.html">RooStats Tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p> <a href="http://nbviewer.jupyter.org/url/root.cern.ch/doc/master/notebooks/HybridStandardForm.C.nbconvert.ipynb" target="_blank"><img src= notebook.gif alt="View in nbviewer" style="height:1em" ></a> <a href="https://cern.ch/swanserver/cgi-bin/go?projurl=https://root.cern.ch/doc/master/notebooks/HybridStandardForm.C.nbconvert.ipynb" target="_blank"><img src="http://swanserver.web.cern.ch/swanserver/images/badge_swan_white_150.png"  alt="Open in SWAN" style="height:1em" ></a>  A hypothesis testing example based on number counting with background uncertainty. </p>
<p>A hypothesis testing example based on number counting with background uncertainty.</p>
<p>NOTE: This example is like HybridInstructional, but the model is more clearly generalizable to an analysis with shapes. There is a lot of flexibility for how one models a problem in RooFit/RooStats. Models come in a few common forms:</p><ul>
<li>standard form: extended PDF of some discriminating variable m: eg: P(m) ~ S*fs(m) + B*fb(m), with S+B events expected in this case the dataset has N rows corresponding to N events and the extended term is Pois(N|S+B)</li>
<li>fractional form: non-extended PDF of some discriminating variable m: eg: P(m) ~ s*fs(m) + (1-s)*fb(m), where s is a signal fraction in this case the dataset has N rows corresponding to N events and there is no extended term</li>
<li>number counting form: in which there is no discriminating variable and the counts are modeled directly (see HybridInstructional) eg: P(N) = Pois(N|S+B) in this case the dataset has 1 row corresponding to N events and the extended term is the PDF itself.</li>
</ul>
<p>Here we convert the number counting form into the standard form by introducing a dummy discriminating variable m with a uniform distribution.</p>
<p>This example:</p><ul>
<li>demonstrates the usage of the HybridCalcultor (Part 4-6)</li>
<li>demonstrates the numerical integration of <a class="el" href="namespaceRooFit.html" title="Template specialisation used in RooAbsArg: ">RooFit</a> (Part 2)</li>
<li>validates the <a class="el" href="namespaceRooStats.html" title="Namespace for the RooStats classes. ">RooStats</a> against an example with a known analytic answer</li>
<li>demonstrates usage of different test statistics</li>
<li>explains subtle choices in the prior used for hybrid methods</li>
<li>demonstrates usage of different priors for the nuisance parameters</li>
<li>demonstrates usage of PROOF</li>
</ul>
<p>The basic setup here is that a main measurement has observed x events with an expectation of s+b. One can choose an ad hoc prior for the uncertainty on b, or try to base it on an auxiliary measurement. In this case, the auxiliary measurement (aka control measurement, sideband) is another counting experiment with measurement y and expectation tau*b. With an 'original prior' on b, called \( \eta(b) \) then one can obtain a posterior from the auxiliary measurement \( \pi(b) = \eta(b) * Pois(y|tau*b) \). This is a principled choice for a prior on b in the main measurement of x, which can then be treated in a hybrid Bayesian/Frequentist way. Additionally, one can try to treat the two measurements simultaneously, which is detailed in Part 6 of the tutorial.</p>
<p>This tutorial is related to the FourBin.C tutorial in the modeling, but focuses on hypothesis testing instead of interval estimation.</p>
<p>More background on this 'prototype problem' can be found in the following papers:</p>
<ul>
<li>Evaluation of three methods for calculating statistical significance when incorporating a systematic uncertainty into a test of the background-only hypothesis for a Poisson process Authors: Robert D. Cousins, James T. Linnemann, Jordan Tucker <a href="http://arxiv.org/abs/physics/0702156">http://arxiv.org/abs/physics/0702156</a> NIM A 595 (2008) 480&ndash;501</li>
<li>Statistical Challenges for Searches for New Physics at the LHC Author: Kyle Cranmer <a href="http://arxiv.org/abs/physics/0511028">http://arxiv.org/abs/physics/0511028</a></li>
<li>Measures of Significance in HEP and Astrophysics Author: J. T. Linnemann <a href="http://arxiv.org/abs/physics/0312059">http://arxiv.org/abs/physics/0312059</a></li>
</ul>
<div class="image">
<img src="pict1_HybridStandardForm.C.png" alt="pict1_HybridStandardForm.C.png" width="700"/>
</div>
 <div class="fragment"><div class="line"></div><div class="line"></div><div class="line">[1mRooFit v3.60 -- Developed by Wouter Verkerke and David Kirkby[0m </div><div class="line">                Copyright (C) 2000-2013 NIKHEF, University of California &amp; Stanford University</div><div class="line">                All rights reserved, please read http://roofit.sourceforge.net/license.txt</div><div class="line"></div><div class="line">-----------------------------------------</div><div class="line">Part 3</div><div class="line">Z_Bi p-value (analytic): 0.00094165</div><div class="line">Z_Bi significance (analytic): 3.10804</div><div class="line">Real time 0:00:00, CP time 0.020</div><div class="line">[#0] WARNING:Eval -- RooStatsUtils::MakeNuisancePdf - no constraints found on nuisance parameters in the input model</div><div class="line">[#0] WARNING:Eval -- RooStatsUtils::MakeNuisancePdf - no constraints found on nuisance parameters in the input model</div><div class="line">-----------------------------------------</div><div class="line">Part 4</div><div class="line"></div><div class="line">Results HypoTestCalculator_result: </div><div class="line"> - Null p-value = 0.0009 +/- 0.000173127</div><div class="line"> - Significance = 3.12139 +/- 0.0566416 sigma</div><div class="line"> - Number of Alt toys: 1000</div><div class="line"> - Number of Null toys: 30000</div><div class="line"> - Test statistic evaluated on data: 150</div><div class="line"> - CL_b: 0.0009 +/- 0.000173127</div><div class="line"> - CL_s+b: 0.533 +/- 0.0157769</div><div class="line"> - CL_s: 592.222 +/- 115.263</div><div class="line">Real time 0:00:53, CP time 53.190</div></div><!-- fragment --> <div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooGlobalFunc_8h.html">RooGlobalFunc.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooRealVar_8h.html">RooRealVar.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooProdPdf_8h.html">RooProdPdf.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooWorkspace_8h.html">RooWorkspace.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooDataSet_8h.html">RooDataSet.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooDataHist_8h.html">RooDataHist.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TStopwatch_8h.html">TStopwatch.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TH1_8h.html">TH1.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooPlot_8h.html">RooPlot.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RooMsgService_8h.html">RooMsgService.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="NumberCountingUtils_8h.html">RooStats/NumberCountingUtils.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="HybridCalculator_8h.html">RooStats/HybridCalculator.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ToyMCSampler_8h.html">RooStats/ToyMCSampler.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="HypoTestPlot_8h.html">RooStats/HypoTestPlot.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="NumEventsTestStat_8h.html">RooStats/NumEventsTestStat.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ProfileLikelihoodTestStat_8h.html">RooStats/ProfileLikelihoodTestStat.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SimpleLikelihoodRatioTestStat_8h.html">RooStats/SimpleLikelihoodRatioTestStat.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RatioOfProfiledLikelihoodsTestStat_8h.html">RooStats/RatioOfProfiledLikelihoodsTestStat.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="MaxLikelihoodEstimateTestStat_8h.html">RooStats/MaxLikelihoodEstimateTestStat.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooFit.html">RooFit</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceRooStats.html">RooStats</a>;</div><div class="line"></div><div class="line"><span class="comment">//-------------------------------------------------------</span></div><div class="line"><span class="comment">// A New Test Statistic Class for this example.</span></div><div class="line"><span class="comment">// It simply returns the sum of the values in a particular</span></div><div class="line"><span class="comment">// column of a dataset.</span></div><div class="line"><span class="comment">// You can ignore this class and focus on the macro below</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>BinCountTestStat : <span class="keyword">public</span> <a class="code" href="classRooStats_1_1TestStatistic.html">TestStatistic</a> {</div><div class="line"><span class="keyword">public</span>:</div><div class="line">   BinCountTestStat(<span class="keywordtype">void</span>) : fColumnName(<span class="stringliteral">&quot;tmp&quot;</span>) {}</div><div class="line">   BinCountTestStat(<span class="keywordtype">string</span> columnName) : fColumnName(columnName) {}</div><div class="line"></div><div class="line">   <span class="keyword">virtual</span> <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> Evaluate(<a class="code" href="classRooAbsData.html">RooAbsData</a> &amp;data, <a class="code" href="classRooArgSet.html">RooArgSet</a> &amp; <span class="comment">/*nullPOI*/</span>)</div><div class="line">   {</div><div class="line">      <span class="comment">// This is the main method in the interface</span></div><div class="line">      <a class="code" href="RtypesCore_8h.html#ab9b5334647b78ec4256db251e3ae1fc6">Double_t</a> value = 0.0;</div><div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; data.<a class="code" href="classRooAbsData.html#ab6f573d74bd8cb6fa1db720a608a3f9e">numEntries</a>(); i++) {</div><div class="line">         value += data.<a class="code" href="classRooAbsData.html#a10ce6b6339b82563c08e2e547d9f408a">get</a>(i)-&gt;<a class="code" href="classRooArgSet.html#a72568bf2b2726891810ba3b3e8251f0b">getRealValue</a>(fColumnName.c_str());</div><div class="line">      }</div><div class="line">      <span class="keywordflow">return</span> value;</div><div class="line">   }</div><div class="line">   <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="classTString.html">TString</a> GetVarName()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> fColumnName; }</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">   <span class="keywordtype">string</span> fColumnName;</div><div class="line"></div><div class="line"><span class="keyword">protected</span>:</div><div class="line">   <a class="code" href="Rtypes_8h.html#a0f5f4feb8484fa7bec8adf82b6c3836b">ClassDef</a>(BinCountTestStat, 1)</div><div class="line">};</div><div class="line"></div><div class="line"><a class="code" href="Rtypes_8h.html#a3f9bf160bbbb44209e95556960836b96">ClassImp</a>(BinCountTestStat)</div><div class="line"></div><div class="line">   <span class="comment">//-----------------------------</span></div><div class="line">   <span class="comment">// The Actual Tutorial Macro</span></div><div class="line">   <span class="comment">//-----------------------------</span></div><div class="line"></div><div class="line">   <span class="keywordtype">void</span> HybridStandardForm()</div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// This tutorial has 6 parts</span></div><div class="line">   <span class="comment">// Table of Contents</span></div><div class="line">   <span class="comment">// Setup</span></div><div class="line">   <span class="comment">//   1. Make the model for the &#39;prototype problem&#39;</span></div><div class="line">   <span class="comment">// Special cases</span></div><div class="line">   <span class="comment">//   2. NOT RELEVANT HERE</span></div><div class="line">   <span class="comment">//   3. Use RooStats analytic solution for this problem</span></div><div class="line">   <span class="comment">// RooStats HybridCalculator -- can be generalized</span></div><div class="line">   <span class="comment">//   4. RooStats ToyMC version of 2. &amp; 3.</span></div><div class="line">   <span class="comment">//   5. RooStats ToyMC with an equivalent test statistic</span></div><div class="line">   <span class="comment">//   6. RooStats ToyMC with simultaneous control &amp; main measurement</span></div><div class="line"></div><div class="line">   <span class="comment">// Part 4 takes ~4 min without PROOF.</span></div><div class="line">   <span class="comment">// Part 5 takes about ~2 min with PROOF on 4 cores.</span></div><div class="line">   <span class="comment">// Of course, everything looks nicer with more toys, which takes longer.</span></div><div class="line"></div><div class="line">   <a class="code" href="classTStopwatch.html">TStopwatch</a> t;</div><div class="line">   t.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">   <a class="code" href="classTCanvas.html">TCanvas</a> *<a class="code" href="RSha256_8hxx.html#a63f410abde93141c9013b7d3f3971738">c</a> = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>;</div><div class="line">   <a class="code" href="RSha256_8hxx.html#a63f410abde93141c9013b7d3f3971738">c</a>-&gt;Divide(2, 2);</div><div class="line"></div><div class="line">   <span class="comment">//-----------------------------------------------------</span></div><div class="line">   <span class="comment">// P A R T   1  :  D I R E C T   I N T E G R A T I O N</span></div><div class="line">   <span class="comment">// ====================================================</span></div><div class="line">   <span class="comment">// Make model for prototype on/off problem</span></div><div class="line">   <span class="comment">// Pois(x | s+b) * Pois(y | tau b )</span></div><div class="line">   <span class="comment">// for Z_Gamma, use uniform prior on b.</span></div><div class="line">   <a class="code" href="classRooWorkspace.html">RooWorkspace</a> *w = <span class="keyword">new</span> <a class="code" href="classRooWorkspace.html">RooWorkspace</a>(<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// replace the pdf in &#39;number counting form&#39;</span></div><div class="line">   <span class="comment">// w-&gt;factory(&quot;Poisson::px(x[150,0,500],sum::splusb(s[0,0,100],b[100,0,300]))&quot;);</span></div><div class="line">   <span class="comment">// with one in standard form.  Now x is encoded in event count</span></div><div class="line">   w-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Uniform::f(m[0,1])&quot;</span>); <span class="comment">// m is a dummy discriminating variable</span></div><div class="line">   w-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;ExtendPdf::px(f,sum::splusb(s[0,0,100],b[100,0,300]))&quot;</span>);</div><div class="line">   w-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Poisson::py(y[100,0,500],prod::taub(tau[1.],b))&quot;</span>);</div><div class="line">   w-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;PROD::model(px,py)&quot;</span>);</div><div class="line">   w-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Uniform::prior_b(b)&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// We will control the output level in a few places to avoid</span></div><div class="line">   <span class="comment">// verbose progress messages.  We start by keeping track</span></div><div class="line">   <span class="comment">// of the current threshold on messages.</span></div><div class="line">   <a class="code" href="namespaceRooFit.html#a36e12ae9ea9c0d3ab48f71c4ffcdace3">RooFit::MsgLevel</a> msglevel = <a class="code" href="classRooMsgService.html#a1aa4beeeda7e2aab5de645f2b8774c9c">RooMsgService::instance</a>().<a class="code" href="classRooMsgService.html#af93881c7dc6172b3e71419943a0244df">globalKillBelow</a>();</div><div class="line"></div><div class="line">   <span class="comment">// Use PROOF-lite on multi-core machines</span></div><div class="line">   <a class="code" href="classRooStats_1_1ProofConfig.html">ProofConfig</a> *<a class="code" href="namespaceTGeant4Unit.html#a9b9c22ca28407dfecdc404f99df537bb">pc</a> = NULL;</div><div class="line">   <span class="comment">// uncomment below if you want to use PROOF</span></div><div class="line">   <a class="code" href="namespaceTGeant4Unit.html#a9b9c22ca28407dfecdc404f99df537bb">pc</a> = <span class="keyword">new</span> <a class="code" href="classRooStats_1_1ProofConfig.html">ProofConfig</a>(*w, 4, <span class="stringliteral">&quot;workers=4&quot;</span>, <a class="code" href="RtypesCore_8h.html#a7e568baf910535e8ffd438acb843434d">kFALSE</a>); <span class="comment">// machine with 4 cores</span></div><div class="line">   <span class="comment">//  pc = new ProofConfig(*w, 2, &quot;workers=2&quot;, kFALSE); // machine with 2 cores</span></div><div class="line"></div><div class="line">   <span class="comment">//-----------------------------------------------</span></div><div class="line">   <span class="comment">// P A R T   3  :  A N A L Y T I C   R E S U L T</span></div><div class="line">   <span class="comment">// ==============================================</span></div><div class="line">   <span class="comment">// In this special case, the integrals are known analytically</span></div><div class="line">   <span class="comment">// and they are implemented in RooStats::NumberCountingUtils</span></div><div class="line"></div><div class="line">   <span class="comment">// analytic Z_Bi</span></div><div class="line">   <span class="keywordtype">double</span> p_Bi = <a class="code" href="namespaceRooStats_1_1NumberCountingUtils.html#aa30c8bc91fab6ad0dc30c6e70fe7847b">NumberCountingUtils::BinomialWithTauObsP</a>(150, 100, 1);</div><div class="line">   <span class="keywordtype">double</span> Z_Bi = <a class="code" href="namespaceRooStats_1_1NumberCountingUtils.html#a8c4ed450b4236877ff9d7e064262e538">NumberCountingUtils::BinomialWithTauObsZ</a>(150, 100, 1);</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span> &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Part 3&quot;</span> &lt;&lt; endl;</div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;Z_Bi p-value (analytic): &quot;</span> &lt;&lt; p_Bi &lt;&lt; std::endl;</div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;Z_Bi significance (analytic): &quot;</span> &lt;&lt; Z_Bi &lt;&lt; std::endl;</div><div class="line">   t.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   t.<a class="code" href="classTStopwatch.html#aa393762ec66c9732940dccf05e8be7ec">Print</a>();</div><div class="line">   t.<a class="code" href="classTStopwatch.html#a9cb8c7786814f77c892cbd6621f1a5e9">Reset</a>();</div><div class="line">   t.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line"></div><div class="line">   <span class="comment">//--------------------------------------------------------------</span></div><div class="line">   <span class="comment">// P A R T   4  :  U S I N G   H Y B R I D   C A L C U L A T O R</span></div><div class="line">   <span class="comment">// ==============================================================</span></div><div class="line">   <span class="comment">// Now we demonstrate the RooStats HybridCalculator.</span></div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// Like all RooStats calculators it needs the data and a ModelConfig</span></div><div class="line">   <span class="comment">// for the relevant hypotheses.  Since we are doing hypothesis testing</span></div><div class="line">   <span class="comment">// we need a ModelConfig for the null (background only) and the alternate</span></div><div class="line">   <span class="comment">// (signal+background) hypotheses.  We also need to specify the PDF,</span></div><div class="line">   <span class="comment">// the parameters of interest, and the observables.  Furthermore, since</span></div><div class="line">   <span class="comment">// the parameter of interest is floating, we need to specify which values</span></div><div class="line">   <span class="comment">// of the parameter corresponds to the null and alternate (eg. s=0 and s=50)</span></div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// define some sets of variables obs={x} and poi={s}</span></div><div class="line">   <span class="comment">// note here, x is the only observable in the main measurement</span></div><div class="line">   <span class="comment">// and y is treated as a separate measurement, which is used</span></div><div class="line">   <span class="comment">// to produce the prior that will be used in this calculation</span></div><div class="line">   <span class="comment">// to randomize the nuisance parameters.</span></div><div class="line">   w-&gt;<a class="code" href="classRooWorkspace.html#abe7f509a5b08d97201cfa90c1cf91479">defineSet</a>(<span class="stringliteral">&quot;obs&quot;</span>, <span class="stringliteral">&quot;m&quot;</span>);</div><div class="line">   w-&gt;<a class="code" href="classRooWorkspace.html#abe7f509a5b08d97201cfa90c1cf91479">defineSet</a>(<span class="stringliteral">&quot;poi&quot;</span>, <span class="stringliteral">&quot;s&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// create a toy dataset with the x=150</span></div><div class="line">   <span class="comment">//  RooDataSet *data = new RooDataSet(&quot;d&quot;, &quot;d&quot;, *w-&gt;set(&quot;obs&quot;));</span></div><div class="line">   <span class="comment">//  data-&gt;add(*w-&gt;set(&quot;obs&quot;));</span></div><div class="line">   <a class="code" href="classRooDataSet.html">RooDataSet</a> *data = w-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;px&quot;</span>)-&gt;<a class="code" href="classRooAbsPdf.html#aff9a0b0fd2e1cab5124bd0d209ecbb18">generate</a>(*w-&gt;<a class="code" href="classRooWorkspace.html#af505b7efdb0c2aae4a2e4234734ba51d">set</a>(<span class="stringliteral">&quot;obs&quot;</span>), 150);</div><div class="line"></div><div class="line">   <span class="comment">// Part 3a : Setup ModelConfigs</span></div><div class="line">   <span class="comment">//-------------------------------------------------------</span></div><div class="line">   <span class="comment">// create the null (background-only) ModelConfig with s=0</span></div><div class="line">   <a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> b_model(<span class="stringliteral">&quot;B_model&quot;</span>, w);</div><div class="line">   b_model.SetPdf(*w-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;px&quot;</span>));</div><div class="line">   b_model.SetObservables(*w-&gt;<a class="code" href="classRooWorkspace.html#af505b7efdb0c2aae4a2e4234734ba51d">set</a>(<span class="stringliteral">&quot;obs&quot;</span>));</div><div class="line">   b_model.SetParametersOfInterest(*w-&gt;<a class="code" href="classRooWorkspace.html#af505b7efdb0c2aae4a2e4234734ba51d">set</a>(<span class="stringliteral">&quot;poi&quot;</span>));</div><div class="line">   w-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;s&quot;</span>)-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(0.0); <span class="comment">// important!</span></div><div class="line">   b_model.SetSnapshot(*w-&gt;<a class="code" href="classRooWorkspace.html#af505b7efdb0c2aae4a2e4234734ba51d">set</a>(<span class="stringliteral">&quot;poi&quot;</span>));</div><div class="line"></div><div class="line">   <span class="comment">// create the alternate (signal+background) ModelConfig with s=50</span></div><div class="line">   <a class="code" href="classRooStats_1_1ModelConfig.html">ModelConfig</a> sb_model(<span class="stringliteral">&quot;S+B_model&quot;</span>, w);</div><div class="line">   sb_model.SetPdf(*w-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;px&quot;</span>));</div><div class="line">   sb_model.SetObservables(*w-&gt;<a class="code" href="classRooWorkspace.html#af505b7efdb0c2aae4a2e4234734ba51d">set</a>(<span class="stringliteral">&quot;obs&quot;</span>));</div><div class="line">   sb_model.SetParametersOfInterest(*w-&gt;<a class="code" href="classRooWorkspace.html#af505b7efdb0c2aae4a2e4234734ba51d">set</a>(<span class="stringliteral">&quot;poi&quot;</span>));</div><div class="line">   w-&gt;<a class="code" href="classRooWorkspace.html#acf5f9126ee264c234721a4ed1f9bf837">var</a>(<span class="stringliteral">&quot;s&quot;</span>)-&gt;<a class="code" href="classRooRealVar.html#af248c231ad6b7f3ad854ca12197cec48">setVal</a>(50.0); <span class="comment">// important!</span></div><div class="line">   sb_model.SetSnapshot(*w-&gt;<a class="code" href="classRooWorkspace.html#af505b7efdb0c2aae4a2e4234734ba51d">set</a>(<span class="stringliteral">&quot;poi&quot;</span>));</div><div class="line"></div><div class="line">   <span class="comment">// Part 3b : Choose Test Statistic</span></div><div class="line">   <span class="comment">//--------------------------------------------------------------</span></div><div class="line">   <span class="comment">// To make an equivalent calculation we need to use x as the test</span></div><div class="line">   <span class="comment">// statistic.  This is not a built-in test statistic in RooStats</span></div><div class="line">   <span class="comment">// so we define it above.  The new class inherits from the</span></div><div class="line">   <span class="comment">// RooStats::TestStatistic interface, and simply returns the value</span></div><div class="line">   <span class="comment">// of x in the dataset.</span></div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1NumEventsTestStat.html">NumEventsTestStat</a> eventCount(*w-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;px&quot;</span>));</div><div class="line"></div><div class="line">   <span class="comment">// Part 3c : Define Prior used to randomize nuisance parameters</span></div><div class="line">   <span class="comment">//-------------------------------------------------------------</span></div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// The prior used for the hybrid calculator is the posterior</span></div><div class="line">   <span class="comment">// from the auxiliary measurement y.  The model for the aux.</span></div><div class="line">   <span class="comment">// measurement is Pois(y|tau*b), thus the likelihood function</span></div><div class="line">   <span class="comment">// is proportional to (has the form of) a Gamma distribution.</span></div><div class="line">   <span class="comment">// if the &#39;original prior&#39; $\eta(b)$ is uniform, then from</span></div><div class="line">   <span class="comment">// Bayes&#39;s theorem we have the posterior:</span></div><div class="line">   <span class="comment">//  $\pi(b) = Pois(y|tau*b) * \eta(b)$</span></div><div class="line">   <span class="comment">// If $\eta(b)$ is flat, then we arrive at a Gamma distribution.</span></div><div class="line">   <span class="comment">// Since RooFit will normalize the PDF we can actually supply</span></div><div class="line">   <span class="comment">// py=Pois(y,tau*b) that will be equivalent to multiplying by a uniform.</span></div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// Alternatively, we could explicitly use a gamma distribution:</span></div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// `w-&gt;factory(&quot;Gamma::gamma(b,sum::temp(y,1),1,0)&quot;);`</span></div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// or we can use some other ad hoc prior that do not naturally</span></div><div class="line">   <span class="comment">// follow from the known form of the auxiliary measurement.</span></div><div class="line">   <span class="comment">// The common choice is the equivalent Gaussian:</span></div><div class="line">   w-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Gaussian::gauss_prior(b,y, expr::sqrty(&#39;sqrt(y)&#39;,y))&quot;</span>);</div><div class="line">   <span class="comment">// this corresponds to the &quot;Z_N&quot; calculation.</span></div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// or one could use the analogous log-normal prior</span></div><div class="line">   w-&gt;<a class="code" href="classRooWorkspace.html#ad8df6179ef2c096008217105a9f42920">factory</a>(<span class="stringliteral">&quot;Lognormal::lognorm_prior(b,y, expr::kappa(&#39;1+1./sqrt(y)&#39;,y))&quot;</span>);</div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// Ideally, the HybridCalculator would be able to inspect the full</span></div><div class="line">   <span class="comment">// model Pois(x | s+b) * Pois(y | tau b ) and be given the original</span></div><div class="line">   <span class="comment">// prior $\eta(b)$ to form $\pi(b) = Pois(y|tau*b) * \eta(b)$.</span></div><div class="line">   <span class="comment">// This is not yet implemented because in the general case</span></div><div class="line">   <span class="comment">// it is not easy to identify the terms in the PDF that correspond</span></div><div class="line">   <span class="comment">// to the auxiliary measurement.  So for now, it must be set</span></div><div class="line">   <span class="comment">// explicitly with:</span></div><div class="line">   <span class="comment">//  - ForcePriorNuisanceNull()</span></div><div class="line">   <span class="comment">//  - ForcePriorNuisanceAlt()</span></div><div class="line">   <span class="comment">// the name &quot;ForcePriorNuisance&quot; was chosen because we anticipate</span></div><div class="line">   <span class="comment">// this to be auto-detected, but will leave the option open</span></div><div class="line">   <span class="comment">// to force to a different prior for the nuisance parameters.</span></div><div class="line"></div><div class="line">   <span class="comment">// Part 3d : Construct and configure the HybridCalculator</span></div><div class="line">   <span class="comment">//-------------------------------------------------------</span></div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1HybridCalculator.html">HybridCalculator</a> hc1(*data, sb_model, b_model);</div><div class="line">   <a class="code" href="classRooStats_1_1ToyMCSampler.html">ToyMCSampler</a> *toymcs1 = (<a class="code" href="classRooStats_1_1ToyMCSampler.html">ToyMCSampler</a> *)hc1.GetTestStatSampler();</div><div class="line">   <span class="comment">//  toymcs1-&gt;SetNEventsPerToy(1); // because the model is in number counting form</span></div><div class="line">   toymcs1-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#a9fe8958b3d1f1b72f3e2fc20c5a674ad">SetTestStatistic</a>(&amp;eventCount); <span class="comment">// set the test statistic</span></div><div class="line">   <span class="comment">//  toymcs1-&gt;SetGenerateBinned();</span></div><div class="line">   hc1.SetToys(30000, 1000);</div><div class="line">   hc1.ForcePriorNuisanceAlt(*w-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;py&quot;</span>));</div><div class="line">   hc1.ForcePriorNuisanceNull(*w-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;py&quot;</span>));</div><div class="line">   <span class="comment">// if you wanted to use the ad hoc Gaussian prior instead</span></div><div class="line">   <span class="comment">// ~~~</span></div><div class="line">   <span class="comment">//  hc1.ForcePriorNuisanceAlt(*w-&gt;pdf(&quot;gauss_prior&quot;));</span></div><div class="line">   <span class="comment">//  hc1.ForcePriorNuisanceNull(*w-&gt;pdf(&quot;gauss_prior&quot;));</span></div><div class="line">   <span class="comment">// ~~~</span></div><div class="line">   <span class="comment">// if you wanted to use the ad hoc log-normal prior instead</span></div><div class="line">   <span class="comment">// ~~~</span></div><div class="line">   <span class="comment">//  hc1.ForcePriorNuisanceAlt(*w-&gt;pdf(&quot;lognorm_prior&quot;));</span></div><div class="line">   <span class="comment">//  hc1.ForcePriorNuisanceNull(*w-&gt;pdf(&quot;lognorm_prior&quot;));</span></div><div class="line">   <span class="comment">// ~~~</span></div><div class="line"></div><div class="line">   <span class="comment">// enable proof</span></div><div class="line">   <span class="comment">// proof not enabled for this test statistic</span></div><div class="line">   <span class="comment">//  if(pc) toymcs1-&gt;SetProofConfig(pc);</span></div><div class="line"></div><div class="line">   <span class="comment">// these lines save current msg level and then kill any messages below ERROR</span></div><div class="line">   <a class="code" href="classRooMsgService.html#a1aa4beeeda7e2aab5de645f2b8774c9c">RooMsgService::instance</a>().<a class="code" href="classRooMsgService.html#a2dd001ce79ae42f7b8ff145053f255ed">setGlobalKillBelow</a>(<a class="code" href="namespaceRooFit.html#a36e12ae9ea9c0d3ab48f71c4ffcdace3a908b03c418352ac3e23f60a6bc436c5a">RooFit::ERROR</a>);</div><div class="line">   <span class="comment">// Get the result</span></div><div class="line">   <a class="code" href="classRooStats_1_1HypoTestResult.html">HypoTestResult</a> *r1 = hc1.GetHypoTest();</div><div class="line">   <a class="code" href="classRooMsgService.html#a1aa4beeeda7e2aab5de645f2b8774c9c">RooMsgService::instance</a>().<a class="code" href="classRooMsgService.html#a2dd001ce79ae42f7b8ff145053f255ed">setGlobalKillBelow</a>(msglevel); <span class="comment">// set it back</span></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span> &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Part 4&quot;</span> &lt;&lt; endl;</div><div class="line">   r1-&gt;<a class="code" href="classRooStats_1_1HypoTestResult.html#ae7fbfc107ebfdcb1980405a663f22281">Print</a>();</div><div class="line">   t.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   t.<a class="code" href="classTStopwatch.html#aa393762ec66c9732940dccf05e8be7ec">Print</a>();</div><div class="line">   t.<a class="code" href="classTStopwatch.html#a9cb8c7786814f77c892cbd6621f1a5e9">Reset</a>();</div><div class="line">   t.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line"></div><div class="line">   <a class="code" href="RSha256_8hxx.html#a63f410abde93141c9013b7d3f3971738">c</a>-&gt;cd(2);</div><div class="line">   <a class="code" href="classRooStats_1_1HypoTestPlot.html">HypoTestPlot</a> *p1 = <span class="keyword">new</span> <a class="code" href="classRooStats_1_1HypoTestPlot.html">HypoTestPlot</a>(*r1, 30); <span class="comment">// 30 bins, TS is discrete</span></div><div class="line">   p1-&gt;<a class="code" href="classRooStats_1_1SamplingDistPlot.html#aa7d6b8754c005683cf57b7bb5067fc29">Draw</a>();</div><div class="line"></div><div class="line">   <span class="keywordflow">return</span>; <span class="comment">// keep the running time sort by default</span></div><div class="line">   <span class="comment">//-------------------------------------------------------------------------</span></div><div class="line">   <span class="comment">// # P A R T   5  :  U S I N G   H Y B R I D   C A L C U L A T O R   W I T H</span></div><div class="line">   <span class="comment">// # A N   A L T E R N A T I V E   T E S T   S T A T I S T I C</span></div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">// A likelihood ratio test statistics should be 1-to-1 with the count x</span></div><div class="line">   <span class="comment">// when the value of b is fixed in the likelihood.  This is implemented</span></div><div class="line">   <span class="comment">// by the SimpleLikelihoodRatioTestStat</span></div><div class="line"></div><div class="line">   <a class="code" href="classRooStats_1_1SimpleLikelihoodRatioTestStat.html">SimpleLikelihoodRatioTestStat</a> slrts(*b_model.GetPdf(), *sb_model.GetPdf());</div><div class="line">   slrts.<a class="code" href="classRooStats_1_1SimpleLikelihoodRatioTestStat.html#a8621a7126cc9d0d704e68e3ed172d766">SetNullParameters</a>(*b_model.GetSnapshot());</div><div class="line">   slrts.SetAltParameters(*sb_model.GetSnapshot());</div><div class="line"></div><div class="line">   <span class="comment">// HYBRID CALCULATOR</span></div><div class="line">   <a class="code" href="classRooStats_1_1HybridCalculator.html">HybridCalculator</a> hc2(*data, sb_model, b_model);</div><div class="line">   <a class="code" href="classRooStats_1_1ToyMCSampler.html">ToyMCSampler</a> *toymcs2 = (<a class="code" href="classRooStats_1_1ToyMCSampler.html">ToyMCSampler</a> *)hc2.GetTestStatSampler();</div><div class="line">   <span class="comment">//  toymcs2-&gt;SetNEventsPerToy(1);</span></div><div class="line">   toymcs2-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#a9fe8958b3d1f1b72f3e2fc20c5a674ad">SetTestStatistic</a>(&amp;slrts);</div><div class="line">   <span class="comment">//  toymcs2-&gt;SetGenerateBinned();</span></div><div class="line">   hc2.SetToys(20000, 1000);</div><div class="line">   hc2.ForcePriorNuisanceAlt(*w-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;py&quot;</span>));</div><div class="line">   hc2.ForcePriorNuisanceNull(*w-&gt;<a class="code" href="classRooWorkspace.html#afa7384cece424a1a94a644bb05549eee">pdf</a>(<span class="stringliteral">&quot;py&quot;</span>));</div><div class="line">   <span class="comment">// if you wanted to use the ad hoc Gaussian prior instead</span></div><div class="line">   <span class="comment">// ~~~</span></div><div class="line">   <span class="comment">//  hc2.ForcePriorNuisanceAlt(*w-&gt;pdf(&quot;gauss_prior&quot;));</span></div><div class="line">   <span class="comment">//  hc2.ForcePriorNuisanceNull(*w-&gt;pdf(&quot;gauss_prior&quot;));</span></div><div class="line">   <span class="comment">// ~~~</span></div><div class="line">   <span class="comment">// if you wanted to use the ad hoc log-normal prior instead</span></div><div class="line">   <span class="comment">// ~~~</span></div><div class="line">   <span class="comment">//  hc2.ForcePriorNuisanceAlt(*w-&gt;pdf(&quot;lognorm_prior&quot;));</span></div><div class="line">   <span class="comment">//  hc2.ForcePriorNuisanceNull(*w-&gt;pdf(&quot;lognorm_prior&quot;));</span></div><div class="line">   <span class="comment">// ~~~</span></div><div class="line"></div><div class="line">   <span class="comment">// enable proof</span></div><div class="line">   <span class="keywordflow">if</span> (<a class="code" href="namespaceTGeant4Unit.html#a9b9c22ca28407dfecdc404f99df537bb">pc</a>)</div><div class="line">      toymcs2-&gt;<a class="code" href="classRooStats_1_1ToyMCSampler.html#a3518c12aaf49b74d3ef58e22b41de58c">SetProofConfig</a>(<a class="code" href="namespaceTGeant4Unit.html#a9b9c22ca28407dfecdc404f99df537bb">pc</a>);</div><div class="line"></div><div class="line">   <span class="comment">// these lines save current msg level and then kill any messages below ERROR</span></div><div class="line">   <a class="code" href="classRooMsgService.html#a1aa4beeeda7e2aab5de645f2b8774c9c">RooMsgService::instance</a>().<a class="code" href="classRooMsgService.html#a2dd001ce79ae42f7b8ff145053f255ed">setGlobalKillBelow</a>(<a class="code" href="namespaceRooFit.html#a36e12ae9ea9c0d3ab48f71c4ffcdace3a908b03c418352ac3e23f60a6bc436c5a">RooFit::ERROR</a>);</div><div class="line">   <span class="comment">// Get the result</span></div><div class="line">   <a class="code" href="classRooStats_1_1HypoTestResult.html">HypoTestResult</a> *r2 = hc2.GetHypoTest();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span> &lt;&lt; endl;</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Part 5&quot;</span> &lt;&lt; endl;</div><div class="line">   r2-&gt;<a class="code" href="classRooStats_1_1HypoTestResult.html#ae7fbfc107ebfdcb1980405a663f22281">Print</a>();</div><div class="line">   t.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   t.<a class="code" href="classTStopwatch.html#aa393762ec66c9732940dccf05e8be7ec">Print</a>();</div><div class="line">   t.<a class="code" href="classTStopwatch.html#a9cb8c7786814f77c892cbd6621f1a5e9">Reset</a>();</div><div class="line">   t.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">   <a class="code" href="classRooMsgService.html#a1aa4beeeda7e2aab5de645f2b8774c9c">RooMsgService::instance</a>().<a class="code" href="classRooMsgService.html#a2dd001ce79ae42f7b8ff145053f255ed">setGlobalKillBelow</a>(msglevel);</div><div class="line"></div><div class="line">   <a class="code" href="RSha256_8hxx.html#a63f410abde93141c9013b7d3f3971738">c</a>-&gt;cd(3);</div><div class="line">   <a class="code" href="classRooStats_1_1HypoTestPlot.html">HypoTestPlot</a> *p2 = <span class="keyword">new</span> <a class="code" href="classRooStats_1_1HypoTestPlot.html">HypoTestPlot</a>(*r2, 30); <span class="comment">// 30 bins</span></div><div class="line">   p2-&gt;<a class="code" href="classRooStats_1_1SamplingDistPlot.html#aa7d6b8754c005683cf57b7bb5067fc29">Draw</a>();</div><div class="line"></div><div class="line">   <span class="keywordflow">return</span>; <span class="comment">// so standard tutorial runs faster</span></div><div class="line"></div><div class="line">   <span class="comment">//---------------------------------------------</span></div><div class="line">   <span class="comment">// OUTPUT W/O PROOF (2.66 GHz Intel Core i7)</span></div><div class="line">   <span class="comment">// ============================================</span></div><div class="line"></div><div class="line">   <span class="comment">// -----------------------------------------</span></div><div class="line">   <span class="comment">// Part 3</span></div><div class="line">   <span class="comment">// Z_Bi p-value (analytic): 0.00094165</span></div><div class="line">   <span class="comment">// Z_Bi significance (analytic): 3.10804</span></div><div class="line">   <span class="comment">// Real time 0:00:00, CP time 0.610</span></div><div class="line"></div><div class="line">   <span class="comment">// Results HybridCalculator_result:</span></div><div class="line">   <span class="comment">// - Null p-value = 0.00103333 +/- 0.000179406</span></div><div class="line">   <span class="comment">// - Significance = 3.08048 sigma</span></div><div class="line">   <span class="comment">// - Number of S+B toys: 1000</span></div><div class="line">   <span class="comment">// - Number of B toys: 30000</span></div><div class="line">   <span class="comment">// - Test statistic evaluated on data: 150</span></div><div class="line">   <span class="comment">// - CL_b: 0.998967 +/- 0.000185496</span></div><div class="line">   <span class="comment">// - CL_s+b: 0.495 +/- 0.0158106</span></div><div class="line">   <span class="comment">// - CL_s: 0.495512 +/- 0.0158272</span></div><div class="line">   <span class="comment">// Real time 0:04:43, CP time 283.780</span></div><div class="line"></div><div class="line">   <span class="comment">// With PROOF</span></div><div class="line">   <span class="comment">// -----------------------------------------</span></div><div class="line">   <span class="comment">// Part 5</span></div><div class="line"></div><div class="line">   <span class="comment">// Results HybridCalculator_result:</span></div><div class="line">   <span class="comment">// - Null p-value = 0.00105 +/- 0.000206022</span></div><div class="line">   <span class="comment">// - Significance = 3.07571 sigma</span></div><div class="line">   <span class="comment">// - Number of S+B toys: 1000</span></div><div class="line">   <span class="comment">// - Number of B toys: 20000</span></div><div class="line">   <span class="comment">// - Test statistic evaluated on data: 10.8198</span></div><div class="line">   <span class="comment">// - CL_b: 0.99895 +/- 0.000229008</span></div><div class="line">   <span class="comment">// - CL_s+b: 0.491 +/- 0.0158088</span></div><div class="line">   <span class="comment">// - CL_s: 0.491516 +/- 0.0158258</span></div><div class="line">   <span class="comment">// Real time 0:02:22, CP time 0.990</span></div><div class="line"></div><div class="line">   <span class="comment">//-------------------------------------------------------</span></div><div class="line">   <span class="comment">// Comparison</span></div><div class="line">   <span class="comment">//-------------------------------------------------------</span></div><div class="line">   <span class="comment">// LEPStatToolsForLHC</span></div><div class="line">   <span class="comment">// https://plone4.fnal.gov:4430/P0/phystat/packages/0703002</span></div><div class="line">   <span class="comment">// Uses Gaussian prior</span></div><div class="line">   <span class="comment">// CL_b = 6.218476e-04, Significance = 3.228665 sigma</span></div><div class="line">   <span class="comment">//</span></div><div class="line">   <span class="comment">//-------------------------------------------------------</span></div><div class="line">   <span class="comment">// Comparison</span></div><div class="line">   <span class="comment">//-------------------------------------------------------</span></div><div class="line">   <span class="comment">// Asymptotic</span></div><div class="line">   <span class="comment">// From the value of the profile likelihood ratio (5.0338)</span></div><div class="line">   <span class="comment">// The significance can be estimated using Wilks&#39;s theorem</span></div><div class="line">   <span class="comment">// significance = sqrt(2*profileLR) = 3.1729 sigma</span></div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Authors</dt><dd>Kyle Cranmer, Wouter Verkerke, and Sven Kreiss </dd></dl>

<p class="definition">Definition in file <a class="el" href="HybridStandardForm_8C_source.html">HybridStandardForm.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:25 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>

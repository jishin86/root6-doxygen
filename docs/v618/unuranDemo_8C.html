<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>ROOT: tutorials/unuran/unuranDemo.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="./mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table bgcolor="#346295" cellspacing="0" cellpadding="0">
  <tr>
    <td> <img style="height:90px" alt="Logo" src="rootlogo.gif"/> </td>
    <td valign="middle" style="color: #FFFFFF" nowrap="nowrap"><font size="6">ROOT</font> &#160; 6.18/03 <br> Reference Guide </td>
    <td style="width:100%"> </td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0d353d24d0afa59909efab6593124f6d.html">tutorials</a></li><li class="navelem"><a class="el" href="dir_5c5068b278f61d3483a9b8a23b237324.html">unuran</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">unuranDemo.C File Reference<div class="ingroups"><a class="el" href="group__Tutorials.html">Tutorials</a> &raquo; <a class="el" href="group__tutorial__unuran.html">Unuran tutorials</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Example macro to show unuran capabilities The results are compared with what is obtained using <a class="el" href="classTRandom.html" title=" This is the base class for the ROOT Random number generators. ">TRandom</a> or <a class="el" href="classTF1.html#ab44c5f63db88a3831d74c7c84dc6316b" title="Return a random number following this function shape. ">TF1::GetRandom</a> The macro is divided in 3 parts: </p>
<ul>
<li>testStringAPI : show how to use string API of UNURAN to generate Gaussian random numbers</li>
<li>testDistr1D : show how to pass a 1D distribution object to UNURAN to generate numbers according to the given distribution object</li>
<li>testDistrMultiDIm : show how to pass a multidimensional distribution object to UNURAN</li>
</ul>
<p>To execute the macro type in:</p>
<div class="fragment"><div class="line">root[0]: <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a6ff4c4c6cd8a75a199a30dd94359f205">Load</a>(<span class="stringliteral">&quot;libMathCore&quot;</span>);</div><div class="line">root[0]: <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a6ff4c4c6cd8a75a199a30dd94359f205">Load</a>(<span class="stringliteral">&quot;libUnuran&quot;</span>);</div><div class="line">root[0]: .x  unuranDemo.C+</div></div><!-- fragment --><div class="fragment"><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TStopwatch_8h.html">TStopwatch.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TUnuran_8h.html">TUnuran.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TUnuranContDist_8h.html">TUnuranContDist.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TUnuranMultiContDist_8h.html">TUnuranMultiContDist.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TUnuranDiscrDist_8h.html">TUnuranDiscrDist.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TUnuranEmpDist_8h.html">TUnuranEmpDist.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TH1_8h.html">TH1.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TH3_8h.html">TH3.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TF3_8h.html">TF3.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TMath_8h.html">TMath.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TRandom2_8h.html">TRandom2.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TSystem_8h.html">TSystem.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TStyle_8h.html">TStyle.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TApplication_8h.html">TApplication.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TCanvas_8h.html">TCanvas.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ProbFunc_8h.html">Math/ProbFunc.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="DistFunc_8h.html">Math/DistFunc.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using</span> std::cout;</div><div class="line"><span class="keyword">using</span> std::endl;</div><div class="line"></div><div class="line"><span class="comment">// number of distribution generated points</span></div><div class="line"><span class="preprocessor">#define NGEN 1000000</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> izone = 0;</div><div class="line"><a class="code" href="classTCanvas.html">TCanvas</a> * <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a> = 0;</div><div class="line"></div><div class="line"><span class="comment">// test using UNURAN string interface</span></div><div class="line"><span class="keywordtype">void</span> testStringAPI() {</div><div class="line"></div><div class="line">   <a class="code" href="classTH1D.html">TH1D</a> * <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a> = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;h1G&quot;</span>,<span class="stringliteral">&quot;gaussian distribution from Unuran&quot;</span>,100,-10,10);</div><div class="line">   <a class="code" href="classTH1D.html">TH1D</a> * h2 = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;h2G&quot;</span>,<span class="stringliteral">&quot;gaussian distribution from TRandom&quot;</span>,100,-10,10);</div><div class="line"></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;\nTest using UNURAN string API \n\n&quot;</span>;</div><div class="line"></div><div class="line"></div><div class="line">   <a class="code" href="classTUnuran.html">TUnuran</a> unr;</div><div class="line">   <span class="keywordflow">if</span> (! unr.<a class="code" href="classTUnuran.html#a793f7255df1e6d595fdfb6bc2f3a8256">Init</a>( <span class="stringliteral">&quot;normal()&quot;</span>, <span class="stringliteral">&quot;method=arou&quot;</span>) ) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;Error initializing unuran&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="keywordtype">int</span> <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a> = NGEN;</div><div class="line">   <a class="code" href="classTStopwatch.html">TStopwatch</a> w;</div><div class="line">   w.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line"></div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; ++i) {</div><div class="line">       <span class="keywordtype">double</span> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = unr.<a class="code" href="classTUnuran.html#ac1039b3ae8d62c97edb5a0e54cefb90a">Sample</a>();</div><div class="line">       <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(  <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> );</div><div class="line">   }</div><div class="line"></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Time using Unuran method &quot;</span> &lt;&lt; unr.<a class="code" href="classTUnuran.html#a90c31e98b3f8b3d96f8280345c93202b">MethodName</a>() &lt;&lt; <span class="stringliteral">&quot;\t=\t &quot;</span> &lt;&lt; w.<a class="code" href="classTStopwatch.html#a6cd3ec9942388d9186d23d66f88d70b8">CpuTime</a>() &lt;&lt; endl;</div><div class="line"></div><div class="line"></div><div class="line">   <span class="comment">// use TRandom::Gaus</span></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; ++i) {</div><div class="line">      <span class="keywordtype">double</span> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = <a class="code" href="TRandom_8h.html#a9ee275021031e1e27291bb36baa0e3e2">gRandom</a>-&gt;<a class="code" href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">Gaus</a>(0,1);</div><div class="line">       h2-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(  <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> );</div><div class="line">   }</div><div class="line"></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Time using TRandom::Gaus  \t=\t &quot;</span> &lt;&lt; w.<a class="code" href="classTStopwatch.html#a6cd3ec9942388d9186d23d66f88d70b8">CpuTime</a>() &lt;&lt; endl;</div><div class="line"></div><div class="line">   assert(<a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a> != 0);</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(++izone);</div><div class="line">   <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(++izone);</div><div class="line">   h2-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">double</span> distr(<span class="keywordtype">double</span> *<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <span class="keywordtype">double</span> *p) {</div><div class="line">   <span class="keywordflow">return</span> <a class="code" href="group__PdfFunc.html#ga674162ea051bf687243264996d046f73">ROOT::Math::breitwigner_pdf</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0],p[0],p[1]);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">double</span> cdf(<span class="keywordtype">double</span> *<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <span class="keywordtype">double</span> *p) {</div><div class="line">   <span class="keywordflow">return</span> <a class="code" href="group__ProbFunc.html#ga9e4f919c4ac8f2896a69120e941f91cc">ROOT::Math::breitwigner_cdf</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0],p[0],p[1]);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// test of unuran passing as input a distribution object( a BreitWigner) distribution</span></div><div class="line"><span class="keywordtype">void</span> testDistr1D() {</div><div class="line"></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;\nTest 1D Continous distributions\n\n&quot;</span>;</div><div class="line"></div><div class="line">   <a class="code" href="classTH1D.html">TH1D</a> * <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a> = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;h1BW&quot;</span>,<span class="stringliteral">&quot;Breit-Wigner distribution from Unuran&quot;</span>,100,-10,10);</div><div class="line">   <a class="code" href="classTH1D.html">TH1D</a> * h2 = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;h2BW&quot;</span>,<span class="stringliteral">&quot;Breit-Wigner distribution from GetRandom&quot;</span>,100,-10,10);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">   <a class="code" href="classTF1.html">TF1</a> * <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a> = <span class="keyword">new</span> <a class="code" href="classTF1.html">TF1</a>(<span class="stringliteral">&quot;distrFunc&quot;</span>,distr,-10,10,2);</div><div class="line">   <span class="keywordtype">double</span> par[2] = {1,0};  <span class="comment">// values are gamma and mean</span></div><div class="line">   <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>-&gt;SetParameters(par);</div><div class="line"></div><div class="line">   <a class="code" href="classTF1.html">TF1</a> * <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a> = <span class="keyword">new</span> <a class="code" href="classTF1.html">TF1</a>(<span class="stringliteral">&quot;cdfFunc&quot;</span>,cdf,-10,10,2);</div><div class="line">   <a class="code" href="civetweb_8c.html#a4d1e08e68d8456f97fbfe21f3e3c85bd">fc</a>-&gt;SetParameters(par);</div><div class="line"></div><div class="line">   <span class="comment">// create Unuran 1D distribution object</span></div><div class="line">   <a class="code" href="classTUnuranContDist.html">TUnuranContDist</a> <a class="code" href="namespaceROOT_1_1Math_1_1gv__detail.html#a8ab33c06d03028aa065f9ec2466f4341">dist</a>(<a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>);</div><div class="line">   <span class="comment">// to use a different random number engine do:</span></div><div class="line">   <a class="code" href="classTRandom2.html">TRandom2</a> * random = <span class="keyword">new</span> <a class="code" href="classTRandom2.html">TRandom2</a>();</div><div class="line">   <span class="keywordtype">int</span> logLevel = 2;</div><div class="line">   <a class="code" href="classTUnuran.html">TUnuran</a> unr(random,logLevel);</div><div class="line"></div><div class="line">   <span class="comment">// select unuran method for generating the random numbers</span></div><div class="line">   std::string method = <span class="stringliteral">&quot;tdr&quot;</span>;</div><div class="line">   <span class="comment">//std::string method = &quot;method=auto&quot;;</span></div><div class="line">   <span class="comment">// &quot;method=hinv&quot;</span></div><div class="line">   <span class="comment">// set the cdf for some methods like hinv that requires it</span></div><div class="line">   <span class="comment">// dist.SetCdf(fc);</span></div><div class="line"></div><div class="line">   <span class="comment">//cout &lt;&lt; &quot;unuran method is &quot; &lt;&lt; method &lt;&lt; endl;</span></div><div class="line"></div><div class="line">   <span class="keywordflow">if</span> (!unr.<a class="code" href="classTUnuran.html#a793f7255df1e6d595fdfb6bc2f3a8256">Init</a>(<a class="code" href="namespaceROOT_1_1Math_1_1gv__detail.html#a8ab33c06d03028aa065f9ec2466f4341">dist</a>,method) ) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;Error initializing unuran&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">   <a class="code" href="classTStopwatch.html">TStopwatch</a> w;</div><div class="line">   w.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line"></div><div class="line">   <span class="keywordtype">int</span> <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a> = NGEN;</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; ++i) {</div><div class="line">      <span class="keywordtype">double</span> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = unr.<a class="code" href="classTUnuran.html#ac1039b3ae8d62c97edb5a0e54cefb90a">Sample</a>();</div><div class="line">      <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(  <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> );</div><div class="line">   }</div><div class="line"></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Time using Unuran method &quot;</span> &lt;&lt; unr.<a class="code" href="classTUnuran.html#a90c31e98b3f8b3d96f8280345c93202b">MethodName</a>() &lt;&lt; <span class="stringliteral">&quot;\t=\t &quot;</span> &lt;&lt; w.<a class="code" href="classTStopwatch.html#a6cd3ec9942388d9186d23d66f88d70b8">CpuTime</a>() &lt;&lt; endl;</div><div class="line"></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; ++i) {</div><div class="line">      <span class="keywordtype">double</span> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> = <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>-&gt;GetRandom();</div><div class="line">      h2-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(  <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a> );</div><div class="line">   }</div><div class="line"></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Time using TF1::GetRandom()  \t=\t &quot;</span> &lt;&lt; w.<a class="code" href="classTStopwatch.html#a6cd3ec9942388d9186d23d66f88d70b8">CpuTime</a>() &lt;&lt; endl;</div><div class="line"></div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(++izone);</div><div class="line">   <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line"></div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(++izone);</div><div class="line">   h2-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line"></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot; chi2 test of UNURAN vs GetRandom generated histograms:  &quot;</span> &lt;&lt; std::endl;</div><div class="line">   <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTH1.html#a6c281eebc0c0a848e7a0d620425090a5">Chi2Test</a>(h2,<span class="stringliteral">&quot;UUP&quot;</span>);</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// 3D gaussian distribution</span></div><div class="line"><span class="keywordtype">double</span> gaus3d(<span class="keywordtype">double</span> *<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <span class="keywordtype">double</span> *p) {</div><div class="line"></div><div class="line">   <span class="keywordtype">double</span> sigma_x = p[0];</div><div class="line">   <span class="keywordtype">double</span> sigma_y = p[1];</div><div class="line">   <span class="keywordtype">double</span> sigma_z = p[2];</div><div class="line">   <span class="keywordtype">double</span> rho = p[2];</div><div class="line">   <span class="keywordtype">double</span> u = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0] / sigma_x ;</div><div class="line">   <span class="keywordtype">double</span> <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a> = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[1] / sigma_y ;</div><div class="line">   <span class="keywordtype">double</span> w = <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[2] / sigma_z ;</div><div class="line">   <span class="keywordtype">double</span> <a class="code" href="RSha256_8hxx.html#a63f410abde93141c9013b7d3f3971738">c</a> = 1 - rho*rho ;</div><div class="line">   <span class="keywordtype">double</span> result = (1 / (2 * <a class="code" href="namespaceTMath.html#ab7512d834c08404cd5110251f5a31099">TMath::Pi</a>() * sigma_x * sigma_y * sigma_z * <a class="code" href="TMath_8h.html#acdb55c1010a6c379a49db0201bf55d89">sqrt</a>(<a class="code" href="RSha256_8hxx.html#a63f410abde93141c9013b7d3f3971738">c</a>)))</div><div class="line">      * <a class="code" href="TMath_8h.html#ae87cffe9d4bba63937ab959bda26aa0c">exp</a> (-(u * u - 2 * rho * u * <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a> + <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a> * <a class="code" href="Dict_8h.html#ae4dfd0ff80708edc0ec19fe36e65d9a7">v</a> + w*w) / (2 * <a class="code" href="RSha256_8hxx.html#a63f410abde93141c9013b7d3f3971738">c</a>));</div><div class="line">   <span class="keywordflow">return</span> result;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// test of unuran passing as input a multi-dimension distribution object</span></div><div class="line"><span class="keywordtype">void</span> testDistrMultiDim() {</div><div class="line"></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;\nTest Multidimensional distributions\n\n&quot;</span>;</div><div class="line"></div><div class="line">   <a class="code" href="classTH3D.html">TH3D</a> * <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a> = <span class="keyword">new</span> <a class="code" href="classTH3D.html">TH3D</a>(<span class="stringliteral">&quot;h13D&quot;</span>,<span class="stringliteral">&quot;gaussian 3D distribution from Unuran&quot;</span>,50,-10,10,50,-10,10,50,-10,10);</div><div class="line">   <a class="code" href="classTH3D.html">TH3D</a> * h2 = <span class="keyword">new</span> <a class="code" href="classTH3D.html">TH3D</a>(<span class="stringliteral">&quot;h23D&quot;</span>,<span class="stringliteral">&quot;gaussian 3D distribution from GetRandom&quot;</span>,50,-10,10,50,-10,10,50,-10,10);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">   <a class="code" href="classTF3.html">TF3</a> * <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a> = <span class="keyword">new</span> <a class="code" href="classTF3.html">TF3</a>(<span class="stringliteral">&quot;g3d&quot;</span>,gaus3d,-10,10,-10,10,-10,10,3);</div><div class="line">   <span class="keywordtype">double</span> par[3] = {2,2,0.5};</div><div class="line">   <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>-&gt;SetParameters(par);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">   <a class="code" href="classTUnuranMultiContDist.html">TUnuranMultiContDist</a> <a class="code" href="namespaceROOT_1_1Math_1_1gv__detail.html#a8ab33c06d03028aa065f9ec2466f4341">dist</a>(<a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>);</div><div class="line">   <a class="code" href="classTUnuran.html">TUnuran</a> unr(<a class="code" href="TRandom_8h.html#a9ee275021031e1e27291bb36baa0e3e2">gRandom</a>);</div><div class="line">   <span class="comment">//std::string method = &quot;method=vnrou&quot;;</span></div><div class="line"></div><div class="line">   <span class="comment">//std::string method = &quot;method=hitro;use_boundingrectangle=false &quot;;</span></div><div class="line">   std::string method = <span class="stringliteral">&quot;hitro&quot;</span>;</div><div class="line">   <span class="keywordflow">if</span> ( !  unr.<a class="code" href="classTUnuran.html#a793f7255df1e6d595fdfb6bc2f3a8256">Init</a>(<a class="code" href="namespaceROOT_1_1Math_1_1gv__detail.html#a8ab33c06d03028aa065f9ec2466f4341">dist</a>,method) ) {</div><div class="line">      cout &lt;&lt; <span class="stringliteral">&quot;Error initializing unuran&quot;</span> &lt;&lt; endl;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">   }</div><div class="line"></div><div class="line">   <a class="code" href="classTStopwatch.html">TStopwatch</a> w;</div><div class="line">   w.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line"></div><div class="line">   <span class="keywordtype">double</span> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[3];</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NGEN; ++i) {</div><div class="line">      unr.<a class="code" href="classTUnuran.html#a661d8eb229fc7792096232ea0a29035b">SampleMulti</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>);</div><div class="line">      <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0],<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[1],<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[2]);</div><div class="line">   }</div><div class="line"></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Time using Unuran method &quot;</span> &lt;&lt; unr.<a class="code" href="classTUnuran.html#a90c31e98b3f8b3d96f8280345c93202b">MethodName</a>() &lt;&lt; <span class="stringliteral">&quot;\t=\t\t &quot;</span> &lt;&lt; w.<a class="code" href="classTStopwatch.html#a6cd3ec9942388d9186d23d66f88d70b8">CpuTime</a>() &lt;&lt; endl;</div><div class="line"></div><div class="line">   assert(<a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a> != 0);</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(++izone);</div><div class="line">   <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line"></div><div class="line"></div><div class="line">   <span class="comment">// need to set a reasonable number of points in TF1 to get acceptable quality from GetRandom to</span></div><div class="line">   <span class="keywordtype">int</span> np = 200;</div><div class="line">   <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>-&gt;SetNpx(np);</div><div class="line">   <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>-&gt;SetNpy(np);</div><div class="line">   <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>-&gt;SetNpz(np);</div><div class="line"></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NGEN; ++i) {</div><div class="line">      <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>-&gt;GetRandom3(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0],<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[1],<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[2]);</div><div class="line">      h2-&gt;<a class="code" href="classTH3.html#a0f7adbf36657568f005e06716ac7182a">Fill</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0],<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[1],<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[2]);</div><div class="line">   }</div><div class="line"></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Time using TF1::GetRandom  \t\t=\t &quot;</span> &lt;&lt; w.<a class="code" href="classTStopwatch.html#a6cd3ec9942388d9186d23d66f88d70b8">CpuTime</a>() &lt;&lt; endl;</div><div class="line"></div><div class="line"></div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(++izone);</div><div class="line">   h2-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line"></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot; chi2 test of UNURAN vs GetRandom generated histograms:  &quot;</span> &lt;&lt; std::endl;</div><div class="line">   <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTH1.html#a6c281eebc0c0a848e7a0d620425090a5">Chi2Test</a>(h2,<span class="stringliteral">&quot;UUP&quot;</span>);</div><div class="line"></div><div class="line">}</div><div class="line"><span class="comment">//_____________________________________________</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// example of discrete distributions</span></div><div class="line"></div><div class="line"><span class="keywordtype">double</span> poisson(<span class="keywordtype">double</span> * <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>, <span class="keywordtype">double</span> * p) {</div><div class="line">   <span class="keywordflow">return</span> <a class="code" href="group__PdfFunc.html#gae9dc7f7dea3121f4b69ce290d385319d">ROOT::Math::poisson_pdf</a>(<span class="keywordtype">int</span>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[0]),p[0]);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> testDiscDistr() {</div><div class="line"></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;\nTest Discrete distributions\n\n&quot;</span>;</div><div class="line"></div><div class="line">   <a class="code" href="classTH1D.html">TH1D</a> * <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a> = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;h1PS&quot;</span>,<span class="stringliteral">&quot;Unuran Poisson prob&quot;</span>,20,0,20);</div><div class="line">   <a class="code" href="classTH1D.html">TH1D</a> * h2 = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;h2PS&quot;</span>,<span class="stringliteral">&quot;Poisson dist from TRandom&quot;</span>,20,0,20);</div><div class="line"></div><div class="line">   <span class="keywordtype">double</span> mu = 5;</div><div class="line"></div><div class="line">   <a class="code" href="classTF1.html">TF1</a> * <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a> = <span class="keyword">new</span> <a class="code" href="classTF1.html">TF1</a>(<span class="stringliteral">&quot;fps&quot;</span>,poisson,1,0,1);</div><div class="line">   <a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>-&gt;SetParameter(0,mu);</div><div class="line"></div><div class="line">   <a class="code" href="classTUnuranDiscrDist.html">TUnuranDiscrDist</a> dist2 = <a class="code" href="classTUnuranDiscrDist.html">TUnuranDiscrDist</a>(<a class="code" href="RSha256_8hxx.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>);</div><div class="line">   <a class="code" href="classTUnuran.html">TUnuran</a> unr;</div><div class="line"></div><div class="line">   <span class="comment">// dari method (needs also the mode and pmf sum)</span></div><div class="line">   dist2.<a class="code" href="classTUnuranDiscrDist.html#a250c6fd33e0a113523820e0bc7b787c0">SetMode</a>(<span class="keywordtype">int</span>(mu) );</div><div class="line">   dist2.<a class="code" href="classTUnuranDiscrDist.html#a78b50ef63d376107657f85ae6cb0e65f">SetProbSum</a>(1.0);</div><div class="line">   <span class="keywordtype">bool</span> ret = unr.<a class="code" href="classTUnuran.html#a793f7255df1e6d595fdfb6bc2f3a8256">Init</a>(dist2,<span class="stringliteral">&quot;dari&quot;</span>);</div><div class="line">   <span class="keywordflow">if</span> (!ret) <span class="keywordflow">return</span>;</div><div class="line"></div><div class="line">   <a class="code" href="classTStopwatch.html">TStopwatch</a> w;</div><div class="line">   w.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line"></div><div class="line">   <span class="keywordtype">int</span> <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a> = NGEN;</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; ++i) {</div><div class="line">      <span class="keywordtype">int</span> k = unr.<a class="code" href="classTUnuran.html#a394ee641ae3cd9711ebe9b78865fe79e">SampleDiscr</a>();</div><div class="line">      <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>( <span class="keywordtype">double</span>(k) );</div><div class="line">   }</div><div class="line"></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Time using Unuran method &quot;</span> &lt;&lt; unr.<a class="code" href="classTUnuran.html#a90c31e98b3f8b3d96f8280345c93202b">MethodName</a>() &lt;&lt; <span class="stringliteral">&quot;\t=\t\t &quot;</span> &lt;&lt; w.<a class="code" href="classTStopwatch.html#a6cd3ec9942388d9186d23d66f88d70b8">CpuTime</a>() &lt;&lt; endl;</div><div class="line"></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; ++i) {</div><div class="line">      h2-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(  <a class="code" href="TRandom_8h.html#a9ee275021031e1e27291bb36baa0e3e2">gRandom</a>-&gt;<a class="code" href="classTRandom.html#a1529ed28e6ce1230d135548460b12c19">Poisson</a>(mu) );</div><div class="line">   }</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Time using TRandom::Poisson &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t=\t\t &quot;</span> &lt;&lt; w.<a class="code" href="classTStopwatch.html#a6cd3ec9942388d9186d23d66f88d70b8">CpuTime</a>() &lt;&lt; endl;</div><div class="line"></div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(++izone);</div><div class="line">   <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTAttMarker.html#a697e1a65975ff344c9dca7618fd44de4">SetMarkerStyle</a>(20);</div><div class="line">   <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>(<span class="stringliteral">&quot;E&quot;</span>);</div><div class="line">   h2-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>(<span class="stringliteral">&quot;same&quot;</span>);</div><div class="line"></div><div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot; chi2 test of UNURAN vs TRandom generated histograms:  &quot;</span> &lt;&lt; std::endl;</div><div class="line">   <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTH1.html#a6c281eebc0c0a848e7a0d620425090a5">Chi2Test</a>(h2,<span class="stringliteral">&quot;UUP&quot;</span>);</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//_____________________________________________</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// example of empirical distributions</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> testEmpDistr() {</div><div class="line"></div><div class="line"></div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;\nTest Empirical distributions using smoothing\n\n&quot;</span>;</div><div class="line"></div><div class="line">   <span class="comment">// start with a set of data</span></div><div class="line">   <span class="comment">// for example 1000 two-gaussian data</span></div><div class="line">   <span class="keyword">const</span> <span class="keywordtype">int</span> Ndata = 1000;</div><div class="line">   <span class="keywordtype">double</span> <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[Ndata];</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Ndata; ++i) {</div><div class="line">      <span class="keywordflow">if</span> (i &lt; 0.5*Ndata )</div><div class="line">         <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i] = <a class="code" href="TRandom_8h.html#a9ee275021031e1e27291bb36baa0e3e2">gRandom</a>-&gt;<a class="code" href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">Gaus</a>(-1.,1.);</div><div class="line">      <span class="keywordflow">else</span></div><div class="line">         <a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>[i] = <a class="code" href="TRandom_8h.html#a9ee275021031e1e27291bb36baa0e3e2">gRandom</a>-&gt;<a class="code" href="classTRandom.html#a0e445e213eae1343b3d22086ecb87314">Gaus</a>(1.,3.);</div><div class="line">   }</div><div class="line"></div><div class="line">   <a class="code" href="classTH1D.html">TH1D</a> * h0 = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;h0Ref&quot;</span>,<span class="stringliteral">&quot;Starting data&quot;</span>,100,-10,10);</div><div class="line">   <a class="code" href="classTH1D.html">TH1D</a> * <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a> = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;h1Unr&quot;</span>,<span class="stringliteral">&quot;Unuran unbin Generated data&quot;</span>,100,-10,10);</div><div class="line">   <a class="code" href="classTH1D.html">TH1D</a> * h1b = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;h1bUnr&quot;</span>,<span class="stringliteral">&quot;Unuran bin Generated data&quot;</span>,100,-10,10);</div><div class="line">   <a class="code" href="classTH1D.html">TH1D</a> * h2 = <span class="keyword">new</span> <a class="code" href="classTH1D.html">TH1D</a>(<span class="stringliteral">&quot;h2GR&quot;</span>,<span class="stringliteral">&quot;Data from TH1::GetRandom&quot;</span>,100,-10,10);</div><div class="line"></div><div class="line">   h0-&gt;<a class="code" href="classTH1.html#ac52e9d4e6a3946f02dedb43014607adf">FillN</a>(Ndata,<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,0,1); <span class="comment">// fill histogram with starting data</span></div><div class="line"></div><div class="line">   <a class="code" href="classTUnuran.html">TUnuran</a> unr;</div><div class="line">   <a class="code" href="classTUnuranEmpDist.html">TUnuranEmpDist</a> <a class="code" href="namespaceROOT_1_1Math_1_1gv__detail.html#a8ab33c06d03028aa065f9ec2466f4341">dist</a>(<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>,<a class="code" href="legend1_8C.html#a13c6713ae496caa8195647f76887f926">x</a>+Ndata,1);</div><div class="line"></div><div class="line"></div><div class="line">   <a class="code" href="classTStopwatch.html">TStopwatch</a> w;</div><div class="line">   <span class="keywordtype">int</span> <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a> = NGEN;</div><div class="line"></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">   <span class="keywordflow">if</span> (!unr.<a class="code" href="classTUnuran.html#a793f7255df1e6d595fdfb6bc2f3a8256">Init</a>(<a class="code" href="namespaceROOT_1_1Math_1_1gv__detail.html#a8ab33c06d03028aa065f9ec2466f4341">dist</a>)) <span class="keywordflow">return</span>;</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; ++i) {</div><div class="line">      <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>( unr.<a class="code" href="classTUnuran.html#ac1039b3ae8d62c97edb5a0e54cefb90a">Sample</a>() );</div><div class="line">   }</div><div class="line"></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Time using Unuran unbin  &quot;</span> &lt;&lt; unr.<a class="code" href="classTUnuran.html#a90c31e98b3f8b3d96f8280345c93202b">MethodName</a>() &lt;&lt; <span class="stringliteral">&quot;\t=\t\t &quot;</span> &lt;&lt; w.<a class="code" href="classTStopwatch.html#a6cd3ec9942388d9186d23d66f88d70b8">CpuTime</a>() &lt;&lt; endl;</div><div class="line"></div><div class="line">   <a class="code" href="classTUnuranEmpDist.html">TUnuranEmpDist</a> binDist(h0);</div><div class="line"></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">   <span class="keywordflow">if</span> (!unr.<a class="code" href="classTUnuran.html#a793f7255df1e6d595fdfb6bc2f3a8256">Init</a>(binDist)) <span class="keywordflow">return</span>;</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; ++i) {</div><div class="line">      h1b-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>( unr.<a class="code" href="classTUnuran.html#ac1039b3ae8d62c97edb5a0e54cefb90a">Sample</a>() );</div><div class="line">   }</div><div class="line">   w.<a class="code" href="classTStopwatch.html#a95876cba044994c635f8fd5340603ea4">Stop</a>();</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Time using Unuran bin  &quot;</span> &lt;&lt; unr.<a class="code" href="classTUnuran.html#a90c31e98b3f8b3d96f8280345c93202b">MethodName</a>() &lt;&lt; <span class="stringliteral">&quot;\t=\t\t &quot;</span> &lt;&lt; w.<a class="code" href="classTStopwatch.html#a6cd3ec9942388d9186d23d66f88d70b8">CpuTime</a>() &lt;&lt; endl;</div><div class="line"></div><div class="line">   w.<a class="code" href="classTStopwatch.html#a13fe330b5d3a2143551fe5eb584a5034">Start</a>();</div><div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="legend1_8C.html#a16daaa7b596941b23915a1ac1be5b42c">n</a>; ++i) {</div><div class="line">      h2-&gt;<a class="code" href="classTH1.html#a77e71290a82517d317ea8d05e96b6c4a">Fill</a>(  h0-&gt;<a class="code" href="classTH1.html#a4dd1bbf1cbeea1e7da03e781d01cf232">GetRandom</a>() );</div><div class="line">   }</div><div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;Time using TH1::GetRandom &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\t=\t\t &quot;</span> &lt;&lt; w.<a class="code" href="classTStopwatch.html#a6cd3ec9942388d9186d23d66f88d70b8">CpuTime</a>() &lt;&lt; endl;</div><div class="line"></div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;cd(++izone);</div><div class="line"></div><div class="line">   h2-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>();</div><div class="line">   <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTAttLine.html#a718156d3be0e4b3e0c52b2257a9d4e7a">SetLineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8a5a655b1a02e5b0311571ca57ce4f3900">kRed</a>);</div><div class="line">   <a class="code" href="legend1_8C.html#aaf2545ecc018288fcf442904a5af9e83">h1</a>-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>(<span class="stringliteral">&quot;same&quot;</span>);</div><div class="line">   h1b-&gt;<a class="code" href="classTAttLine.html#a718156d3be0e4b3e0c52b2257a9d4e7a">SetLineColor</a>(<a class="code" href="Rtypes_8h.html#ac31db05c6cb5891c704eae374f6926a8aab48c32302f7159d81e081c41dc2d3d2">kBlue</a>);</div><div class="line">   h1b-&gt;<a class="code" href="classTH1.html#aa53a024a9e94d5ec91e3ef49e49563da">Draw</a>(<span class="stringliteral">&quot;same&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> unuranDemo() {</div><div class="line"></div><div class="line">   <span class="comment">//gRandom-&gt;SetSeed(0);</span></div><div class="line"></div><div class="line">   <span class="comment">// load libraries</span></div><div class="line">   <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a6ff4c4c6cd8a75a199a30dd94359f205">Load</a>(<span class="stringliteral">&quot;libMathCore&quot;</span>);</div><div class="line">   <a class="code" href="TSystem_8h.html#ab7182c9ab5a9236e2bc1ed8b3fcb045f">gSystem</a>-&gt;<a class="code" href="classTSystem.html#a6ff4c4c6cd8a75a199a30dd94359f205">Load</a>(<span class="stringliteral">&quot;libUnuran&quot;</span>);</div><div class="line"></div><div class="line">   <span class="comment">// create canvas</span></div><div class="line"></div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a> = <span class="keyword">new</span> <a class="code" href="classTCanvas.html">TCanvas</a>(<span class="stringliteral">&quot;c1_unuranMulti&quot;</span>,<span class="stringliteral">&quot;Multidimensional distribution&quot;</span>,10,10,1000,1000);</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;Divide(2,4);</div><div class="line">   <a class="code" href="TStyle_8h.html#ace94cabdcf18c1e8a7856d8c3f388cfe">gStyle</a>-&gt;<a class="code" href="classTStyle.html#aedeb1d117d9f16af9f8ad430bf956d64">SetOptFit</a>();</div><div class="line"></div><div class="line">   testStringAPI();</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;Update();</div><div class="line">   testDistr1D();</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;Update();</div><div class="line">   testDistrMultiDim();</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;Update();</div><div class="line">   testDiscDistr();</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;Update();</div><div class="line">   testEmpDistr();</div><div class="line">   <a class="code" href="legend1_8C.html#a1259eec59a19080ae1da77e79182c60e">c1</a>-&gt;Update();</div><div class="line"></div><div class="line"></div><div class="line">}</div></div><!-- fragment --><dl class="section author"><dt>Author</dt><dd>Lorenzo Moneta </dd></dl>

<p class="definition">Definition in file <a class="el" href="unuranDemo_8C_source.html">unuranDemo.C</a>.</p>
</div></div><!-- contents -->
<html>
<body>
<div id="footer" style="background-color:#E5EBF3;">
<small>
<img class="footer" src="rootlogo_s.gif" alt="root"/></a>
ROOT 6.18/03 - Reference Guide Generated on Thu Aug 29 2019 04:10:37 (GVA Time) using Doxygen 1.8.14.
</small>
</div>
</body>
</html>
